var Cg=(s,r)=>()=>(r||s((r={exports:{}}).exports,r),r.exports);var _b=Cg((Ab,vi)=>{function Tg(s,r){for(var n=0;n<r.length;n++){const o=r[n];if(typeof o!="string"&&!Array.isArray(o)){for(const l in o)if(l!=="default"&&!(l in s)){const c=Object.getOwnPropertyDescriptor(o,l);c&&Object.defineProperty(s,l,c.get?c:{enumerable:!0,get:()=>o[l]})}}}return Object.freeze(Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}))}(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const c of l)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function n(l){const c={};return l.integrity&&(c.integrity=l.integrity),l.referrerPolicy&&(c.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?c.credentials="include":l.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(l){if(l.ep)return;l.ep=!0;const c=n(l);fetch(l.href,c)}})();const Pg="modulepreload",Ag=function(s){return"/"+s},of={},et=function(r,n,o){let l=Promise.resolve();if(n&&n.length>0){let g=function(y){return Promise.all(y.map(x=>Promise.resolve(x).then(b=>({status:"fulfilled",value:b}),b=>({status:"rejected",reason:b}))))};var d=g;document.getElementsByTagName("link");const p=document.querySelector("meta[property=csp-nonce]"),f=p?.nonce||p?.getAttribute("nonce");l=g(n.map(y=>{if(y=Ag(y),y in of)return;of[y]=!0;const x=y.endsWith(".css"),b=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${b}`))return;const T=document.createElement("link");if(T.rel=x?"stylesheet":Pg,x||(T.as="script"),T.crossOrigin="",T.href=y,f&&T.setAttribute("nonce",f),document.head.appendChild(T),x)return new Promise((_,E)=>{T.addEventListener("load",_),T.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${y}`)))})}))}function c(p){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=p,window.dispatchEvent(f),!f.defaultPrevented)throw p}return l.then(p=>{for(const f of p||[])f.status==="rejected"&&c(f.reason);return r().catch(c)})};function Nu(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function Og(s){if(Object.prototype.hasOwnProperty.call(s,"__esModule"))return s;var r=s.default;if(typeof r=="function"){var n=function o(){var l=!1;try{l=this instanceof o}catch{}return l?Reflect.construct(r,arguments,this.constructor):r.apply(this,arguments)};n.prototype=r.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(s).forEach(function(o){var l=Object.getOwnPropertyDescriptor(s,o);Object.defineProperty(n,o,l.get?l:{enumerable:!0,get:function(){return s[o]}})}),n}var zc={exports:{}},ri={},qc={exports:{}},Xe={};var lf;function Ig(){if(lf)return Xe;lf=1;var s=Symbol.for("react.element"),r=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),c=Symbol.for("react.provider"),d=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),x=Symbol.iterator;function b(w){return w===null||typeof w!="object"?null:(w=x&&w[x]||w["@@iterator"],typeof w=="function"?w:null)}var T={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,E={};function k(w,L,Y){this.props=w,this.context=L,this.refs=E,this.updater=Y||T}k.prototype.isReactComponent={},k.prototype.setState=function(w,L){if(typeof w!="object"&&typeof w!="function"&&w!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,w,L,"setState")},k.prototype.forceUpdate=function(w){this.updater.enqueueForceUpdate(this,w,"forceUpdate")};function D(){}D.prototype=k.prototype;function O(w,L,Y){this.props=w,this.context=L,this.refs=E,this.updater=Y||T}var R=O.prototype=new D;R.constructor=O,_(R,k.prototype),R.isPureReactComponent=!0;var M=Array.isArray,X=Object.prototype.hasOwnProperty,G={current:null},de={key:!0,ref:!0,__self:!0,__source:!0};function we(w,L,Y){var ne,ee={},ye=null,se=null;if(L!=null)for(ne in L.ref!==void 0&&(se=L.ref),L.key!==void 0&&(ye=""+L.key),L)X.call(L,ne)&&!de.hasOwnProperty(ne)&&(ee[ne]=L[ne]);var ve=arguments.length-2;if(ve===1)ee.children=Y;else if(1<ve){for(var Ae=Array(ve),Ie=0;Ie<ve;Ie++)Ae[Ie]=arguments[Ie+2];ee.children=Ae}if(w&&w.defaultProps)for(ne in ve=w.defaultProps,ve)ee[ne]===void 0&&(ee[ne]=ve[ne]);return{$$typeof:s,type:w,key:ye,ref:se,props:ee,_owner:G.current}}function $(w,L){return{$$typeof:s,type:w.type,key:L,ref:w.ref,props:w.props,_owner:w._owner}}function he(w){return typeof w=="object"&&w!==null&&w.$$typeof===s}function oe(w){var L={"=":"=0",":":"=2"};return"$"+w.replace(/[=:]/g,function(Y){return L[Y]})}var re=/\/+/g;function le(w,L){return typeof w=="object"&&w!==null&&w.key!=null?oe(""+w.key):L.toString(36)}function J(w,L,Y,ne,ee){var ye=typeof w;(ye==="undefined"||ye==="boolean")&&(w=null);var se=!1;if(w===null)se=!0;else switch(ye){case"string":case"number":se=!0;break;case"object":switch(w.$$typeof){case s:case r:se=!0}}if(se)return se=w,ee=ee(se),w=ne===""?"."+le(se,0):ne,M(ee)?(Y="",w!=null&&(Y=w.replace(re,"$&/")+"/"),J(ee,L,Y,"",function(Ie){return Ie})):ee!=null&&(he(ee)&&(ee=$(ee,Y+(!ee.key||se&&se.key===ee.key?"":(""+ee.key).replace(re,"$&/")+"/")+w)),L.push(ee)),1;if(se=0,ne=ne===""?".":ne+":",M(w))for(var ve=0;ve<w.length;ve++){ye=w[ve];var Ae=ne+le(ye,ve);se+=J(ye,L,Y,Ae,ee)}else if(Ae=b(w),typeof Ae=="function")for(w=Ae.call(w),ve=0;!(ye=w.next()).done;)ye=ye.value,Ae=ne+le(ye,ve++),se+=J(ye,L,Y,Ae,ee);else if(ye==="object")throw L=String(w),Error("Objects are not valid as a React child (found: "+(L==="[object Object]"?"object with keys {"+Object.keys(w).join(", ")+"}":L)+"). If you meant to render a collection of children, use an array instead.");return se}function xe(w,L,Y){if(w==null)return w;var ne=[],ee=0;return J(w,ne,"","",function(ye){return L.call(Y,ye,ee++)}),ne}function ge(w){if(w._status===-1){var L=w._result;L=L(),L.then(function(Y){(w._status===0||w._status===-1)&&(w._status=1,w._result=Y)},function(Y){(w._status===0||w._status===-1)&&(w._status=2,w._result=Y)}),w._status===-1&&(w._status=0,w._result=L)}if(w._status===1)return w._result.default;throw w._result}var H={current:null},V={transition:null},pe={ReactCurrentDispatcher:H,ReactCurrentBatchConfig:V,ReactCurrentOwner:G};function C(){throw Error("act(...) is not supported in production builds of React.")}return Xe.Children={map:xe,forEach:function(w,L,Y){xe(w,function(){L.apply(this,arguments)},Y)},count:function(w){var L=0;return xe(w,function(){L++}),L},toArray:function(w){return xe(w,function(L){return L})||[]},only:function(w){if(!he(w))throw Error("React.Children.only expected to receive a single React element child.");return w}},Xe.Component=k,Xe.Fragment=n,Xe.Profiler=l,Xe.PureComponent=O,Xe.StrictMode=o,Xe.Suspense=f,Xe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pe,Xe.act=C,Xe.cloneElement=function(w,L,Y){if(w==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+w+".");var ne=_({},w.props),ee=w.key,ye=w.ref,se=w._owner;if(L!=null){if(L.ref!==void 0&&(ye=L.ref,se=G.current),L.key!==void 0&&(ee=""+L.key),w.type&&w.type.defaultProps)var ve=w.type.defaultProps;for(Ae in L)X.call(L,Ae)&&!de.hasOwnProperty(Ae)&&(ne[Ae]=L[Ae]===void 0&&ve!==void 0?ve[Ae]:L[Ae])}var Ae=arguments.length-2;if(Ae===1)ne.children=Y;else if(1<Ae){ve=Array(Ae);for(var Ie=0;Ie<Ae;Ie++)ve[Ie]=arguments[Ie+2];ne.children=ve}return{$$typeof:s,type:w.type,key:ee,ref:ye,props:ne,_owner:se}},Xe.createContext=function(w){return w={$$typeof:d,_currentValue:w,_currentValue2:w,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},w.Provider={$$typeof:c,_context:w},w.Consumer=w},Xe.createElement=we,Xe.createFactory=function(w){var L=we.bind(null,w);return L.type=w,L},Xe.createRef=function(){return{current:null}},Xe.forwardRef=function(w){return{$$typeof:p,render:w}},Xe.isValidElement=he,Xe.lazy=function(w){return{$$typeof:y,_payload:{_status:-1,_result:w},_init:ge}},Xe.memo=function(w,L){return{$$typeof:g,type:w,compare:L===void 0?null:L}},Xe.startTransition=function(w){var L=V.transition;V.transition={};try{w()}finally{V.transition=L}},Xe.unstable_act=C,Xe.useCallback=function(w,L){return H.current.useCallback(w,L)},Xe.useContext=function(w){return H.current.useContext(w)},Xe.useDebugValue=function(){},Xe.useDeferredValue=function(w){return H.current.useDeferredValue(w)},Xe.useEffect=function(w,L){return H.current.useEffect(w,L)},Xe.useId=function(){return H.current.useId()},Xe.useImperativeHandle=function(w,L,Y){return H.current.useImperativeHandle(w,L,Y)},Xe.useInsertionEffect=function(w,L){return H.current.useInsertionEffect(w,L)},Xe.useLayoutEffect=function(w,L){return H.current.useLayoutEffect(w,L)},Xe.useMemo=function(w,L){return H.current.useMemo(w,L)},Xe.useReducer=function(w,L,Y){return H.current.useReducer(w,L,Y)},Xe.useRef=function(w){return H.current.useRef(w)},Xe.useState=function(w){return H.current.useState(w)},Xe.useSyncExternalStore=function(w,L,Y){return H.current.useSyncExternalStore(w,L,Y)},Xe.useTransition=function(){return H.current.useTransition()},Xe.version="18.3.1",Xe}var cf;function Eu(){return cf||(cf=1,qc.exports=Ig()),qc.exports}var uf;function Dg(){if(uf)return ri;uf=1;var s=Eu(),r=Symbol.for("react.element"),n=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,l=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function d(p,f,g){var y,x={},b=null,T=null;g!==void 0&&(b=""+g),f.key!==void 0&&(b=""+f.key),f.ref!==void 0&&(T=f.ref);for(y in f)o.call(f,y)&&!c.hasOwnProperty(y)&&(x[y]=f[y]);if(p&&p.defaultProps)for(y in f=p.defaultProps,f)x[y]===void 0&&(x[y]=f[y]);return{$$typeof:r,type:p,key:b,ref:T,props:x,_owner:l.current}}return ri.Fragment=n,ri.jsx=d,ri.jsxs=d,ri}var df;function Rg(){return df||(df=1,zc.exports=Dg()),zc.exports}var a=Rg(),S=Eu();const pr=Nu(S),Lg=Tg({__proto__:null,default:pr},[S]);var Po={},Hc={exports:{}},hr={},Gc={exports:{}},Vc={};var hf;function Mg(){return hf||(hf=1,function(s){function r(V,pe){var C=V.length;V.push(pe);e:for(;0<C;){var w=C-1>>>1,L=V[w];if(0<l(L,pe))V[w]=pe,V[C]=L,C=w;else break e}}function n(V){return V.length===0?null:V[0]}function o(V){if(V.length===0)return null;var pe=V[0],C=V.pop();if(C!==pe){V[0]=C;e:for(var w=0,L=V.length,Y=L>>>1;w<Y;){var ne=2*(w+1)-1,ee=V[ne],ye=ne+1,se=V[ye];if(0>l(ee,C))ye<L&&0>l(se,ee)?(V[w]=se,V[ye]=C,w=ye):(V[w]=ee,V[ne]=C,w=ne);else if(ye<L&&0>l(se,C))V[w]=se,V[ye]=C,w=ye;else break e}}return pe}function l(V,pe){var C=V.sortIndex-pe.sortIndex;return C!==0?C:V.id-pe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var c=performance;s.unstable_now=function(){return c.now()}}else{var d=Date,p=d.now();s.unstable_now=function(){return d.now()-p}}var f=[],g=[],y=1,x=null,b=3,T=!1,_=!1,E=!1,k=typeof setTimeout=="function"?setTimeout:null,D=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function R(V){for(var pe=n(g);pe!==null;){if(pe.callback===null)o(g);else if(pe.startTime<=V)o(g),pe.sortIndex=pe.expirationTime,r(f,pe);else break;pe=n(g)}}function M(V){if(E=!1,R(V),!_)if(n(f)!==null)_=!0,ge(X);else{var pe=n(g);pe!==null&&H(M,pe.startTime-V)}}function X(V,pe){_=!1,E&&(E=!1,D(we),we=-1),T=!0;var C=b;try{for(R(pe),x=n(f);x!==null&&(!(x.expirationTime>pe)||V&&!oe());){var w=x.callback;if(typeof w=="function"){x.callback=null,b=x.priorityLevel;var L=w(x.expirationTime<=pe);pe=s.unstable_now(),typeof L=="function"?x.callback=L:x===n(f)&&o(f),R(pe)}else o(f);x=n(f)}if(x!==null)var Y=!0;else{var ne=n(g);ne!==null&&H(M,ne.startTime-pe),Y=!1}return Y}finally{x=null,b=C,T=!1}}var G=!1,de=null,we=-1,$=5,he=-1;function oe(){return!(s.unstable_now()-he<$)}function re(){if(de!==null){var V=s.unstable_now();he=V;var pe=!0;try{pe=de(!0,V)}finally{pe?le():(G=!1,de=null)}}else G=!1}var le;if(typeof O=="function")le=function(){O(re)};else if(typeof MessageChannel<"u"){var J=new MessageChannel,xe=J.port2;J.port1.onmessage=re,le=function(){xe.postMessage(null)}}else le=function(){k(re,0)};function ge(V){de=V,G||(G=!0,le())}function H(V,pe){we=k(function(){V(s.unstable_now())},pe)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(V){V.callback=null},s.unstable_continueExecution=function(){_||T||(_=!0,ge(X))},s.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):$=0<V?Math.floor(1e3/V):5},s.unstable_getCurrentPriorityLevel=function(){return b},s.unstable_getFirstCallbackNode=function(){return n(f)},s.unstable_next=function(V){switch(b){case 1:case 2:case 3:var pe=3;break;default:pe=b}var C=b;b=pe;try{return V()}finally{b=C}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(V,pe){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var C=b;b=V;try{return pe()}finally{b=C}},s.unstable_scheduleCallback=function(V,pe,C){var w=s.unstable_now();switch(typeof C=="object"&&C!==null?(C=C.delay,C=typeof C=="number"&&0<C?w+C:w):C=w,V){case 1:var L=-1;break;case 2:L=250;break;case 5:L=1073741823;break;case 4:L=1e4;break;default:L=5e3}return L=C+L,V={id:y++,callback:pe,priorityLevel:V,startTime:C,expirationTime:L,sortIndex:-1},C>w?(V.sortIndex=C,r(g,V),n(f)===null&&V===n(g)&&(E?(D(we),we=-1):E=!0,H(M,C-w))):(V.sortIndex=L,r(f,V),_||T||(_=!0,ge(X))),V},s.unstable_shouldYield=oe,s.unstable_wrapCallback=function(V){var pe=b;return function(){var C=b;b=pe;try{return V.apply(this,arguments)}finally{b=C}}}}(Vc)),Vc}var ff;function Ug(){return ff||(ff=1,Gc.exports=Mg()),Gc.exports}var pf;function Fg(){if(pf)return hr;pf=1;var s=Eu(),r=Ug();function n(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,l={};function c(e,t){d(e,t),d(e+"Capture",t)}function d(e,t){for(l[e]=t,e=0;e<t.length;e++)o.add(t[e])}var p=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,g=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,y={},x={};function b(e){return f.call(x,e)?!0:f.call(y,e)?!1:g.test(e)?x[e]=!0:(y[e]=!0,!1)}function T(e,t,i,u){if(i!==null&&i.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return u?!1:i!==null?!i.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function _(e,t,i,u){if(t===null||typeof t>"u"||T(e,t,i,u))return!0;if(u)return!1;if(i!==null)switch(i.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function E(e,t,i,u,h,m,v){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=u,this.attributeNamespace=h,this.mustUseProperty=i,this.propertyName=e,this.type=t,this.sanitizeURL=m,this.removeEmptyString=v}var k={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){k[e]=new E(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];k[t]=new E(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){k[e]=new E(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){k[e]=new E(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){k[e]=new E(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){k[e]=new E(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){k[e]=new E(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){k[e]=new E(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){k[e]=new E(e,5,!1,e.toLowerCase(),null,!1,!1)});var D=/[\-:]([a-z])/g;function O(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(D,O);k[t]=new E(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(D,O);k[t]=new E(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(D,O);k[t]=new E(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){k[e]=new E(e,1,!1,e.toLowerCase(),null,!1,!1)}),k.xlinkHref=new E("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){k[e]=new E(e,1,!1,e.toLowerCase(),null,!0,!0)});function R(e,t,i,u){var h=k.hasOwnProperty(t)?k[t]:null;(h!==null?h.type!==0:u||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(_(t,i,h,u)&&(i=null),u||h===null?b(t)&&(i===null?e.removeAttribute(t):e.setAttribute(t,""+i)):h.mustUseProperty?e[h.propertyName]=i===null?h.type===3?!1:"":i:(t=h.attributeName,u=h.attributeNamespace,i===null?e.removeAttribute(t):(h=h.type,i=h===3||h===4&&i===!0?"":""+i,u?e.setAttributeNS(u,t,i):e.setAttribute(t,i))))}var M=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,X=Symbol.for("react.element"),G=Symbol.for("react.portal"),de=Symbol.for("react.fragment"),we=Symbol.for("react.strict_mode"),$=Symbol.for("react.profiler"),he=Symbol.for("react.provider"),oe=Symbol.for("react.context"),re=Symbol.for("react.forward_ref"),le=Symbol.for("react.suspense"),J=Symbol.for("react.suspense_list"),xe=Symbol.for("react.memo"),ge=Symbol.for("react.lazy"),H=Symbol.for("react.offscreen"),V=Symbol.iterator;function pe(e){return e===null||typeof e!="object"?null:(e=V&&e[V]||e["@@iterator"],typeof e=="function"?e:null)}var C=Object.assign,w;function L(e){if(w===void 0)try{throw Error()}catch(i){var t=i.stack.trim().match(/\n( *(at )?)/);w=t&&t[1]||""}return`
`+w+e}var Y=!1;function ne(e,t){if(!e||Y)return"";Y=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(z){var u=z}Reflect.construct(e,[],t)}else{try{t.call()}catch(z){u=z}e.call(t.prototype)}else{try{throw Error()}catch(z){u=z}e()}}catch(z){if(z&&u&&typeof z.stack=="string"){for(var h=z.stack.split(`
`),m=u.stack.split(`
`),v=h.length-1,N=m.length-1;1<=v&&0<=N&&h[v]!==m[N];)N--;for(;1<=v&&0<=N;v--,N--)if(h[v]!==m[N]){if(v!==1||N!==1)do if(v--,N--,0>N||h[v]!==m[N]){var P=`
`+h[v].replace(" at new "," at ");return e.displayName&&P.includes("<anonymous>")&&(P=P.replace("<anonymous>",e.displayName)),P}while(1<=v&&0<=N);break}}}finally{Y=!1,Error.prepareStackTrace=i}return(e=e?e.displayName||e.name:"")?L(e):""}function ee(e){switch(e.tag){case 5:return L(e.type);case 16:return L("Lazy");case 13:return L("Suspense");case 19:return L("SuspenseList");case 0:case 2:case 15:return e=ne(e.type,!1),e;case 11:return e=ne(e.type.render,!1),e;case 1:return e=ne(e.type,!0),e;default:return""}}function ye(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case de:return"Fragment";case G:return"Portal";case $:return"Profiler";case we:return"StrictMode";case le:return"Suspense";case J:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case oe:return(e.displayName||"Context")+".Consumer";case he:return(e._context.displayName||"Context")+".Provider";case re:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case xe:return t=e.displayName||null,t!==null?t:ye(e.type)||"Memo";case ge:t=e._payload,e=e._init;try{return ye(e(t))}catch{}}return null}function se(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ye(t);case 8:return t===we?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ve(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ae(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Ie(e){var t=Ae(e)?"checked":"value",i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),u=""+e[t];if(!e.hasOwnProperty(t)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var h=i.get,m=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return h.call(this)},set:function(v){u=""+v,m.call(this,v)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return u},setValue:function(v){u=""+v},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ye(e){e._valueTracker||(e._valueTracker=Ie(e))}function Ge(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var i=t.getValue(),u="";return e&&(u=Ae(e)?e.checked?"true":"false":e.value),e=u,e!==i?(t.setValue(e),!0):!1}function K(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function te(e,t){var i=t.checked;return C({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:i??e._wrapperState.initialChecked})}function Se(e,t){var i=t.defaultValue==null?"":t.defaultValue,u=t.checked!=null?t.checked:t.defaultChecked;i=ve(t.value!=null?t.value:i),e._wrapperState={initialChecked:u,initialValue:i,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function I(e,t){t=t.checked,t!=null&&R(e,"checked",t,!1)}function B(e,t){I(e,t);var i=ve(t.value),u=t.type;if(i!=null)u==="number"?(i===0&&e.value===""||e.value!=i)&&(e.value=""+i):e.value!==""+i&&(e.value=""+i);else if(u==="submit"||u==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Le(e,t.type,i):t.hasOwnProperty("defaultValue")&&Le(e,t.type,ve(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Ne(e,t,i){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var u=t.type;if(!(u!=="submit"&&u!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,i||t===e.value||(e.value=t),e.defaultValue=t}i=e.name,i!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,i!==""&&(e.name=i)}function Le(e,t,i){(t!=="number"||K(e.ownerDocument)!==e)&&(i==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+i&&(e.defaultValue=""+i))}var be=Array.isArray;function Fe(e,t,i,u){if(e=e.options,t){t={};for(var h=0;h<i.length;h++)t["$"+i[h]]=!0;for(i=0;i<e.length;i++)h=t.hasOwnProperty("$"+e[i].value),e[i].selected!==h&&(e[i].selected=h),h&&u&&(e[i].defaultSelected=!0)}else{for(i=""+ve(i),t=null,h=0;h<e.length;h++){if(e[h].value===i){e[h].selected=!0,u&&(e[h].defaultSelected=!0);return}t!==null||e[h].disabled||(t=e[h])}t!==null&&(t.selected=!0)}}function ze(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(n(91));return C({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function $e(e,t){var i=t.value;if(i==null){if(i=t.children,t=t.defaultValue,i!=null){if(t!=null)throw Error(n(92));if(be(i)){if(1<i.length)throw Error(n(93));i=i[0]}t=i}t==null&&(t=""),i=t}e._wrapperState={initialValue:ve(i)}}function Ke(e,t){var i=ve(t.value),u=ve(t.defaultValue);i!=null&&(i=""+i,i!==e.value&&(e.value=i),t.defaultValue==null&&e.defaultValue!==i&&(e.defaultValue=i)),u!=null&&(e.defaultValue=""+u)}function mt(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function gt(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ht(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?gt(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var jt,bt=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,i,u,h){MSApp.execUnsafeLocalFunction(function(){return e(t,i,u,h)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(jt=jt||document.createElement("div"),jt.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=jt.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Ft(e,t){if(t){var i=e.firstChild;if(i&&i===e.lastChild&&i.nodeType===3){i.nodeValue=t;return}}e.textContent=t}var Ht={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},gr=["Webkit","ms","Moz","O"];Object.keys(Ht).forEach(function(e){gr.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Ht[t]=Ht[e]})});function Dt(e,t,i){return t==null||typeof t=="boolean"||t===""?"":i||typeof t!="number"||t===0||Ht.hasOwnProperty(e)&&Ht[e]?(""+t).trim():t+"px"}function tr(e,t){e=e.style;for(var i in t)if(t.hasOwnProperty(i)){var u=i.indexOf("--")===0,h=Dt(i,t[i],u);i==="float"&&(i="cssFloat"),u?e.setProperty(i,h):e[i]=h}}var fn=C({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ya(e,t){if(t){if(fn[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(n(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(n(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(n(61))}if(t.style!=null&&typeof t.style!="object")throw Error(n(62))}}function ws(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var va=null;function wa(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var xa=null,Br=null,Gt=null;function Kr(e){if(e=Ba(e)){if(typeof xa!="function")throw Error(n(280));var t=e.stateNode;t&&(t=qi(t),xa(e.stateNode,e.type,t))}}function Pr(e){Br?Gt?Gt.push(e):Gt=[e]:Br=e}function bi(){if(Br){var e=Br,t=Gt;if(Gt=Br=null,Kr(e),t)for(e=0;e<t.length;e++)Kr(t[e])}}function ba(e,t){return e(t)}function ki(){}var ka=!1;function Vn(e,t,i){if(ka)return e(t,i);ka=!0;try{return ba(e,t,i)}finally{ka=!1,(Br!==null||Gt!==null)&&(ki(),bi())}}function pn(e,t){var i=e.stateNode;if(i===null)return null;var u=qi(i);if(u===null)return null;i=u[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(e=e.type,u=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!u;break e;default:e=!1}if(e)return null;if(i&&typeof i!="function")throw Error(n(231,t,typeof i));return i}var Sa=!1;if(p)try{var Yr={};Object.defineProperty(Yr,"passive",{get:function(){Sa=!0}}),window.addEventListener("test",Yr,Yr),window.removeEventListener("test",Yr,Yr)}catch{Sa=!1}function _a(e,t,i,u,h,m,v,N,P){var z=Array.prototype.slice.call(arguments,3);try{t.apply(i,z)}catch(Z){this.onError(Z)}}var mn=!1,Jn=null,Qr=!1,xs=null,al={onError:function(e){mn=!0,Jn=e}};function il(e,t,i,u,h,m,v,N,P){mn=!1,Jn=null,_a.apply(al,arguments)}function ol(e,t,i,u,h,m,v,N,P){if(il.apply(this,arguments),mn){if(mn){var z=Jn;mn=!1,Jn=null}else throw Error(n(198));Qr||(Qr=!0,xs=z)}}function Xr(e){var t=e,i=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(i=t.return),e=t.return;while(e)}return t.tag===3?i:null}function Si(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function bs(e){if(Xr(e)!==e)throw Error(n(188))}function ll(e){var t=e.alternate;if(!t){if(t=Xr(e),t===null)throw Error(n(188));return t!==e?null:e}for(var i=e,u=t;;){var h=i.return;if(h===null)break;var m=h.alternate;if(m===null){if(u=h.return,u!==null){i=u;continue}break}if(h.child===m.child){for(m=h.child;m;){if(m===i)return bs(h),e;if(m===u)return bs(h),t;m=m.sibling}throw Error(n(188))}if(i.return!==u.return)i=h,u=m;else{for(var v=!1,N=h.child;N;){if(N===i){v=!0,i=h,u=m;break}if(N===u){v=!0,u=h,i=m;break}N=N.sibling}if(!v){for(N=m.child;N;){if(N===i){v=!0,i=m,u=h;break}if(N===u){v=!0,u=m,i=h;break}N=N.sibling}if(!v)throw Error(n(189))}}if(i.alternate!==u)throw Error(n(190))}if(i.tag!==3)throw Error(n(188));return i.stateNode.current===i?e:t}function _i(e){return e=ll(e),e!==null?ji(e):null}function ji(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=ji(e);if(t!==null)return t;e=e.sibling}return null}var Ni=r.unstable_scheduleCallback,Ei=r.unstable_cancelCallback,cl=r.unstable_shouldYield,Ci=r.unstable_requestPaint,yt=r.unstable_now,ul=r.unstable_getCurrentPriorityLevel,ja=r.unstable_ImmediatePriority,gn=r.unstable_UserBlockingPriority,$r=r.unstable_NormalPriority,dl=r.unstable_LowPriority,Ti=r.unstable_IdlePriority,ks=null,Vt=null;function hl(e){if(Vt&&typeof Vt.onCommitFiberRoot=="function")try{Vt.onCommitFiberRoot(ks,e,void 0,(e.current.flags&128)===128)}catch{}}var Wt=Math.clz32?Math.clz32:pl,fl=Math.log,yn=Math.LN2;function pl(e){return e>>>=0,e===0?32:31-(fl(e)/yn|0)|0}var Ss=64,_s=4194304;function j(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function W(e,t){var i=e.pendingLanes;if(i===0)return 0;var u=0,h=e.suspendedLanes,m=e.pingedLanes,v=i&268435455;if(v!==0){var N=v&~h;N!==0?u=j(N):(m&=v,m!==0&&(u=j(m)))}else v=i&~h,v!==0?u=j(v):m!==0&&(u=j(m));if(u===0)return 0;if(t!==0&&t!==u&&(t&h)===0&&(h=u&-u,m=t&-t,h>=m||h===16&&(m&4194240)!==0))return t;if((u&4)!==0&&(u|=i&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=u;0<t;)i=31-Wt(t),h=1<<i,u|=e[i],t&=~h;return u}function q(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ae(e,t){for(var i=e.suspendedLanes,u=e.pingedLanes,h=e.expirationTimes,m=e.pendingLanes;0<m;){var v=31-Wt(m),N=1<<v,P=h[v];P===-1?((N&i)===0||(N&u)!==0)&&(h[v]=q(N,t)):P<=t&&(e.expiredLanes|=N),m&=~N}}function _e(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Oe(){var e=Ss;return Ss<<=1,(Ss&4194240)===0&&(Ss=64),e}function me(e){for(var t=[],i=0;31>i;i++)t.push(e);return t}function Re(e,t,i){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Wt(t),e[t]=i}function De(e,t){var i=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var u=e.eventTimes;for(e=e.expirationTimes;0<i;){var h=31-Wt(i),m=1<<h;t[h]=0,u[h]=-1,e[h]=-1,i&=~m}}function ue(e,t){var i=e.entangledLanes|=t;for(e=e.entanglements;i;){var u=31-Wt(i),h=1<<u;h&t|e[u]&t&&(e[u]|=t),i&=~h}}var fe=0;function Me(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var Ve,it,rt,Qe,He,rr=!1,Bt=[],ke=null,Jt=null,vt=null,Ue=new Map,Na=new Map,vn=[],Yp="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function zu(e,t){switch(e){case"focusin":case"focusout":ke=null;break;case"dragenter":case"dragleave":Jt=null;break;case"mouseover":case"mouseout":vt=null;break;case"pointerover":case"pointerout":Ue.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Na.delete(t.pointerId)}}function Ea(e,t,i,u,h,m){return e===null||e.nativeEvent!==m?(e={blockedOn:t,domEventName:i,eventSystemFlags:u,nativeEvent:m,targetContainers:[h]},t!==null&&(t=Ba(t),t!==null&&it(t)),e):(e.eventSystemFlags|=u,t=e.targetContainers,h!==null&&t.indexOf(h)===-1&&t.push(h),e)}function Qp(e,t,i,u,h){switch(t){case"focusin":return ke=Ea(ke,e,t,i,u,h),!0;case"dragenter":return Jt=Ea(Jt,e,t,i,u,h),!0;case"mouseover":return vt=Ea(vt,e,t,i,u,h),!0;case"pointerover":var m=h.pointerId;return Ue.set(m,Ea(Ue.get(m)||null,e,t,i,u,h)),!0;case"gotpointercapture":return m=h.pointerId,Na.set(m,Ea(Na.get(m)||null,e,t,i,u,h)),!0}return!1}function qu(e){var t=Kn(e.target);if(t!==null){var i=Xr(t);if(i!==null){if(t=i.tag,t===13){if(t=Si(i),t!==null){e.blockedOn=t,He(e.priority,function(){rt(i)});return}}else if(t===3&&i.stateNode.current.memoizedState.isDehydrated){e.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Pi(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var i=gl(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(i===null){i=e.nativeEvent;var u=new i.constructor(i.type,i);va=u,i.target.dispatchEvent(u),va=null}else return t=Ba(i),t!==null&&it(t),e.blockedOn=i,!1;t.shift()}return!0}function Hu(e,t,i){Pi(e)&&i.delete(t)}function Xp(){rr=!1,ke!==null&&Pi(ke)&&(ke=null),Jt!==null&&Pi(Jt)&&(Jt=null),vt!==null&&Pi(vt)&&(vt=null),Ue.forEach(Hu),Na.forEach(Hu)}function Ca(e,t){e.blockedOn===t&&(e.blockedOn=null,rr||(rr=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Xp)))}function Ta(e){function t(h){return Ca(h,e)}if(0<Bt.length){Ca(Bt[0],e);for(var i=1;i<Bt.length;i++){var u=Bt[i];u.blockedOn===e&&(u.blockedOn=null)}}for(ke!==null&&Ca(ke,e),Jt!==null&&Ca(Jt,e),vt!==null&&Ca(vt,e),Ue.forEach(t),Na.forEach(t),i=0;i<vn.length;i++)u=vn[i],u.blockedOn===e&&(u.blockedOn=null);for(;0<vn.length&&(i=vn[0],i.blockedOn===null);)qu(i),i.blockedOn===null&&vn.shift()}var js=M.ReactCurrentBatchConfig,Ai=!0;function Zp(e,t,i,u){var h=fe,m=js.transition;js.transition=null;try{fe=1,ml(e,t,i,u)}finally{fe=h,js.transition=m}}function em(e,t,i,u){var h=fe,m=js.transition;js.transition=null;try{fe=4,ml(e,t,i,u)}finally{fe=h,js.transition=m}}function ml(e,t,i,u){if(Ai){var h=gl(e,t,i,u);if(h===null)Il(e,t,u,Oi,i),zu(e,u);else if(Qp(h,e,t,i,u))u.stopPropagation();else if(zu(e,u),t&4&&-1<Yp.indexOf(e)){for(;h!==null;){var m=Ba(h);if(m!==null&&Ve(m),m=gl(e,t,i,u),m===null&&Il(e,t,u,Oi,i),m===h)break;h=m}h!==null&&u.stopPropagation()}else Il(e,t,u,null,i)}}var Oi=null;function gl(e,t,i,u){if(Oi=null,e=wa(u),e=Kn(e),e!==null)if(t=Xr(e),t===null)e=null;else if(i=t.tag,i===13){if(e=Si(t),e!==null)return e;e=null}else if(i===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Oi=e,null}function Gu(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ul()){case ja:return 1;case gn:return 4;case $r:case dl:return 16;case Ti:return 536870912;default:return 16}default:return 16}}var wn=null,yl=null,Ii=null;function Vu(){if(Ii)return Ii;var e,t=yl,i=t.length,u,h="value"in wn?wn.value:wn.textContent,m=h.length;for(e=0;e<i&&t[e]===h[e];e++);var v=i-e;for(u=1;u<=v&&t[i-u]===h[m-u];u++);return Ii=h.slice(e,1<u?1-u:void 0)}function Di(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Ri(){return!0}function Ju(){return!1}function yr(e){function t(i,u,h,m,v){this._reactName=i,this._targetInst=h,this.type=u,this.nativeEvent=m,this.target=v,this.currentTarget=null;for(var N in e)e.hasOwnProperty(N)&&(i=e[N],this[N]=i?i(m):m[N]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?Ri:Ju,this.isPropagationStopped=Ju,this}return C(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=Ri)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=Ri)},persist:function(){},isPersistent:Ri}),t}var Ns={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},vl=yr(Ns),Pa=C({},Ns,{view:0,detail:0}),tm=yr(Pa),wl,xl,Aa,Li=C({},Pa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kl,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Aa&&(Aa&&e.type==="mousemove"?(wl=e.screenX-Aa.screenX,xl=e.screenY-Aa.screenY):xl=wl=0,Aa=e),wl)},movementY:function(e){return"movementY"in e?e.movementY:xl}}),Ku=yr(Li),rm=C({},Li,{dataTransfer:0}),nm=yr(rm),sm=C({},Pa,{relatedTarget:0}),bl=yr(sm),am=C({},Ns,{animationName:0,elapsedTime:0,pseudoElement:0}),im=yr(am),om=C({},Ns,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),lm=yr(om),cm=C({},Ns,{data:0}),Yu=yr(cm),um={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},dm={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hm={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fm(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=hm[e])?!!t[e]:!1}function kl(){return fm}var pm=C({},Pa,{key:function(e){if(e.key){var t=um[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Di(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?dm[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kl,charCode:function(e){return e.type==="keypress"?Di(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Di(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),mm=yr(pm),gm=C({},Li,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Qu=yr(gm),ym=C({},Pa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kl}),vm=yr(ym),wm=C({},Ns,{propertyName:0,elapsedTime:0,pseudoElement:0}),xm=yr(wm),bm=C({},Li,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),km=yr(bm),Sm=[9,13,27,32],Sl=p&&"CompositionEvent"in window,Oa=null;p&&"documentMode"in document&&(Oa=document.documentMode);var _m=p&&"TextEvent"in window&&!Oa,Xu=p&&(!Sl||Oa&&8<Oa&&11>=Oa),Zu=" ",ed=!1;function td(e,t){switch(e){case"keyup":return Sm.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function rd(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Es=!1;function jm(e,t){switch(e){case"compositionend":return rd(t);case"keypress":return t.which!==32?null:(ed=!0,Zu);case"textInput":return e=t.data,e===Zu&&ed?null:e;default:return null}}function Nm(e,t){if(Es)return e==="compositionend"||!Sl&&td(e,t)?(e=Vu(),Ii=yl=wn=null,Es=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Xu&&t.locale!=="ko"?null:t.data;default:return null}}var Em={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function nd(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Em[e.type]:t==="textarea"}function sd(e,t,i,u){Pr(u),t=Bi(t,"onChange"),0<t.length&&(i=new vl("onChange","change",null,i,u),e.push({event:i,listeners:t}))}var Ia=null,Da=null;function Cm(e){kd(e,0)}function Mi(e){var t=Os(e);if(Ge(t))return e}function Tm(e,t){if(e==="change")return t}var ad=!1;if(p){var _l;if(p){var jl="oninput"in document;if(!jl){var id=document.createElement("div");id.setAttribute("oninput","return;"),jl=typeof id.oninput=="function"}_l=jl}else _l=!1;ad=_l&&(!document.documentMode||9<document.documentMode)}function od(){Ia&&(Ia.detachEvent("onpropertychange",ld),Da=Ia=null)}function ld(e){if(e.propertyName==="value"&&Mi(Da)){var t=[];sd(t,Da,e,wa(e)),Vn(Cm,t)}}function Pm(e,t,i){e==="focusin"?(od(),Ia=t,Da=i,Ia.attachEvent("onpropertychange",ld)):e==="focusout"&&od()}function Am(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Mi(Da)}function Om(e,t){if(e==="click")return Mi(t)}function Im(e,t){if(e==="input"||e==="change")return Mi(t)}function Dm(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ar=typeof Object.is=="function"?Object.is:Dm;function Ra(e,t){if(Ar(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var i=Object.keys(e),u=Object.keys(t);if(i.length!==u.length)return!1;for(u=0;u<i.length;u++){var h=i[u];if(!f.call(t,h)||!Ar(e[h],t[h]))return!1}return!0}function cd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ud(e,t){var i=cd(e);e=0;for(var u;i;){if(i.nodeType===3){if(u=e+i.textContent.length,e<=t&&u>=t)return{node:i,offset:t-e};e=u}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=cd(i)}}function dd(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?dd(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function hd(){for(var e=window,t=K();t instanceof e.HTMLIFrameElement;){try{var i=typeof t.contentWindow.location.href=="string"}catch{i=!1}if(i)e=t.contentWindow;else break;t=K(e.document)}return t}function Nl(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Rm(e){var t=hd(),i=e.focusedElem,u=e.selectionRange;if(t!==i&&i&&i.ownerDocument&&dd(i.ownerDocument.documentElement,i)){if(u!==null&&Nl(i)){if(t=u.start,e=u.end,e===void 0&&(e=t),"selectionStart"in i)i.selectionStart=t,i.selectionEnd=Math.min(e,i.value.length);else if(e=(t=i.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var h=i.textContent.length,m=Math.min(u.start,h);u=u.end===void 0?m:Math.min(u.end,h),!e.extend&&m>u&&(h=u,u=m,m=h),h=ud(i,m);var v=ud(i,u);h&&v&&(e.rangeCount!==1||e.anchorNode!==h.node||e.anchorOffset!==h.offset||e.focusNode!==v.node||e.focusOffset!==v.offset)&&(t=t.createRange(),t.setStart(h.node,h.offset),e.removeAllRanges(),m>u?(e.addRange(t),e.extend(v.node,v.offset)):(t.setEnd(v.node,v.offset),e.addRange(t)))}}for(t=[],e=i;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof i.focus=="function"&&i.focus(),i=0;i<t.length;i++)e=t[i],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Lm=p&&"documentMode"in document&&11>=document.documentMode,Cs=null,El=null,La=null,Cl=!1;function fd(e,t,i){var u=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;Cl||Cs==null||Cs!==K(u)||(u=Cs,"selectionStart"in u&&Nl(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),La&&Ra(La,u)||(La=u,u=Bi(El,"onSelect"),0<u.length&&(t=new vl("onSelect","select",null,t,i),e.push({event:t,listeners:u}),t.target=Cs)))}function Ui(e,t){var i={};return i[e.toLowerCase()]=t.toLowerCase(),i["Webkit"+e]="webkit"+t,i["Moz"+e]="moz"+t,i}var Ts={animationend:Ui("Animation","AnimationEnd"),animationiteration:Ui("Animation","AnimationIteration"),animationstart:Ui("Animation","AnimationStart"),transitionend:Ui("Transition","TransitionEnd")},Tl={},pd={};p&&(pd=document.createElement("div").style,"AnimationEvent"in window||(delete Ts.animationend.animation,delete Ts.animationiteration.animation,delete Ts.animationstart.animation),"TransitionEvent"in window||delete Ts.transitionend.transition);function Fi(e){if(Tl[e])return Tl[e];if(!Ts[e])return e;var t=Ts[e],i;for(i in t)if(t.hasOwnProperty(i)&&i in pd)return Tl[e]=t[i];return e}var md=Fi("animationend"),gd=Fi("animationiteration"),yd=Fi("animationstart"),vd=Fi("transitionend"),wd=new Map,xd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function xn(e,t){wd.set(e,t),c(t,[e])}for(var Pl=0;Pl<xd.length;Pl++){var Al=xd[Pl],Mm=Al.toLowerCase(),Um=Al[0].toUpperCase()+Al.slice(1);xn(Mm,"on"+Um)}xn(md,"onAnimationEnd"),xn(gd,"onAnimationIteration"),xn(yd,"onAnimationStart"),xn("dblclick","onDoubleClick"),xn("focusin","onFocus"),xn("focusout","onBlur"),xn(vd,"onTransitionEnd"),d("onMouseEnter",["mouseout","mouseover"]),d("onMouseLeave",["mouseout","mouseover"]),d("onPointerEnter",["pointerout","pointerover"]),d("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ma="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fm=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ma));function bd(e,t,i){var u=e.type||"unknown-event";e.currentTarget=i,ol(u,t,void 0,e),e.currentTarget=null}function kd(e,t){t=(t&4)!==0;for(var i=0;i<e.length;i++){var u=e[i],h=u.event;u=u.listeners;e:{var m=void 0;if(t)for(var v=u.length-1;0<=v;v--){var N=u[v],P=N.instance,z=N.currentTarget;if(N=N.listener,P!==m&&h.isPropagationStopped())break e;bd(h,N,z),m=P}else for(v=0;v<u.length;v++){if(N=u[v],P=N.instance,z=N.currentTarget,N=N.listener,P!==m&&h.isPropagationStopped())break e;bd(h,N,z),m=P}}}if(Qr)throw e=xs,Qr=!1,xs=null,e}function ct(e,t){var i=t[Fl];i===void 0&&(i=t[Fl]=new Set);var u=e+"__bubble";i.has(u)||(Sd(t,e,2,!1),i.add(u))}function Ol(e,t,i){var u=0;t&&(u|=4),Sd(i,e,u,t)}var Wi="_reactListening"+Math.random().toString(36).slice(2);function Ua(e){if(!e[Wi]){e[Wi]=!0,o.forEach(function(i){i!=="selectionchange"&&(Fm.has(i)||Ol(i,!1,e),Ol(i,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Wi]||(t[Wi]=!0,Ol("selectionchange",!1,t))}}function Sd(e,t,i,u){switch(Gu(t)){case 1:var h=Zp;break;case 4:h=em;break;default:h=ml}i=h.bind(null,t,i,e),h=void 0,!Sa||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(h=!0),u?h!==void 0?e.addEventListener(t,i,{capture:!0,passive:h}):e.addEventListener(t,i,!0):h!==void 0?e.addEventListener(t,i,{passive:h}):e.addEventListener(t,i,!1)}function Il(e,t,i,u,h){var m=u;if((t&1)===0&&(t&2)===0&&u!==null)e:for(;;){if(u===null)return;var v=u.tag;if(v===3||v===4){var N=u.stateNode.containerInfo;if(N===h||N.nodeType===8&&N.parentNode===h)break;if(v===4)for(v=u.return;v!==null;){var P=v.tag;if((P===3||P===4)&&(P=v.stateNode.containerInfo,P===h||P.nodeType===8&&P.parentNode===h))return;v=v.return}for(;N!==null;){if(v=Kn(N),v===null)return;if(P=v.tag,P===5||P===6){u=m=v;continue e}N=N.parentNode}}u=u.return}Vn(function(){var z=m,Z=wa(i),ie=[];e:{var Q=wd.get(e);if(Q!==void 0){var je=vl,Ce=e;switch(e){case"keypress":if(Di(i)===0)break e;case"keydown":case"keyup":je=mm;break;case"focusin":Ce="focus",je=bl;break;case"focusout":Ce="blur",je=bl;break;case"beforeblur":case"afterblur":je=bl;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":je=Ku;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":je=nm;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":je=vm;break;case md:case gd:case yd:je=im;break;case vd:je=xm;break;case"scroll":je=tm;break;case"wheel":je=km;break;case"copy":case"cut":case"paste":je=lm;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":je=Qu}var Te=(t&4)!==0,St=!Te&&e==="scroll",U=Te?Q!==null?Q+"Capture":null:Q;Te=[];for(var A=z,F;A!==null;){F=A;var ce=F.stateNode;if(F.tag===5&&ce!==null&&(F=ce,U!==null&&(ce=pn(A,U),ce!=null&&Te.push(Fa(A,ce,F)))),St)break;A=A.return}0<Te.length&&(Q=new je(Q,Ce,null,i,Z),ie.push({event:Q,listeners:Te}))}}if((t&7)===0){e:{if(Q=e==="mouseover"||e==="pointerover",je=e==="mouseout"||e==="pointerout",Q&&i!==va&&(Ce=i.relatedTarget||i.fromElement)&&(Kn(Ce)||Ce[Zr]))break e;if((je||Q)&&(Q=Z.window===Z?Z:(Q=Z.ownerDocument)?Q.defaultView||Q.parentWindow:window,je?(Ce=i.relatedTarget||i.toElement,je=z,Ce=Ce?Kn(Ce):null,Ce!==null&&(St=Xr(Ce),Ce!==St||Ce.tag!==5&&Ce.tag!==6)&&(Ce=null)):(je=null,Ce=z),je!==Ce)){if(Te=Ku,ce="onMouseLeave",U="onMouseEnter",A="mouse",(e==="pointerout"||e==="pointerover")&&(Te=Qu,ce="onPointerLeave",U="onPointerEnter",A="pointer"),St=je==null?Q:Os(je),F=Ce==null?Q:Os(Ce),Q=new Te(ce,A+"leave",je,i,Z),Q.target=St,Q.relatedTarget=F,ce=null,Kn(Z)===z&&(Te=new Te(U,A+"enter",Ce,i,Z),Te.target=F,Te.relatedTarget=St,ce=Te),St=ce,je&&Ce)t:{for(Te=je,U=Ce,A=0,F=Te;F;F=Ps(F))A++;for(F=0,ce=U;ce;ce=Ps(ce))F++;for(;0<A-F;)Te=Ps(Te),A--;for(;0<F-A;)U=Ps(U),F--;for(;A--;){if(Te===U||U!==null&&Te===U.alternate)break t;Te=Ps(Te),U=Ps(U)}Te=null}else Te=null;je!==null&&_d(ie,Q,je,Te,!1),Ce!==null&&St!==null&&_d(ie,St,Ce,Te,!0)}}e:{if(Q=z?Os(z):window,je=Q.nodeName&&Q.nodeName.toLowerCase(),je==="select"||je==="input"&&Q.type==="file")var Pe=Tm;else if(nd(Q))if(ad)Pe=Im;else{Pe=Am;var We=Pm}else(je=Q.nodeName)&&je.toLowerCase()==="input"&&(Q.type==="checkbox"||Q.type==="radio")&&(Pe=Om);if(Pe&&(Pe=Pe(e,z))){sd(ie,Pe,i,Z);break e}We&&We(e,Q,z),e==="focusout"&&(We=Q._wrapperState)&&We.controlled&&Q.type==="number"&&Le(Q,"number",Q.value)}switch(We=z?Os(z):window,e){case"focusin":(nd(We)||We.contentEditable==="true")&&(Cs=We,El=z,La=null);break;case"focusout":La=El=Cs=null;break;case"mousedown":Cl=!0;break;case"contextmenu":case"mouseup":case"dragend":Cl=!1,fd(ie,i,Z);break;case"selectionchange":if(Lm)break;case"keydown":case"keyup":fd(ie,i,Z)}var Be;if(Sl)e:{switch(e){case"compositionstart":var qe="onCompositionStart";break e;case"compositionend":qe="onCompositionEnd";break e;case"compositionupdate":qe="onCompositionUpdate";break e}qe=void 0}else Es?td(e,i)&&(qe="onCompositionEnd"):e==="keydown"&&i.keyCode===229&&(qe="onCompositionStart");qe&&(Xu&&i.locale!=="ko"&&(Es||qe!=="onCompositionStart"?qe==="onCompositionEnd"&&Es&&(Be=Vu()):(wn=Z,yl="value"in wn?wn.value:wn.textContent,Es=!0)),We=Bi(z,qe),0<We.length&&(qe=new Yu(qe,e,null,i,Z),ie.push({event:qe,listeners:We}),Be?qe.data=Be:(Be=rd(i),Be!==null&&(qe.data=Be)))),(Be=_m?jm(e,i):Nm(e,i))&&(z=Bi(z,"onBeforeInput"),0<z.length&&(Z=new Yu("onBeforeInput","beforeinput",null,i,Z),ie.push({event:Z,listeners:z}),Z.data=Be))}kd(ie,t)})}function Fa(e,t,i){return{instance:e,listener:t,currentTarget:i}}function Bi(e,t){for(var i=t+"Capture",u=[];e!==null;){var h=e,m=h.stateNode;h.tag===5&&m!==null&&(h=m,m=pn(e,i),m!=null&&u.unshift(Fa(e,m,h)),m=pn(e,t),m!=null&&u.push(Fa(e,m,h))),e=e.return}return u}function Ps(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function _d(e,t,i,u,h){for(var m=t._reactName,v=[];i!==null&&i!==u;){var N=i,P=N.alternate,z=N.stateNode;if(P!==null&&P===u)break;N.tag===5&&z!==null&&(N=z,h?(P=pn(i,m),P!=null&&v.unshift(Fa(i,P,N))):h||(P=pn(i,m),P!=null&&v.push(Fa(i,P,N)))),i=i.return}v.length!==0&&e.push({event:t,listeners:v})}var Wm=/\r\n?/g,Bm=/\u0000|\uFFFD/g;function jd(e){return(typeof e=="string"?e:""+e).replace(Wm,`
`).replace(Bm,"")}function $i(e,t,i){if(t=jd(t),jd(e)!==t&&i)throw Error(n(425))}function zi(){}var Dl=null,Rl=null;function Ll(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Ml=typeof setTimeout=="function"?setTimeout:void 0,$m=typeof clearTimeout=="function"?clearTimeout:void 0,Nd=typeof Promise=="function"?Promise:void 0,zm=typeof queueMicrotask=="function"?queueMicrotask:typeof Nd<"u"?function(e){return Nd.resolve(null).then(e).catch(qm)}:Ml;function qm(e){setTimeout(function(){throw e})}function Ul(e,t){var i=t,u=0;do{var h=i.nextSibling;if(e.removeChild(i),h&&h.nodeType===8)if(i=h.data,i==="/$"){if(u===0){e.removeChild(h),Ta(t);return}u--}else i!=="$"&&i!=="$?"&&i!=="$!"||u++;i=h}while(i);Ta(t)}function bn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Ed(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var i=e.data;if(i==="$"||i==="$!"||i==="$?"){if(t===0)return e;t--}else i==="/$"&&t++}e=e.previousSibling}return null}var As=Math.random().toString(36).slice(2),zr="__reactFiber$"+As,Wa="__reactProps$"+As,Zr="__reactContainer$"+As,Fl="__reactEvents$"+As,Hm="__reactListeners$"+As,Gm="__reactHandles$"+As;function Kn(e){var t=e[zr];if(t)return t;for(var i=e.parentNode;i;){if(t=i[Zr]||i[zr]){if(i=t.alternate,t.child!==null||i!==null&&i.child!==null)for(e=Ed(e);e!==null;){if(i=e[zr])return i;e=Ed(e)}return t}e=i,i=e.parentNode}return null}function Ba(e){return e=e[zr]||e[Zr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Os(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(n(33))}function qi(e){return e[Wa]||null}var Wl=[],Is=-1;function kn(e){return{current:e}}function ut(e){0>Is||(e.current=Wl[Is],Wl[Is]=null,Is--)}function ot(e,t){Is++,Wl[Is]=e.current,e.current=t}var Sn={},Kt=kn(Sn),or=kn(!1),Yn=Sn;function Ds(e,t){var i=e.type.contextTypes;if(!i)return Sn;var u=e.stateNode;if(u&&u.__reactInternalMemoizedUnmaskedChildContext===t)return u.__reactInternalMemoizedMaskedChildContext;var h={},m;for(m in i)h[m]=t[m];return u&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=h),h}function lr(e){return e=e.childContextTypes,e!=null}function Hi(){ut(or),ut(Kt)}function Cd(e,t,i){if(Kt.current!==Sn)throw Error(n(168));ot(Kt,t),ot(or,i)}function Td(e,t,i){var u=e.stateNode;if(t=t.childContextTypes,typeof u.getChildContext!="function")return i;u=u.getChildContext();for(var h in u)if(!(h in t))throw Error(n(108,se(e)||"Unknown",h));return C({},i,u)}function Gi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Sn,Yn=Kt.current,ot(Kt,e),ot(or,or.current),!0}function Pd(e,t,i){var u=e.stateNode;if(!u)throw Error(n(169));i?(e=Td(e,t,Yn),u.__reactInternalMemoizedMergedChildContext=e,ut(or),ut(Kt),ot(Kt,e)):ut(or),ot(or,i)}var en=null,Vi=!1,Bl=!1;function Ad(e){en===null?en=[e]:en.push(e)}function Vm(e){Vi=!0,Ad(e)}function _n(){if(!Bl&&en!==null){Bl=!0;var e=0,t=fe;try{var i=en;for(fe=1;e<i.length;e++){var u=i[e];do u=u(!0);while(u!==null)}en=null,Vi=!1}catch(h){throw en!==null&&(en=en.slice(e+1)),Ni(ja,_n),h}finally{fe=t,Bl=!1}}return null}var Rs=[],Ls=0,Ji=null,Ki=0,kr=[],Sr=0,Qn=null,tn=1,rn="";function Xn(e,t){Rs[Ls++]=Ki,Rs[Ls++]=Ji,Ji=e,Ki=t}function Od(e,t,i){kr[Sr++]=tn,kr[Sr++]=rn,kr[Sr++]=Qn,Qn=e;var u=tn;e=rn;var h=32-Wt(u)-1;u&=~(1<<h),i+=1;var m=32-Wt(t)+h;if(30<m){var v=h-h%5;m=(u&(1<<v)-1).toString(32),u>>=v,h-=v,tn=1<<32-Wt(t)+h|i<<h|u,rn=m+e}else tn=1<<m|i<<h|u,rn=e}function $l(e){e.return!==null&&(Xn(e,1),Od(e,1,0))}function zl(e){for(;e===Ji;)Ji=Rs[--Ls],Rs[Ls]=null,Ki=Rs[--Ls],Rs[Ls]=null;for(;e===Qn;)Qn=kr[--Sr],kr[Sr]=null,rn=kr[--Sr],kr[Sr]=null,tn=kr[--Sr],kr[Sr]=null}var vr=null,wr=null,ft=!1,Or=null;function Id(e,t){var i=Er(5,null,null,0);i.elementType="DELETED",i.stateNode=t,i.return=e,t=e.deletions,t===null?(e.deletions=[i],e.flags|=16):t.push(i)}function Dd(e,t){switch(e.tag){case 5:var i=e.type;return t=t.nodeType!==1||i.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,vr=e,wr=bn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,vr=e,wr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(i=Qn!==null?{id:tn,overflow:rn}:null,e.memoizedState={dehydrated:t,treeContext:i,retryLane:1073741824},i=Er(18,null,null,0),i.stateNode=t,i.return=e,e.child=i,vr=e,wr=null,!0):!1;default:return!1}}function ql(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Hl(e){if(ft){var t=wr;if(t){var i=t;if(!Dd(e,t)){if(ql(e))throw Error(n(418));t=bn(i.nextSibling);var u=vr;t&&Dd(e,t)?Id(u,i):(e.flags=e.flags&-4097|2,ft=!1,vr=e)}}else{if(ql(e))throw Error(n(418));e.flags=e.flags&-4097|2,ft=!1,vr=e}}}function Rd(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;vr=e}function Yi(e){if(e!==vr)return!1;if(!ft)return Rd(e),ft=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Ll(e.type,e.memoizedProps)),t&&(t=wr)){if(ql(e))throw Ld(),Error(n(418));for(;t;)Id(e,t),t=bn(t.nextSibling)}if(Rd(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(n(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var i=e.data;if(i==="/$"){if(t===0){wr=bn(e.nextSibling);break e}t--}else i!=="$"&&i!=="$!"&&i!=="$?"||t++}e=e.nextSibling}wr=null}}else wr=vr?bn(e.stateNode.nextSibling):null;return!0}function Ld(){for(var e=wr;e;)e=bn(e.nextSibling)}function Ms(){wr=vr=null,ft=!1}function Gl(e){Or===null?Or=[e]:Or.push(e)}var Jm=M.ReactCurrentBatchConfig;function $a(e,t,i){if(e=i.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(i._owner){if(i=i._owner,i){if(i.tag!==1)throw Error(n(309));var u=i.stateNode}if(!u)throw Error(n(147,e));var h=u,m=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===m?t.ref:(t=function(v){var N=h.refs;v===null?delete N[m]:N[m]=v},t._stringRef=m,t)}if(typeof e!="string")throw Error(n(284));if(!i._owner)throw Error(n(290,e))}return e}function Qi(e,t){throw e=Object.prototype.toString.call(t),Error(n(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Md(e){var t=e._init;return t(e._payload)}function Ud(e){function t(U,A){if(e){var F=U.deletions;F===null?(U.deletions=[A],U.flags|=16):F.push(A)}}function i(U,A){if(!e)return null;for(;A!==null;)t(U,A),A=A.sibling;return null}function u(U,A){for(U=new Map;A!==null;)A.key!==null?U.set(A.key,A):U.set(A.index,A),A=A.sibling;return U}function h(U,A){return U=On(U,A),U.index=0,U.sibling=null,U}function m(U,A,F){return U.index=F,e?(F=U.alternate,F!==null?(F=F.index,F<A?(U.flags|=2,A):F):(U.flags|=2,A)):(U.flags|=1048576,A)}function v(U){return e&&U.alternate===null&&(U.flags|=2),U}function N(U,A,F,ce){return A===null||A.tag!==6?(A=Mc(F,U.mode,ce),A.return=U,A):(A=h(A,F),A.return=U,A)}function P(U,A,F,ce){var Pe=F.type;return Pe===de?Z(U,A,F.props.children,ce,F.key):A!==null&&(A.elementType===Pe||typeof Pe=="object"&&Pe!==null&&Pe.$$typeof===ge&&Md(Pe)===A.type)?(ce=h(A,F.props),ce.ref=$a(U,A,F),ce.return=U,ce):(ce=ko(F.type,F.key,F.props,null,U.mode,ce),ce.ref=$a(U,A,F),ce.return=U,ce)}function z(U,A,F,ce){return A===null||A.tag!==4||A.stateNode.containerInfo!==F.containerInfo||A.stateNode.implementation!==F.implementation?(A=Uc(F,U.mode,ce),A.return=U,A):(A=h(A,F.children||[]),A.return=U,A)}function Z(U,A,F,ce,Pe){return A===null||A.tag!==7?(A=is(F,U.mode,ce,Pe),A.return=U,A):(A=h(A,F),A.return=U,A)}function ie(U,A,F){if(typeof A=="string"&&A!==""||typeof A=="number")return A=Mc(""+A,U.mode,F),A.return=U,A;if(typeof A=="object"&&A!==null){switch(A.$$typeof){case X:return F=ko(A.type,A.key,A.props,null,U.mode,F),F.ref=$a(U,null,A),F.return=U,F;case G:return A=Uc(A,U.mode,F),A.return=U,A;case ge:var ce=A._init;return ie(U,ce(A._payload),F)}if(be(A)||pe(A))return A=is(A,U.mode,F,null),A.return=U,A;Qi(U,A)}return null}function Q(U,A,F,ce){var Pe=A!==null?A.key:null;if(typeof F=="string"&&F!==""||typeof F=="number")return Pe!==null?null:N(U,A,""+F,ce);if(typeof F=="object"&&F!==null){switch(F.$$typeof){case X:return F.key===Pe?P(U,A,F,ce):null;case G:return F.key===Pe?z(U,A,F,ce):null;case ge:return Pe=F._init,Q(U,A,Pe(F._payload),ce)}if(be(F)||pe(F))return Pe!==null?null:Z(U,A,F,ce,null);Qi(U,F)}return null}function je(U,A,F,ce,Pe){if(typeof ce=="string"&&ce!==""||typeof ce=="number")return U=U.get(F)||null,N(A,U,""+ce,Pe);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case X:return U=U.get(ce.key===null?F:ce.key)||null,P(A,U,ce,Pe);case G:return U=U.get(ce.key===null?F:ce.key)||null,z(A,U,ce,Pe);case ge:var We=ce._init;return je(U,A,F,We(ce._payload),Pe)}if(be(ce)||pe(ce))return U=U.get(F)||null,Z(A,U,ce,Pe,null);Qi(A,ce)}return null}function Ce(U,A,F,ce){for(var Pe=null,We=null,Be=A,qe=A=0,Mt=null;Be!==null&&qe<F.length;qe++){Be.index>qe?(Mt=Be,Be=null):Mt=Be.sibling;var nt=Q(U,Be,F[qe],ce);if(nt===null){Be===null&&(Be=Mt);break}e&&Be&&nt.alternate===null&&t(U,Be),A=m(nt,A,qe),We===null?Pe=nt:We.sibling=nt,We=nt,Be=Mt}if(qe===F.length)return i(U,Be),ft&&Xn(U,qe),Pe;if(Be===null){for(;qe<F.length;qe++)Be=ie(U,F[qe],ce),Be!==null&&(A=m(Be,A,qe),We===null?Pe=Be:We.sibling=Be,We=Be);return ft&&Xn(U,qe),Pe}for(Be=u(U,Be);qe<F.length;qe++)Mt=je(Be,U,qe,F[qe],ce),Mt!==null&&(e&&Mt.alternate!==null&&Be.delete(Mt.key===null?qe:Mt.key),A=m(Mt,A,qe),We===null?Pe=Mt:We.sibling=Mt,We=Mt);return e&&Be.forEach(function(In){return t(U,In)}),ft&&Xn(U,qe),Pe}function Te(U,A,F,ce){var Pe=pe(F);if(typeof Pe!="function")throw Error(n(150));if(F=Pe.call(F),F==null)throw Error(n(151));for(var We=Pe=null,Be=A,qe=A=0,Mt=null,nt=F.next();Be!==null&&!nt.done;qe++,nt=F.next()){Be.index>qe?(Mt=Be,Be=null):Mt=Be.sibling;var In=Q(U,Be,nt.value,ce);if(In===null){Be===null&&(Be=Mt);break}e&&Be&&In.alternate===null&&t(U,Be),A=m(In,A,qe),We===null?Pe=In:We.sibling=In,We=In,Be=Mt}if(nt.done)return i(U,Be),ft&&Xn(U,qe),Pe;if(Be===null){for(;!nt.done;qe++,nt=F.next())nt=ie(U,nt.value,ce),nt!==null&&(A=m(nt,A,qe),We===null?Pe=nt:We.sibling=nt,We=nt);return ft&&Xn(U,qe),Pe}for(Be=u(U,Be);!nt.done;qe++,nt=F.next())nt=je(Be,U,qe,nt.value,ce),nt!==null&&(e&&nt.alternate!==null&&Be.delete(nt.key===null?qe:nt.key),A=m(nt,A,qe),We===null?Pe=nt:We.sibling=nt,We=nt);return e&&Be.forEach(function(Eg){return t(U,Eg)}),ft&&Xn(U,qe),Pe}function St(U,A,F,ce){if(typeof F=="object"&&F!==null&&F.type===de&&F.key===null&&(F=F.props.children),typeof F=="object"&&F!==null){switch(F.$$typeof){case X:e:{for(var Pe=F.key,We=A;We!==null;){if(We.key===Pe){if(Pe=F.type,Pe===de){if(We.tag===7){i(U,We.sibling),A=h(We,F.props.children),A.return=U,U=A;break e}}else if(We.elementType===Pe||typeof Pe=="object"&&Pe!==null&&Pe.$$typeof===ge&&Md(Pe)===We.type){i(U,We.sibling),A=h(We,F.props),A.ref=$a(U,We,F),A.return=U,U=A;break e}i(U,We);break}else t(U,We);We=We.sibling}F.type===de?(A=is(F.props.children,U.mode,ce,F.key),A.return=U,U=A):(ce=ko(F.type,F.key,F.props,null,U.mode,ce),ce.ref=$a(U,A,F),ce.return=U,U=ce)}return v(U);case G:e:{for(We=F.key;A!==null;){if(A.key===We)if(A.tag===4&&A.stateNode.containerInfo===F.containerInfo&&A.stateNode.implementation===F.implementation){i(U,A.sibling),A=h(A,F.children||[]),A.return=U,U=A;break e}else{i(U,A);break}else t(U,A);A=A.sibling}A=Uc(F,U.mode,ce),A.return=U,U=A}return v(U);case ge:return We=F._init,St(U,A,We(F._payload),ce)}if(be(F))return Ce(U,A,F,ce);if(pe(F))return Te(U,A,F,ce);Qi(U,F)}return typeof F=="string"&&F!==""||typeof F=="number"?(F=""+F,A!==null&&A.tag===6?(i(U,A.sibling),A=h(A,F),A.return=U,U=A):(i(U,A),A=Mc(F,U.mode,ce),A.return=U,U=A),v(U)):i(U,A)}return St}var Us=Ud(!0),Fd=Ud(!1),Xi=kn(null),Zi=null,Fs=null,Vl=null;function Jl(){Vl=Fs=Zi=null}function Kl(e){var t=Xi.current;ut(Xi),e._currentValue=t}function Yl(e,t,i){for(;e!==null;){var u=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,u!==null&&(u.childLanes|=t)):u!==null&&(u.childLanes&t)!==t&&(u.childLanes|=t),e===i)break;e=e.return}}function Ws(e,t){Zi=e,Vl=Fs=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&t)!==0&&(cr=!0),e.firstContext=null)}function _r(e){var t=e._currentValue;if(Vl!==e)if(e={context:e,memoizedValue:t,next:null},Fs===null){if(Zi===null)throw Error(n(308));Fs=e,Zi.dependencies={lanes:0,firstContext:e}}else Fs=Fs.next=e;return t}var Zn=null;function Ql(e){Zn===null?Zn=[e]:Zn.push(e)}function Wd(e,t,i,u){var h=t.interleaved;return h===null?(i.next=i,Ql(t)):(i.next=h.next,h.next=i),t.interleaved=i,nn(e,u)}function nn(e,t){e.lanes|=t;var i=e.alternate;for(i!==null&&(i.lanes|=t),i=e,e=e.return;e!==null;)e.childLanes|=t,i=e.alternate,i!==null&&(i.childLanes|=t),i=e,e=e.return;return i.tag===3?i.stateNode:null}var jn=!1;function Xl(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Bd(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function sn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Nn(e,t,i){var u=e.updateQueue;if(u===null)return null;if(u=u.shared,(tt&2)!==0){var h=u.pending;return h===null?t.next=t:(t.next=h.next,h.next=t),u.pending=t,nn(e,i)}return h=u.interleaved,h===null?(t.next=t,Ql(u)):(t.next=h.next,h.next=t),u.interleaved=t,nn(e,i)}function eo(e,t,i){if(t=t.updateQueue,t!==null&&(t=t.shared,(i&4194240)!==0)){var u=t.lanes;u&=e.pendingLanes,i|=u,t.lanes=i,ue(e,i)}}function $d(e,t){var i=e.updateQueue,u=e.alternate;if(u!==null&&(u=u.updateQueue,i===u)){var h=null,m=null;if(i=i.firstBaseUpdate,i!==null){do{var v={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};m===null?h=m=v:m=m.next=v,i=i.next}while(i!==null);m===null?h=m=t:m=m.next=t}else h=m=t;i={baseState:u.baseState,firstBaseUpdate:h,lastBaseUpdate:m,shared:u.shared,effects:u.effects},e.updateQueue=i;return}e=i.lastBaseUpdate,e===null?i.firstBaseUpdate=t:e.next=t,i.lastBaseUpdate=t}function to(e,t,i,u){var h=e.updateQueue;jn=!1;var m=h.firstBaseUpdate,v=h.lastBaseUpdate,N=h.shared.pending;if(N!==null){h.shared.pending=null;var P=N,z=P.next;P.next=null,v===null?m=z:v.next=z,v=P;var Z=e.alternate;Z!==null&&(Z=Z.updateQueue,N=Z.lastBaseUpdate,N!==v&&(N===null?Z.firstBaseUpdate=z:N.next=z,Z.lastBaseUpdate=P))}if(m!==null){var ie=h.baseState;v=0,Z=z=P=null,N=m;do{var Q=N.lane,je=N.eventTime;if((u&Q)===Q){Z!==null&&(Z=Z.next={eventTime:je,lane:0,tag:N.tag,payload:N.payload,callback:N.callback,next:null});e:{var Ce=e,Te=N;switch(Q=t,je=i,Te.tag){case 1:if(Ce=Te.payload,typeof Ce=="function"){ie=Ce.call(je,ie,Q);break e}ie=Ce;break e;case 3:Ce.flags=Ce.flags&-65537|128;case 0:if(Ce=Te.payload,Q=typeof Ce=="function"?Ce.call(je,ie,Q):Ce,Q==null)break e;ie=C({},ie,Q);break e;case 2:jn=!0}}N.callback!==null&&N.lane!==0&&(e.flags|=64,Q=h.effects,Q===null?h.effects=[N]:Q.push(N))}else je={eventTime:je,lane:Q,tag:N.tag,payload:N.payload,callback:N.callback,next:null},Z===null?(z=Z=je,P=ie):Z=Z.next=je,v|=Q;if(N=N.next,N===null){if(N=h.shared.pending,N===null)break;Q=N,N=Q.next,Q.next=null,h.lastBaseUpdate=Q,h.shared.pending=null}}while(!0);if(Z===null&&(P=ie),h.baseState=P,h.firstBaseUpdate=z,h.lastBaseUpdate=Z,t=h.shared.interleaved,t!==null){h=t;do v|=h.lane,h=h.next;while(h!==t)}else m===null&&(h.shared.lanes=0);rs|=v,e.lanes=v,e.memoizedState=ie}}function zd(e,t,i){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var u=e[t],h=u.callback;if(h!==null){if(u.callback=null,u=i,typeof h!="function")throw Error(n(191,h));h.call(u)}}}var za={},qr=kn(za),qa=kn(za),Ha=kn(za);function es(e){if(e===za)throw Error(n(174));return e}function Zl(e,t){switch(ot(Ha,t),ot(qa,e),ot(qr,za),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ht(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=ht(t,e)}ut(qr),ot(qr,t)}function Bs(){ut(qr),ut(qa),ut(Ha)}function qd(e){es(Ha.current);var t=es(qr.current),i=ht(t,e.type);t!==i&&(ot(qa,e),ot(qr,i))}function ec(e){qa.current===e&&(ut(qr),ut(qa))}var wt=kn(0);function ro(e){for(var t=e;t!==null;){if(t.tag===13){var i=t.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||i.data==="$?"||i.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var tc=[];function rc(){for(var e=0;e<tc.length;e++)tc[e]._workInProgressVersionPrimary=null;tc.length=0}var no=M.ReactCurrentDispatcher,nc=M.ReactCurrentBatchConfig,ts=0,xt=null,Tt=null,Rt=null,so=!1,Ga=!1,Va=0,Km=0;function Yt(){throw Error(n(321))}function sc(e,t){if(t===null)return!1;for(var i=0;i<t.length&&i<e.length;i++)if(!Ar(e[i],t[i]))return!1;return!0}function ac(e,t,i,u,h,m){if(ts=m,xt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,no.current=e===null||e.memoizedState===null?Zm:eg,e=i(u,h),Ga){m=0;do{if(Ga=!1,Va=0,25<=m)throw Error(n(301));m+=1,Rt=Tt=null,t.updateQueue=null,no.current=tg,e=i(u,h)}while(Ga)}if(no.current=oo,t=Tt!==null&&Tt.next!==null,ts=0,Rt=Tt=xt=null,so=!1,t)throw Error(n(300));return e}function ic(){var e=Va!==0;return Va=0,e}function Hr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Rt===null?xt.memoizedState=Rt=e:Rt=Rt.next=e,Rt}function jr(){if(Tt===null){var e=xt.alternate;e=e!==null?e.memoizedState:null}else e=Tt.next;var t=Rt===null?xt.memoizedState:Rt.next;if(t!==null)Rt=t,Tt=e;else{if(e===null)throw Error(n(310));Tt=e,e={memoizedState:Tt.memoizedState,baseState:Tt.baseState,baseQueue:Tt.baseQueue,queue:Tt.queue,next:null},Rt===null?xt.memoizedState=Rt=e:Rt=Rt.next=e}return Rt}function Ja(e,t){return typeof t=="function"?t(e):t}function oc(e){var t=jr(),i=t.queue;if(i===null)throw Error(n(311));i.lastRenderedReducer=e;var u=Tt,h=u.baseQueue,m=i.pending;if(m!==null){if(h!==null){var v=h.next;h.next=m.next,m.next=v}u.baseQueue=h=m,i.pending=null}if(h!==null){m=h.next,u=u.baseState;var N=v=null,P=null,z=m;do{var Z=z.lane;if((ts&Z)===Z)P!==null&&(P=P.next={lane:0,action:z.action,hasEagerState:z.hasEagerState,eagerState:z.eagerState,next:null}),u=z.hasEagerState?z.eagerState:e(u,z.action);else{var ie={lane:Z,action:z.action,hasEagerState:z.hasEagerState,eagerState:z.eagerState,next:null};P===null?(N=P=ie,v=u):P=P.next=ie,xt.lanes|=Z,rs|=Z}z=z.next}while(z!==null&&z!==m);P===null?v=u:P.next=N,Ar(u,t.memoizedState)||(cr=!0),t.memoizedState=u,t.baseState=v,t.baseQueue=P,i.lastRenderedState=u}if(e=i.interleaved,e!==null){h=e;do m=h.lane,xt.lanes|=m,rs|=m,h=h.next;while(h!==e)}else h===null&&(i.lanes=0);return[t.memoizedState,i.dispatch]}function lc(e){var t=jr(),i=t.queue;if(i===null)throw Error(n(311));i.lastRenderedReducer=e;var u=i.dispatch,h=i.pending,m=t.memoizedState;if(h!==null){i.pending=null;var v=h=h.next;do m=e(m,v.action),v=v.next;while(v!==h);Ar(m,t.memoizedState)||(cr=!0),t.memoizedState=m,t.baseQueue===null&&(t.baseState=m),i.lastRenderedState=m}return[m,u]}function Hd(){}function Gd(e,t){var i=xt,u=jr(),h=t(),m=!Ar(u.memoizedState,h);if(m&&(u.memoizedState=h,cr=!0),u=u.queue,cc(Kd.bind(null,i,u,e),[e]),u.getSnapshot!==t||m||Rt!==null&&Rt.memoizedState.tag&1){if(i.flags|=2048,Ka(9,Jd.bind(null,i,u,h,t),void 0,null),Lt===null)throw Error(n(349));(ts&30)!==0||Vd(i,t,h)}return h}function Vd(e,t,i){e.flags|=16384,e={getSnapshot:t,value:i},t=xt.updateQueue,t===null?(t={lastEffect:null,stores:null},xt.updateQueue=t,t.stores=[e]):(i=t.stores,i===null?t.stores=[e]:i.push(e))}function Jd(e,t,i,u){t.value=i,t.getSnapshot=u,Yd(t)&&Qd(e)}function Kd(e,t,i){return i(function(){Yd(t)&&Qd(e)})}function Yd(e){var t=e.getSnapshot;e=e.value;try{var i=t();return!Ar(e,i)}catch{return!0}}function Qd(e){var t=nn(e,1);t!==null&&Lr(t,e,1,-1)}function Xd(e){var t=Hr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ja,lastRenderedState:e},t.queue=e,e=e.dispatch=Xm.bind(null,xt,e),[t.memoizedState,e]}function Ka(e,t,i,u){return e={tag:e,create:t,destroy:i,deps:u,next:null},t=xt.updateQueue,t===null?(t={lastEffect:null,stores:null},xt.updateQueue=t,t.lastEffect=e.next=e):(i=t.lastEffect,i===null?t.lastEffect=e.next=e:(u=i.next,i.next=e,e.next=u,t.lastEffect=e)),e}function Zd(){return jr().memoizedState}function ao(e,t,i,u){var h=Hr();xt.flags|=e,h.memoizedState=Ka(1|t,i,void 0,u===void 0?null:u)}function io(e,t,i,u){var h=jr();u=u===void 0?null:u;var m=void 0;if(Tt!==null){var v=Tt.memoizedState;if(m=v.destroy,u!==null&&sc(u,v.deps)){h.memoizedState=Ka(t,i,m,u);return}}xt.flags|=e,h.memoizedState=Ka(1|t,i,m,u)}function eh(e,t){return ao(8390656,8,e,t)}function cc(e,t){return io(2048,8,e,t)}function th(e,t){return io(4,2,e,t)}function rh(e,t){return io(4,4,e,t)}function nh(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function sh(e,t,i){return i=i!=null?i.concat([e]):null,io(4,4,nh.bind(null,t,e),i)}function uc(){}function ah(e,t){var i=jr();t=t===void 0?null:t;var u=i.memoizedState;return u!==null&&t!==null&&sc(t,u[1])?u[0]:(i.memoizedState=[e,t],e)}function ih(e,t){var i=jr();t=t===void 0?null:t;var u=i.memoizedState;return u!==null&&t!==null&&sc(t,u[1])?u[0]:(e=e(),i.memoizedState=[e,t],e)}function oh(e,t,i){return(ts&21)===0?(e.baseState&&(e.baseState=!1,cr=!0),e.memoizedState=i):(Ar(i,t)||(i=Oe(),xt.lanes|=i,rs|=i,e.baseState=!0),t)}function Ym(e,t){var i=fe;fe=i!==0&&4>i?i:4,e(!0);var u=nc.transition;nc.transition={};try{e(!1),t()}finally{fe=i,nc.transition=u}}function lh(){return jr().memoizedState}function Qm(e,t,i){var u=Pn(e);if(i={lane:u,action:i,hasEagerState:!1,eagerState:null,next:null},ch(e))uh(t,i);else if(i=Wd(e,t,i,u),i!==null){var h=sr();Lr(i,e,u,h),dh(i,t,u)}}function Xm(e,t,i){var u=Pn(e),h={lane:u,action:i,hasEagerState:!1,eagerState:null,next:null};if(ch(e))uh(t,h);else{var m=e.alternate;if(e.lanes===0&&(m===null||m.lanes===0)&&(m=t.lastRenderedReducer,m!==null))try{var v=t.lastRenderedState,N=m(v,i);if(h.hasEagerState=!0,h.eagerState=N,Ar(N,v)){var P=t.interleaved;P===null?(h.next=h,Ql(t)):(h.next=P.next,P.next=h),t.interleaved=h;return}}catch{}finally{}i=Wd(e,t,h,u),i!==null&&(h=sr(),Lr(i,e,u,h),dh(i,t,u))}}function ch(e){var t=e.alternate;return e===xt||t!==null&&t===xt}function uh(e,t){Ga=so=!0;var i=e.pending;i===null?t.next=t:(t.next=i.next,i.next=t),e.pending=t}function dh(e,t,i){if((i&4194240)!==0){var u=t.lanes;u&=e.pendingLanes,i|=u,t.lanes=i,ue(e,i)}}var oo={readContext:_r,useCallback:Yt,useContext:Yt,useEffect:Yt,useImperativeHandle:Yt,useInsertionEffect:Yt,useLayoutEffect:Yt,useMemo:Yt,useReducer:Yt,useRef:Yt,useState:Yt,useDebugValue:Yt,useDeferredValue:Yt,useTransition:Yt,useMutableSource:Yt,useSyncExternalStore:Yt,useId:Yt,unstable_isNewReconciler:!1},Zm={readContext:_r,useCallback:function(e,t){return Hr().memoizedState=[e,t===void 0?null:t],e},useContext:_r,useEffect:eh,useImperativeHandle:function(e,t,i){return i=i!=null?i.concat([e]):null,ao(4194308,4,nh.bind(null,t,e),i)},useLayoutEffect:function(e,t){return ao(4194308,4,e,t)},useInsertionEffect:function(e,t){return ao(4,2,e,t)},useMemo:function(e,t){var i=Hr();return t=t===void 0?null:t,e=e(),i.memoizedState=[e,t],e},useReducer:function(e,t,i){var u=Hr();return t=i!==void 0?i(t):t,u.memoizedState=u.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},u.queue=e,e=e.dispatch=Qm.bind(null,xt,e),[u.memoizedState,e]},useRef:function(e){var t=Hr();return e={current:e},t.memoizedState=e},useState:Xd,useDebugValue:uc,useDeferredValue:function(e){return Hr().memoizedState=e},useTransition:function(){var e=Xd(!1),t=e[0];return e=Ym.bind(null,e[1]),Hr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,i){var u=xt,h=Hr();if(ft){if(i===void 0)throw Error(n(407));i=i()}else{if(i=t(),Lt===null)throw Error(n(349));(ts&30)!==0||Vd(u,t,i)}h.memoizedState=i;var m={value:i,getSnapshot:t};return h.queue=m,eh(Kd.bind(null,u,m,e),[e]),u.flags|=2048,Ka(9,Jd.bind(null,u,m,i,t),void 0,null),i},useId:function(){var e=Hr(),t=Lt.identifierPrefix;if(ft){var i=rn,u=tn;i=(u&~(1<<32-Wt(u)-1)).toString(32)+i,t=":"+t+"R"+i,i=Va++,0<i&&(t+="H"+i.toString(32)),t+=":"}else i=Km++,t=":"+t+"r"+i.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},eg={readContext:_r,useCallback:ah,useContext:_r,useEffect:cc,useImperativeHandle:sh,useInsertionEffect:th,useLayoutEffect:rh,useMemo:ih,useReducer:oc,useRef:Zd,useState:function(){return oc(Ja)},useDebugValue:uc,useDeferredValue:function(e){var t=jr();return oh(t,Tt.memoizedState,e)},useTransition:function(){var e=oc(Ja)[0],t=jr().memoizedState;return[e,t]},useMutableSource:Hd,useSyncExternalStore:Gd,useId:lh,unstable_isNewReconciler:!1},tg={readContext:_r,useCallback:ah,useContext:_r,useEffect:cc,useImperativeHandle:sh,useInsertionEffect:th,useLayoutEffect:rh,useMemo:ih,useReducer:lc,useRef:Zd,useState:function(){return lc(Ja)},useDebugValue:uc,useDeferredValue:function(e){var t=jr();return Tt===null?t.memoizedState=e:oh(t,Tt.memoizedState,e)},useTransition:function(){var e=lc(Ja)[0],t=jr().memoizedState;return[e,t]},useMutableSource:Hd,useSyncExternalStore:Gd,useId:lh,unstable_isNewReconciler:!1};function Ir(e,t){if(e&&e.defaultProps){t=C({},t),e=e.defaultProps;for(var i in e)t[i]===void 0&&(t[i]=e[i]);return t}return t}function dc(e,t,i,u){t=e.memoizedState,i=i(u,t),i=i==null?t:C({},t,i),e.memoizedState=i,e.lanes===0&&(e.updateQueue.baseState=i)}var lo={isMounted:function(e){return(e=e._reactInternals)?Xr(e)===e:!1},enqueueSetState:function(e,t,i){e=e._reactInternals;var u=sr(),h=Pn(e),m=sn(u,h);m.payload=t,i!=null&&(m.callback=i),t=Nn(e,m,h),t!==null&&(Lr(t,e,h,u),eo(t,e,h))},enqueueReplaceState:function(e,t,i){e=e._reactInternals;var u=sr(),h=Pn(e),m=sn(u,h);m.tag=1,m.payload=t,i!=null&&(m.callback=i),t=Nn(e,m,h),t!==null&&(Lr(t,e,h,u),eo(t,e,h))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var i=sr(),u=Pn(e),h=sn(i,u);h.tag=2,t!=null&&(h.callback=t),t=Nn(e,h,u),t!==null&&(Lr(t,e,u,i),eo(t,e,u))}};function hh(e,t,i,u,h,m,v){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(u,m,v):t.prototype&&t.prototype.isPureReactComponent?!Ra(i,u)||!Ra(h,m):!0}function fh(e,t,i){var u=!1,h=Sn,m=t.contextType;return typeof m=="object"&&m!==null?m=_r(m):(h=lr(t)?Yn:Kt.current,u=t.contextTypes,m=(u=u!=null)?Ds(e,h):Sn),t=new t(i,m),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=lo,e.stateNode=t,t._reactInternals=e,u&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=h,e.__reactInternalMemoizedMaskedChildContext=m),t}function ph(e,t,i,u){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(i,u),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(i,u),t.state!==e&&lo.enqueueReplaceState(t,t.state,null)}function hc(e,t,i,u){var h=e.stateNode;h.props=i,h.state=e.memoizedState,h.refs={},Xl(e);var m=t.contextType;typeof m=="object"&&m!==null?h.context=_r(m):(m=lr(t)?Yn:Kt.current,h.context=Ds(e,m)),h.state=e.memoizedState,m=t.getDerivedStateFromProps,typeof m=="function"&&(dc(e,t,m,i),h.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof h.getSnapshotBeforeUpdate=="function"||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(t=h.state,typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount(),t!==h.state&&lo.enqueueReplaceState(h,h.state,null),to(e,i,h,u),h.state=e.memoizedState),typeof h.componentDidMount=="function"&&(e.flags|=4194308)}function $s(e,t){try{var i="",u=t;do i+=ee(u),u=u.return;while(u);var h=i}catch(m){h=`
Error generating stack: `+m.message+`
`+m.stack}return{value:e,source:t,stack:h,digest:null}}function fc(e,t,i){return{value:e,source:null,stack:i??null,digest:t??null}}function pc(e,t){try{console.error(t.value)}catch(i){setTimeout(function(){throw i})}}var rg=typeof WeakMap=="function"?WeakMap:Map;function mh(e,t,i){i=sn(-1,i),i.tag=3,i.payload={element:null};var u=t.value;return i.callback=function(){go||(go=!0,Tc=u),pc(e,t)},i}function gh(e,t,i){i=sn(-1,i),i.tag=3;var u=e.type.getDerivedStateFromError;if(typeof u=="function"){var h=t.value;i.payload=function(){return u(h)},i.callback=function(){pc(e,t)}}var m=e.stateNode;return m!==null&&typeof m.componentDidCatch=="function"&&(i.callback=function(){pc(e,t),typeof u!="function"&&(Cn===null?Cn=new Set([this]):Cn.add(this));var v=t.stack;this.componentDidCatch(t.value,{componentStack:v!==null?v:""})}),i}function yh(e,t,i){var u=e.pingCache;if(u===null){u=e.pingCache=new rg;var h=new Set;u.set(t,h)}else h=u.get(t),h===void 0&&(h=new Set,u.set(t,h));h.has(i)||(h.add(i),e=gg.bind(null,e,t,i),t.then(e,e))}function vh(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function wh(e,t,i,u,h){return(e.mode&1)===0?(e===t?e.flags|=65536:(e.flags|=128,i.flags|=131072,i.flags&=-52805,i.tag===1&&(i.alternate===null?i.tag=17:(t=sn(-1,1),t.tag=2,Nn(i,t,1))),i.lanes|=1),e):(e.flags|=65536,e.lanes=h,e)}var ng=M.ReactCurrentOwner,cr=!1;function nr(e,t,i,u){t.child=e===null?Fd(t,null,i,u):Us(t,e.child,i,u)}function xh(e,t,i,u,h){i=i.render;var m=t.ref;return Ws(t,h),u=ac(e,t,i,u,m,h),i=ic(),e!==null&&!cr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~h,an(e,t,h)):(ft&&i&&$l(t),t.flags|=1,nr(e,t,u,h),t.child)}function bh(e,t,i,u,h){if(e===null){var m=i.type;return typeof m=="function"&&!Lc(m)&&m.defaultProps===void 0&&i.compare===null&&i.defaultProps===void 0?(t.tag=15,t.type=m,kh(e,t,m,u,h)):(e=ko(i.type,null,u,t,t.mode,h),e.ref=t.ref,e.return=t,t.child=e)}if(m=e.child,(e.lanes&h)===0){var v=m.memoizedProps;if(i=i.compare,i=i!==null?i:Ra,i(v,u)&&e.ref===t.ref)return an(e,t,h)}return t.flags|=1,e=On(m,u),e.ref=t.ref,e.return=t,t.child=e}function kh(e,t,i,u,h){if(e!==null){var m=e.memoizedProps;if(Ra(m,u)&&e.ref===t.ref)if(cr=!1,t.pendingProps=u=m,(e.lanes&h)!==0)(e.flags&131072)!==0&&(cr=!0);else return t.lanes=e.lanes,an(e,t,h)}return mc(e,t,i,u,h)}function Sh(e,t,i){var u=t.pendingProps,h=u.children,m=e!==null?e.memoizedState:null;if(u.mode==="hidden")if((t.mode&1)===0)t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ot(qs,xr),xr|=i;else{if((i&1073741824)===0)return e=m!==null?m.baseLanes|i:i,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ot(qs,xr),xr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},u=m!==null?m.baseLanes:i,ot(qs,xr),xr|=u}else m!==null?(u=m.baseLanes|i,t.memoizedState=null):u=i,ot(qs,xr),xr|=u;return nr(e,t,h,i),t.child}function _h(e,t){var i=t.ref;(e===null&&i!==null||e!==null&&e.ref!==i)&&(t.flags|=512,t.flags|=2097152)}function mc(e,t,i,u,h){var m=lr(i)?Yn:Kt.current;return m=Ds(t,m),Ws(t,h),i=ac(e,t,i,u,m,h),u=ic(),e!==null&&!cr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~h,an(e,t,h)):(ft&&u&&$l(t),t.flags|=1,nr(e,t,i,h),t.child)}function jh(e,t,i,u,h){if(lr(i)){var m=!0;Gi(t)}else m=!1;if(Ws(t,h),t.stateNode===null)uo(e,t),fh(t,i,u),hc(t,i,u,h),u=!0;else if(e===null){var v=t.stateNode,N=t.memoizedProps;v.props=N;var P=v.context,z=i.contextType;typeof z=="object"&&z!==null?z=_r(z):(z=lr(i)?Yn:Kt.current,z=Ds(t,z));var Z=i.getDerivedStateFromProps,ie=typeof Z=="function"||typeof v.getSnapshotBeforeUpdate=="function";ie||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(N!==u||P!==z)&&ph(t,v,u,z),jn=!1;var Q=t.memoizedState;v.state=Q,to(t,u,v,h),P=t.memoizedState,N!==u||Q!==P||or.current||jn?(typeof Z=="function"&&(dc(t,i,Z,u),P=t.memoizedState),(N=jn||hh(t,i,N,u,Q,P,z))?(ie||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(t.flags|=4194308)):(typeof v.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=u,t.memoizedState=P),v.props=u,v.state=P,v.context=z,u=N):(typeof v.componentDidMount=="function"&&(t.flags|=4194308),u=!1)}else{v=t.stateNode,Bd(e,t),N=t.memoizedProps,z=t.type===t.elementType?N:Ir(t.type,N),v.props=z,ie=t.pendingProps,Q=v.context,P=i.contextType,typeof P=="object"&&P!==null?P=_r(P):(P=lr(i)?Yn:Kt.current,P=Ds(t,P));var je=i.getDerivedStateFromProps;(Z=typeof je=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(N!==ie||Q!==P)&&ph(t,v,u,P),jn=!1,Q=t.memoizedState,v.state=Q,to(t,u,v,h);var Ce=t.memoizedState;N!==ie||Q!==Ce||or.current||jn?(typeof je=="function"&&(dc(t,i,je,u),Ce=t.memoizedState),(z=jn||hh(t,i,z,u,Q,Ce,P)||!1)?(Z||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(u,Ce,P),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(u,Ce,P)),typeof v.componentDidUpdate=="function"&&(t.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof v.componentDidUpdate!="function"||N===e.memoizedProps&&Q===e.memoizedState||(t.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||N===e.memoizedProps&&Q===e.memoizedState||(t.flags|=1024),t.memoizedProps=u,t.memoizedState=Ce),v.props=u,v.state=Ce,v.context=P,u=z):(typeof v.componentDidUpdate!="function"||N===e.memoizedProps&&Q===e.memoizedState||(t.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||N===e.memoizedProps&&Q===e.memoizedState||(t.flags|=1024),u=!1)}return gc(e,t,i,u,m,h)}function gc(e,t,i,u,h,m){_h(e,t);var v=(t.flags&128)!==0;if(!u&&!v)return h&&Pd(t,i,!1),an(e,t,m);u=t.stateNode,ng.current=t;var N=v&&typeof i.getDerivedStateFromError!="function"?null:u.render();return t.flags|=1,e!==null&&v?(t.child=Us(t,e.child,null,m),t.child=Us(t,null,N,m)):nr(e,t,N,m),t.memoizedState=u.state,h&&Pd(t,i,!0),t.child}function Nh(e){var t=e.stateNode;t.pendingContext?Cd(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Cd(e,t.context,!1),Zl(e,t.containerInfo)}function Eh(e,t,i,u,h){return Ms(),Gl(h),t.flags|=256,nr(e,t,i,u),t.child}var yc={dehydrated:null,treeContext:null,retryLane:0};function vc(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ch(e,t,i){var u=t.pendingProps,h=wt.current,m=!1,v=(t.flags&128)!==0,N;if((N=v)||(N=e!==null&&e.memoizedState===null?!1:(h&2)!==0),N?(m=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(h|=1),ot(wt,h&1),e===null)return Hl(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((t.mode&1)===0?t.lanes=1:e.data==="$!"?t.lanes=8:t.lanes=1073741824,null):(v=u.children,e=u.fallback,m?(u=t.mode,m=t.child,v={mode:"hidden",children:v},(u&1)===0&&m!==null?(m.childLanes=0,m.pendingProps=v):m=So(v,u,0,null),e=is(e,u,i,null),m.return=t,e.return=t,m.sibling=e,t.child=m,t.child.memoizedState=vc(i),t.memoizedState=yc,e):wc(t,v));if(h=e.memoizedState,h!==null&&(N=h.dehydrated,N!==null))return sg(e,t,v,u,N,h,i);if(m){m=u.fallback,v=t.mode,h=e.child,N=h.sibling;var P={mode:"hidden",children:u.children};return(v&1)===0&&t.child!==h?(u=t.child,u.childLanes=0,u.pendingProps=P,t.deletions=null):(u=On(h,P),u.subtreeFlags=h.subtreeFlags&14680064),N!==null?m=On(N,m):(m=is(m,v,i,null),m.flags|=2),m.return=t,u.return=t,u.sibling=m,t.child=u,u=m,m=t.child,v=e.child.memoizedState,v=v===null?vc(i):{baseLanes:v.baseLanes|i,cachePool:null,transitions:v.transitions},m.memoizedState=v,m.childLanes=e.childLanes&~i,t.memoizedState=yc,u}return m=e.child,e=m.sibling,u=On(m,{mode:"visible",children:u.children}),(t.mode&1)===0&&(u.lanes=i),u.return=t,u.sibling=null,e!==null&&(i=t.deletions,i===null?(t.deletions=[e],t.flags|=16):i.push(e)),t.child=u,t.memoizedState=null,u}function wc(e,t){return t=So({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function co(e,t,i,u){return u!==null&&Gl(u),Us(t,e.child,null,i),e=wc(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function sg(e,t,i,u,h,m,v){if(i)return t.flags&256?(t.flags&=-257,u=fc(Error(n(422))),co(e,t,v,u)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(m=u.fallback,h=t.mode,u=So({mode:"visible",children:u.children},h,0,null),m=is(m,h,v,null),m.flags|=2,u.return=t,m.return=t,u.sibling=m,t.child=u,(t.mode&1)!==0&&Us(t,e.child,null,v),t.child.memoizedState=vc(v),t.memoizedState=yc,m);if((t.mode&1)===0)return co(e,t,v,null);if(h.data==="$!"){if(u=h.nextSibling&&h.nextSibling.dataset,u)var N=u.dgst;return u=N,m=Error(n(419)),u=fc(m,u,void 0),co(e,t,v,u)}if(N=(v&e.childLanes)!==0,cr||N){if(u=Lt,u!==null){switch(v&-v){case 4:h=2;break;case 16:h=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:h=32;break;case 536870912:h=268435456;break;default:h=0}h=(h&(u.suspendedLanes|v))!==0?0:h,h!==0&&h!==m.retryLane&&(m.retryLane=h,nn(e,h),Lr(u,e,h,-1))}return Rc(),u=fc(Error(n(421))),co(e,t,v,u)}return h.data==="$?"?(t.flags|=128,t.child=e.child,t=yg.bind(null,e),h._reactRetry=t,null):(e=m.treeContext,wr=bn(h.nextSibling),vr=t,ft=!0,Or=null,e!==null&&(kr[Sr++]=tn,kr[Sr++]=rn,kr[Sr++]=Qn,tn=e.id,rn=e.overflow,Qn=t),t=wc(t,u.children),t.flags|=4096,t)}function Th(e,t,i){e.lanes|=t;var u=e.alternate;u!==null&&(u.lanes|=t),Yl(e.return,t,i)}function xc(e,t,i,u,h){var m=e.memoizedState;m===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:u,tail:i,tailMode:h}:(m.isBackwards=t,m.rendering=null,m.renderingStartTime=0,m.last=u,m.tail=i,m.tailMode=h)}function Ph(e,t,i){var u=t.pendingProps,h=u.revealOrder,m=u.tail;if(nr(e,t,u.children,i),u=wt.current,(u&2)!==0)u=u&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Th(e,i,t);else if(e.tag===19)Th(e,i,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}u&=1}if(ot(wt,u),(t.mode&1)===0)t.memoizedState=null;else switch(h){case"forwards":for(i=t.child,h=null;i!==null;)e=i.alternate,e!==null&&ro(e)===null&&(h=i),i=i.sibling;i=h,i===null?(h=t.child,t.child=null):(h=i.sibling,i.sibling=null),xc(t,!1,h,i,m);break;case"backwards":for(i=null,h=t.child,t.child=null;h!==null;){if(e=h.alternate,e!==null&&ro(e)===null){t.child=h;break}e=h.sibling,h.sibling=i,i=h,h=e}xc(t,!0,i,null,m);break;case"together":xc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function uo(e,t){(t.mode&1)===0&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function an(e,t,i){if(e!==null&&(t.dependencies=e.dependencies),rs|=t.lanes,(i&t.childLanes)===0)return null;if(e!==null&&t.child!==e.child)throw Error(n(153));if(t.child!==null){for(e=t.child,i=On(e,e.pendingProps),t.child=i,i.return=t;e.sibling!==null;)e=e.sibling,i=i.sibling=On(e,e.pendingProps),i.return=t;i.sibling=null}return t.child}function ag(e,t,i){switch(t.tag){case 3:Nh(t),Ms();break;case 5:qd(t);break;case 1:lr(t.type)&&Gi(t);break;case 4:Zl(t,t.stateNode.containerInfo);break;case 10:var u=t.type._context,h=t.memoizedProps.value;ot(Xi,u._currentValue),u._currentValue=h;break;case 13:if(u=t.memoizedState,u!==null)return u.dehydrated!==null?(ot(wt,wt.current&1),t.flags|=128,null):(i&t.child.childLanes)!==0?Ch(e,t,i):(ot(wt,wt.current&1),e=an(e,t,i),e!==null?e.sibling:null);ot(wt,wt.current&1);break;case 19:if(u=(i&t.childLanes)!==0,(e.flags&128)!==0){if(u)return Ph(e,t,i);t.flags|=128}if(h=t.memoizedState,h!==null&&(h.rendering=null,h.tail=null,h.lastEffect=null),ot(wt,wt.current),u)break;return null;case 22:case 23:return t.lanes=0,Sh(e,t,i)}return an(e,t,i)}var Ah,bc,Oh,Ih;Ah=function(e,t){for(var i=t.child;i!==null;){if(i.tag===5||i.tag===6)e.appendChild(i.stateNode);else if(i.tag!==4&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}},bc=function(){},Oh=function(e,t,i,u){var h=e.memoizedProps;if(h!==u){e=t.stateNode,es(qr.current);var m=null;switch(i){case"input":h=te(e,h),u=te(e,u),m=[];break;case"select":h=C({},h,{value:void 0}),u=C({},u,{value:void 0}),m=[];break;case"textarea":h=ze(e,h),u=ze(e,u),m=[];break;default:typeof h.onClick!="function"&&typeof u.onClick=="function"&&(e.onclick=zi)}ya(i,u);var v;i=null;for(z in h)if(!u.hasOwnProperty(z)&&h.hasOwnProperty(z)&&h[z]!=null)if(z==="style"){var N=h[z];for(v in N)N.hasOwnProperty(v)&&(i||(i={}),i[v]="")}else z!=="dangerouslySetInnerHTML"&&z!=="children"&&z!=="suppressContentEditableWarning"&&z!=="suppressHydrationWarning"&&z!=="autoFocus"&&(l.hasOwnProperty(z)?m||(m=[]):(m=m||[]).push(z,null));for(z in u){var P=u[z];if(N=h?.[z],u.hasOwnProperty(z)&&P!==N&&(P!=null||N!=null))if(z==="style")if(N){for(v in N)!N.hasOwnProperty(v)||P&&P.hasOwnProperty(v)||(i||(i={}),i[v]="");for(v in P)P.hasOwnProperty(v)&&N[v]!==P[v]&&(i||(i={}),i[v]=P[v])}else i||(m||(m=[]),m.push(z,i)),i=P;else z==="dangerouslySetInnerHTML"?(P=P?P.__html:void 0,N=N?N.__html:void 0,P!=null&&N!==P&&(m=m||[]).push(z,P)):z==="children"?typeof P!="string"&&typeof P!="number"||(m=m||[]).push(z,""+P):z!=="suppressContentEditableWarning"&&z!=="suppressHydrationWarning"&&(l.hasOwnProperty(z)?(P!=null&&z==="onScroll"&&ct("scroll",e),m||N===P||(m=[])):(m=m||[]).push(z,P))}i&&(m=m||[]).push("style",i);var z=m;(t.updateQueue=z)&&(t.flags|=4)}},Ih=function(e,t,i,u){i!==u&&(t.flags|=4)};function Ya(e,t){if(!ft)switch(e.tailMode){case"hidden":t=e.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var u=null;i!==null;)i.alternate!==null&&(u=i),i=i.sibling;u===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:u.sibling=null}}function Qt(e){var t=e.alternate!==null&&e.alternate.child===e.child,i=0,u=0;if(t)for(var h=e.child;h!==null;)i|=h.lanes|h.childLanes,u|=h.subtreeFlags&14680064,u|=h.flags&14680064,h.return=e,h=h.sibling;else for(h=e.child;h!==null;)i|=h.lanes|h.childLanes,u|=h.subtreeFlags,u|=h.flags,h.return=e,h=h.sibling;return e.subtreeFlags|=u,e.childLanes=i,t}function ig(e,t,i){var u=t.pendingProps;switch(zl(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qt(t),null;case 1:return lr(t.type)&&Hi(),Qt(t),null;case 3:return u=t.stateNode,Bs(),ut(or),ut(Kt),rc(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(e===null||e.child===null)&&(Yi(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,Or!==null&&(Oc(Or),Or=null))),bc(e,t),Qt(t),null;case 5:ec(t);var h=es(Ha.current);if(i=t.type,e!==null&&t.stateNode!=null)Oh(e,t,i,u,h),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!u){if(t.stateNode===null)throw Error(n(166));return Qt(t),null}if(e=es(qr.current),Yi(t)){u=t.stateNode,i=t.type;var m=t.memoizedProps;switch(u[zr]=t,u[Wa]=m,e=(t.mode&1)!==0,i){case"dialog":ct("cancel",u),ct("close",u);break;case"iframe":case"object":case"embed":ct("load",u);break;case"video":case"audio":for(h=0;h<Ma.length;h++)ct(Ma[h],u);break;case"source":ct("error",u);break;case"img":case"image":case"link":ct("error",u),ct("load",u);break;case"details":ct("toggle",u);break;case"input":Se(u,m),ct("invalid",u);break;case"select":u._wrapperState={wasMultiple:!!m.multiple},ct("invalid",u);break;case"textarea":$e(u,m),ct("invalid",u)}ya(i,m),h=null;for(var v in m)if(m.hasOwnProperty(v)){var N=m[v];v==="children"?typeof N=="string"?u.textContent!==N&&(m.suppressHydrationWarning!==!0&&$i(u.textContent,N,e),h=["children",N]):typeof N=="number"&&u.textContent!==""+N&&(m.suppressHydrationWarning!==!0&&$i(u.textContent,N,e),h=["children",""+N]):l.hasOwnProperty(v)&&N!=null&&v==="onScroll"&&ct("scroll",u)}switch(i){case"input":Ye(u),Ne(u,m,!0);break;case"textarea":Ye(u),mt(u);break;case"select":case"option":break;default:typeof m.onClick=="function"&&(u.onclick=zi)}u=h,t.updateQueue=u,u!==null&&(t.flags|=4)}else{v=h.nodeType===9?h:h.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=gt(i)),e==="http://www.w3.org/1999/xhtml"?i==="script"?(e=v.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof u.is=="string"?e=v.createElement(i,{is:u.is}):(e=v.createElement(i),i==="select"&&(v=e,u.multiple?v.multiple=!0:u.size&&(v.size=u.size))):e=v.createElementNS(e,i),e[zr]=t,e[Wa]=u,Ah(e,t,!1,!1),t.stateNode=e;e:{switch(v=ws(i,u),i){case"dialog":ct("cancel",e),ct("close",e),h=u;break;case"iframe":case"object":case"embed":ct("load",e),h=u;break;case"video":case"audio":for(h=0;h<Ma.length;h++)ct(Ma[h],e);h=u;break;case"source":ct("error",e),h=u;break;case"img":case"image":case"link":ct("error",e),ct("load",e),h=u;break;case"details":ct("toggle",e),h=u;break;case"input":Se(e,u),h=te(e,u),ct("invalid",e);break;case"option":h=u;break;case"select":e._wrapperState={wasMultiple:!!u.multiple},h=C({},u,{value:void 0}),ct("invalid",e);break;case"textarea":$e(e,u),h=ze(e,u),ct("invalid",e);break;default:h=u}ya(i,h),N=h;for(m in N)if(N.hasOwnProperty(m)){var P=N[m];m==="style"?tr(e,P):m==="dangerouslySetInnerHTML"?(P=P?P.__html:void 0,P!=null&&bt(e,P)):m==="children"?typeof P=="string"?(i!=="textarea"||P!=="")&&Ft(e,P):typeof P=="number"&&Ft(e,""+P):m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&m!=="autoFocus"&&(l.hasOwnProperty(m)?P!=null&&m==="onScroll"&&ct("scroll",e):P!=null&&R(e,m,P,v))}switch(i){case"input":Ye(e),Ne(e,u,!1);break;case"textarea":Ye(e),mt(e);break;case"option":u.value!=null&&e.setAttribute("value",""+ve(u.value));break;case"select":e.multiple=!!u.multiple,m=u.value,m!=null?Fe(e,!!u.multiple,m,!1):u.defaultValue!=null&&Fe(e,!!u.multiple,u.defaultValue,!0);break;default:typeof h.onClick=="function"&&(e.onclick=zi)}switch(i){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}}u&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Qt(t),null;case 6:if(e&&t.stateNode!=null)Ih(e,t,e.memoizedProps,u);else{if(typeof u!="string"&&t.stateNode===null)throw Error(n(166));if(i=es(Ha.current),es(qr.current),Yi(t)){if(u=t.stateNode,i=t.memoizedProps,u[zr]=t,(m=u.nodeValue!==i)&&(e=vr,e!==null))switch(e.tag){case 3:$i(u.nodeValue,i,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&$i(u.nodeValue,i,(e.mode&1)!==0)}m&&(t.flags|=4)}else u=(i.nodeType===9?i:i.ownerDocument).createTextNode(u),u[zr]=t,t.stateNode=u}return Qt(t),null;case 13:if(ut(wt),u=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ft&&wr!==null&&(t.mode&1)!==0&&(t.flags&128)===0)Ld(),Ms(),t.flags|=98560,m=!1;else if(m=Yi(t),u!==null&&u.dehydrated!==null){if(e===null){if(!m)throw Error(n(318));if(m=t.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(n(317));m[zr]=t}else Ms(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Qt(t),m=!1}else Or!==null&&(Oc(Or),Or=null),m=!0;if(!m)return t.flags&65536?t:null}return(t.flags&128)!==0?(t.lanes=i,t):(u=u!==null,u!==(e!==null&&e.memoizedState!==null)&&u&&(t.child.flags|=8192,(t.mode&1)!==0&&(e===null||(wt.current&1)!==0?Pt===0&&(Pt=3):Rc())),t.updateQueue!==null&&(t.flags|=4),Qt(t),null);case 4:return Bs(),bc(e,t),e===null&&Ua(t.stateNode.containerInfo),Qt(t),null;case 10:return Kl(t.type._context),Qt(t),null;case 17:return lr(t.type)&&Hi(),Qt(t),null;case 19:if(ut(wt),m=t.memoizedState,m===null)return Qt(t),null;if(u=(t.flags&128)!==0,v=m.rendering,v===null)if(u)Ya(m,!1);else{if(Pt!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(v=ro(e),v!==null){for(t.flags|=128,Ya(m,!1),u=v.updateQueue,u!==null&&(t.updateQueue=u,t.flags|=4),t.subtreeFlags=0,u=i,i=t.child;i!==null;)m=i,e=u,m.flags&=14680066,v=m.alternate,v===null?(m.childLanes=0,m.lanes=e,m.child=null,m.subtreeFlags=0,m.memoizedProps=null,m.memoizedState=null,m.updateQueue=null,m.dependencies=null,m.stateNode=null):(m.childLanes=v.childLanes,m.lanes=v.lanes,m.child=v.child,m.subtreeFlags=0,m.deletions=null,m.memoizedProps=v.memoizedProps,m.memoizedState=v.memoizedState,m.updateQueue=v.updateQueue,m.type=v.type,e=v.dependencies,m.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),i=i.sibling;return ot(wt,wt.current&1|2),t.child}e=e.sibling}m.tail!==null&&yt()>Hs&&(t.flags|=128,u=!0,Ya(m,!1),t.lanes=4194304)}else{if(!u)if(e=ro(v),e!==null){if(t.flags|=128,u=!0,i=e.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),Ya(m,!0),m.tail===null&&m.tailMode==="hidden"&&!v.alternate&&!ft)return Qt(t),null}else 2*yt()-m.renderingStartTime>Hs&&i!==1073741824&&(t.flags|=128,u=!0,Ya(m,!1),t.lanes=4194304);m.isBackwards?(v.sibling=t.child,t.child=v):(i=m.last,i!==null?i.sibling=v:t.child=v,m.last=v)}return m.tail!==null?(t=m.tail,m.rendering=t,m.tail=t.sibling,m.renderingStartTime=yt(),t.sibling=null,i=wt.current,ot(wt,u?i&1|2:i&1),t):(Qt(t),null);case 22:case 23:return Dc(),u=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==u&&(t.flags|=8192),u&&(t.mode&1)!==0?(xr&1073741824)!==0&&(Qt(t),t.subtreeFlags&6&&(t.flags|=8192)):Qt(t),null;case 24:return null;case 25:return null}throw Error(n(156,t.tag))}function og(e,t){switch(zl(t),t.tag){case 1:return lr(t.type)&&Hi(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Bs(),ut(or),ut(Kt),rc(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 5:return ec(t),null;case 13:if(ut(wt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(n(340));Ms()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ut(wt),null;case 4:return Bs(),null;case 10:return Kl(t.type._context),null;case 22:case 23:return Dc(),null;case 24:return null;default:return null}}var ho=!1,Xt=!1,lg=typeof WeakSet=="function"?WeakSet:Set,Ee=null;function zs(e,t){var i=e.ref;if(i!==null)if(typeof i=="function")try{i(null)}catch(u){kt(e,t,u)}else i.current=null}function kc(e,t,i){try{i()}catch(u){kt(e,t,u)}}var Dh=!1;function cg(e,t){if(Dl=Ai,e=hd(),Nl(e)){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{i=(i=e.ownerDocument)&&i.defaultView||window;var u=i.getSelection&&i.getSelection();if(u&&u.rangeCount!==0){i=u.anchorNode;var h=u.anchorOffset,m=u.focusNode;u=u.focusOffset;try{i.nodeType,m.nodeType}catch{i=null;break e}var v=0,N=-1,P=-1,z=0,Z=0,ie=e,Q=null;t:for(;;){for(var je;ie!==i||h!==0&&ie.nodeType!==3||(N=v+h),ie!==m||u!==0&&ie.nodeType!==3||(P=v+u),ie.nodeType===3&&(v+=ie.nodeValue.length),(je=ie.firstChild)!==null;)Q=ie,ie=je;for(;;){if(ie===e)break t;if(Q===i&&++z===h&&(N=v),Q===m&&++Z===u&&(P=v),(je=ie.nextSibling)!==null)break;ie=Q,Q=ie.parentNode}ie=je}i=N===-1||P===-1?null:{start:N,end:P}}else i=null}i=i||{start:0,end:0}}else i=null;for(Rl={focusedElem:e,selectionRange:i},Ai=!1,Ee=t;Ee!==null;)if(t=Ee,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ee=e;else for(;Ee!==null;){t=Ee;try{var Ce=t.alternate;if((t.flags&1024)!==0)switch(t.tag){case 0:case 11:case 15:break;case 1:if(Ce!==null){var Te=Ce.memoizedProps,St=Ce.memoizedState,U=t.stateNode,A=U.getSnapshotBeforeUpdate(t.elementType===t.type?Te:Ir(t.type,Te),St);U.__reactInternalSnapshotBeforeUpdate=A}break;case 3:var F=t.stateNode.containerInfo;F.nodeType===1?F.textContent="":F.nodeType===9&&F.documentElement&&F.removeChild(F.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(ce){kt(t,t.return,ce)}if(e=t.sibling,e!==null){e.return=t.return,Ee=e;break}Ee=t.return}return Ce=Dh,Dh=!1,Ce}function Qa(e,t,i){var u=t.updateQueue;if(u=u!==null?u.lastEffect:null,u!==null){var h=u=u.next;do{if((h.tag&e)===e){var m=h.destroy;h.destroy=void 0,m!==void 0&&kc(t,i,m)}h=h.next}while(h!==u)}}function fo(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var i=t=t.next;do{if((i.tag&e)===e){var u=i.create;i.destroy=u()}i=i.next}while(i!==t)}}function Sc(e){var t=e.ref;if(t!==null){var i=e.stateNode;switch(e.tag){case 5:e=i;break;default:e=i}typeof t=="function"?t(e):t.current=e}}function Rh(e){var t=e.alternate;t!==null&&(e.alternate=null,Rh(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[zr],delete t[Wa],delete t[Fl],delete t[Hm],delete t[Gm])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Lh(e){return e.tag===5||e.tag===3||e.tag===4}function Mh(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Lh(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function _c(e,t,i){var u=e.tag;if(u===5||u===6)e=e.stateNode,t?i.nodeType===8?i.parentNode.insertBefore(e,t):i.insertBefore(e,t):(i.nodeType===8?(t=i.parentNode,t.insertBefore(e,i)):(t=i,t.appendChild(e)),i=i._reactRootContainer,i!=null||t.onclick!==null||(t.onclick=zi));else if(u!==4&&(e=e.child,e!==null))for(_c(e,t,i),e=e.sibling;e!==null;)_c(e,t,i),e=e.sibling}function jc(e,t,i){var u=e.tag;if(u===5||u===6)e=e.stateNode,t?i.insertBefore(e,t):i.appendChild(e);else if(u!==4&&(e=e.child,e!==null))for(jc(e,t,i),e=e.sibling;e!==null;)jc(e,t,i),e=e.sibling}var $t=null,Dr=!1;function En(e,t,i){for(i=i.child;i!==null;)Uh(e,t,i),i=i.sibling}function Uh(e,t,i){if(Vt&&typeof Vt.onCommitFiberUnmount=="function")try{Vt.onCommitFiberUnmount(ks,i)}catch{}switch(i.tag){case 5:Xt||zs(i,t);case 6:var u=$t,h=Dr;$t=null,En(e,t,i),$t=u,Dr=h,$t!==null&&(Dr?(e=$t,i=i.stateNode,e.nodeType===8?e.parentNode.removeChild(i):e.removeChild(i)):$t.removeChild(i.stateNode));break;case 18:$t!==null&&(Dr?(e=$t,i=i.stateNode,e.nodeType===8?Ul(e.parentNode,i):e.nodeType===1&&Ul(e,i),Ta(e)):Ul($t,i.stateNode));break;case 4:u=$t,h=Dr,$t=i.stateNode.containerInfo,Dr=!0,En(e,t,i),$t=u,Dr=h;break;case 0:case 11:case 14:case 15:if(!Xt&&(u=i.updateQueue,u!==null&&(u=u.lastEffect,u!==null))){h=u=u.next;do{var m=h,v=m.destroy;m=m.tag,v!==void 0&&((m&2)!==0||(m&4)!==0)&&kc(i,t,v),h=h.next}while(h!==u)}En(e,t,i);break;case 1:if(!Xt&&(zs(i,t),u=i.stateNode,typeof u.componentWillUnmount=="function"))try{u.props=i.memoizedProps,u.state=i.memoizedState,u.componentWillUnmount()}catch(N){kt(i,t,N)}En(e,t,i);break;case 21:En(e,t,i);break;case 22:i.mode&1?(Xt=(u=Xt)||i.memoizedState!==null,En(e,t,i),Xt=u):En(e,t,i);break;default:En(e,t,i)}}function Fh(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var i=e.stateNode;i===null&&(i=e.stateNode=new lg),t.forEach(function(u){var h=vg.bind(null,e,u);i.has(u)||(i.add(u),u.then(h,h))})}}function Rr(e,t){var i=t.deletions;if(i!==null)for(var u=0;u<i.length;u++){var h=i[u];try{var m=e,v=t,N=v;e:for(;N!==null;){switch(N.tag){case 5:$t=N.stateNode,Dr=!1;break e;case 3:$t=N.stateNode.containerInfo,Dr=!0;break e;case 4:$t=N.stateNode.containerInfo,Dr=!0;break e}N=N.return}if($t===null)throw Error(n(160));Uh(m,v,h),$t=null,Dr=!1;var P=h.alternate;P!==null&&(P.return=null),h.return=null}catch(z){kt(h,t,z)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Wh(t,e),t=t.sibling}function Wh(e,t){var i=e.alternate,u=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Rr(t,e),Gr(e),u&4){try{Qa(3,e,e.return),fo(3,e)}catch(Te){kt(e,e.return,Te)}try{Qa(5,e,e.return)}catch(Te){kt(e,e.return,Te)}}break;case 1:Rr(t,e),Gr(e),u&512&&i!==null&&zs(i,i.return);break;case 5:if(Rr(t,e),Gr(e),u&512&&i!==null&&zs(i,i.return),e.flags&32){var h=e.stateNode;try{Ft(h,"")}catch(Te){kt(e,e.return,Te)}}if(u&4&&(h=e.stateNode,h!=null)){var m=e.memoizedProps,v=i!==null?i.memoizedProps:m,N=e.type,P=e.updateQueue;if(e.updateQueue=null,P!==null)try{N==="input"&&m.type==="radio"&&m.name!=null&&I(h,m),ws(N,v);var z=ws(N,m);for(v=0;v<P.length;v+=2){var Z=P[v],ie=P[v+1];Z==="style"?tr(h,ie):Z==="dangerouslySetInnerHTML"?bt(h,ie):Z==="children"?Ft(h,ie):R(h,Z,ie,z)}switch(N){case"input":B(h,m);break;case"textarea":Ke(h,m);break;case"select":var Q=h._wrapperState.wasMultiple;h._wrapperState.wasMultiple=!!m.multiple;var je=m.value;je!=null?Fe(h,!!m.multiple,je,!1):Q!==!!m.multiple&&(m.defaultValue!=null?Fe(h,!!m.multiple,m.defaultValue,!0):Fe(h,!!m.multiple,m.multiple?[]:"",!1))}h[Wa]=m}catch(Te){kt(e,e.return,Te)}}break;case 6:if(Rr(t,e),Gr(e),u&4){if(e.stateNode===null)throw Error(n(162));h=e.stateNode,m=e.memoizedProps;try{h.nodeValue=m}catch(Te){kt(e,e.return,Te)}}break;case 3:if(Rr(t,e),Gr(e),u&4&&i!==null&&i.memoizedState.isDehydrated)try{Ta(t.containerInfo)}catch(Te){kt(e,e.return,Te)}break;case 4:Rr(t,e),Gr(e);break;case 13:Rr(t,e),Gr(e),h=e.child,h.flags&8192&&(m=h.memoizedState!==null,h.stateNode.isHidden=m,!m||h.alternate!==null&&h.alternate.memoizedState!==null||(Cc=yt())),u&4&&Fh(e);break;case 22:if(Z=i!==null&&i.memoizedState!==null,e.mode&1?(Xt=(z=Xt)||Z,Rr(t,e),Xt=z):Rr(t,e),Gr(e),u&8192){if(z=e.memoizedState!==null,(e.stateNode.isHidden=z)&&!Z&&(e.mode&1)!==0)for(Ee=e,Z=e.child;Z!==null;){for(ie=Ee=Z;Ee!==null;){switch(Q=Ee,je=Q.child,Q.tag){case 0:case 11:case 14:case 15:Qa(4,Q,Q.return);break;case 1:zs(Q,Q.return);var Ce=Q.stateNode;if(typeof Ce.componentWillUnmount=="function"){u=Q,i=Q.return;try{t=u,Ce.props=t.memoizedProps,Ce.state=t.memoizedState,Ce.componentWillUnmount()}catch(Te){kt(u,i,Te)}}break;case 5:zs(Q,Q.return);break;case 22:if(Q.memoizedState!==null){zh(ie);continue}}je!==null?(je.return=Q,Ee=je):zh(ie)}Z=Z.sibling}e:for(Z=null,ie=e;;){if(ie.tag===5){if(Z===null){Z=ie;try{h=ie.stateNode,z?(m=h.style,typeof m.setProperty=="function"?m.setProperty("display","none","important"):m.display="none"):(N=ie.stateNode,P=ie.memoizedProps.style,v=P!=null&&P.hasOwnProperty("display")?P.display:null,N.style.display=Dt("display",v))}catch(Te){kt(e,e.return,Te)}}}else if(ie.tag===6){if(Z===null)try{ie.stateNode.nodeValue=z?"":ie.memoizedProps}catch(Te){kt(e,e.return,Te)}}else if((ie.tag!==22&&ie.tag!==23||ie.memoizedState===null||ie===e)&&ie.child!==null){ie.child.return=ie,ie=ie.child;continue}if(ie===e)break e;for(;ie.sibling===null;){if(ie.return===null||ie.return===e)break e;Z===ie&&(Z=null),ie=ie.return}Z===ie&&(Z=null),ie.sibling.return=ie.return,ie=ie.sibling}}break;case 19:Rr(t,e),Gr(e),u&4&&Fh(e);break;case 21:break;default:Rr(t,e),Gr(e)}}function Gr(e){var t=e.flags;if(t&2){try{e:{for(var i=e.return;i!==null;){if(Lh(i)){var u=i;break e}i=i.return}throw Error(n(160))}switch(u.tag){case 5:var h=u.stateNode;u.flags&32&&(Ft(h,""),u.flags&=-33);var m=Mh(e);jc(e,m,h);break;case 3:case 4:var v=u.stateNode.containerInfo,N=Mh(e);_c(e,N,v);break;default:throw Error(n(161))}}catch(P){kt(e,e.return,P)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function ug(e,t,i){Ee=e,Bh(e)}function Bh(e,t,i){for(var u=(e.mode&1)!==0;Ee!==null;){var h=Ee,m=h.child;if(h.tag===22&&u){var v=h.memoizedState!==null||ho;if(!v){var N=h.alternate,P=N!==null&&N.memoizedState!==null||Xt;N=ho;var z=Xt;if(ho=v,(Xt=P)&&!z)for(Ee=h;Ee!==null;)v=Ee,P=v.child,v.tag===22&&v.memoizedState!==null?qh(h):P!==null?(P.return=v,Ee=P):qh(h);for(;m!==null;)Ee=m,Bh(m),m=m.sibling;Ee=h,ho=N,Xt=z}$h(e)}else(h.subtreeFlags&8772)!==0&&m!==null?(m.return=h,Ee=m):$h(e)}}function $h(e){for(;Ee!==null;){var t=Ee;if((t.flags&8772)!==0){var i=t.alternate;try{if((t.flags&8772)!==0)switch(t.tag){case 0:case 11:case 15:Xt||fo(5,t);break;case 1:var u=t.stateNode;if(t.flags&4&&!Xt)if(i===null)u.componentDidMount();else{var h=t.elementType===t.type?i.memoizedProps:Ir(t.type,i.memoizedProps);u.componentDidUpdate(h,i.memoizedState,u.__reactInternalSnapshotBeforeUpdate)}var m=t.updateQueue;m!==null&&zd(t,m,u);break;case 3:var v=t.updateQueue;if(v!==null){if(i=null,t.child!==null)switch(t.child.tag){case 5:i=t.child.stateNode;break;case 1:i=t.child.stateNode}zd(t,v,i)}break;case 5:var N=t.stateNode;if(i===null&&t.flags&4){i=N;var P=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":P.autoFocus&&i.focus();break;case"img":P.src&&(i.src=P.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var z=t.alternate;if(z!==null){var Z=z.memoizedState;if(Z!==null){var ie=Z.dehydrated;ie!==null&&Ta(ie)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}Xt||t.flags&512&&Sc(t)}catch(Q){kt(t,t.return,Q)}}if(t===e){Ee=null;break}if(i=t.sibling,i!==null){i.return=t.return,Ee=i;break}Ee=t.return}}function zh(e){for(;Ee!==null;){var t=Ee;if(t===e){Ee=null;break}var i=t.sibling;if(i!==null){i.return=t.return,Ee=i;break}Ee=t.return}}function qh(e){for(;Ee!==null;){var t=Ee;try{switch(t.tag){case 0:case 11:case 15:var i=t.return;try{fo(4,t)}catch(P){kt(t,i,P)}break;case 1:var u=t.stateNode;if(typeof u.componentDidMount=="function"){var h=t.return;try{u.componentDidMount()}catch(P){kt(t,h,P)}}var m=t.return;try{Sc(t)}catch(P){kt(t,m,P)}break;case 5:var v=t.return;try{Sc(t)}catch(P){kt(t,v,P)}}}catch(P){kt(t,t.return,P)}if(t===e){Ee=null;break}var N=t.sibling;if(N!==null){N.return=t.return,Ee=N;break}Ee=t.return}}var dg=Math.ceil,po=M.ReactCurrentDispatcher,Nc=M.ReactCurrentOwner,Nr=M.ReactCurrentBatchConfig,tt=0,Lt=null,Nt=null,zt=0,xr=0,qs=kn(0),Pt=0,Xa=null,rs=0,mo=0,Ec=0,Za=null,ur=null,Cc=0,Hs=1/0,on=null,go=!1,Tc=null,Cn=null,yo=!1,Tn=null,vo=0,ei=0,Pc=null,wo=-1,xo=0;function sr(){return(tt&6)!==0?yt():wo!==-1?wo:wo=yt()}function Pn(e){return(e.mode&1)===0?1:(tt&2)!==0&&zt!==0?zt&-zt:Jm.transition!==null?(xo===0&&(xo=Oe()),xo):(e=fe,e!==0||(e=window.event,e=e===void 0?16:Gu(e.type)),e)}function Lr(e,t,i,u){if(50<ei)throw ei=0,Pc=null,Error(n(185));Re(e,i,u),((tt&2)===0||e!==Lt)&&(e===Lt&&((tt&2)===0&&(mo|=i),Pt===4&&An(e,zt)),dr(e,u),i===1&&tt===0&&(t.mode&1)===0&&(Hs=yt()+500,Vi&&_n()))}function dr(e,t){var i=e.callbackNode;ae(e,t);var u=W(e,e===Lt?zt:0);if(u===0)i!==null&&Ei(i),e.callbackNode=null,e.callbackPriority=0;else if(t=u&-u,e.callbackPriority!==t){if(i!=null&&Ei(i),t===1)e.tag===0?Vm(Gh.bind(null,e)):Ad(Gh.bind(null,e)),zm(function(){(tt&6)===0&&_n()}),i=null;else{switch(Me(u)){case 1:i=ja;break;case 4:i=gn;break;case 16:i=$r;break;case 536870912:i=Ti;break;default:i=$r}i=ef(i,Hh.bind(null,e))}e.callbackPriority=t,e.callbackNode=i}}function Hh(e,t){if(wo=-1,xo=0,(tt&6)!==0)throw Error(n(327));var i=e.callbackNode;if(Gs()&&e.callbackNode!==i)return null;var u=W(e,e===Lt?zt:0);if(u===0)return null;if((u&30)!==0||(u&e.expiredLanes)!==0||t)t=bo(e,u);else{t=u;var h=tt;tt|=2;var m=Jh();(Lt!==e||zt!==t)&&(on=null,Hs=yt()+500,ss(e,t));do try{pg();break}catch(N){Vh(e,N)}while(!0);Jl(),po.current=m,tt=h,Nt!==null?t=0:(Lt=null,zt=0,t=Pt)}if(t!==0){if(t===2&&(h=_e(e),h!==0&&(u=h,t=Ac(e,h))),t===1)throw i=Xa,ss(e,0),An(e,u),dr(e,yt()),i;if(t===6)An(e,u);else{if(h=e.current.alternate,(u&30)===0&&!hg(h)&&(t=bo(e,u),t===2&&(m=_e(e),m!==0&&(u=m,t=Ac(e,m))),t===1))throw i=Xa,ss(e,0),An(e,u),dr(e,yt()),i;switch(e.finishedWork=h,e.finishedLanes=u,t){case 0:case 1:throw Error(n(345));case 2:as(e,ur,on);break;case 3:if(An(e,u),(u&130023424)===u&&(t=Cc+500-yt(),10<t)){if(W(e,0)!==0)break;if(h=e.suspendedLanes,(h&u)!==u){sr(),e.pingedLanes|=e.suspendedLanes&h;break}e.timeoutHandle=Ml(as.bind(null,e,ur,on),t);break}as(e,ur,on);break;case 4:if(An(e,u),(u&4194240)===u)break;for(t=e.eventTimes,h=-1;0<u;){var v=31-Wt(u);m=1<<v,v=t[v],v>h&&(h=v),u&=~m}if(u=h,u=yt()-u,u=(120>u?120:480>u?480:1080>u?1080:1920>u?1920:3e3>u?3e3:4320>u?4320:1960*dg(u/1960))-u,10<u){e.timeoutHandle=Ml(as.bind(null,e,ur,on),u);break}as(e,ur,on);break;case 5:as(e,ur,on);break;default:throw Error(n(329))}}}return dr(e,yt()),e.callbackNode===i?Hh.bind(null,e):null}function Ac(e,t){var i=Za;return e.current.memoizedState.isDehydrated&&(ss(e,t).flags|=256),e=bo(e,t),e!==2&&(t=ur,ur=i,t!==null&&Oc(t)),e}function Oc(e){ur===null?ur=e:ur.push.apply(ur,e)}function hg(e){for(var t=e;;){if(t.flags&16384){var i=t.updateQueue;if(i!==null&&(i=i.stores,i!==null))for(var u=0;u<i.length;u++){var h=i[u],m=h.getSnapshot;h=h.value;try{if(!Ar(m(),h))return!1}catch{return!1}}}if(i=t.child,t.subtreeFlags&16384&&i!==null)i.return=t,t=i;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function An(e,t){for(t&=~Ec,t&=~mo,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var i=31-Wt(t),u=1<<i;e[i]=-1,t&=~u}}function Gh(e){if((tt&6)!==0)throw Error(n(327));Gs();var t=W(e,0);if((t&1)===0)return dr(e,yt()),null;var i=bo(e,t);if(e.tag!==0&&i===2){var u=_e(e);u!==0&&(t=u,i=Ac(e,u))}if(i===1)throw i=Xa,ss(e,0),An(e,t),dr(e,yt()),i;if(i===6)throw Error(n(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,as(e,ur,on),dr(e,yt()),null}function Ic(e,t){var i=tt;tt|=1;try{return e(t)}finally{tt=i,tt===0&&(Hs=yt()+500,Vi&&_n())}}function ns(e){Tn!==null&&Tn.tag===0&&(tt&6)===0&&Gs();var t=tt;tt|=1;var i=Nr.transition,u=fe;try{if(Nr.transition=null,fe=1,e)return e()}finally{fe=u,Nr.transition=i,tt=t,(tt&6)===0&&_n()}}function Dc(){xr=qs.current,ut(qs)}function ss(e,t){e.finishedWork=null,e.finishedLanes=0;var i=e.timeoutHandle;if(i!==-1&&(e.timeoutHandle=-1,$m(i)),Nt!==null)for(i=Nt.return;i!==null;){var u=i;switch(zl(u),u.tag){case 1:u=u.type.childContextTypes,u!=null&&Hi();break;case 3:Bs(),ut(or),ut(Kt),rc();break;case 5:ec(u);break;case 4:Bs();break;case 13:ut(wt);break;case 19:ut(wt);break;case 10:Kl(u.type._context);break;case 22:case 23:Dc()}i=i.return}if(Lt=e,Nt=e=On(e.current,null),zt=xr=t,Pt=0,Xa=null,Ec=mo=rs=0,ur=Za=null,Zn!==null){for(t=0;t<Zn.length;t++)if(i=Zn[t],u=i.interleaved,u!==null){i.interleaved=null;var h=u.next,m=i.pending;if(m!==null){var v=m.next;m.next=h,u.next=v}i.pending=u}Zn=null}return e}function Vh(e,t){do{var i=Nt;try{if(Jl(),no.current=oo,so){for(var u=xt.memoizedState;u!==null;){var h=u.queue;h!==null&&(h.pending=null),u=u.next}so=!1}if(ts=0,Rt=Tt=xt=null,Ga=!1,Va=0,Nc.current=null,i===null||i.return===null){Pt=1,Xa=t,Nt=null;break}e:{var m=e,v=i.return,N=i,P=t;if(t=zt,N.flags|=32768,P!==null&&typeof P=="object"&&typeof P.then=="function"){var z=P,Z=N,ie=Z.tag;if((Z.mode&1)===0&&(ie===0||ie===11||ie===15)){var Q=Z.alternate;Q?(Z.updateQueue=Q.updateQueue,Z.memoizedState=Q.memoizedState,Z.lanes=Q.lanes):(Z.updateQueue=null,Z.memoizedState=null)}var je=vh(v);if(je!==null){je.flags&=-257,wh(je,v,N,m,t),je.mode&1&&yh(m,z,t),t=je,P=z;var Ce=t.updateQueue;if(Ce===null){var Te=new Set;Te.add(P),t.updateQueue=Te}else Ce.add(P);break e}else{if((t&1)===0){yh(m,z,t),Rc();break e}P=Error(n(426))}}else if(ft&&N.mode&1){var St=vh(v);if(St!==null){(St.flags&65536)===0&&(St.flags|=256),wh(St,v,N,m,t),Gl($s(P,N));break e}}m=P=$s(P,N),Pt!==4&&(Pt=2),Za===null?Za=[m]:Za.push(m),m=v;do{switch(m.tag){case 3:m.flags|=65536,t&=-t,m.lanes|=t;var U=mh(m,P,t);$d(m,U);break e;case 1:N=P;var A=m.type,F=m.stateNode;if((m.flags&128)===0&&(typeof A.getDerivedStateFromError=="function"||F!==null&&typeof F.componentDidCatch=="function"&&(Cn===null||!Cn.has(F)))){m.flags|=65536,t&=-t,m.lanes|=t;var ce=gh(m,N,t);$d(m,ce);break e}}m=m.return}while(m!==null)}Yh(i)}catch(Pe){t=Pe,Nt===i&&i!==null&&(Nt=i=i.return);continue}break}while(!0)}function Jh(){var e=po.current;return po.current=oo,e===null?oo:e}function Rc(){(Pt===0||Pt===3||Pt===2)&&(Pt=4),Lt===null||(rs&268435455)===0&&(mo&268435455)===0||An(Lt,zt)}function bo(e,t){var i=tt;tt|=2;var u=Jh();(Lt!==e||zt!==t)&&(on=null,ss(e,t));do try{fg();break}catch(h){Vh(e,h)}while(!0);if(Jl(),tt=i,po.current=u,Nt!==null)throw Error(n(261));return Lt=null,zt=0,Pt}function fg(){for(;Nt!==null;)Kh(Nt)}function pg(){for(;Nt!==null&&!cl();)Kh(Nt)}function Kh(e){var t=Zh(e.alternate,e,xr);e.memoizedProps=e.pendingProps,t===null?Yh(e):Nt=t,Nc.current=null}function Yh(e){var t=e;do{var i=t.alternate;if(e=t.return,(t.flags&32768)===0){if(i=ig(i,t,xr),i!==null){Nt=i;return}}else{if(i=og(i,t),i!==null){i.flags&=32767,Nt=i;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Pt=6,Nt=null;return}}if(t=t.sibling,t!==null){Nt=t;return}Nt=t=e}while(t!==null);Pt===0&&(Pt=5)}function as(e,t,i){var u=fe,h=Nr.transition;try{Nr.transition=null,fe=1,mg(e,t,i,u)}finally{Nr.transition=h,fe=u}return null}function mg(e,t,i,u){do Gs();while(Tn!==null);if((tt&6)!==0)throw Error(n(327));i=e.finishedWork;var h=e.finishedLanes;if(i===null)return null;if(e.finishedWork=null,e.finishedLanes=0,i===e.current)throw Error(n(177));e.callbackNode=null,e.callbackPriority=0;var m=i.lanes|i.childLanes;if(De(e,m),e===Lt&&(Nt=Lt=null,zt=0),(i.subtreeFlags&2064)===0&&(i.flags&2064)===0||yo||(yo=!0,ef($r,function(){return Gs(),null})),m=(i.flags&15990)!==0,(i.subtreeFlags&15990)!==0||m){m=Nr.transition,Nr.transition=null;var v=fe;fe=1;var N=tt;tt|=4,Nc.current=null,cg(e,i),Wh(i,e),Rm(Rl),Ai=!!Dl,Rl=Dl=null,e.current=i,ug(i),Ci(),tt=N,fe=v,Nr.transition=m}else e.current=i;if(yo&&(yo=!1,Tn=e,vo=h),m=e.pendingLanes,m===0&&(Cn=null),hl(i.stateNode),dr(e,yt()),t!==null)for(u=e.onRecoverableError,i=0;i<t.length;i++)h=t[i],u(h.value,{componentStack:h.stack,digest:h.digest});if(go)throw go=!1,e=Tc,Tc=null,e;return(vo&1)!==0&&e.tag!==0&&Gs(),m=e.pendingLanes,(m&1)!==0?e===Pc?ei++:(ei=0,Pc=e):ei=0,_n(),null}function Gs(){if(Tn!==null){var e=Me(vo),t=Nr.transition,i=fe;try{if(Nr.transition=null,fe=16>e?16:e,Tn===null)var u=!1;else{if(e=Tn,Tn=null,vo=0,(tt&6)!==0)throw Error(n(331));var h=tt;for(tt|=4,Ee=e.current;Ee!==null;){var m=Ee,v=m.child;if((Ee.flags&16)!==0){var N=m.deletions;if(N!==null){for(var P=0;P<N.length;P++){var z=N[P];for(Ee=z;Ee!==null;){var Z=Ee;switch(Z.tag){case 0:case 11:case 15:Qa(8,Z,m)}var ie=Z.child;if(ie!==null)ie.return=Z,Ee=ie;else for(;Ee!==null;){Z=Ee;var Q=Z.sibling,je=Z.return;if(Rh(Z),Z===z){Ee=null;break}if(Q!==null){Q.return=je,Ee=Q;break}Ee=je}}}var Ce=m.alternate;if(Ce!==null){var Te=Ce.child;if(Te!==null){Ce.child=null;do{var St=Te.sibling;Te.sibling=null,Te=St}while(Te!==null)}}Ee=m}}if((m.subtreeFlags&2064)!==0&&v!==null)v.return=m,Ee=v;else e:for(;Ee!==null;){if(m=Ee,(m.flags&2048)!==0)switch(m.tag){case 0:case 11:case 15:Qa(9,m,m.return)}var U=m.sibling;if(U!==null){U.return=m.return,Ee=U;break e}Ee=m.return}}var A=e.current;for(Ee=A;Ee!==null;){v=Ee;var F=v.child;if((v.subtreeFlags&2064)!==0&&F!==null)F.return=v,Ee=F;else e:for(v=A;Ee!==null;){if(N=Ee,(N.flags&2048)!==0)try{switch(N.tag){case 0:case 11:case 15:fo(9,N)}}catch(Pe){kt(N,N.return,Pe)}if(N===v){Ee=null;break e}var ce=N.sibling;if(ce!==null){ce.return=N.return,Ee=ce;break e}Ee=N.return}}if(tt=h,_n(),Vt&&typeof Vt.onPostCommitFiberRoot=="function")try{Vt.onPostCommitFiberRoot(ks,e)}catch{}u=!0}return u}finally{fe=i,Nr.transition=t}}return!1}function Qh(e,t,i){t=$s(i,t),t=mh(e,t,1),e=Nn(e,t,1),t=sr(),e!==null&&(Re(e,1,t),dr(e,t))}function kt(e,t,i){if(e.tag===3)Qh(e,e,i);else for(;t!==null;){if(t.tag===3){Qh(t,e,i);break}else if(t.tag===1){var u=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(Cn===null||!Cn.has(u))){e=$s(i,e),e=gh(t,e,1),t=Nn(t,e,1),e=sr(),t!==null&&(Re(t,1,e),dr(t,e));break}}t=t.return}}function gg(e,t,i){var u=e.pingCache;u!==null&&u.delete(t),t=sr(),e.pingedLanes|=e.suspendedLanes&i,Lt===e&&(zt&i)===i&&(Pt===4||Pt===3&&(zt&130023424)===zt&&500>yt()-Cc?ss(e,0):Ec|=i),dr(e,t)}function Xh(e,t){t===0&&((e.mode&1)===0?t=1:(t=_s,_s<<=1,(_s&130023424)===0&&(_s=4194304)));var i=sr();e=nn(e,t),e!==null&&(Re(e,t,i),dr(e,i))}function yg(e){var t=e.memoizedState,i=0;t!==null&&(i=t.retryLane),Xh(e,i)}function vg(e,t){var i=0;switch(e.tag){case 13:var u=e.stateNode,h=e.memoizedState;h!==null&&(i=h.retryLane);break;case 19:u=e.stateNode;break;default:throw Error(n(314))}u!==null&&u.delete(t),Xh(e,i)}var Zh;Zh=function(e,t,i){if(e!==null)if(e.memoizedProps!==t.pendingProps||or.current)cr=!0;else{if((e.lanes&i)===0&&(t.flags&128)===0)return cr=!1,ag(e,t,i);cr=(e.flags&131072)!==0}else cr=!1,ft&&(t.flags&1048576)!==0&&Od(t,Ki,t.index);switch(t.lanes=0,t.tag){case 2:var u=t.type;uo(e,t),e=t.pendingProps;var h=Ds(t,Kt.current);Ws(t,i),h=ac(null,t,u,e,h,i);var m=ic();return t.flags|=1,typeof h=="object"&&h!==null&&typeof h.render=="function"&&h.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,lr(u)?(m=!0,Gi(t)):m=!1,t.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,Xl(t),h.updater=lo,t.stateNode=h,h._reactInternals=t,hc(t,u,e,i),t=gc(null,t,u,!0,m,i)):(t.tag=0,ft&&m&&$l(t),nr(null,t,h,i),t=t.child),t;case 16:u=t.elementType;e:{switch(uo(e,t),e=t.pendingProps,h=u._init,u=h(u._payload),t.type=u,h=t.tag=xg(u),e=Ir(u,e),h){case 0:t=mc(null,t,u,e,i);break e;case 1:t=jh(null,t,u,e,i);break e;case 11:t=xh(null,t,u,e,i);break e;case 14:t=bh(null,t,u,Ir(u.type,e),i);break e}throw Error(n(306,u,""))}return t;case 0:return u=t.type,h=t.pendingProps,h=t.elementType===u?h:Ir(u,h),mc(e,t,u,h,i);case 1:return u=t.type,h=t.pendingProps,h=t.elementType===u?h:Ir(u,h),jh(e,t,u,h,i);case 3:e:{if(Nh(t),e===null)throw Error(n(387));u=t.pendingProps,m=t.memoizedState,h=m.element,Bd(e,t),to(t,u,null,i);var v=t.memoizedState;if(u=v.element,m.isDehydrated)if(m={element:u,isDehydrated:!1,cache:v.cache,pendingSuspenseBoundaries:v.pendingSuspenseBoundaries,transitions:v.transitions},t.updateQueue.baseState=m,t.memoizedState=m,t.flags&256){h=$s(Error(n(423)),t),t=Eh(e,t,u,i,h);break e}else if(u!==h){h=$s(Error(n(424)),t),t=Eh(e,t,u,i,h);break e}else for(wr=bn(t.stateNode.containerInfo.firstChild),vr=t,ft=!0,Or=null,i=Fd(t,null,u,i),t.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling;else{if(Ms(),u===h){t=an(e,t,i);break e}nr(e,t,u,i)}t=t.child}return t;case 5:return qd(t),e===null&&Hl(t),u=t.type,h=t.pendingProps,m=e!==null?e.memoizedProps:null,v=h.children,Ll(u,h)?v=null:m!==null&&Ll(u,m)&&(t.flags|=32),_h(e,t),nr(e,t,v,i),t.child;case 6:return e===null&&Hl(t),null;case 13:return Ch(e,t,i);case 4:return Zl(t,t.stateNode.containerInfo),u=t.pendingProps,e===null?t.child=Us(t,null,u,i):nr(e,t,u,i),t.child;case 11:return u=t.type,h=t.pendingProps,h=t.elementType===u?h:Ir(u,h),xh(e,t,u,h,i);case 7:return nr(e,t,t.pendingProps,i),t.child;case 8:return nr(e,t,t.pendingProps.children,i),t.child;case 12:return nr(e,t,t.pendingProps.children,i),t.child;case 10:e:{if(u=t.type._context,h=t.pendingProps,m=t.memoizedProps,v=h.value,ot(Xi,u._currentValue),u._currentValue=v,m!==null)if(Ar(m.value,v)){if(m.children===h.children&&!or.current){t=an(e,t,i);break e}}else for(m=t.child,m!==null&&(m.return=t);m!==null;){var N=m.dependencies;if(N!==null){v=m.child;for(var P=N.firstContext;P!==null;){if(P.context===u){if(m.tag===1){P=sn(-1,i&-i),P.tag=2;var z=m.updateQueue;if(z!==null){z=z.shared;var Z=z.pending;Z===null?P.next=P:(P.next=Z.next,Z.next=P),z.pending=P}}m.lanes|=i,P=m.alternate,P!==null&&(P.lanes|=i),Yl(m.return,i,t),N.lanes|=i;break}P=P.next}}else if(m.tag===10)v=m.type===t.type?null:m.child;else if(m.tag===18){if(v=m.return,v===null)throw Error(n(341));v.lanes|=i,N=v.alternate,N!==null&&(N.lanes|=i),Yl(v,i,t),v=m.sibling}else v=m.child;if(v!==null)v.return=m;else for(v=m;v!==null;){if(v===t){v=null;break}if(m=v.sibling,m!==null){m.return=v.return,v=m;break}v=v.return}m=v}nr(e,t,h.children,i),t=t.child}return t;case 9:return h=t.type,u=t.pendingProps.children,Ws(t,i),h=_r(h),u=u(h),t.flags|=1,nr(e,t,u,i),t.child;case 14:return u=t.type,h=Ir(u,t.pendingProps),h=Ir(u.type,h),bh(e,t,u,h,i);case 15:return kh(e,t,t.type,t.pendingProps,i);case 17:return u=t.type,h=t.pendingProps,h=t.elementType===u?h:Ir(u,h),uo(e,t),t.tag=1,lr(u)?(e=!0,Gi(t)):e=!1,Ws(t,i),fh(t,u,h),hc(t,u,h,i),gc(null,t,u,!0,e,i);case 19:return Ph(e,t,i);case 22:return Sh(e,t,i)}throw Error(n(156,t.tag))};function ef(e,t){return Ni(e,t)}function wg(e,t,i,u){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Er(e,t,i,u){return new wg(e,t,i,u)}function Lc(e){return e=e.prototype,!(!e||!e.isReactComponent)}function xg(e){if(typeof e=="function")return Lc(e)?1:0;if(e!=null){if(e=e.$$typeof,e===re)return 11;if(e===xe)return 14}return 2}function On(e,t){var i=e.alternate;return i===null?(i=Er(e.tag,t,e.key,e.mode),i.elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=t,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=e.flags&14680064,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,t=e.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i}function ko(e,t,i,u,h,m){var v=2;if(u=e,typeof e=="function")Lc(e)&&(v=1);else if(typeof e=="string")v=5;else e:switch(e){case de:return is(i.children,h,m,t);case we:v=8,h|=8;break;case $:return e=Er(12,i,t,h|2),e.elementType=$,e.lanes=m,e;case le:return e=Er(13,i,t,h),e.elementType=le,e.lanes=m,e;case J:return e=Er(19,i,t,h),e.elementType=J,e.lanes=m,e;case H:return So(i,h,m,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case he:v=10;break e;case oe:v=9;break e;case re:v=11;break e;case xe:v=14;break e;case ge:v=16,u=null;break e}throw Error(n(130,e==null?e:typeof e,""))}return t=Er(v,i,t,h),t.elementType=e,t.type=u,t.lanes=m,t}function is(e,t,i,u){return e=Er(7,e,u,t),e.lanes=i,e}function So(e,t,i,u){return e=Er(22,e,u,t),e.elementType=H,e.lanes=i,e.stateNode={isHidden:!1},e}function Mc(e,t,i){return e=Er(6,e,null,t),e.lanes=i,e}function Uc(e,t,i){return t=Er(4,e.children!==null?e.children:[],e.key,t),t.lanes=i,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function bg(e,t,i,u,h){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=me(0),this.expirationTimes=me(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=me(0),this.identifierPrefix=u,this.onRecoverableError=h,this.mutableSourceEagerHydrationData=null}function Fc(e,t,i,u,h,m,v,N,P){return e=new bg(e,t,i,N,P),t===1?(t=1,m===!0&&(t|=8)):t=0,m=Er(3,null,null,t),e.current=m,m.stateNode=e,m.memoizedState={element:u,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},Xl(m),e}function kg(e,t,i){var u=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:G,key:u==null?null:""+u,children:e,containerInfo:t,implementation:i}}function tf(e){if(!e)return Sn;e=e._reactInternals;e:{if(Xr(e)!==e||e.tag!==1)throw Error(n(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(lr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(n(171))}if(e.tag===1){var i=e.type;if(lr(i))return Td(e,i,t)}return t}function rf(e,t,i,u,h,m,v,N,P){return e=Fc(i,u,!0,e,h,m,v,N,P),e.context=tf(null),i=e.current,u=sr(),h=Pn(i),m=sn(u,h),m.callback=t??null,Nn(i,m,h),e.current.lanes=h,Re(e,h,u),dr(e,u),e}function _o(e,t,i,u){var h=t.current,m=sr(),v=Pn(h);return i=tf(i),t.context===null?t.context=i:t.pendingContext=i,t=sn(m,v),t.payload={element:e},u=u===void 0?null:u,u!==null&&(t.callback=u),e=Nn(h,t,v),e!==null&&(Lr(e,h,v,m),eo(e,h,v)),v}function jo(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function nf(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var i=e.retryLane;e.retryLane=i!==0&&i<t?i:t}}function Wc(e,t){nf(e,t),(e=e.alternate)&&nf(e,t)}function Sg(){return null}var sf=typeof reportError=="function"?reportError:function(e){console.error(e)};function Bc(e){this._internalRoot=e}No.prototype.render=Bc.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(n(409));_o(e,t,null,null)},No.prototype.unmount=Bc.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ns(function(){_o(null,e,null,null)}),t[Zr]=null}};function No(e){this._internalRoot=e}No.prototype.unstable_scheduleHydration=function(e){if(e){var t=Qe();e={blockedOn:null,target:e,priority:t};for(var i=0;i<vn.length&&t!==0&&t<vn[i].priority;i++);vn.splice(i,0,e),i===0&&qu(e)}};function $c(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Eo(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function af(){}function _g(e,t,i,u,h){if(h){if(typeof u=="function"){var m=u;u=function(){var z=jo(v);m.call(z)}}var v=rf(t,u,e,0,null,!1,!1,"",af);return e._reactRootContainer=v,e[Zr]=v.current,Ua(e.nodeType===8?e.parentNode:e),ns(),v}for(;h=e.lastChild;)e.removeChild(h);if(typeof u=="function"){var N=u;u=function(){var z=jo(P);N.call(z)}}var P=Fc(e,0,!1,null,null,!1,!1,"",af);return e._reactRootContainer=P,e[Zr]=P.current,Ua(e.nodeType===8?e.parentNode:e),ns(function(){_o(t,P,i,u)}),P}function Co(e,t,i,u,h){var m=i._reactRootContainer;if(m){var v=m;if(typeof h=="function"){var N=h;h=function(){var P=jo(v);N.call(P)}}_o(t,v,e,h)}else v=_g(i,t,e,h,u);return jo(v)}Ve=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var i=j(t.pendingLanes);i!==0&&(ue(t,i|1),dr(t,yt()),(tt&6)===0&&(Hs=yt()+500,_n()))}break;case 13:ns(function(){var u=nn(e,1);if(u!==null){var h=sr();Lr(u,e,1,h)}}),Wc(e,1)}},it=function(e){if(e.tag===13){var t=nn(e,134217728);if(t!==null){var i=sr();Lr(t,e,134217728,i)}Wc(e,134217728)}},rt=function(e){if(e.tag===13){var t=Pn(e),i=nn(e,t);if(i!==null){var u=sr();Lr(i,e,t,u)}Wc(e,t)}},Qe=function(){return fe},He=function(e,t){var i=fe;try{return fe=e,t()}finally{fe=i}},xa=function(e,t,i){switch(t){case"input":if(B(e,i),t=i.name,i.type==="radio"&&t!=null){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<i.length;t++){var u=i[t];if(u!==e&&u.form===e.form){var h=qi(u);if(!h)throw Error(n(90));Ge(u),B(u,h)}}}break;case"textarea":Ke(e,i);break;case"select":t=i.value,t!=null&&Fe(e,!!i.multiple,t,!1)}},ba=Ic,ki=ns;var jg={usingClientEntryPoint:!1,Events:[Ba,Os,qi,Pr,bi,Ic]},ti={findFiberByHostInstance:Kn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Ng={bundleType:ti.bundleType,version:ti.version,rendererPackageName:ti.rendererPackageName,rendererConfig:ti.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:M.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=_i(e),e===null?null:e.stateNode},findFiberByHostInstance:ti.findFiberByHostInstance||Sg,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var To=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!To.isDisabled&&To.supportsFiber)try{ks=To.inject(Ng),Vt=To}catch{}}return hr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=jg,hr.createPortal=function(e,t){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!$c(t))throw Error(n(200));return kg(e,t,null,i)},hr.createRoot=function(e,t){if(!$c(e))throw Error(n(299));var i=!1,u="",h=sf;return t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(u=t.identifierPrefix),t.onRecoverableError!==void 0&&(h=t.onRecoverableError)),t=Fc(e,1,!1,null,null,i,!1,u,h),e[Zr]=t.current,Ua(e.nodeType===8?e.parentNode:e),new Bc(t)},hr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(n(188)):(e=Object.keys(e).join(","),Error(n(268,e)));return e=_i(t),e=e===null?null:e.stateNode,e},hr.flushSync=function(e){return ns(e)},hr.hydrate=function(e,t,i){if(!Eo(t))throw Error(n(200));return Co(null,e,t,!0,i)},hr.hydrateRoot=function(e,t,i){if(!$c(e))throw Error(n(405));var u=i!=null&&i.hydratedSources||null,h=!1,m="",v=sf;if(i!=null&&(i.unstable_strictMode===!0&&(h=!0),i.identifierPrefix!==void 0&&(m=i.identifierPrefix),i.onRecoverableError!==void 0&&(v=i.onRecoverableError)),t=rf(t,null,e,1,i??null,h,!1,m,v),e[Zr]=t.current,Ua(e),u)for(e=0;e<u.length;e++)i=u[e],h=i._getVersion,h=h(i._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[i,h]:t.mutableSourceEagerHydrationData.push(i,h);return new No(t)},hr.render=function(e,t,i){if(!Eo(t))throw Error(n(200));return Co(null,e,t,!1,i)},hr.unmountComponentAtNode=function(e){if(!Eo(e))throw Error(n(40));return e._reactRootContainer?(ns(function(){Co(null,null,e,!1,function(){e._reactRootContainer=null,e[Zr]=null})}),!0):!1},hr.unstable_batchedUpdates=Ic,hr.unstable_renderSubtreeIntoContainer=function(e,t,i,u){if(!Eo(i))throw Error(n(200));if(e==null||e._reactInternals===void 0)throw Error(n(38));return Co(e,t,i,!1,u)},hr.version="18.3.1-next-f1338f8080-20240426",hr}var mf;function cp(){if(mf)return Hc.exports;mf=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(r){console.error(r)}}return s(),Hc.exports=Fg(),Hc.exports}var gf;function Wg(){if(gf)return Po;gf=1;var s=cp();return Po.createRoot=s.createRoot,Po.hydrateRoot=s.hydrateRoot,Po}var Bg=Wg();const $g=Nu(Bg);cp();function di(){return di=Object.assign?Object.assign.bind():function(s){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(s[o]=n[o])}return s},di.apply(this,arguments)}var Wn;(function(s){s.Pop="POP",s.Push="PUSH",s.Replace="REPLACE"})(Wn||(Wn={}));const yf="popstate";function zg(s){s===void 0&&(s={});function r(o,l){let{pathname:c,search:d,hash:p}=o.location;return iu("",{pathname:c,search:d,hash:p},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function n(o,l){return typeof l=="string"?l:zo(l)}return Hg(r,n,null,s)}function _t(s,r){if(s===!1||s===null||typeof s>"u")throw new Error(r)}function up(s,r){if(!s){typeof console<"u"&&console.warn(r);try{throw new Error(r)}catch{}}}function qg(){return Math.random().toString(36).substr(2,8)}function vf(s,r){return{usr:s.state,key:s.key,idx:r}}function iu(s,r,n,o){return n===void 0&&(n=null),di({pathname:typeof s=="string"?s:s.pathname,search:"",hash:""},typeof r=="string"?ha(r):r,{state:n,key:r&&r.key||o||qg()})}function zo(s){let{pathname:r="/",search:n="",hash:o=""}=s;return n&&n!=="?"&&(r+=n.charAt(0)==="?"?n:"?"+n),o&&o!=="#"&&(r+=o.charAt(0)==="#"?o:"#"+o),r}function ha(s){let r={};if(s){let n=s.indexOf("#");n>=0&&(r.hash=s.substr(n),s=s.substr(0,n));let o=s.indexOf("?");o>=0&&(r.search=s.substr(o),s=s.substr(0,o)),s&&(r.pathname=s)}return r}function Hg(s,r,n,o){o===void 0&&(o={});let{window:l=document.defaultView,v5Compat:c=!1}=o,d=l.history,p=Wn.Pop,f=null,g=y();g==null&&(g=0,d.replaceState(di({},d.state,{idx:g}),""));function y(){return(d.state||{idx:null}).idx}function x(){p=Wn.Pop;let k=y(),D=k==null?null:k-g;g=k,f&&f({action:p,location:E.location,delta:D})}function b(k,D){p=Wn.Push;let O=iu(E.location,k,D);g=y()+1;let R=vf(O,g),M=E.createHref(O);try{d.pushState(R,"",M)}catch(X){if(X instanceof DOMException&&X.name==="DataCloneError")throw X;l.location.assign(M)}c&&f&&f({action:p,location:E.location,delta:1})}function T(k,D){p=Wn.Replace;let O=iu(E.location,k,D);g=y();let R=vf(O,g),M=E.createHref(O);d.replaceState(R,"",M),c&&f&&f({action:p,location:E.location,delta:0})}function _(k){let D=l.location.origin!=="null"?l.location.origin:l.location.href,O=typeof k=="string"?k:zo(k);return O=O.replace(/ $/,"%20"),_t(D,"No window.location.(origin|href) available to create URL for href: "+O),new URL(O,D)}let E={get action(){return p},get location(){return s(l,d)},listen(k){if(f)throw new Error("A history only accepts one active listener");return l.addEventListener(yf,x),f=k,()=>{l.removeEventListener(yf,x),f=null}},createHref(k){return r(l,k)},createURL:_,encodeLocation(k){let D=_(k);return{pathname:D.pathname,search:D.search,hash:D.hash}},push:b,replace:T,go(k){return d.go(k)}};return E}var wf;(function(s){s.data="data",s.deferred="deferred",s.redirect="redirect",s.error="error"})(wf||(wf={}));function Gg(s,r,n){return n===void 0&&(n="/"),Vg(s,r,n)}function Vg(s,r,n,o){let l=typeof r=="string"?ha(r):r,c=Cu(l.pathname||"/",n);if(c==null)return null;let d=dp(s);Jg(d);let p=null;for(let f=0;p==null&&f<d.length;++f){let g=iy(c);p=ny(d[f],g)}return p}function dp(s,r,n,o){r===void 0&&(r=[]),n===void 0&&(n=[]),o===void 0&&(o="");let l=(c,d,p)=>{let f={relativePath:p===void 0?c.path||"":p,caseSensitive:c.caseSensitive===!0,childrenIndex:d,route:c};f.relativePath.startsWith("/")&&(_t(f.relativePath.startsWith(o),'Absolute route path "'+f.relativePath+'" nested under path '+('"'+o+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),f.relativePath=f.relativePath.slice(o.length));let g=Bn([o,f.relativePath]),y=n.concat(f);c.children&&c.children.length>0&&(_t(c.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+g+'".')),dp(c.children,r,y,g)),!(c.path==null&&!c.index)&&r.push({path:g,score:ty(g,c.index),routesMeta:y})};return s.forEach((c,d)=>{var p;if(c.path===""||!((p=c.path)!=null&&p.includes("?")))l(c,d);else for(let f of hp(c.path))l(c,d,f)}),r}function hp(s){let r=s.split("/");if(r.length===0)return[];let[n,...o]=r,l=n.endsWith("?"),c=n.replace(/\?$/,"");if(o.length===0)return l?[c,""]:[c];let d=hp(o.join("/")),p=[];return p.push(...d.map(f=>f===""?c:[c,f].join("/"))),l&&p.push(...d),p.map(f=>s.startsWith("/")&&f===""?"/":f)}function Jg(s){s.sort((r,n)=>r.score!==n.score?n.score-r.score:ry(r.routesMeta.map(o=>o.childrenIndex),n.routesMeta.map(o=>o.childrenIndex)))}const Kg=/^:[\w-]+$/,Yg=3,Qg=2,Xg=1,Zg=10,ey=-2,xf=s=>s==="*";function ty(s,r){let n=s.split("/"),o=n.length;return n.some(xf)&&(o+=ey),r&&(o+=Qg),n.filter(l=>!xf(l)).reduce((l,c)=>l+(Kg.test(c)?Yg:c===""?Xg:Zg),o)}function ry(s,r){return s.length===r.length&&s.slice(0,-1).every((o,l)=>o===r[l])?s[s.length-1]-r[r.length-1]:0}function ny(s,r,n){let{routesMeta:o}=s,l={},c="/",d=[];for(let p=0;p<o.length;++p){let f=o[p],g=p===o.length-1,y=c==="/"?r:r.slice(c.length)||"/",x=sy({path:f.relativePath,caseSensitive:f.caseSensitive,end:g},y),b=f.route;if(!x)return null;Object.assign(l,x.params),d.push({params:l,pathname:Bn([c,x.pathname]),pathnameBase:uy(Bn([c,x.pathnameBase])),route:b}),x.pathnameBase!=="/"&&(c=Bn([c,x.pathnameBase]))}return d}function sy(s,r){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[n,o]=ay(s.path,s.caseSensitive,s.end),l=r.match(n);if(!l)return null;let c=l[0],d=c.replace(/(.)\/+$/,"$1"),p=l.slice(1);return{params:o.reduce((g,y,x)=>{let{paramName:b,isOptional:T}=y;if(b==="*"){let E=p[x]||"";d=c.slice(0,c.length-E.length).replace(/(.)\/+$/,"$1")}const _=p[x];return T&&!_?g[b]=void 0:g[b]=(_||"").replace(/%2F/g,"/"),g},{}),pathname:c,pathnameBase:d,pattern:s}}function ay(s,r,n){r===void 0&&(r=!1),n===void 0&&(n=!0),up(s==="*"||!s.endsWith("*")||s.endsWith("/*"),'Route path "'+s+'" will be treated as if it were '+('"'+s.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+s.replace(/\*$/,"/*")+'".'));let o=[],l="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,p,f)=>(o.push({paramName:p,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return s.endsWith("*")?(o.push({paramName:"*"}),l+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?l+="\\/*$":s!==""&&s!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,r?void 0:"i"),o]}function iy(s){try{return s.split("/").map(r=>decodeURIComponent(r).replace(/\//g,"%2F")).join("/")}catch(r){return up(!1,'The URL path "'+s+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+r+").")),s}}function Cu(s,r){if(r==="/")return s;if(!s.toLowerCase().startsWith(r.toLowerCase()))return null;let n=r.endsWith("/")?r.length-1:r.length,o=s.charAt(n);return o&&o!=="/"?null:s.slice(n)||"/"}function oy(s,r){r===void 0&&(r="/");let{pathname:n,search:o="",hash:l=""}=typeof s=="string"?ha(s):s;return{pathname:n?n.startsWith("/")?n:ly(n,r):r,search:dy(o),hash:hy(l)}}function ly(s,r){let n=r.replace(/\/+$/,"").split("/");return s.split("/").forEach(l=>{l===".."?n.length>1&&n.pop():l!=="."&&n.push(l)}),n.length>1?n.join("/"):"/"}function Jc(s,r,n,o){return"Cannot include a '"+s+"' character in a manually specified "+("`to."+r+"` field ["+JSON.stringify(o)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function cy(s){return s.filter((r,n)=>n===0||r.route.path&&r.route.path.length>0)}function Tu(s,r){let n=cy(s);return r?n.map((o,l)=>l===n.length-1?o.pathname:o.pathnameBase):n.map(o=>o.pathnameBase)}function Pu(s,r,n,o){o===void 0&&(o=!1);let l;typeof s=="string"?l=ha(s):(l=di({},s),_t(!l.pathname||!l.pathname.includes("?"),Jc("?","pathname","search",l)),_t(!l.pathname||!l.pathname.includes("#"),Jc("#","pathname","hash",l)),_t(!l.search||!l.search.includes("#"),Jc("#","search","hash",l)));let c=s===""||l.pathname==="",d=c?"/":l.pathname,p;if(d==null)p=n;else{let x=r.length-1;if(!o&&d.startsWith("..")){let b=d.split("/");for(;b[0]==="..";)b.shift(),x-=1;l.pathname=b.join("/")}p=x>=0?r[x]:"/"}let f=oy(l,p),g=d&&d!=="/"&&d.endsWith("/"),y=(c||d===".")&&n.endsWith("/");return!f.pathname.endsWith("/")&&(g||y)&&(f.pathname+="/"),f}const Bn=s=>s.join("/").replace(/\/\/+/g,"/"),uy=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),dy=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,hy=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s;function fy(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}const fp=["post","put","patch","delete"];new Set(fp);const py=["get",...fp];new Set(py);function hi(){return hi=Object.assign?Object.assign.bind():function(s){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(s[o]=n[o])}return s},hi.apply(this,arguments)}const Au=S.createContext(null),my=S.createContext(null),$n=S.createContext(null),Xo=S.createContext(null),zn=S.createContext({outlet:null,matches:[],isDataRoute:!1}),pp=S.createContext(null);function gy(s,r){let{relative:n}=r===void 0?{}:r;fa()||_t(!1);let{basename:o,navigator:l}=S.useContext($n),{hash:c,pathname:d,search:p}=gp(s,{relative:n}),f=d;return o!=="/"&&(f=d==="/"?o:Bn([o,d])),l.createHref({pathname:f,search:p,hash:c})}function fa(){return S.useContext(Xo)!=null}function qn(){return fa()||_t(!1),S.useContext(Xo).location}function mp(s){S.useContext($n).static||S.useLayoutEffect(s)}function Wr(){let{isDataRoute:s}=S.useContext(zn);return s?Ty():yy()}function yy(){fa()||_t(!1);let s=S.useContext(Au),{basename:r,future:n,navigator:o}=S.useContext($n),{matches:l}=S.useContext(zn),{pathname:c}=qn(),d=JSON.stringify(Tu(l,n.v7_relativeSplatPath)),p=S.useRef(!1);return mp(()=>{p.current=!0}),S.useCallback(function(g,y){if(y===void 0&&(y={}),!p.current)return;if(typeof g=="number"){o.go(g);return}let x=Pu(g,JSON.parse(d),c,y.relative==="path");s==null&&r!=="/"&&(x.pathname=x.pathname==="/"?r:Bn([r,x.pathname])),(y.replace?o.replace:o.push)(x,y.state,y)},[r,o,d,c,s])}function gp(s,r){let{relative:n}=r===void 0?{}:r,{future:o}=S.useContext($n),{matches:l}=S.useContext(zn),{pathname:c}=qn(),d=JSON.stringify(Tu(l,o.v7_relativeSplatPath));return S.useMemo(()=>Pu(s,JSON.parse(d),c,n==="path"),[s,d,c,n])}function vy(s,r){return wy(s,r)}function wy(s,r,n,o){fa()||_t(!1);let{navigator:l}=S.useContext($n),{matches:c}=S.useContext(zn),d=c[c.length-1],p=d?d.params:{};d&&d.pathname;let f=d?d.pathnameBase:"/";d&&d.route;let g=qn(),y;if(r){var x;let k=typeof r=="string"?ha(r):r;f==="/"||(x=k.pathname)!=null&&x.startsWith(f)||_t(!1),y=k}else y=g;let b=y.pathname||"/",T=b;if(f!=="/"){let k=f.replace(/^\//,"").split("/");T="/"+b.replace(/^\//,"").split("/").slice(k.length).join("/")}let _=Gg(s,{pathname:T}),E=_y(_&&_.map(k=>Object.assign({},k,{params:Object.assign({},p,k.params),pathname:Bn([f,l.encodeLocation?l.encodeLocation(k.pathname).pathname:k.pathname]),pathnameBase:k.pathnameBase==="/"?f:Bn([f,l.encodeLocation?l.encodeLocation(k.pathnameBase).pathname:k.pathnameBase])})),c,n,o);return r&&E?S.createElement(Xo.Provider,{value:{location:hi({pathname:"/",search:"",hash:"",state:null,key:"default"},y),navigationType:Wn.Pop}},E):E}function xy(){let s=Cy(),r=fy(s)?s.status+" "+s.statusText:s instanceof Error?s.message:JSON.stringify(s),n=s instanceof Error?s.stack:null,l={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return S.createElement(S.Fragment,null,S.createElement("h2",null,"Unexpected Application Error!"),S.createElement("h3",{style:{fontStyle:"italic"}},r),n?S.createElement("pre",{style:l},n):null,null)}const by=S.createElement(xy,null);class ky extends S.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,n){return n.location!==r.location||n.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:n.error,location:n.location,revalidation:r.revalidation||n.revalidation}}componentDidCatch(r,n){console.error("React Router caught the following error during render",r,n)}render(){return this.state.error!==void 0?S.createElement(zn.Provider,{value:this.props.routeContext},S.createElement(pp.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Sy(s){let{routeContext:r,match:n,children:o}=s,l=S.useContext(Au);return l&&l.static&&l.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(l.staticContext._deepestRenderedBoundaryId=n.route.id),S.createElement(zn.Provider,{value:r},o)}function _y(s,r,n,o){var l;if(r===void 0&&(r=[]),n===void 0&&(n=null),o===void 0&&(o=null),s==null){var c;if(!n)return null;if(n.errors)s=n.matches;else if((c=o)!=null&&c.v7_partialHydration&&r.length===0&&!n.initialized&&n.matches.length>0)s=n.matches;else return null}let d=s,p=(l=n)==null?void 0:l.errors;if(p!=null){let y=d.findIndex(x=>x.route.id&&p?.[x.route.id]!==void 0);y>=0||_t(!1),d=d.slice(0,Math.min(d.length,y+1))}let f=!1,g=-1;if(n&&o&&o.v7_partialHydration)for(let y=0;y<d.length;y++){let x=d[y];if((x.route.HydrateFallback||x.route.hydrateFallbackElement)&&(g=y),x.route.id){let{loaderData:b,errors:T}=n,_=x.route.loader&&b[x.route.id]===void 0&&(!T||T[x.route.id]===void 0);if(x.route.lazy||_){f=!0,g>=0?d=d.slice(0,g+1):d=[d[0]];break}}}return d.reduceRight((y,x,b)=>{let T,_=!1,E=null,k=null;n&&(T=p&&x.route.id?p[x.route.id]:void 0,E=x.route.errorElement||by,f&&(g<0&&b===0?(Py("route-fallback"),_=!0,k=null):g===b&&(_=!0,k=x.route.hydrateFallbackElement||null)));let D=r.concat(d.slice(0,b+1)),O=()=>{let R;return T?R=E:_?R=k:x.route.Component?R=S.createElement(x.route.Component,null):x.route.element?R=x.route.element:R=y,S.createElement(Sy,{match:x,routeContext:{outlet:y,matches:D,isDataRoute:n!=null},children:R})};return n&&(x.route.ErrorBoundary||x.route.errorElement||b===0)?S.createElement(ky,{location:n.location,revalidation:n.revalidation,component:E,error:T,children:O(),routeContext:{outlet:null,matches:D,isDataRoute:!0}}):O()},null)}var yp=function(s){return s.UseBlocker="useBlocker",s.UseRevalidator="useRevalidator",s.UseNavigateStable="useNavigate",s}(yp||{}),vp=function(s){return s.UseBlocker="useBlocker",s.UseLoaderData="useLoaderData",s.UseActionData="useActionData",s.UseRouteError="useRouteError",s.UseNavigation="useNavigation",s.UseRouteLoaderData="useRouteLoaderData",s.UseMatches="useMatches",s.UseRevalidator="useRevalidator",s.UseNavigateStable="useNavigate",s.UseRouteId="useRouteId",s}(vp||{});function jy(s){let r=S.useContext(Au);return r||_t(!1),r}function Ny(s){let r=S.useContext(my);return r||_t(!1),r}function Ey(s){let r=S.useContext(zn);return r||_t(!1),r}function wp(s){let r=Ey(),n=r.matches[r.matches.length-1];return n.route.id||_t(!1),n.route.id}function Cy(){var s;let r=S.useContext(pp),n=Ny(),o=wp();return r!==void 0?r:(s=n.errors)==null?void 0:s[o]}function Ty(){let{router:s}=jy(yp.UseNavigateStable),r=wp(vp.UseNavigateStable),n=S.useRef(!1);return mp(()=>{n.current=!0}),S.useCallback(function(l,c){c===void 0&&(c={}),n.current&&(typeof l=="number"?s.navigate(l):s.navigate(l,hi({fromRouteId:r},c)))},[s,r])}const bf={};function Py(s,r,n){bf[s]||(bf[s]=!0)}function Ay(s,r){s?.v7_startTransition,s?.v7_relativeSplatPath}function kf(s){let{to:r,replace:n,state:o,relative:l}=s;fa()||_t(!1);let{future:c,static:d}=S.useContext($n),{matches:p}=S.useContext(zn),{pathname:f}=qn(),g=Wr(),y=Pu(r,Tu(p,c.v7_relativeSplatPath),f,l==="path"),x=JSON.stringify(y);return S.useEffect(()=>g(JSON.parse(x),{replace:n,state:o,relative:l}),[g,x,l,n,o]),null}function At(s){_t(!1)}function Oy(s){let{basename:r="/",children:n=null,location:o,navigationType:l=Wn.Pop,navigator:c,static:d=!1,future:p}=s;fa()&&_t(!1);let f=r.replace(/^\/*/,"/"),g=S.useMemo(()=>({basename:f,navigator:c,static:d,future:hi({v7_relativeSplatPath:!1},p)}),[f,p,c,d]);typeof o=="string"&&(o=ha(o));let{pathname:y="/",search:x="",hash:b="",state:T=null,key:_="default"}=o,E=S.useMemo(()=>{let k=Cu(y,f);return k==null?null:{location:{pathname:k,search:x,hash:b,state:T,key:_},navigationType:l}},[f,y,x,b,T,_,l]);return E==null?null:S.createElement($n.Provider,{value:g},S.createElement(Xo.Provider,{children:n,value:E}))}function Iy(s){let{children:r,location:n}=s;return vy(ou(r),n)}new Promise(()=>{});function ou(s,r){r===void 0&&(r=[]);let n=[];return S.Children.forEach(s,(o,l)=>{if(!S.isValidElement(o))return;let c=[...r,l];if(o.type===S.Fragment){n.push.apply(n,ou(o.props.children,c));return}o.type!==At&&_t(!1),!o.props.index||!o.props.children||_t(!1);let d={id:o.props.id||c.join("-"),caseSensitive:o.props.caseSensitive,element:o.props.element,Component:o.props.Component,index:o.props.index,path:o.props.path,loader:o.props.loader,action:o.props.action,errorElement:o.props.errorElement,ErrorBoundary:o.props.ErrorBoundary,hasErrorBoundary:o.props.ErrorBoundary!=null||o.props.errorElement!=null,shouldRevalidate:o.props.shouldRevalidate,handle:o.props.handle,lazy:o.props.lazy};o.props.children&&(d.children=ou(o.props.children,c)),n.push(d)}),n}function lu(){return lu=Object.assign?Object.assign.bind():function(s){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(s[o]=n[o])}return s},lu.apply(this,arguments)}function Dy(s,r){if(s==null)return{};var n={},o=Object.keys(s),l,c;for(c=0;c<o.length;c++)l=o[c],!(r.indexOf(l)>=0)&&(n[l]=s[l]);return n}function Ry(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function Ly(s,r){return s.button===0&&(!r||r==="_self")&&!Ry(s)}const My=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Uy="6";try{window.__reactRouterVersion=Uy}catch{}const Fy="startTransition",Sf=Lg[Fy];function Wy(s){let{basename:r,children:n,future:o,window:l}=s,c=S.useRef();c.current==null&&(c.current=zg({window:l,v5Compat:!0}));let d=c.current,[p,f]=S.useState({action:d.action,location:d.location}),{v7_startTransition:g}=o||{},y=S.useCallback(x=>{g&&Sf?Sf(()=>f(x)):f(x)},[f,g]);return S.useLayoutEffect(()=>d.listen(y),[d,y]),S.useEffect(()=>Ay(o),[o]),S.createElement(Oy,{basename:r,children:n,location:p.location,navigationType:p.action,navigator:d,future:o})}const By=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",$y=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Fr=S.forwardRef(function(r,n){let{onClick:o,relative:l,reloadDocument:c,replace:d,state:p,target:f,to:g,preventScrollReset:y,viewTransition:x}=r,b=Dy(r,My),{basename:T}=S.useContext($n),_,E=!1;if(typeof g=="string"&&$y.test(g)&&(_=g,By))try{let R=new URL(window.location.href),M=g.startsWith("//")?new URL(R.protocol+g):new URL(g),X=Cu(M.pathname,T);M.origin===R.origin&&X!=null?g=X+M.search+M.hash:E=!0}catch{}let k=gy(g,{relative:l}),D=zy(g,{replace:d,state:p,target:f,preventScrollReset:y,relative:l,viewTransition:x});function O(R){o&&o(R),R.defaultPrevented||D(R)}return S.createElement("a",lu({},b,{href:_||k,onClick:E||c?o:O,ref:n,target:f}))});var _f;(function(s){s.UseScrollRestoration="useScrollRestoration",s.UseSubmit="useSubmit",s.UseSubmitFetcher="useSubmitFetcher",s.UseFetcher="useFetcher",s.useViewTransitionState="useViewTransitionState"})(_f||(_f={}));var jf;(function(s){s.UseFetcher="useFetcher",s.UseFetchers="useFetchers",s.UseScrollRestoration="useScrollRestoration"})(jf||(jf={}));function zy(s,r){let{target:n,replace:o,state:l,preventScrollReset:c,relative:d,viewTransition:p}=r===void 0?{}:r,f=Wr(),g=qn(),y=gp(s,{relative:d});return S.useCallback(x=>{if(Ly(x,n)){x.preventDefault();let b=o!==void 0?o:zo(g)===zo(y);f(s,{replace:b,state:l,preventScrollReset:c,relative:d,viewTransition:p})}},[g,f,y,o,l,n,s,c,d,p])}var qy={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Hy=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Gy=(s,r)=>{const n=S.forwardRef(({color:o="currentColor",size:l=24,strokeWidth:c=2,absoluteStrokeWidth:d,children:p,...f},g)=>S.createElement("svg",{ref:g,...qy,width:l,height:l,stroke:o,strokeWidth:d?Number(c)*24/Number(l):c,className:`lucide lucide-${Hy(s)}`,...f},[...r.map(([y,x])=>S.createElement(y,x)),...(Array.isArray(p)?p:[p])||[]]));return n.displayName=`${s}`,n};var st=Gy;const Vy=st("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),Jy=st("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),Tr=st("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),Fo=st("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),cu=st("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),Ky=st("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),ia=st("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),Et=st("Dumbbell",[["path",{d:"m6.5 6.5 11 11",key:"f7oqzb"}],["path",{d:"m21 21-1-1",key:"cpc6if"}],["path",{d:"m3 3 1 1",key:"d3rpuf"}],["path",{d:"m18 22 4-4",key:"1e32o6"}],["path",{d:"m2 6 4-4",key:"189tqz"}],["path",{d:"m3 10 7-7",key:"1bxui2"}],["path",{d:"m14 21 7-7",key:"16x78n"}]]),Yy=st("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),fi=st("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]),ln=st("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),Qy=st("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),uu=st("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]),Xy=st("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]),Zy=st("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),oi=st("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),Nf=st("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),du=st("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),xp=st("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),ev=st("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),tv=st("ShieldCheck",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z",key:"3xmgem"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),Ef=st("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),Wo=st("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]),dn=st("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),bp=st("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),Cr=st("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),Bo=st("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),ua=st("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),pi=st("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),ps=st("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),Dn=[{text:"Set Goals",color:"primary",icon:a.jsx(Cr,{size:20})},{text:"Track Progress",color:"blue",icon:a.jsx(ps,{size:20})},{text:"Plan Workouts",color:"orange",icon:a.jsx(Tr,{size:20})},{text:"Stay Motivated",color:"purple",icon:a.jsx(Wo,{size:20})},{text:"AI Powered",color:"pink",icon:a.jsx(dn,{size:20})},{text:"Fun & Easy",color:"green",icon:a.jsx(bp,{size:20})},{text:"Personalized",color:"blue2",icon:a.jsx(ua,{size:20})}],rv=()=>{if(typeof document>"u")return!0;const s=document.referrer;if(console.log("[IntroBubbles] Referrer:",String(s).slice(0,200)),s)try{const r=new URL(s);if(console.log("[IntroBubbles] Referrer hostname:",r.hostname,"Current hostname:",window.location.hostname),r.hostname===window.location.hostname&&window.sessionStorage.getItem("fitbuddyai-skip-intro")==="1")return console.log("[IntroBubbles] Skipping intro due to sessionStorage flag."),!1}catch(r){console.log("[IntroBubbles] Referrer parse error:",r)}return console.log("[IntroBubbles] Showing intro."),!0},nv=({onFinish:s})=>{const[r,n]=S.useState(null),[o,l]=S.useState("wait"),[c,d]=S.useState(!1),[p,f]=S.useState(0);S.useEffect(()=>{const x=rv();console.log("[IntroBubbles] useEffect: shouldShowIntro() =",x),n(x)},[]);const g=S.useRef();if(!g.current){g.current={angle:Array.from({length:Dn.length},()=>Math.random()*30-15),dist:Array.from({length:Dn.length},()=>Math.random()*30-15),edge:Array.from({length:Dn.length},()=>Math.floor(Math.random()*4)),edgePos:Array.from({length:Dn.length},()=>Math.random()*100)};try{const x=JSON.stringify(g.current).slice(0,400);console.log("[IntroBubbles] Random seeds generated:",x)}catch{console.log("[IntroBubbles] Random seeds generated")}}const y=S.useRef(s);return S.useEffect(()=>{y.current=s},[s]),S.useEffect(()=>{if(r===null)return;if(!r){console.log("[IntroBubbles] Skipping intro, calling onFinish immediately."),y.current();return}const x=[];console.log("[IntroBubbles] Starting intro animation."),l("flyin"),f(0);for(let T=0;T<Dn.length;T++)x.push(setTimeout(()=>{f(_=>_+1),console.log(`[IntroBubbles] Bubble ${T} now visible.`)},T*400));const b=Dn.length*400+800;return x.push(setTimeout(()=>{l("meet"),console.log("[IntroBubbles] Phase changed: meet")},b)),x.push(setTimeout(()=>{l("orbit"),console.log("[IntroBubbles] Phase changed: orbit")},b+1e3)),x.push(setTimeout(()=>{l("fadeout"),console.log("[IntroBubbles] Phase changed: fadeout")},b+4e3)),x.push(setTimeout(()=>{console.log("[IntroBubbles] onFinish called after fadeout. Hiding overlay."),d(!0),y.current()},b+4800)),()=>{x.forEach(clearTimeout),console.log("[IntroBubbles] Cleaned up timers.")}},[r]),r===null||!r?null:(console.log("[IntroBubbles] Rendering. Phase:",o,"Hide:",c,"VisibleBubbles:",p),a.jsx("div",{className:`intro-bubbles-overlay${c?" hide":""} ${o==="fadeout"?"fade-white fade-out":""}`,children:a.jsxs("div",{className:"bubbles-centerpiece",children:[a.jsx("div",{className:"center-logo",children:a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"72",height:"72",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-dumbbell",children:[a.jsx("path",{d:"m6.5 6.5 11 11"}),a.jsx("path",{d:"m21 21-1-1"}),a.jsx("path",{d:"m3 3 1 1"}),a.jsx("path",{d:"m18 22 4-4"}),a.jsx("path",{d:"m2 6 4-4"}),a.jsx("path",{d:"m3 10 7-7"}),a.jsx("path",{d:"m14 21 7-7"})]})}),a.jsx("div",{className:o==="orbit"?"bubbles-rotate":"",children:Dn.map((x,b)=>{if(b>=p)return null;const T=g.current.edge[b],_=g.current.edgePos[b];let E=0,k=0;T===0?(E=_,k=-10):T===1?(E=110,k=_):T===2?(E=_,k=110):(E=-10,k=_);const D=360/Dn.length*b,O=210;let R=`bubble bubble-color-${x.color}`;o==="flyin"&&(R+=" bubble-fly-in"),o==="orbit"&&(R+=" bubble-orbit"),o==="meet"&&(R+=" bubble-meet");try{const M=JSON.stringify({i:b,phase:o,bubbleClass:R,offX:E,offY:k,angle:D,distance:O}).slice(0,300);console.log(`[IntroBubbles] Rendering bubble ${b}:`,M)}catch{console.log(`[IntroBubbles] Rendering bubble ${b}`)}return a.jsxs("div",{className:R,style:{"--offscreen-x":`${E}px`,"--offscreen-y":`${k}px`,"--angle":`${D}deg`,"--distance":`${O}px`},children:[a.jsx("span",{className:"bubble-icon",children:x.icon}),x.text]},b)})})]})}))},Zo=()=>{const s=S.useRef(null),r=S.useRef(null),n=S.useRef({x:0,y:0,active:!1}),[o,l]=S.useState(!1);return S.useEffect(()=>{const c=window.setTimeout(()=>l(!0),20),d=s.current;if(!d)return;const p=d.getContext("2d");if(!p)return;const f=window.matchMedia("(max-width: 768px)").matches,y=!window.matchMedia("(prefers-reduced-motion: reduce)").matches,x=f?450:1600;let b=window.innerWidth,T=window.innerHeight;const _=window.devicePixelRatio||1;d.width=b*_,d.height=T*_,d.style.width=`${b}px`,d.style.height=`${T}px`,p.scale(_,_);const E=Array.from({length:x}).map(()=>({baseX:Math.random()*b,baseY:Math.random()*T,x:0,y:0,r:Math.random()*1.4+.75,jitter:(Math.random()-.5)*.25})).map(we=>({...we,x:we.baseX,y:we.baseY})),k=f?70:120,D=y?.045:.06,O=y?.14:0,R=(we=!1)=>{p.clearRect(0,0,b,T),p.beginPath();for(const $ of E){if(y&&($.x+=$.jitter,$.y+=$.jitter*.6,Math.abs($.x-$.baseX)>10&&($.jitter*=-1),Math.abs($.y-$.baseY)>10&&($.jitter*=-1)),n.current.active&&y){const he=$.x-n.current.x,oe=$.y-n.current.y,re=Math.hypot(he,oe);if(re<k&&re>.01){const le=(k-re)/k;$.x+=he/re*le*k*O,$.y+=oe/re*le*k*O}}$.x+=($.baseX-$.x)*D,$.y+=($.baseY-$.y)*D,p.moveTo($.x+$.r,$.y),p.arc($.x,$.y,$.r,0,Math.PI*2)}p.fillStyle="rgba(30, 200, 130, 0.38)",p.fill(),we||(r.current=requestAnimationFrame(M))},M=we=>{R(!1)},X=we=>{n.current={x:we.clientX,y:we.clientY,active:!0}},G=()=>{n.current.active=!1},de=()=>{b=window.innerWidth,T=window.innerHeight,d.width=b*_,d.height=T*_,d.style.width=`${b}px`,d.style.height=`${T}px`,p.setTransform(1,0,0,1,0,0),p.scale(_,_)};return window.addEventListener("mousemove",X),window.addEventListener("mouseleave",G),window.addEventListener("resize",de),y?r.current=requestAnimationFrame(M):R(!0),()=>{window.removeEventListener("mousemove",X),window.removeEventListener("mouseleave",G),window.removeEventListener("resize",de),r.current&&cancelAnimationFrame(r.current),window.clearTimeout(c)}},[]),a.jsx("canvas",{ref:s,className:`dots-canvas${o?" dots-ready":""}`,"aria-hidden":"true"})},Kc=["Set Goals","Track Progress","Plan Workouts","Stay Motivated","AI Powered","Fun & Easy","Personalized"],oa=[];for(;oa.length<3;){const s=Math.floor(Math.random()*7);oa.includes(s)||oa.push(s)}const sv=()=>{const s=qn(),r=Wr(),o=new URLSearchParams(s.search).get("intro"),l=o===null||o==="1",[c,d]=S.useState(l),[p,f]=S.useState(!l),g=o!=="0",y=S.useRef(null),x=S.useRef(null);S.useEffect(()=>()=>{y.current&&clearTimeout(y.current),x.current&&clearTimeout(x.current)},[]);const b=()=>{f(!0),y.current=window.setTimeout(()=>d(!1),900),s.search.includes("intro")&&r("/",{replace:!0})};return S.useEffect(()=>{if(c)return x.current=window.setTimeout(()=>{f(!0),d(!1)},6e3),()=>{x.current&&(clearTimeout(x.current),x.current=null)}},[c]),a.jsxs("div",{className:"welcome-page",children:[c&&a.jsx(nv,{onFinish:b}),a.jsxs("div",{className:`welcome-main ${p?"is-visible":""}`,children:[a.jsxs("div",{className:"hero-section",children:[a.jsx(Zo,{}),a.jsxs("div",{className:"hero-content centered-absolute",children:[a.jsxs("div",{className:"logo-section"+(g?" bounce-in":""),children:[a.jsx("div",{className:"logo logo-centered",children:a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-dumbbell",children:[a.jsx("path",{d:"m6.5 6.5 11 11"}),a.jsx("path",{d:"m21 21-1-1"}),a.jsx("path",{d:"m3 3 1 1"}),a.jsx("path",{d:"m18 22 4-4"}),a.jsx("path",{d:"m2 6 4-4"}),a.jsx("path",{d:"m3 10 7-7"}),a.jsx("path",{d:"m14 21 7-7"})]})}),a.jsx("h1",{className:"app-title",children:"FitBuddyAI"}),a.jsx("p",{className:"app-subtitle",children:"Your AI-Powered Fitness Companion"})]}),a.jsxs("div",{className:"hero-text fade-in-up",children:[a.jsx("h2",{children:"Transform Your Fitness Journey"}),a.jsx("p",{children:"Get personalized workout plans powered by AI, track your progress, and achieve your fitness goals with fun, gamified experience."})]}),a.jsxs("div",{className:"cta-section fade-in-up",children:[a.jsx(Fr,{to:"/questionnaire",className:"btn btn-primary btn-large",children:"Start Your Journey"}),a.jsx("p",{className:"cta-subtitle",children:"Free  Personalized  AI-Powered"})]})]}),a.jsxs("div",{className:"hero-illustration",children:[a.jsxs("div",{className:"floating-card card-1",children:[a.jsx(Cr,{size:24}),a.jsx("span",{children:Kc[oa[0]]})]}),a.jsxs("div",{className:"floating-card card-2",children:[a.jsx(Tr,{size:24}),a.jsx("span",{children:Kc[oa[1]]})]}),a.jsxs("div",{className:"floating-card card-3",children:[a.jsx(ps,{size:24}),a.jsx("span",{children:Kc[oa[2]]})]}),a.jsxs("div",{className:"floating-card card-4",children:[a.jsx(Et,{size:24}),a.jsx("span",{children:"Strength Training"})]})]})]}),a.jsx("div",{className:"features-section",children:a.jsxs("div",{className:"container",children:[a.jsx("h3",{className:"section-title",children:"Why Choose FitBuddyAI?"}),a.jsxs("div",{className:"features-grid",children:[a.jsxs("div",{className:"feature-card card fade-in-up",children:[a.jsx("div",{className:"feature-icon",children:a.jsx(Cr,{size:32})}),a.jsx("h4",{children:"AI-Powered Plans"}),a.jsx("p",{children:"Get personalized workout routines generated by advanced AI based on your goals, fitness level, and preferences."})]}),a.jsxs("div",{className:"feature-card card fade-in-up",children:[a.jsx("div",{className:"feature-icon",children:a.jsx(Tr,{size:32})}),a.jsx("h4",{children:"Smart Calendar"}),a.jsx("p",{children:"Visualize your workout schedule with an intuitive calendar. Easily modify or request new workouts for any day."})]}),a.jsxs("div",{className:"feature-card card fade-in-up",children:[a.jsx("div",{className:"feature-icon",children:a.jsx(ps,{size:32})}),a.jsx("h4",{children:"Adaptive Training"}),a.jsx("p",{children:"Your workouts evolve with you. The AI adjusts difficulty and variety based on your progress and feedback."})]})]})]})}),a.jsx("div",{className:"how-it-works-section",children:a.jsxs("div",{className:"container",children:[a.jsx("h3",{className:"section-title",children:"How It Works"}),a.jsxs("div",{className:"steps-container",children:[a.jsxs("div",{className:"step",children:[a.jsx("div",{className:"step-number",children:"1"}),a.jsxs("div",{className:"step-content",children:[a.jsx("h4",{children:"Tell Us About You"}),a.jsx("p",{children:"Answer a few questions about your fitness goals, experience level, and preferences."})]})]}),a.jsxs("div",{className:"step",children:[a.jsx("div",{className:"step-number",children:"2"}),a.jsxs("div",{className:"step-content",children:[a.jsx("h4",{children:"Get Your AI Plan"}),a.jsx("p",{children:"Our AI creates a personalized 30-day workout calendar tailored specifically for you."})]})]}),a.jsxs("div",{className:"step",children:[a.jsx("div",{className:"step-number",children:"3"}),a.jsxs("div",{className:"step-content",children:[a.jsx("h4",{children:"Train & Adapt"}),a.jsx("p",{children:"Follow your workouts, track progress, and request changes whenever you need them."})]})]})]})]})}),a.jsx("div",{className:"final-cta-section",children:a.jsx("div",{className:"container",children:a.jsxs("div",{className:"final-cta-content",children:[a.jsx("h3",{children:"Ready to Transform Your Fitness?"}),a.jsx("p",{children:"Join thousands of users who have already started their journey with Fatbuddy."}),a.jsx(Fr,{to:"/questionnaire",className:"btn btn-primary btn-large",children:"Get Started Now"})]})})})]})]})};var Ao={};const Cf=typeof process<"u"&&Ao&&(Ao.GEMINI_API_KEY||Ao.VITE_GEMINI_API_KEY||Ao.NEXT_PUBLIC_GEMINI_API_KEY)||"",Ou=Cf?`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${encodeURIComponent(Cf)}`:"/api/ai/generate",Tf=(s,r)=>{const n=r.startDate||new Date().toISOString().split("T")[0],o=new Date(n),l=["strength","cardio","strength","flexibility","mixed","cardio","rest"],c=l.map((d,p)=>{const f=new Date(o);return f.setDate(f.getDate()+p),{date:f.toISOString().split("T")[0],type:d,completed:!1,totalTime:d==="rest"?"0 minutes":"30 minutes",workouts:[{name:d==="rest"?"Rest Day":d==="cardio"?"Intervals":"Bodyweight Circuit",description:d==="rest"?"Recovery and light movement.":"A simple session you can do anywhere.",difficulty:"beginner",duration:d==="rest"?"0 min":"30 minutes",reps:d==="rest"?"":"3 rounds",muscleGroups:d==="cardio"?["cardio"]:["full body"],equipment:[]}],alternativeWorkouts:[]}});return{id:`fallback-plan-${Date.now()}`,name:`${s.username||s.name||"Your"} Plan`,description:"Starter plan fallback",startDate:o.toISOString().split("T")[0],endDate:new Date(o.getTime()+(c.length-1)*24*60*60*1e3).toISOString().split("T")[0],totalDays:c.length,weeklyStructure:l.map(d=>`${d[0].toUpperCase()}${d.slice(1)} Day`),dailyWorkouts:c}},ai=async(s,r,n)=>{const o=new Date().toISOString().split("T")[0],l=r.startDate||o,c=`{
    "type": "object",
    "properties": {
      "id": { "type": "string" },
      "name": { "type": "string" },
      "description": { "type": "string" },
      "startDate": { "type": "string", "pattern": "\\d{4}-\\d{2}-\\d{2}" },
      "endDate": { "type": "string", "pattern": "\\d{4}-\\d{2}-\\d{2}" },
      "totalDays": { "type": "number" },
      "totalTime": { "type": "string" },
      "weeklyStructure": { "type": "array", "items": { "type": "string" } },
      "dailyWorkouts": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "date": { "type": "string", "pattern": "\\d{4}-\\d{2}-\\d{2}" },
            "type": { "type": "string" },
            "completed": { "type": "boolean" },
            "totalTime": { "type": "string" },
            "workouts": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "name": { "type": "string" },
                  "difficulty": { "type": "string" },
                  "duration": { "type": "string" },
                  "reps": { "anyOf": [{ "type": "number" }, { "type": "string" }] },
                  "muscleGroups": { "type": "array", "items": { "type": "string" } },
                  "equipment": { "type": "array", "items": { "type": "string" } },
                  "description": { "type": "string" },
                  "sets": { "type": "number" },
                  "rest": { "type": "string" }
                },
                "required": ["name","difficulty","duration","reps","muscleGroups"]
              }
            },
            "alternativeWorkouts": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "name": { "type": "string" },
                  "difficulty": { "type": "string" },
                  "duration": { "type": "string" },
                  "reps": { "anyOf": [{ "type": "number" }, { "type": "string" }] },
                  "muscleGroups": { "type": "array", "items": { "type": "string" } },
                  "equipment": { "type": "array", "items": { "type": "string" } },
                  "description": { "type": "string" }
                },
                "required": ["name","difficulty","duration","reps","muscleGroups"]
              }
            }
          },
          "required": ["date","type","workouts","alternativeWorkouts"]
        }
      }
    },
    "required": ["id","name","description","startDate","endDate","totalDays","totalTime","weeklyStructure","dailyWorkouts"]
  }`,d=JSON.stringify(n.map(k=>({id:k.id,title:k.title,subtitle:k.subtitle,type:k.type,options:k.options||[]})),null,2),p=JSON.stringify(r,null,2),g=`Please strictly adhere to the following JSON schema without adding any extra text, markdown, or code fences. Ensure all required fields are present and match the specified types. For the 'type' field in dailyWorkouts, use only one of the following values: 'strength', 'cardio', 'flexibility', 'rest', or 'mixed'.

Schema:
${c}

User Data:
${JSON.stringify(s,null,2)}

Questions Context:
${d}

Answers Context:
${p}

The current date is ${o}. The plan MUST start on ${l}.

Follow the provided weeklyStructure order as given by the schema.


  In dailyWorkouts, items must include keys in this order: date, type, completed, totalTime, workouts, alternativeWorkouts.

  Each workout entry must have ONLY these fields (and in the schema above these are required where noted): name, difficulty, duration, reps, muscleGroups, equipment, description. Additional optional fields allowed are: sets (number) and rest (string).

  Field formats (MUST be human-readable where indicated):
  - duration: a human-readable time string such as "5 minutes", "30 sec", "1 min per side" or "15-20 minutes".
  - reps: either a number (e.g. 10) or a short string like "AMRAP", "to failure", "8-12". If an exercise is time-based, reps can be an empty string or a descriptor.
  - muscleGroups: an array of short strings naming targeted body parts, e.g. ["chest","triceps","quads"]. Use common single-word names; avoid sentences.

  Ensure the JSON is syntactically valid: all arrays, objects, quotes, commas, brackets and braces must be closed. No trailing commas. Do not truncate any lists or objects.

Generate and return the JSON now.`,y=Math.random().toString(36).slice(2,9),x=new Date().toISOString(),b=`${g}

Variation-hint: please vary the workout details. RequestNonce:${y} RequestTime:${x}`,T=await fetch("/api/ai/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:b,userId:s?.id||null,meta:{nonce:y,ts:x}})});if(!T.ok)throw new Error("AI generation failed");const E=(await T.json()).text||"";if(!E||String(E).trim().length<2)return console.warn("generateWorkoutPlan: empty AI response; using fallback plan"),Tf(s,r);try{return av(E,s)}catch(k){return console.warn("generateWorkoutPlan: parse failed, falling back to deterministic plan",k),Tf(s,r)}},av=(s,r)=>{console.log("Parsing AI response:",s);try{let n=s;const o=s.match(/```(?:json)?\s*([\s\S]*?)```/i);o&&o[1]?n=o[1].trim():n=s.replace(/```[a-zA-Z]*\n?|```/g,"").trim(),console.log("Extracted AI JSON:",n);const l=n.match(/{[\s\S]*}/);if(l&&(n=l[0],console.log("Trimmed to JSON block:",n)),n.startsWith("{")&&n.endsWith("}")){let c=JSON.parse(n);if(c.workout_plan&&(console.warn("parseAIResponse: unwrapping top-level workout_plan field"),c=c.workout_plan),!c.dailyWorkouts&&c.workouts&&(console.warn("parseAIResponse: mapping top-level 'workouts' to 'dailyWorkouts'"),c.dailyWorkouts=c.workouts),c.dailyWorkouts&&c.dailyWorkouts.length>0&&c.dailyWorkouts.every(p=>!p.date)&&c.startDate&&c.weeklyStructure){const p=new Date(c.startDate),f=c.weeklyStructure.map(b=>b.split(":")[0].trim()),g={Sunday:0,Monday:1,Tuesday:2,Wednesday:3,Thursday:4,Friday:5,Saturday:6},y=f.map(b=>{const T=g[b]??new Date(c.startDate).getDay(),_=new Date(p);for(let E=0;E<7;E++){if(_.getDay()===T)return new Date(_);_.setDate(_.getDate()+1)}return new Date(p)}),x=f.length;c.dailyWorkouts.forEach((b,T)=>{const _=Math.floor(T/x),E=T%x,k=new Date(y[E]);k.setDate(k.getDate()+_*7),b.date=k.toISOString().split("T")[0],b.type=f[E].toLowerCase()}),console.warn("parseAIResponse: assigned fallback dates/types from weeklyStructure")}if(console.log("Parsed AI response JSON:",c),!c.dailyWorkouts)throw new Error("Parsed response missing dailyWorkouts");const d=c.dailyWorkouts.map(p=>({date:p.date,totalTime:p.totalTime||"",workouts:((p.workouts??p.exercises)||[]).map(f=>{if(typeof f=="string")return{name:f,description:f,difficulty:"beginner",muscleGroups:[],equipment:[],duration:"",reps:""};const g=f.name??f.exercise??"",y=f.description??f.instructions??"",x=f.duration??(f.durationSeconds?`${f.durationSeconds} sec`:""),b=f.sets,T=f.reps??"",_=f.rest??"",E=f.difficulty||"beginner",k=["beginner","intermediate","advanced"].includes(E)?E:"beginner";return{name:g,description:y,difficulty:k,muscleGroups:f.muscleGroups||[],equipment:f.equipment||[],duration:x,reps:T,...b!==void 0?{sets:b}:{},..._?{rest:_}:{}}}),alternativeWorkouts:((p.alternativeWorkouts??p.alternatives)||[]).map(f=>{if(typeof f=="string")return{name:f,description:f,difficulty:"beginner",muscleGroups:[],equipment:[],duration:"",reps:""};const g=f.name??f.exercise??"",y=f.description??f.instructions??"",x=f.duration??(f.durationSeconds?`${f.durationSeconds} sec`:""),b=f.sets,T=f.reps??"",_=f.rest??"",E=f.difficulty||"beginner",k=["beginner","intermediate","advanced"].includes(E)?E:"beginner";return{name:g,description:y,difficulty:k,muscleGroups:f.muscleGroups||[],equipment:f.equipment||[],duration:x,reps:T,...b!==void 0?{sets:b}:{},..._?{rest:_}:{}}}),completed:p.completed??!1,type:p.type||"mixed"}));return console.log("Mapped daily workouts:",d),{id:c.id||`plan-${Date.now()}`,name:c.name||`${r.username||"User"}'s Fitness Plan`,description:c.description||"A personalized workout plan.",startDate:c.startDate||new Date().toISOString().split("T")[0],endDate:c.endDate||new Date(Date.now()+720*60*60*1e3).toISOString().split("T")[0],totalDays:c.totalDays||30,weeklyStructure:c.weeklyStructure||[],dailyWorkouts:d}}else throw new Error("Response is not in JSON format")}catch(n){throw console.error("Error parsing AI response:",n),console.error("Raw AI response:",s),n}},Oo=async(s,r,n,o,l,c,d)=>{const p=new Date().toISOString().split("T")[0],f=r.startDate||p,g=`{
    "type": "object",
    "properties": {
      "date": { "type": "string", "pattern": "\\d{4}-\\d{2}-\\d{2}" },
      "type": { "type": "string" },
      "totalTime": { "type": "string" },
      "workouts": { "type": "array", "items": { "type": "object" } },
      "alternativeWorkouts": { "type": "array", "items": { "type": "object" } }
    },
    "required": ["date","type","workouts","alternativeWorkouts"]
  }`,y=JSON.stringify(s,null,2),x=JSON.stringify(n.map(O=>({id:O.id,title:O.title,type:O.type,options:O.options||[]})),null,2),b=JSON.stringify(r,null,2),T=JSON.stringify(c,null,2),_=JSON.stringify(d,null,2),E=`Here is the JSON schema for a DayWorkout:
${g}

Preferred start date: ${f}
User data:
${y}

User questionnaire schema and answers:
${x}
${b}

Existing plan workouts:
${T}
Current day old workout:
${_}

Current date: ${p}
Generate one DayWorkout JSON for ${o}, type '${l}', compatible with others. No wrappers, no markdown, pure JSON.`,k=`
IMPORTANT: return only the pure JSON object matching the DayWorkout schema, no markdown or code fences.`,D=()=>({date:o,type:l||"mixed",completed:!1,totalTime:"30 minutes",workouts:[{name:l==="cardio"?"Tempo Walk":l==="rest"?"Rest Day":"Bodyweight Circuit",description:l==="rest"?"Take a breather to recover.":"A quick, equipment-free session to keep you moving.",difficulty:"beginner",duration:l==="rest"?"0 min":"30 minutes",reps:l==="rest"?"":"3 rounds",muscleGroups:l==="cardio"?["cardio"]:["full body"],equipment:[]}],alternativeWorkouts:[]});for(let O=1;O<=2;O++){const R=Math.random().toString(36).slice(2,9),M=new Date().toISOString(),X=`${E}

Variation-hint: please vary the workout details and ordering where possible. RequestNonce:${R} RequestTime:${M}`,G=O===1?X:X+k;console.log(`generateWorkoutForDay: attempt ${O}, nonce=${R}, promptStart=`,G.slice(0,300));const de=typeof AbortController<"u"?new AbortController:null,we=O===1?12e3:8e3,$=de?setTimeout(()=>de.abort(),we):null;let he=null;try{he=await(await fetch(Ou,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:G}]}]}),...de?{signal:de.signal}:{}})).json()}catch(re){if(re?.name==="AbortError"?console.warn(`generateWorkoutForDay: attempt ${O} timed out after ${we}ms`):console.warn(`generateWorkoutForDay: attempt ${O} failed`,re),$&&clearTimeout($),O===2)return console.warn("generateWorkoutForDay: using fallback day due to errors/timeouts"),D();continue}finally{$&&clearTimeout($)}const oe=he.candidates?.[0]?.content?.parts?.[0]?.text||"";console.log("generateWorkoutForDay: received AI text=",oe);try{let le=oe.match(/```(?:json)?\s*([\s\S]*?)```/i)?.[1]?.trim()??oe.replace(/```[a-zA-Z]*\\n?|```/g,"").trim();const J=le.match(/{[\s\S]*}/);if(J&&(le=J[0]),!le||le.length<2)throw new Error("Empty AI response");return console.log("generateWorkoutForDay: parsing cleaned=",le),JSON.parse(le)}catch(re){if(console.warn(`generateWorkoutForDay: parse failed on attempt ${O}:`,re),O===2)return console.warn("generateWorkoutForDay: using fallback day due to parse errors"),D()}}return D()};async function iv(s){console.log("Requesting AI response with prompt:",s.prompt);const n=await(await fetch(Ou,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:s.prompt}]}]})})).json();console.log("Raw AI response:",n);const o=n.candidates?.[0],l=typeof n?.text=="string"?n.text:void 0,c=o?.content?.parts?.[0]?.text,d=n?.generated_text;let p="";typeof l=="string"&&l.trim()?p=l:typeof c=="string"&&c.trim()?p=c:typeof d=="string"&&d.trim()?p=d:typeof n=="string"&&(p=n),console.log("Raw AI text extracted for parsing (trim 2000):",String(p).slice(0,2e3));let f="";try{const g=p.match(/```(?:json)?\s*([\s\S]*?)\s*```/i);if(g&&g[1]&&(f=g[1].trim()),!f){const y=p.match(/\[[\s\S]*\]/),x=p.match(/\{[\s\S]*\}/);y?f=y[0]:x&&(f=x[0])}f||(f=p.trim())}catch{f=p.trim()}console.log("Cleaned AI JSON or text (trim 2000):",String(f).slice(0,2e3));try{return JSON.parse(f)}catch(g){return console.warn("AI response is not valid JSON; returning cleaned text instead.",g),f}}async function ov(s){const r=[s.prompt],n=s.localStorageContext;n?(n.questionnaire&&r.push(`

Local: fitbuddyai_questionnaire_progress: ${JSON.stringify(n.questionnaire).slice(0,1200)}`),n.userData&&r.push(`

Local: fitbuddyai_user_data: ${JSON.stringify(n.userData).slice(0,1200)}`),n.workoutPlan&&r.push(`

Local: fitbuddyai_workout_plan: ${JSON.stringify(n.workoutPlan).slice(0,2e3)}`)):s.workoutPlan&&r.push(`

User workoutPlan (truncated): ${JSON.stringify(s.workoutPlan).slice(0,2e3)}`);const o=r.join(`
`);console.log("Requesting AI text response with prompt (trim):",o.slice(0,300));const l=await fetch(Ou,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:o}]}]})});let c=null;try{c=await l.json()}catch(x){console.warn("getAITextResponse: failed to parse JSON response",x)}if(!l.ok){const x=c&&(c.message||c.error)?c.message||c.error:`AI request failed (${l.status})`;throw new Error(x)}const d=c.candidates?.[0];let p="";typeof c?.text=="string"&&c.text.trim()?p=c.text:typeof c?.message=="string"&&c.message.trim()?p=c.message:d&&d.content&&Array.isArray(d.content.parts)&&d.content.parts[0]&&typeof d.content.parts[0].text=="string"?p=d.content.parts[0].text:typeof c?.generated_text=="string"?p=c.generated_text:typeof c=="string"?p=c:p="";const f=p.match(/```(?:json)?\n([\s\S]*?)```/),g=f&&f[1]?f[1].trim():p.trim(),y=c?.message||"Buddy is currently unavailable. Please try again later.";return{text:g||y,raw:p||y}}async function gi(s){const r=localStorage.getItem("fitbuddyai_questionnaire_progress"),n=localStorage.getItem("fitbuddyai_workout_plan"),o=localStorage.getItem("fitbuddyai_assessment_data"),l=sessionStorage.getItem(`fitbuddyai_chat_${s}`)||localStorage.getItem(`fitbuddyai_chat_${s}`),c=sessionStorage.getItem("fitbuddyai_user_data")||localStorage.getItem("fitbuddyai_user_data");if(s)try{const d={userId:s};r!=null&&(d.fitbuddyai_questionnaire_progress=r),n!=null&&(d.fitbuddyai_workout_plan=n),o!=null&&(d.fitbuddyai_assessment_data=o),l!=null&&(d.chat_history=l),c!=null&&(d.fitbuddyai_user_data=c);try{const f=sessionStorage.getItem("fitbuddyai_user_data")||localStorage.getItem("fitbuddyai_user_data");if(f)try{const g=JSON.parse(f);if(g&&typeof g=="object"){const y={...g};y.token&&delete y.token,y.jwt&&delete y.jwt,d.fitbuddyai_user_data=y,y.accepted_terms!==void 0&&(d.accepted_terms=y.accepted_terms),y.accepted_privacy!==void 0&&(d.accepted_privacy=y.accepted_privacy),y.chat_history!==void 0&&d.chat_history===void 0&&(d.chat_history=y.chat_history)}}catch{}}catch{}const p=await et(()=>Promise.resolve().then(()=>Gn),void 0).then(f=>f.attachAuthHeaders({method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)}));await fetch("/api/userdata/save",p)}catch{}}function lv(s){try{if(!s||typeof navigator>"u"||typeof navigator.sendBeacon!="function")return!1;const r=localStorage.getItem("fitbuddyai_questionnaire_progress"),n=localStorage.getItem("fitbuddyai_workout_plan"),o=localStorage.getItem("fitbuddyai_assessment_data"),l={userId:s};r!=null&&(l.fitbuddyai_questionnaire_progress=r),n!=null&&(l.fitbuddyai_workout_plan=n),o!=null&&(l.fitbuddyai_assessment_data=o);try{const p=sessionStorage.getItem("fitbuddyai_user_data")||localStorage.getItem("fitbuddyai_user_data");if(p)try{const f=JSON.parse(p);f&&typeof f=="object"&&(f.accepted_terms!==void 0&&(l.accepted_terms=f.accepted_terms),f.accepted_privacy!==void 0&&(l.accepted_privacy=f.accepted_privacy),f.chat_history!==void 0&&l.chat_history===void 0&&(l.chat_history=f.chat_history))}catch{}}catch{}const c="/api/userdata/save",d=new Blob([JSON.stringify(l)],{type:"application/json"});return navigator.sendBeacon(c,d)}catch{return!1}}async function ms(s){if(s)try{const r="/api/userdata/load";console.log("[cloudBackupService] restoreUserDataFromServer -> POSTing",r,"userId=",s);const n=await et(()=>Promise.resolve().then(()=>Gn),void 0).then(f=>f.attachAuthHeaders({method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:s})})),o=await fetch(r,n),l=await o.text();if(console.log("[cloudBackupService] restoreUserDataFromServer -> response status:",o.status,"ok:",o.ok),l&&l.length>0&&console.log("[cloudBackupService] restoreUserDataFromServer -> response snippet:",l.slice(0,1e3)),!o.ok)return;let c=null;try{c=l?JSON.parse(l):null}catch(f){console.warn("[cloudBackupService] restoreUserDataFromServer -> failed to parse JSON response:",f);return}const d=c?.stored??c?.payload??c;if(!d)return;const p=f=>{try{const g=d[f];if(g==null)return;const y=typeof g=="string"?g:JSON.stringify(g);if(f==="fitbuddyai_user_data")try{sessionStorage.setItem(f,y)}catch{}else try{localStorage.setItem(f,y)}catch{}}catch{}};p("fitbuddyai_questionnaire_progress"),p("fitbuddyai_workout_plan"),p("fitbuddyai_assessment_data");try{const f=sessionStorage.getItem("fitbuddyai_user_data")||localStorage.getItem("fitbuddyai_user_data"),g=f?JSON.parse(f):null,x={...g?.data||g||null||{},...d.username?{username:d.username}:{},...d.avatar?{avatar:d.avatar}:{}};if(Object.keys(x).length>0){const b=g&&g.timestamp?{...g,data:x}:{data:x,timestamp:Date.now()};try{sessionStorage.setItem("fitbuddyai_user_data",JSON.stringify(b))}catch{}try{localStorage.setItem("fitbuddyai_user_data",JSON.stringify(b))}catch{}}}catch(f){console.warn("restoreUserDataFromServer: failed to merge username/avatar into local user_data",f)}try{const f=d.chat_history??d.fitbuddyai_chat??d.fitbuddyai_chat_history;if(f!=null)try{const g=typeof f=="string"?f:JSON.stringify(f);try{sessionStorage.setItem(`fitbuddyai_chat_${s}`,g)}catch{try{localStorage.setItem(`fitbuddyai_chat_${s}`,g)}catch{}}}catch{}}catch{}console.log("[cloudBackupService] restoreUserDataFromServer -> wrote keys from payload:",Object.keys(d))}catch{}}async function Iu(s){if(!s)return!1;try{const r=`fitbuddyai_chat_${s}`,n=localStorage.getItem(r),o=localStorage.getItem("fitbuddyai_tos_accepted_v1"),l={userId:s};if(n!=null)try{l.chat_history=JSON.parse(n)}catch{l.chat_history=n}if(o!=null)try{l.fitbuddyai_tos_accepted_v1=JSON.parse(o)}catch{l.fitbuddyai_tos_accepted_v1=o}if(l.chat_history===void 0&&l.fitbuddyai_tos_accepted_v1===void 0)return!0;const c=await et(()=>Promise.resolve().then(()=>Gn),void 0).then(p=>p.attachAuthHeaders({method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)}));if(!(await fetch("/api/userdata/save",c)).ok)return!1;try{localStorage.removeItem(r)}catch{}try{localStorage.removeItem("fitbuddyai_tos_accepted_v1")}catch{}return!0}catch{return!1}}const la=Object.freeze(Object.defineProperty({__proto__:null,backupAndDeleteSensitive:Iu,backupUserDataToServer:gi,beaconBackupUserData:lv,restoreUserDataFromServer:ms},Symbol.toStringTag,{value:"Module"})),pt={QUESTIONNAIRE_PROGRESS:"fitbuddyai_questionnaire_progress",USER_DATA:"fitbuddyai_user_data",USER_DATA_PERSISTED:"fitbuddyai_user_data_persisted",ASSESSMENT_DATA:"fitbuddyai_assessment_data",WORKOUT_PLAN:"fitbuddyai_workout_plan"},Jr={TOKEN:"fitbuddyai_token",TOKEN_PERSISTED:"fitbuddyai_token_persisted"};function el(s){if(!s)return null;try{let r=JSON.parse(s);if(typeof r=="string")try{r=JSON.parse(r),console.log("[localStorage] safeParseStored -> double-encoded JSON parsed")}catch{}return r}catch(r){return console.warn("[localStorage] safeParseStored -> parse failed:",r),null}}let hs=null;const cv=800;function hn(){try{const s=sessionStorage.getItem(pt.USER_DATA),r=s&&JSON.parse(s).data?.id||null;if(!r)return;hs&&clearTimeout(hs),hs=window.setTimeout(async()=>{hs=null;try{await gi(r)}catch(n){console.warn("Auto backup failed:",n)}},cv)}catch(s){console.warn("Failed to schedule backup:",s)}}const Du=s=>{try{localStorage.setItem(pt.ASSESSMENT_DATA,JSON.stringify({data:s,timestamp:Date.now()})),hn()}catch(r){console.warn("Failed to save assessment data:",r)}},hu=()=>{try{const s=localStorage.getItem(pt.ASSESSMENT_DATA);if(!s)return null;const r=el(s);if(!r)return null;const{data:n,timestamp:o}=r;return console.log("[localStorage] loadAssessmentData -> found data, timestamp:",o),Date.now()-o>10080*60*1e3?(kp(),null):n}catch(s){return console.warn("Failed to load assessment data:",s),null}},kp=()=>{try{localStorage.removeItem(pt.ASSESSMENT_DATA),hn()}catch(s){console.warn("Failed to clear assessment data:",s)}},$o=s=>{try{localStorage.setItem(pt.QUESTIONNAIRE_PROGRESS,JSON.stringify(s)),hn()}catch(r){console.warn("Failed to save questionnaire progress:",r)}},br=()=>{try{const s=localStorage.getItem(pt.QUESTIONNAIRE_PROGRESS);if(!s)return null;const r=el(s);return r?Date.now()-r.timestamp>1440*60*1e3?(pa(),null):r:null}catch(s){return console.warn("Failed to load questionnaire progress:",s),null}},pa=()=>{try{localStorage.removeItem(pt.QUESTIONNAIRE_PROGRESS),hn()}catch(s){console.warn("Failed to clear questionnaire progress:",s)}},qt=(s,r)=>{try{try{if((sessionStorage.getItem("fitbuddyai_no_auto_restore")||localStorage.getItem("fitbuddyai_no_auto_restore"))&&!(r&&r.forceSave))return}catch{}let n={};if(s&&typeof s=="object"&&("data"in s||"token"in s)){if(n.data=s.data||null,"token"in s&&s.token)try{sessionStorage.setItem(Jr.TOKEN,String(s.token))}catch{}}else n.data=s||null;const o={...n,timestamp:Date.now()};try{sessionStorage.setItem(pt.USER_DATA,JSON.stringify(o))}catch{}try{localStorage.setItem(pt.USER_DATA_PERSISTED,JSON.stringify(o))}catch{}try{const l=new BroadcastChannel("fitbuddyai");l.postMessage({type:"user-update",timestamp:Date.now()}),l.close()}catch{}(!r||!r.skipBackup)&&hn();try{sessionStorage.removeItem("fitbuddyai_no_auto_restore")}catch{}try{localStorage.removeItem("fitbuddyai_no_auto_restore")}catch{}}catch(n){console.warn("Failed to save user data:",n)}},mr=()=>{try{let s=sessionStorage.getItem(pt.USER_DATA);if(!s){const l=localStorage.getItem(pt.USER_DATA_PERSISTED);if(l){s=l;try{sessionStorage.setItem(pt.USER_DATA,l)}catch{}}}if(!s)return null;const{data:r,timestamp:n}=JSON.parse(s);return Date.now()-n>10080*60*1e3?(ma(),null):r}catch(s){return console.warn("Failed to load user data:",s),null}},ma=()=>{try{try{sessionStorage.removeItem(pt.USER_DATA)}catch{}try{localStorage.removeItem(pt.USER_DATA_PERSISTED)}catch{}try{sessionStorage.removeItem(Jr.TOKEN)}catch{}try{localStorage.removeItem(Jr.TOKEN_PERSISTED)}catch{}hs&&(clearTimeout(hs),hs=null);try{const s=new BroadcastChannel("fitbuddyai");s.postMessage({type:"user-clear",timestamp:Date.now()}),s.close()}catch{}}catch(s){console.warn("Failed to clear user data:",s)}},Sp=s=>{try{if(!s)return;sessionStorage.setItem(Jr.TOKEN,String(s)),localStorage.setItem(Jr.TOKEN_PERSISTED,JSON.stringify({token:s,timestamp:Date.now()}))}catch{}},qo=()=>{try{const s=sessionStorage.getItem(Jr.TOKEN);if(s)return s;const r=localStorage.getItem(Jr.TOKEN_PERSISTED);if(r){const n=el(r);if(n?.token&&n.timestamp&&Date.now()-n.timestamp<=10080*60*1e3){try{sessionStorage.setItem(Jr.TOKEN,n.token)}catch{}return n.token}try{localStorage.removeItem(Jr.TOKEN_PERSISTED)}catch{}}return null}catch{return null}},Ru=()=>{try{sessionStorage.removeItem(Jr.TOKEN)}catch{}},fr=s=>{try{const o={data:(c=>c&&{id:c.id,name:c.name,description:c.description,startDate:typeof c.startDate=="string"?c.startDate:c.startDate?new Date(c.startDate).toISOString().split("T")[0]:void 0,endDate:typeof c.endDate=="string"?c.endDate:c.endDate?new Date(c.endDate).toISOString().split("T")[0]:void 0,totalDays:typeof c.totalDays=="number"?c.totalDays:Array.isArray(c.dailyWorkouts)?c.dailyWorkouts.filter(Boolean).length:void 0,totalTime:c.totalTime,weeklyStructure:Array.isArray(c.weeklyStructure)?c.weeklyStructure.slice():[],dailyWorkouts:Array.isArray(c.dailyWorkouts)?c.dailyWorkouts.filter(Boolean).map(p=>({date:typeof p?.date=="string"?p.date:p?.date?new Date(p.date).toISOString().split("T")[0]:"",type:p?.type,types:Array.isArray(p?.types)?p.types.filter(Boolean).slice(0,4):p?.type?[p.type]:[],completed:!!p?.completed,completedTypes:Array.isArray(p?.completedTypes)?p.completedTypes.filter(Boolean):[],energyRewarded:p?.energyRewarded?!0:void 0,totalTime:p?.totalTime||"",workouts:Array.isArray(p?.workouts)?p.workouts.filter(Boolean).map(f=>({name:f?.name??"",description:f?.description??"",difficulty:f?.difficulty??"beginner",duration:f?.duration??"",reps:f?.reps??"",muscleGroups:Array.isArray(f?.muscleGroups)?f.muscleGroups:f?.muscleGroups?[f.muscleGroups]:[],equipment:Array.isArray(f?.equipment)?f.equipment:f?.equipment?[f.equipment]:[],sets:typeof f?.sets=="number"?f.sets:void 0,rest:f?.rest||void 0})):[],alternativeWorkouts:Array.isArray(p?.alternativeWorkouts)?p.alternativeWorkouts.filter(Boolean).map(f=>({name:f?.name??"",description:f?.description??"",difficulty:f?.difficulty??"beginner",duration:f?.duration??"",reps:f?.reps??"",muscleGroups:Array.isArray(f?.muscleGroups)?f.muscleGroups:f?.muscleGroups?[f.muscleGroups]:[],equipment:Array.isArray(f?.equipment)?f.equipment:f?.equipment?[f.equipment]:[],sets:typeof f?.sets=="number"?f.sets:void 0,rest:f?.rest||void 0})):[]})):[]})(s),timestamp:Date.now()},l=JSON.stringify(o);localStorage.setItem(pt.WORKOUT_PLAN,l);try{const c=localStorage.getItem(pt.WORKOUT_PLAN);if(!c)throw new Error("Written value missing");JSON.parse(c)}catch(c){console.warn("Workout plan verification failed after save; removing corrupted key.",c);try{localStorage.removeItem(pt.WORKOUT_PLAN)}catch{}return}hn()}catch(r){console.warn("Failed to save workout plan:",r)}},gs=()=>{try{const s=localStorage.getItem(pt.WORKOUT_PLAN);if(!s)return null;console.log("[localStorage] loadWorkoutPlan -> raw length:",s.length);const r=el(s);if(!r)return null;const{data:n,timestamp:o}=r;return Date.now()-o>720*60*60*1e3?(yi(),null):n}catch(s){return console.warn("Failed to load workout plan:",s),null}},yi=()=>{try{localStorage.removeItem(pt.WORKOUT_PLAN),hn()}catch(s){console.warn("Failed to clear workout plan:",s)}},uv=()=>{pa(),ma(),yi()},dv=(s,r)=>{try{const o=`fitbuddyai_chat_${r?.userId||(()=>{try{const p=sessionStorage.getItem(pt.USER_DATA);return p&&JSON.parse(p).data?.id||null}catch{return null}})()||"anon"}`,l=sessionStorage.getItem(o)||localStorage.getItem(o);let c=[];if(l)try{c=JSON.parse(l),Array.isArray(c)||(c=[])}catch{c=[]}const d={role:s.role,text:s.text,ts:s.ts||Date.now()};c.push(d);try{sessionStorage.setItem(o,JSON.stringify(c))}catch{}try{const p=sessionStorage.getItem(pt.USER_DATA);if(p)try{const f=JSON.parse(p);f.chat_history=f.chat_history||[],f.chat_history.push(d);try{sessionStorage.setItem(pt.USER_DATA,JSON.stringify(f))}catch{}}catch{}}catch{}hn()}catch(n){console.warn("appendChatMessage failed",n)}},hv=s=>{try{const r=sessionStorage.getItem(pt.USER_DATA);let n=r?JSON.parse(r):{data:null,timestamp:Date.now()};n.accepted_terms=s.accepted_terms??n.accepted_terms??null,n.accepted_privacy=s.accepted_privacy??n.accepted_privacy??null;try{sessionStorage.setItem(pt.USER_DATA,JSON.stringify(n))}catch{}hn()}catch(r){console.warn("setAcceptanceFlags failed",r)}},ir=Object.freeze(Object.defineProperty({__proto__:null,appendChatMessage:dv,clearAllData:uv,clearAssessmentData:kp,clearAuthToken:Ru,clearQuestionnaireProgress:pa,clearUserData:ma,clearWorkoutPlan:yi,getAuthToken:qo,loadAssessmentData:hu,loadQuestionnaireProgress:br,loadUserData:mr,loadWorkoutPlan:gs,saveAssessmentData:Du,saveAuthToken:Sp,saveQuestionnaireProgress:$o,saveUserData:qt,saveWorkoutPlan:fr,setAcceptanceFlags:hv},Symbol.toStringTag,{value:"Module"})),fv="https://corsproxy.io/?key=7cf03de1&url=https://script.google.com/macros/s/AKfycbwFDdT0QVaP2jY8t4N0048PfQW_rYxB4noFaG-nExO9MZ5h3DCuNLUPNg3-qntT01tg/exec?gid=0",Rn=[{id:"age",title:"How old are you?",subtitle:"This helps us create age-appropriate workouts",type:"number",min:13,max:100,icon:a.jsx(Tr,{size:32})},{id:"fitnessLevel",title:"What's your current fitness level?",subtitle:"Be honest - we'll adjust everything to match your abilities",type:"single",options:["Beginner - Just starting out","Intermediate - I work out sometimes","Advanced - I exercise regularly"],icon:a.jsx(Et,{size:32})},{id:"fitnessBackground",title:"Tell us about your fitness journey so far",subtitle:"Share any previous experience, challenges, or what's worked for you before",type:"textarea",icon:a.jsx(ln,{size:32})},{id:"motivation",title:"What motivates you to start this fitness journey?",subtitle:"Understanding your 'why' helps us keep you motivated",type:"textarea",icon:a.jsx(Cr,{size:32})},{id:"goals",title:"What are your fitness goals?",subtitle:"Select all that apply - we'll create a plan that covers everything",type:"multiple",options:["Lose weight","Build muscle","Improve endurance","Increase flexibility","General health","Sport-specific training","Stress relief","Better sleep","Improve posture","Boost confidence","Other"],icon:a.jsx(Cr,{size:32})},{id:"specificGoals",title:"Can you be more specific about your main goal?",subtitle:"For example: 'Lose 20 pounds for my wedding' or 'Run a 5K without stopping'",type:"textarea",icon:a.jsx(Cr,{size:32})},{id:"timeAvailable",title:"How much time can you dedicate daily?",subtitle:"We'll make sure every minute counts",type:"slider",min:15,max:120,step:15,icon:a.jsx(ia,{size:32})},{id:"startDate",title:"When would you like to start your workout plan?",subtitle:"Please enter your preferred start date (YYYY-MM-DD)",type:"text",icon:a.jsx(Tr,{size:32})},{id:"exerciseFormat",title:"How do you prefer to track your exercises?",subtitle:"This helps us format your workout instructions perfectly for you",type:"single",options:["Time-based (e.g., 30 seconds)","Rep-based (e.g., 10 reps)","Mixed - both time and reps","Other"],icon:a.jsx(ia,{size:32})},{id:"planDuration",title:"How long do you want your workout plan to be?",subtitle:"We can create plans of different lengths to match your goals and commitment level",type:"single",options:["1 week (Mini)","2 weeks (Quick start)","1 month (Standard)","6 weeks (Build habits)","3 months (Transformation)","6 months (Lifestyle change)"],icon:a.jsx(Tr,{size:32})},{id:"daysPerWeek",title:"How many days per week do you want to work out?",subtitle:"We'll plan rest days to help you recover",type:"single",options:["3 days","4 days","5 days","6 days","7 days","Other"],icon:a.jsx(Tr,{size:32})},{id:"preferredTime",title:"When do you prefer to work out?",subtitle:"We can tailor workouts to your energy levels throughout the day",type:"single",options:["Early morning (5-8 AM)","Morning (8-11 AM)","Lunch time (11 AM-2 PM)","Afternoon (2-5 PM)","Evening (5-8 PM)","Night (8-11 PM)","Varies/Flexible","Other"],icon:a.jsx(ia,{size:32})},{id:"energyLevels",title:"How would you rate your current energy levels?",subtitle:"This helps us design workouts that match your vitality",type:"rating",min:1,max:10,icon:a.jsx(ln,{size:32})},{id:"preferences",title:"What types of workouts do you enjoy?",subtitle:"Let's make fitness fun for you",type:"multiple",options:["Strength training","Cardio workouts","Yoga & stretching","HIIT workouts","Bodyweight exercises","Dance workouts","Outdoor activities","Swimming","Pilates","Martial arts","Team sports","Walking/Hiking","Other"],icon:a.jsx(ln,{size:32})},{id:"dislikes",title:"Are there any exercises you want to avoid?",subtitle:"We'll make sure to exclude anything you don't enjoy or can't do",type:"textarea",icon:a.jsx(ln,{size:32})},{id:"injuries",title:"Do you have any injuries or physical limitations?",subtitle:"This helps us create safe workouts tailored to your needs",type:"textarea",icon:a.jsx(ln,{size:32})},{id:"equipment",title:"What equipment do you have access to?",subtitle:"We'll work with whatever you've got",type:"multiple",options:["No equipment (bodyweight only)","Dumbbells","Resistance bands","Yoga mat","Pull-up bar","Gym membership","Treadmill/bike","Kettlebells","Barbell","Medicine ball","Foam roller","Suspension trainer (TRX)","Other"],icon:a.jsx(Et,{size:32})},{id:"budget",title:"Are you interested in additional fitness resources?",subtitle:"We can suggest equipment or services within your budget",type:"single",options:["No budget for additional equipment","Small budget ($0-50)","Medium budget ($50-200)","Higher budget ($200+)","Already have everything I need"],icon:a.jsx(Cr,{size:32})},{id:"lifestyle",title:"How would you describe your lifestyle?",subtitle:"This helps us understand how to fit fitness into your routine",type:"single",options:["Very sedentary (desk job, little movement)","Mostly sedentary with some walking","Moderately active (some daily movement)","Active (regular movement throughout day)","Very active (physical job or lots of movement)"],icon:a.jsx(ua,{size:32})},{id:"sleepQuality",title:"How well do you sleep?",subtitle:"Sleep affects recovery and workout performance",type:"rating",min:1,max:10,icon:a.jsx(ln,{size:32})},{id:"stressLevel",title:"What's your current stress level?",subtitle:"We can include stress-relief exercises in your plan",type:"rating",min:1,max:10,icon:a.jsx(ln,{size:32})},{id:"socialPreference",title:"Do you prefer working out alone or with others?",subtitle:"This helps us suggest the right type of workout environment",type:"single",options:["Definitely alone","Mostly alone","No preference","Mostly with others","Definitely with others"],icon:a.jsx(ua,{size:32})},{id:"progressTracking",title:"How do you like to track your progress?",subtitle:"We can suggest the best methods for you",type:"multiple",options:["Weight/measurements","Progress photos","Workout logs","Fitness apps","Wearable devices","How I feel","Performance improvements","I don't like tracking","Other"],icon:a.jsx(Cr,{size:32})},{id:"concerns",title:"Any questions, concerns, or special requests?",subtitle:"Share anything else that would help us create the perfect plan for you - dietary restrictions, work schedule, family commitments, past injuries, fears, or anything else on your mind",type:"textarea",icon:a.jsx(ln,{size:32})}],pv=({onRegenerate:s,onEditResponses:r,onGoToCalendar:n})=>a.jsx("div",{className:"menu-screen",children:a.jsxs("div",{className:"menu-container menu-container--hero",children:[a.jsxs("div",{className:"menu-hero",children:[a.jsx("div",{className:"menu-hero-icon",children:a.jsx(Et,{size:48})}),a.jsx("h1",{className:"menu-header",children:"Assessment Complete"}),a.jsx("p",{className:"menu-subtitle",children:"Nice work  we've saved your answers and can generate a refreshed plan anytime."})]}),a.jsxs("div",{className:"menu-actions",children:[a.jsxs("button",{className:"btn btn-primary menu-btn menu-btn--large",onClick:()=>s(),children:[a.jsx(oi,{size:18}),a.jsx("span",{children:"Regenerate Plan"})]}),a.jsxs("button",{className:"btn btn-outline menu-btn menu-btn--large menu-btn--alt",onClick:()=>n(),children:[a.jsx(Tr,{size:18}),a.jsx("span",{children:"Go to Calendar"})]}),a.jsxs("button",{className:"btn btn-outline menu-btn menu-btn--alt",onClick:()=>r(),children:[a.jsx(ua,{size:18}),a.jsx("span",{children:"Edit Responses"})]})]}),a.jsx("div",{className:"menu-footer",children:a.jsx("small",{className:"menu-note",children:"Tip: Regenerating will create a fresh plan based on your current answers  your previous plan is saved in your profile."})})]})}),mv=()=>a.jsx("div",{className:"questionnaire-page",children:a.jsx("div",{className:"questionnaire-container",children:a.jsxs("div",{className:"followup-loading-content",children:[a.jsx("div",{className:"spinner"}),a.jsx("h2",{className:"loading-title",children:"Generating Follow-Up Questions"}),a.jsx("p",{className:"loading-subtitle",children:"Hang tight while we personalize your questionnaire..."}),a.jsx("p",{className:"ai-disclaimer",children:"Disclaimer: These follow-up questions are AI-generated and may not be perfect."})]})})}),gv=({onRetry:s})=>a.jsx("div",{className:"questionnaire-page",children:a.jsx("div",{className:"questionnaire-container error-screen",children:a.jsxs("div",{className:"error-content",children:[a.jsx("h2",{className:"error-title",children:"Oops! Something went wrong."}),a.jsx("p",{className:"error-message",children:"We couldn't generate your plan. Please try again."}),a.jsx("button",{className:"btn error-btn",onClick:s,children:"Retry"})]})})}),yv=({onComplete:s})=>{const r=async(I,B)=>{try{console.log("Preparing data to send to Google Sheet webhook...");const Ne=Object.entries(I).map(([Fe,ze],$e)=>{const Ke=B.find(mt=>mt.id===Fe);return{questionOrder:$e+1,questionType:Ke?.aiGenerated?"AI":"Base",question:Ke?.title||Fe,answer:Array.isArray(ze)?ze.join("; "):String(ze)}}),Le={timestamp:new Date().toISOString(),rows:Ne};console.log("Sending POST request to Google Sheet webhook with payload:",Le);const be=await fetch(fv,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Le)});if(!be.ok)throw new Error(`Failed with status ${be.status}`);console.log("Data successfully sent to Google Sheet:",await be.json())}catch(Ne){console.error("Failed to send to Google Sheet:",Ne)}},[n,o]=S.useState(0),[l,c]=S.useState({}),[d,p]=S.useState({}),[f,g]=S.useState(Rn),[y,x]=S.useState(!1),[b,T]=S.useState(!1),_=5,[E,k]=S.useState(!1),[D,O]=S.useState(!1),[R,M]=S.useState(null),[X,G]=S.useState(!1),[de,we]=S.useState(null),[$,he]=S.useState(null),oe=Wr(),[re,le]=S.useState(!1);pr.useEffect(()=>{const I=()=>{document.visibilityState==="visible"&&le(!0)};return document.addEventListener("visibilitychange",I),()=>document.removeEventListener("visibilitychange",I)},[]);const J=(I=!1)=>{if(re&&!I){le(!1),console.log("Skipped automatic navigation to /loading due to recent tab return");return}oe("/loading")},[xe,ge]=S.useState(!1),H=f[n],V=Rn.length+_,pe=(n+1)/V*100;S.useEffect(()=>{let I=!0;return(async()=>{try{try{if(localStorage.getItem("fitbuddyai_no_auto_restore")||sessionStorage.getItem("fitbuddyai_no_auto_restore"))return}catch{}const Ne=br(),Le=gs();if(Ne||Le)return;const be=mr();if(!be||!be.id||(await ms(be.id),!I))return;const Fe=hu();Fe&&c($e=>({...$e||{},...Fe||{}}));const ze=br();ze&&(g(ze.questionsList||f),c(ze.answers||{}),p(ze.customInputs||{}),o(ze.currentQuestion||0),T(!0),ze.completed&&(k(!0),O(!0))),M(be)}catch(Ne){console.warn("Failed to restore server data in Questionnaire:",Ne)}})(),()=>{I=!1}},[]);const C=pr.useRef(null);pr.useEffect(()=>{C.current&&C.current.style.setProperty("--progress-width",`${pe}%`)},[pe]),S.useEffect(()=>{const I=br();if(I){if(I.questionsList){const B=I.questionsList.map(Ne=>({...Ne,icon:L(Ne.iconType||"")}));g(B),B.length>Rn.length&&x(!0)}if(I.completed){k(!0),O(!0),c(I.answers);return}o(I.currentQuestion),c(I.answers),p(I.customInputs||{}),T(!0)}},[]),S.useEffect(()=>{if(b||Object.keys(l).length>0){const I=f.map(({icon:B,...Ne})=>Ne);$o({currentQuestion:n,answers:l,customInputs:d,completed:E,timestamp:Date.now(),userData:R,questionsList:I})}},[n,l,d,b,E,f]);const w=Object.keys(l).length>=23&&!y,L=I=>{switch(I){case"Target":case"target":return a.jsx(Cr,{size:32});case"Clock":case"clock":return a.jsx(ia,{size:32});case"Dumbbell":case"dumbbell":case"equipment":return a.jsx(Et,{size:32});case"Heart":case"heart":case"heartRate":return a.jsx(ln,{size:32});case"Calendar":case"calendar":return a.jsx(Tr,{size:32});case"User":case"user":return a.jsx(ua,{size:32});case"Star":case"star":return a.jsx(bp,{size:32});default:return a.jsx(Cr,{size:32})}},Y=async(I=!1)=>{if(!I&&Object.keys(l).length<23)return console.log("[AI-FOLLOWUP] Not enough answers for follow-up. answers.length:",Object.keys(l).length),!1;G(!0),we(null);try{const B={...l};Object.keys(d).forEach(Fe=>{if(d[Fe]){const ze=B[Fe];if(typeof ze=="string"&&ze==="Other")B[Fe]=d[Fe];else if(Array.isArray(ze)&&ze.includes("Other")){const $e=ze.filter(Ke=>Ke!=="Other");$e.push(d[Fe]),B[Fe]=$e}}});const Ne={questions:f.slice(0,23).map(Fe=>({id:Fe.id,title:Fe.title})),answers:B},Le=`Based on the following user questions and responses, generate exactly 5 additional follow-up questions in JSON array format. Only return valid JSON; no extra text. Each object should have id, title, subtitle, type (single, multiple, textarea (for written responses), rating, slider, number), options, iconType, aiGenerated:true. Context: ${JSON.stringify(Ne)}`;console.log("[AI-FOLLOWUP] Prompt:",Le);const be=await iv({prompt:Le});if(console.log("[AI-FOLLOWUP] Received AI response:",be),Array.isArray(be)){const Fe=be.map((ze,$e)=>(console.log(`[AI-FOLLOWUP] Generated Q${$e+1}:`,ze),{...ze,icon:L(ze.iconType||"")}));return g(ze=>{const $e=[...ze,...Fe];return console.log("[AI-FOLLOWUP] allQuestions after append:",$e),setTimeout(()=>{try{n===Rn.length-1&&o(Rn.length)}catch{}},0),$e}),x(!0),console.log("[AI-FOLLOWUP] Follow-up questions appended and flag set."),!0}else console.error("[AI-FOLLOWUP] AI response is not an array:",be),we("Invalid AI response format")}catch(B){console.error("[AI-FOLLOWUP] Error fetching follow-up questions:",B),we("Failed to fetch follow-up questions. Please try again.")}finally{G(!1),console.log("[AI-FOLLOWUP] Done loading follow-up questions.")}return!1};S.useEffect(()=>{w&&Y()},[w]);const ne=I=>{if(H.id==="startDate"){const B=new Date().toISOString().split("T")[0];I&&I<B?he("Start date cannot be in the past"):he(null)}c(B=>({...B,[H.id]:I}))},ee=async()=>{if(console.log("[NAV] handleNext called. currentQuestion:",n,"allQuestions.length:",f.length),n<f.length-1)n===22&&console.log("[NAV] About to answer 23rd question. Next click will trigger AI follow-up logic."),o(I=>{const B=I+1;return console.log("[NAV] Advancing to question index:",B),B});else{if(!y&&n===Rn.length-1){console.log("[NAV] At last base question; generating follow-ups instead of final plan.");const I=await Y(!0);o(I?Rn.length:B=>Math.min(f.length-1,B+1));return}if(xe){console.log("[PLAN] Generation already in progress, ignoring duplicate request");return}ge(!0),J(!0),we(null),J();try{r(l,f);const I={...l};Object.keys(d).forEach(be=>{if(d[be]){const Fe=I[be];if(typeof Fe=="string"&&Fe==="Other")I[be]=d[be];else if(Array.isArray(Fe)&&Fe.includes("Other")){const ze=Fe.filter($e=>$e!=="Other");ze.push(d[be]),I[be]=ze}}});const B={username:I.username||"",age:I.age,fitnessLevel:I.fitnessLevel?.split(" -")[0].toLowerCase(),fitnessBackground:I.fitnessBackground,motivation:I.motivation,goals:I.goals||[],specificGoals:I.specificGoals,timeAvailable:I.timeAvailable,exerciseFormat:I.exerciseFormat,planDuration:I.planDuration,daysPerWeek:I.daysPerWeek,preferredTime:I.preferredTime,energyLevels:I.energyLevels,preferences:I.preferences||[],dislikes:I.dislikes,injuries:I.injuries,equipment:I.equipment||[],budget:I.budget,lifestyle:I.lifestyle,sleepQuality:I.sleepQuality,stressLevel:I.stressLevel,socialPreference:I.socialPreference,progressTracking:I.progressTracking,concerns:I.concerns};M(B);let Ne;const Le=2;for(let be=1;be<=Le+1;be++)try{console.log(`[PLAN] Generating workout plan, attempt ${be}`);const Fe=(I.planDuration||"").toString().toLowerCase(),$e=(Ke=>Ke.includes("1 week")?1:Ke.includes("2 week")?2:Ke.includes("6 week")?6:Ke.includes("1 month")?4:Ke.includes("3 month")?12:Ke.includes("6 month")?24:2)(Fe);if($e<=1)Ne=await ai(B,I,f);else{const Ke=I.startDate||new Date().toISOString().split("T")[0],mt=[];let gt=new Date(Ke);for(let Dt=0;Dt<$e;Dt++){const tr={...I,startDate:gt.toISOString().split("T")[0],planDuration:"1 week (part)"};try{const fn=await ai(B,tr,f);mt.push(fn),gt.setDate(gt.getDate()+7)}catch(fn){throw console.warn("Week generation failed for week",Dt,fn),fn}}const ht=[];let jt="",bt="",Ft="",Ht="",gr=[];mt.forEach(Dt=>{Ft||(Ft=Dt.startDate),Ht=Dt.endDate||Ht,jt=jt||Dt.name,bt=bt||Dt.description,Array.isArray(Dt.weeklyStructure)&&gr.length===0&&(gr=Dt.weeklyStructure),Array.isArray(Dt.dailyWorkouts)&&ht.push(...Dt.dailyWorkouts)}),Ne={id:`merged-plan-${Date.now()}`,name:jt||`${B.username||"User"}'s Plan`,description:bt||"Merged weekly plan",startDate:Ft||Ke,endDate:Ht||ht[ht.length-1]?.date||Ke,totalDays:ht.length,weeklyStructure:gr,dailyWorkouts:ht}}console.log(`[PLAN] Workout plan generated on attempt ${be}`);break}catch(Fe){console.error(`[PLAN] Attempt ${be} failed:`,Fe),be===Le+1&&we("Failed to generate workout plan. Please try again.")}if(Ne){console.log("[PLAN] Plan complete, calling onComplete."),k(!0),O(!0);try{const be=f.map(({icon:Fe,...ze})=>ze);$o({currentQuestion:n,answers:l,customInputs:d,completed:!0,timestamp:Date.now(),userData:B,questionsList:be})}catch(be){console.warn("Failed to save completed questionnaire progress:",be)}try{const be=mr();if(be){const Fe={...B,...be};s(Fe,Ne)}else{const{id:Fe,token:ze,access_token:$e,jwt:Ke,sub:mt,...gt}=B||{};s(gt,Ne)}}catch{const{id:Fe,token:ze,access_token:$e,jwt:Ke,sub:mt,...gt}=B||{};s(gt,Ne)}}}catch(I){console.error("[PLAN] Error generating plan:",I),we("Failed to generate workout plan. Please try again.")}finally{console.log("[PLAN] Done loading plan."),ge(!1)}}},ye=()=>{n>0?o(I=>I-1):oe("/")},se=()=>{const I=l[H.id];return H.type==="multiple"?I&&I.length>0:H.type==="textarea"?I&&I.trim().length>0:H.type==="rating"?I!==void 0&&I>0:I!==void 0&&I!==""},ve=async()=>{if(se()){ee();return}if(n===Rn.length-1&&!y){await Y(!0),o(Le=>Math.min(f.length-1,Le+1));return}const B=n===V-1,Ne=y&&n===f.length-1;if(B||Ne){ee();return}o(Le=>Math.min(f.length-1,Le+1))},Ae=()=>{const I=l[H.id];switch(H.type){case"text":if(H.id==="startDate"){const B=new Date().toISOString().split("T")[0];return a.jsxs(a.Fragment,{children:[a.jsx("input",{type:"date",className:"input question-input",min:B,value:I||"",onChange:Ne=>ne(Ne.target.value),onKeyDown:Ne=>Ne.key==="Enter"&&!$&&se()&&ee(),"aria-label":H.title}),$&&a.jsx("div",{className:"error-message",role:"alert",children:$})]})}return a.jsx("input",{type:"text",className:"input question-input",placeholder:"Enter your name",value:I||"",onChange:B=>ne(B.target.value),onKeyDown:B=>B.key==="Enter"&&se()&&ee(),"aria-label":H.title});case"number":return a.jsx("input",{type:"number",className:"input question-input",placeholder:"Enter your age",min:H.min,max:H.max,value:I||"",onChange:B=>ne(parseInt(B.target.value)),onKeyDown:B=>B.key==="Enter"&&se()&&ee(),"aria-label":H.title});case"textarea":return a.jsx("textarea",{className:"input question-textarea",placeholder:"Share your thoughts...",rows:4,value:I||"",onChange:B=>ne(B.target.value),"aria-label":H.title});case"rating":return a.jsxs("div",{className:"rating-container",children:[a.jsx("div",{className:"rating-scale",children:Array.from({length:H.max||10},(B,Ne)=>Ne+1).map(B=>a.jsx("button",{className:`rating-button ${I===B?"selected":""}`,onClick:()=>ne(B),"aria-label":`Rating ${B}`,children:B},B))}),a.jsxs("div",{className:"rating-labels",children:[a.jsx("span",{children:"Poor"}),a.jsx("span",{children:"Excellent"})]}),I&&a.jsxs("div",{className:"rating-value",children:["You rated: ",I,"/10"]})]});case"slider":return a.jsxs("div",{className:"slider-container",children:[a.jsx("input",{type:"range",className:"slider",min:H.min,max:H.max,step:H.step,value:I||H.min,onChange:B=>ne(parseInt(B.target.value)),"aria-label":H.title}),a.jsxs("div",{className:"slider-value",children:[I||H.min," minutes"]})]});case"single":return a.jsxs("div",{className:"options-container",children:[a.jsx("div",{className:"options-grid",children:H.options?.map((B,Ne)=>a.jsx("button",{className:`option-button ${I===B?"selected":""}`,onClick:()=>ne(B),"aria-label":B,children:B},Ne))}),I==="Other"&&a.jsx("div",{className:"custom-input-container",children:a.jsx("input",{type:"text",className:"input custom-input",placeholder:"Please specify...",value:d[H.id]||"",onChange:B=>p(Ne=>({...Ne,[H.id]:B.target.value}))})})]});case"multiple":return a.jsxs("div",{className:"options-container",children:[a.jsx("div",{className:"options-grid",children:H.options?.map((B,Ne)=>a.jsx("button",{className:`option-button ${I&&I.includes(B)?"selected":""}`,onClick:()=>{const Le=I||[],be=Le.includes(B)?Le.filter(Fe=>Fe!==B):[...Le,B];ne(be)},"aria-label":B,children:B},Ne))}),I&&I.includes("Other")&&a.jsx("div",{className:"custom-input-container",children:a.jsx("input",{type:"text",className:"input custom-input",placeholder:"Please specify...",value:d[H.id]||"",onChange:B=>p(Ne=>({...Ne,[H.id]:B.target.value}))})})]});default:return a.jsx("input",{type:"text",className:"input question-input",placeholder:"Enter your response",value:I||"",onChange:B=>ne(B.target.value),onKeyDown:B=>B.key==="Enter"&&se()&&ee(),"aria-label":H.title})}},Ie=()=>{pa(),o(0),c({}),p({}),k(!1),O(!1)},Ye=()=>{console.log("Edit Responses button clicked"),O(!1),k(!1),o(0),te(!1);const I=br();I?.answers?(c(I.answers),console.log("Previous answers loaded into state:",I.answers)):console.warn("No previous answers found to populate."),console.log("Questionnaire reset to allow editing of responses")},Ge=()=>{oe("/calendar")},[K,te]=S.useState(!1);S.useEffect(()=>{const I=br();if(console.log("Loaded questionnaire progress:",I),I?.completed){if(te(!0),I.userData&&(M(I.userData),console.log("Restored userData:",I.userData)),I.answers&&(c(I.answers),console.log("Restored answers:",I.answers)),I.customInputs&&(p(I.customInputs),console.log("Restored customInputs:",I.customInputs)),I.questionsList){const B=I.questionsList.map(Ne=>({...Ne,icon:L(Ne.iconType||"")}));g(B),console.log("Restored questionsList:",B)}}else console.warn("No completed progress found in local storage.")},[]);const Se=async()=>{console.log("handleRegenerate invoked"),console.log("State before regeneration  userData:",R,"answers:",l,"allQuestions length:",f.length);let I=R,B=l,Ne=f;if(!I){console.log("No userData in state, attempting to load from localStorage");const Le=br();if(console.log("loadQuestionnaireProgress returned:",Le),Le?.userData){if(console.log("Found saved.userData:",Le.userData),I=Le.userData,B=Le.answers,c(B),console.log("State after restoring answers:",B),Le.customInputs&&p(Le.customInputs),Le.questionsList){console.log("Restoring questionsList of length:",Le.questionsList.length);const be=Le.questionsList.map(Fe=>({...Fe,icon:L(Fe.iconType||"")}));g(be),console.log("State after restoring allQuestions length:",be.length),Ne=be}M(I),console.log("State after restoring userData:",I),console.log("Regenerate: restored state from localStorage",Le)}else{const be=hu();console.log("loadAssessmentData returned:",be),be&&(I=be,M(I))}}if(!I&&B){console.log("Reconstructing userData from currentAnswers");const Le={username:B.username||"",age:B.age,fitnessLevel:typeof B.fitnessLevel=="string"?B.fitnessLevel.split(" -")[0].toLowerCase():"",fitnessBackground:B.fitnessBackground,motivation:B.motivation,goals:B.goals||[],specificGoals:B.specificGoals,timeAvailable:B.timeAvailable,exerciseFormat:B.exerciseFormat,planDuration:B.planDuration,daysPerWeek:B.daysPerWeek,preferredTime:B.preferredTime,energyLevels:B.energyLevels,preferences:B.preferences||[],dislikes:B.dislikes,injuries:B.injuries,equipment:B.equipment||[],budget:B.budget,lifestyle:B.lifestyle,sleepQuality:B.sleepQuality,stressLevel:B.stressLevel,socialPreference:B.socialPreference,progressTracking:B.progressTracking,concerns:B.concerns};I=Le,M(I),console.log("Reconstructed userData:",Le),Du(I)}if(console.log("After restoration  currentUser:",I),!I){console.warn("No userData available to regenerate plan. Exiting handleRegenerate");return}console.log("Regenerate Plan clicked with userData:",I),we(null);try{J();const Le=(B.planDuration||"").toString().toLowerCase(),Fe=($e=>$e.includes("1 week")?1:$e.includes("2 week")?2:$e.includes("6 week")?6:$e.includes("1 month")?4:$e.includes("3 month")?12:$e.includes("6 month")?24:2)(Le);let ze;if(Fe<=1)ze=await ai(I,B,Ne);else{const $e=B.startDate||new Date().toISOString().split("T")[0],Ke=[];let mt=new Date($e);for(let ht=0;ht<Fe;ht++){const jt={...B,startDate:mt.toISOString().split("T")[0],planDuration:"1 week (part)"},bt=await ai(I,jt,Ne);Ke.push(bt),mt.setDate(mt.getDate()+7)}const gt=[];Ke.forEach(ht=>{Array.isArray(ht.dailyWorkouts)&&gt.push(...ht.dailyWorkouts)}),ze={id:`merged-plan-${Date.now()}`,name:Ke[0]?.name||"Merged Plan",description:Ke[0]?.description||"",startDate:Ke[0]?.startDate||$e,endDate:Ke[Ke.length-1]?.endDate||gt[gt.length-1]?.date||$e,totalDays:gt.length,weeklyStructure:Ke[0]?.weeklyStructure||[],dailyWorkouts:gt}}console.log("New plan generated:",ze),k(!0),O(!0);try{const $e=Ne.map(({icon:Ke,...mt})=>mt);$o({currentQuestion:0,answers:B,customInputs:{},completed:!0,timestamp:Date.now(),userData:I,questionsList:$e})}catch($e){console.warn("Failed to save completed progress on regenerate:",$e)}try{const $e=mr();if($e){const Ke={...I,...$e};s(Ke,ze)}else{const{id:Ke,token:mt,access_token:gt,jwt:ht,sub:jt,...bt}=I||{};s(bt,ze)}}catch{const{id:Ke,token:mt,access_token:gt,jwt:ht,sub:jt,...bt}=I||{};s(bt,ze)}oe("/calendar")}catch(Le){console.error("Error regenerating plan:",Le),we("Failed to generate a new plan. Please try again.")}finally{}};return S.useEffect(()=>{E&&!y&&Y()},[E,y]),X?a.jsx(mv,{}):de?a.jsx(gv,{onRetry:Se}):K?a.jsx(pv,{onRegenerate:Se,onEditResponses:Ye,onGoToCalendar:Ge}):E&&D?a.jsxs("div",{className:"completion-screen",children:[a.jsx("h2",{children:"Questionnaire Completed"}),a.jsx("p",{children:"Your responses have been saved. What would you like to do?"}),a.jsx("button",{className:"btn",onClick:Ye,children:"Edit Responses"}),a.jsx("button",{className:"btn btn-secondary",onClick:Ie,children:"Start Over"})]}):a.jsxs("div",{className:"questionnaire-page",children:[a.jsx(Zo,{}),a.jsxs("div",{className:"questionnaire-container",children:[a.jsxs("div",{className:"questionnaire-header",children:["          ",a.jsx("button",{className:"back-button",onClick:ye,"aria-label":"Go back to previous question",children:a.jsx(cu,{size:24})}),"          ",a.jsxs("div",{className:"progress-container",ref:C,children:[a.jsx("div",{className:"progress-bar",children:a.jsx("div",{className:"progress-fill"})}),a.jsxs("span",{className:"progress-text",children:[n+1," of ",V]})]}),"        "]}),b&&n===0&&a.jsx("div",{className:"restoration-notification",children:a.jsxs("div",{className:"notification-content",children:[a.jsx(oi,{size:20}),a.jsx("span",{children:"Your previous progress has been restored!"}),a.jsx("button",{className:"restart-button",onClick:Ie,children:"Start Fresh"})]})}),a.jsxs("div",{className:"question-container card fade-in-up",children:[a.jsx("div",{className:"question-icon",children:H.icon}),H.aiGenerated&&a.jsx("div",{className:"ai-badge",children:" AI Personalized Question"}),a.jsx("h2",{className:"question-title",children:H.title}),a.jsx("p",{className:"question-subtitle",children:H.subtitle}),a.jsx("div",{className:"question-input-container",children:Ae()})]}),"        ",a.jsxs("div",{className:"questionnaire-navigation",children:[a.jsxs("button",{className:`btn btn-secondary ${n===0?"disabled":""}`,onClick:()=>o(I=>Math.max(0,I-1)),disabled:n===0,children:[a.jsx(cu,{size:20}),"Previous"]}),(()=>{const I=n===V-1||y&&n===f.length-1;return a.jsxs("button",{className:`btn ${se()?"btn-primary":"btn-secondary"} continue-skip-btn${se()?"":" fake-disabled"}`,onClick:()=>{xe||(I?ee():ve())},tabIndex:0,"aria-disabled":!se()||xe,disabled:xe,onKeyDown:B=>{if(B.key==="Enter"||B.key===" "){if(B.preventDefault(),xe)return;I?ee():ve()}},children:[a.jsx("span",{className:"continue-text",children:I?xe?"Generating":"Generate My Plan":"Continue"}),!se()&&a.jsx("span",{className:"skip-inline-btn",children:"Skip"})]})})()]})]})]})};function Ho(s){"@babel/helpers - typeof";return Ho=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Ho(s)}function ys(s){if(s===null||s===!0||s===!1)return NaN;var r=Number(s);return isNaN(r)?r:r<0?Math.ceil(r):Math.floor(r)}function Ct(s,r){if(r.length<s)throw new TypeError(s+" argument"+(s>1?"s":"")+" required, but only "+r.length+" present")}function er(s){Ct(1,arguments);var r=Object.prototype.toString.call(s);return s instanceof Date||Ho(s)==="object"&&r==="[object Date]"?new Date(s.getTime()):typeof s=="number"||r==="[object Number]"?new Date(s):((typeof s=="string"||r==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}function vv(s,r){Ct(2,arguments);var n=er(s).getTime(),o=ys(r);return new Date(n+o)}var wv={};function tl(){return wv}function xv(s){var r=new Date(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()));return r.setUTCFullYear(s.getFullYear()),s.getTime()-r.getTime()}function Pf(s){Ct(1,arguments);var r=er(s);return r.setHours(0,0,0,0),r}function bv(s,r){Ct(2,arguments);var n=Pf(s),o=Pf(r);return n.getTime()===o.getTime()}function kv(s){return Ct(1,arguments),s instanceof Date||Ho(s)==="object"&&Object.prototype.toString.call(s)==="[object Date]"}function Sv(s){if(Ct(1,arguments),!kv(s)&&typeof s!="number")return!1;var r=er(s);return!isNaN(Number(r))}function _v(s){Ct(1,arguments);var r=er(s),n=r.getMonth();return r.setFullYear(r.getFullYear(),n+1,0),r.setHours(23,59,59,999),r}function jv(s,r){var n;Ct(1,arguments);var o=s||{},l=er(o.start),c=er(o.end),d=c.getTime();if(!(l.getTime()<=d))throw new RangeError("Invalid interval");var p=[],f=l;f.setHours(0,0,0,0);var g=Number((n=void 0)!==null&&n!==void 0?n:1);if(g<1||isNaN(g))throw new RangeError("`options.step` must be a number greater than 1");for(;f.getTime()<=d;)p.push(er(f)),f.setDate(f.getDate()+g),f.setHours(0,0,0,0);return p}function Nv(s){Ct(1,arguments);var r=er(s);return r.setDate(1),r.setHours(0,0,0,0),r}function Ev(s,r){Ct(2,arguments);var n=ys(r);return vv(s,-n)}var Cv=864e5;function Tv(s){Ct(1,arguments);var r=er(s),n=r.getTime();r.setUTCMonth(0,1),r.setUTCHours(0,0,0,0);var o=r.getTime(),l=n-o;return Math.floor(l/Cv)+1}function Go(s){Ct(1,arguments);var r=1,n=er(s),o=n.getUTCDay(),l=(o<r?7:0)+o-r;return n.setUTCDate(n.getUTCDate()-l),n.setUTCHours(0,0,0,0),n}function _p(s){Ct(1,arguments);var r=er(s),n=r.getUTCFullYear(),o=new Date(0);o.setUTCFullYear(n+1,0,4),o.setUTCHours(0,0,0,0);var l=Go(o),c=new Date(0);c.setUTCFullYear(n,0,4),c.setUTCHours(0,0,0,0);var d=Go(c);return r.getTime()>=l.getTime()?n+1:r.getTime()>=d.getTime()?n:n-1}function Pv(s){Ct(1,arguments);var r=_p(s),n=new Date(0);n.setUTCFullYear(r,0,4),n.setUTCHours(0,0,0,0);var o=Go(n);return o}var Av=6048e5;function Ov(s){Ct(1,arguments);var r=er(s),n=Go(r).getTime()-Pv(r).getTime();return Math.round(n/Av)+1}function Vo(s,r){var n,o,l,c,d,p,f,g;Ct(1,arguments);var y=tl(),x=ys((n=(o=(l=(c=r?.weekStartsOn)!==null&&c!==void 0?c:r==null||(d=r.locale)===null||d===void 0||(p=d.options)===null||p===void 0?void 0:p.weekStartsOn)!==null&&l!==void 0?l:y.weekStartsOn)!==null&&o!==void 0?o:(f=y.locale)===null||f===void 0||(g=f.options)===null||g===void 0?void 0:g.weekStartsOn)!==null&&n!==void 0?n:0);if(!(x>=0&&x<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var b=er(s),T=b.getUTCDay(),_=(T<x?7:0)+T-x;return b.setUTCDate(b.getUTCDate()-_),b.setUTCHours(0,0,0,0),b}function jp(s,r){var n,o,l,c,d,p,f,g;Ct(1,arguments);var y=er(s),x=y.getUTCFullYear(),b=tl(),T=ys((n=(o=(l=(c=r?.firstWeekContainsDate)!==null&&c!==void 0?c:r==null||(d=r.locale)===null||d===void 0||(p=d.options)===null||p===void 0?void 0:p.firstWeekContainsDate)!==null&&l!==void 0?l:b.firstWeekContainsDate)!==null&&o!==void 0?o:(f=b.locale)===null||f===void 0||(g=f.options)===null||g===void 0?void 0:g.firstWeekContainsDate)!==null&&n!==void 0?n:1);if(!(T>=1&&T<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var _=new Date(0);_.setUTCFullYear(x+1,0,T),_.setUTCHours(0,0,0,0);var E=Vo(_,r),k=new Date(0);k.setUTCFullYear(x,0,T),k.setUTCHours(0,0,0,0);var D=Vo(k,r);return y.getTime()>=E.getTime()?x+1:y.getTime()>=D.getTime()?x:x-1}function Iv(s,r){var n,o,l,c,d,p,f,g;Ct(1,arguments);var y=tl(),x=ys((n=(o=(l=(c=r?.firstWeekContainsDate)!==null&&c!==void 0?c:r==null||(d=r.locale)===null||d===void 0||(p=d.options)===null||p===void 0?void 0:p.firstWeekContainsDate)!==null&&l!==void 0?l:y.firstWeekContainsDate)!==null&&o!==void 0?o:(f=y.locale)===null||f===void 0||(g=f.options)===null||g===void 0?void 0:g.firstWeekContainsDate)!==null&&n!==void 0?n:1),b=jp(s,r),T=new Date(0);T.setUTCFullYear(b,0,x),T.setUTCHours(0,0,0,0);var _=Vo(T,r);return _}var Dv=6048e5;function Rv(s,r){Ct(1,arguments);var n=er(s),o=Vo(n,r).getTime()-Iv(n,r).getTime();return Math.round(o/Dv)+1}function at(s,r){for(var n=s<0?"-":"",o=Math.abs(s).toString();o.length<r;)o="0"+o;return n+o}var Ln={y:function(r,n){var o=r.getUTCFullYear(),l=o>0?o:1-o;return at(n==="yy"?l%100:l,n.length)},M:function(r,n){var o=r.getUTCMonth();return n==="M"?String(o+1):at(o+1,2)},d:function(r,n){return at(r.getUTCDate(),n.length)},a:function(r,n){var o=r.getUTCHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return o.toUpperCase();case"aaa":return o;case"aaaaa":return o[0];case"aaaa":default:return o==="am"?"a.m.":"p.m."}},h:function(r,n){return at(r.getUTCHours()%12||12,n.length)},H:function(r,n){return at(r.getUTCHours(),n.length)},m:function(r,n){return at(r.getUTCMinutes(),n.length)},s:function(r,n){return at(r.getUTCSeconds(),n.length)},S:function(r,n){var o=n.length,l=r.getUTCMilliseconds(),c=Math.floor(l*Math.pow(10,o-3));return at(c,n.length)}},Vs={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Lv={G:function(r,n,o){var l=r.getUTCFullYear()>0?1:0;switch(n){case"G":case"GG":case"GGG":return o.era(l,{width:"abbreviated"});case"GGGGG":return o.era(l,{width:"narrow"});case"GGGG":default:return o.era(l,{width:"wide"})}},y:function(r,n,o){if(n==="yo"){var l=r.getUTCFullYear(),c=l>0?l:1-l;return o.ordinalNumber(c,{unit:"year"})}return Ln.y(r,n)},Y:function(r,n,o,l){var c=jp(r,l),d=c>0?c:1-c;if(n==="YY"){var p=d%100;return at(p,2)}return n==="Yo"?o.ordinalNumber(d,{unit:"year"}):at(d,n.length)},R:function(r,n){var o=_p(r);return at(o,n.length)},u:function(r,n){var o=r.getUTCFullYear();return at(o,n.length)},Q:function(r,n,o){var l=Math.ceil((r.getUTCMonth()+1)/3);switch(n){case"Q":return String(l);case"QQ":return at(l,2);case"Qo":return o.ordinalNumber(l,{unit:"quarter"});case"QQQ":return o.quarter(l,{width:"abbreviated",context:"formatting"});case"QQQQQ":return o.quarter(l,{width:"narrow",context:"formatting"});case"QQQQ":default:return o.quarter(l,{width:"wide",context:"formatting"})}},q:function(r,n,o){var l=Math.ceil((r.getUTCMonth()+1)/3);switch(n){case"q":return String(l);case"qq":return at(l,2);case"qo":return o.ordinalNumber(l,{unit:"quarter"});case"qqq":return o.quarter(l,{width:"abbreviated",context:"standalone"});case"qqqqq":return o.quarter(l,{width:"narrow",context:"standalone"});case"qqqq":default:return o.quarter(l,{width:"wide",context:"standalone"})}},M:function(r,n,o){var l=r.getUTCMonth();switch(n){case"M":case"MM":return Ln.M(r,n);case"Mo":return o.ordinalNumber(l+1,{unit:"month"});case"MMM":return o.month(l,{width:"abbreviated",context:"formatting"});case"MMMMM":return o.month(l,{width:"narrow",context:"formatting"});case"MMMM":default:return o.month(l,{width:"wide",context:"formatting"})}},L:function(r,n,o){var l=r.getUTCMonth();switch(n){case"L":return String(l+1);case"LL":return at(l+1,2);case"Lo":return o.ordinalNumber(l+1,{unit:"month"});case"LLL":return o.month(l,{width:"abbreviated",context:"standalone"});case"LLLLL":return o.month(l,{width:"narrow",context:"standalone"});case"LLLL":default:return o.month(l,{width:"wide",context:"standalone"})}},w:function(r,n,o,l){var c=Rv(r,l);return n==="wo"?o.ordinalNumber(c,{unit:"week"}):at(c,n.length)},I:function(r,n,o){var l=Ov(r);return n==="Io"?o.ordinalNumber(l,{unit:"week"}):at(l,n.length)},d:function(r,n,o){return n==="do"?o.ordinalNumber(r.getUTCDate(),{unit:"date"}):Ln.d(r,n)},D:function(r,n,o){var l=Tv(r);return n==="Do"?o.ordinalNumber(l,{unit:"dayOfYear"}):at(l,n.length)},E:function(r,n,o){var l=r.getUTCDay();switch(n){case"E":case"EE":case"EEE":return o.day(l,{width:"abbreviated",context:"formatting"});case"EEEEE":return o.day(l,{width:"narrow",context:"formatting"});case"EEEEEE":return o.day(l,{width:"short",context:"formatting"});case"EEEE":default:return o.day(l,{width:"wide",context:"formatting"})}},e:function(r,n,o,l){var c=r.getUTCDay(),d=(c-l.weekStartsOn+8)%7||7;switch(n){case"e":return String(d);case"ee":return at(d,2);case"eo":return o.ordinalNumber(d,{unit:"day"});case"eee":return o.day(c,{width:"abbreviated",context:"formatting"});case"eeeee":return o.day(c,{width:"narrow",context:"formatting"});case"eeeeee":return o.day(c,{width:"short",context:"formatting"});case"eeee":default:return o.day(c,{width:"wide",context:"formatting"})}},c:function(r,n,o,l){var c=r.getUTCDay(),d=(c-l.weekStartsOn+8)%7||7;switch(n){case"c":return String(d);case"cc":return at(d,n.length);case"co":return o.ordinalNumber(d,{unit:"day"});case"ccc":return o.day(c,{width:"abbreviated",context:"standalone"});case"ccccc":return o.day(c,{width:"narrow",context:"standalone"});case"cccccc":return o.day(c,{width:"short",context:"standalone"});case"cccc":default:return o.day(c,{width:"wide",context:"standalone"})}},i:function(r,n,o){var l=r.getUTCDay(),c=l===0?7:l;switch(n){case"i":return String(c);case"ii":return at(c,n.length);case"io":return o.ordinalNumber(c,{unit:"day"});case"iii":return o.day(l,{width:"abbreviated",context:"formatting"});case"iiiii":return o.day(l,{width:"narrow",context:"formatting"});case"iiiiii":return o.day(l,{width:"short",context:"formatting"});case"iiii":default:return o.day(l,{width:"wide",context:"formatting"})}},a:function(r,n,o){var l=r.getUTCHours(),c=l/12>=1?"pm":"am";switch(n){case"a":case"aa":return o.dayPeriod(c,{width:"abbreviated",context:"formatting"});case"aaa":return o.dayPeriod(c,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return o.dayPeriod(c,{width:"narrow",context:"formatting"});case"aaaa":default:return o.dayPeriod(c,{width:"wide",context:"formatting"})}},b:function(r,n,o){var l=r.getUTCHours(),c;switch(l===12?c=Vs.noon:l===0?c=Vs.midnight:c=l/12>=1?"pm":"am",n){case"b":case"bb":return o.dayPeriod(c,{width:"abbreviated",context:"formatting"});case"bbb":return o.dayPeriod(c,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return o.dayPeriod(c,{width:"narrow",context:"formatting"});case"bbbb":default:return o.dayPeriod(c,{width:"wide",context:"formatting"})}},B:function(r,n,o){var l=r.getUTCHours(),c;switch(l>=17?c=Vs.evening:l>=12?c=Vs.afternoon:l>=4?c=Vs.morning:c=Vs.night,n){case"B":case"BB":case"BBB":return o.dayPeriod(c,{width:"abbreviated",context:"formatting"});case"BBBBB":return o.dayPeriod(c,{width:"narrow",context:"formatting"});case"BBBB":default:return o.dayPeriod(c,{width:"wide",context:"formatting"})}},h:function(r,n,o){if(n==="ho"){var l=r.getUTCHours()%12;return l===0&&(l=12),o.ordinalNumber(l,{unit:"hour"})}return Ln.h(r,n)},H:function(r,n,o){return n==="Ho"?o.ordinalNumber(r.getUTCHours(),{unit:"hour"}):Ln.H(r,n)},K:function(r,n,o){var l=r.getUTCHours()%12;return n==="Ko"?o.ordinalNumber(l,{unit:"hour"}):at(l,n.length)},k:function(r,n,o){var l=r.getUTCHours();return l===0&&(l=24),n==="ko"?o.ordinalNumber(l,{unit:"hour"}):at(l,n.length)},m:function(r,n,o){return n==="mo"?o.ordinalNumber(r.getUTCMinutes(),{unit:"minute"}):Ln.m(r,n)},s:function(r,n,o){return n==="so"?o.ordinalNumber(r.getUTCSeconds(),{unit:"second"}):Ln.s(r,n)},S:function(r,n){return Ln.S(r,n)},X:function(r,n,o,l){var c=l._originalDate||r,d=c.getTimezoneOffset();if(d===0)return"Z";switch(n){case"X":return Of(d);case"XXXX":case"XX":return cs(d);case"XXXXX":case"XXX":default:return cs(d,":")}},x:function(r,n,o,l){var c=l._originalDate||r,d=c.getTimezoneOffset();switch(n){case"x":return Of(d);case"xxxx":case"xx":return cs(d);case"xxxxx":case"xxx":default:return cs(d,":")}},O:function(r,n,o,l){var c=l._originalDate||r,d=c.getTimezoneOffset();switch(n){case"O":case"OO":case"OOO":return"GMT"+Af(d,":");case"OOOO":default:return"GMT"+cs(d,":")}},z:function(r,n,o,l){var c=l._originalDate||r,d=c.getTimezoneOffset();switch(n){case"z":case"zz":case"zzz":return"GMT"+Af(d,":");case"zzzz":default:return"GMT"+cs(d,":")}},t:function(r,n,o,l){var c=l._originalDate||r,d=Math.floor(c.getTime()/1e3);return at(d,n.length)},T:function(r,n,o,l){var c=l._originalDate||r,d=c.getTime();return at(d,n.length)}};function Af(s,r){var n=s>0?"-":"+",o=Math.abs(s),l=Math.floor(o/60),c=o%60;if(c===0)return n+String(l);var d=r;return n+String(l)+d+at(c,2)}function Of(s,r){if(s%60===0){var n=s>0?"-":"+";return n+at(Math.abs(s)/60,2)}return cs(s,r)}function cs(s,r){var n=r||"",o=s>0?"-":"+",l=Math.abs(s),c=at(Math.floor(l/60),2),d=at(l%60,2);return o+c+n+d}var If=function(r,n){switch(r){case"P":return n.date({width:"short"});case"PP":return n.date({width:"medium"});case"PPP":return n.date({width:"long"});case"PPPP":default:return n.date({width:"full"})}},Np=function(r,n){switch(r){case"p":return n.time({width:"short"});case"pp":return n.time({width:"medium"});case"ppp":return n.time({width:"long"});case"pppp":default:return n.time({width:"full"})}},Mv=function(r,n){var o=r.match(/(P+)(p+)?/)||[],l=o[1],c=o[2];if(!c)return If(r,n);var d;switch(l){case"P":d=n.dateTime({width:"short"});break;case"PP":d=n.dateTime({width:"medium"});break;case"PPP":d=n.dateTime({width:"long"});break;case"PPPP":default:d=n.dateTime({width:"full"});break}return d.replace("{{date}}",If(l,n)).replace("{{time}}",Np(c,n))},Uv={p:Np,P:Mv},Fv=["D","DD"],Wv=["YY","YYYY"];function Bv(s){return Fv.indexOf(s)!==-1}function $v(s){return Wv.indexOf(s)!==-1}function Df(s,r,n){if(s==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(r,"`) for formatting years to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(s==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(r,"`) for formatting years to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(s==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(r,"`) for formatting days of the month to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(s==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(r,"`) for formatting days of the month to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var zv={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},qv=function(r,n,o){var l,c=zv[r];return typeof c=="string"?l=c:n===1?l=c.one:l=c.other.replace("{{count}}",n.toString()),o!=null&&o.addSuffix?o.comparison&&o.comparison>0?"in "+l:l+" ago":l};function Yc(s){return function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=r.width?String(r.width):s.defaultWidth,o=s.formats[n]||s.formats[s.defaultWidth];return o}}var Hv={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Gv={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Vv={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Jv={date:Yc({formats:Hv,defaultWidth:"full"}),time:Yc({formats:Gv,defaultWidth:"full"}),dateTime:Yc({formats:Vv,defaultWidth:"full"})},Kv={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Yv=function(r,n,o,l){return Kv[r]};function ni(s){return function(r,n){var o=n!=null&&n.context?String(n.context):"standalone",l;if(o==="formatting"&&s.formattingValues){var c=s.defaultFormattingWidth||s.defaultWidth,d=n!=null&&n.width?String(n.width):c;l=s.formattingValues[d]||s.formattingValues[c]}else{var p=s.defaultWidth,f=n!=null&&n.width?String(n.width):s.defaultWidth;l=s.values[f]||s.values[p]}var g=s.argumentCallback?s.argumentCallback(r):r;return l[g]}}var Qv={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Xv={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Zv={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},ew={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},tw={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},rw={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},nw=function(r,n){var o=Number(r),l=o%100;if(l>20||l<10)switch(l%10){case 1:return o+"st";case 2:return o+"nd";case 3:return o+"rd"}return o+"th"},sw={ordinalNumber:nw,era:ni({values:Qv,defaultWidth:"wide"}),quarter:ni({values:Xv,defaultWidth:"wide",argumentCallback:function(r){return r-1}}),month:ni({values:Zv,defaultWidth:"wide"}),day:ni({values:ew,defaultWidth:"wide"}),dayPeriod:ni({values:tw,defaultWidth:"wide",formattingValues:rw,defaultFormattingWidth:"wide"})};function si(s){return function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=n.width,l=o&&s.matchPatterns[o]||s.matchPatterns[s.defaultMatchWidth],c=r.match(l);if(!c)return null;var d=c[0],p=o&&s.parsePatterns[o]||s.parsePatterns[s.defaultParseWidth],f=Array.isArray(p)?iw(p,function(x){return x.test(d)}):aw(p,function(x){return x.test(d)}),g;g=s.valueCallback?s.valueCallback(f):f,g=n.valueCallback?n.valueCallback(g):g;var y=r.slice(d.length);return{value:g,rest:y}}}function aw(s,r){for(var n in s)if(s.hasOwnProperty(n)&&r(s[n]))return n}function iw(s,r){for(var n=0;n<s.length;n++)if(r(s[n]))return n}function ow(s){return function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=r.match(s.matchPattern);if(!o)return null;var l=o[0],c=r.match(s.parsePattern);if(!c)return null;var d=s.valueCallback?s.valueCallback(c[0]):c[0];d=n.valueCallback?n.valueCallback(d):d;var p=r.slice(l.length);return{value:d,rest:p}}}var lw=/^(\d+)(th|st|nd|rd)?/i,cw=/\d+/i,uw={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},dw={any:[/^b/i,/^(a|c)/i]},hw={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},fw={any:[/1/i,/2/i,/3/i,/4/i]},pw={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},mw={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},gw={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},yw={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},vw={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},ww={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},xw={ordinalNumber:ow({matchPattern:lw,parsePattern:cw,valueCallback:function(r){return parseInt(r,10)}}),era:si({matchPatterns:uw,defaultMatchWidth:"wide",parsePatterns:dw,defaultParseWidth:"any"}),quarter:si({matchPatterns:hw,defaultMatchWidth:"wide",parsePatterns:fw,defaultParseWidth:"any",valueCallback:function(r){return r+1}}),month:si({matchPatterns:pw,defaultMatchWidth:"wide",parsePatterns:mw,defaultParseWidth:"any"}),day:si({matchPatterns:gw,defaultMatchWidth:"wide",parsePatterns:yw,defaultParseWidth:"any"}),dayPeriod:si({matchPatterns:vw,defaultMatchWidth:"any",parsePatterns:ww,defaultParseWidth:"any"})},bw={code:"en-US",formatDistance:qv,formatLong:Jv,formatRelative:Yv,localize:sw,match:xw,options:{weekStartsOn:0,firstWeekContainsDate:1}},kw=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Sw=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,_w=/^'([^]*?)'?$/,jw=/''/g,Nw=/[a-zA-Z]/;function Zt(s,r,n){var o,l,c,d,p,f,g,y,x,b,T,_,E,k;Ct(2,arguments);var D=String(r),O=tl(),R=(o=(l=void 0)!==null&&l!==void 0?l:O.locale)!==null&&o!==void 0?o:bw,M=ys((c=(d=(p=(f=void 0)!==null&&f!==void 0?f:void 0)!==null&&p!==void 0?p:O.firstWeekContainsDate)!==null&&d!==void 0?d:(g=O.locale)===null||g===void 0||(y=g.options)===null||y===void 0?void 0:y.firstWeekContainsDate)!==null&&c!==void 0?c:1);if(!(M>=1&&M<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var X=ys((x=(b=(T=(_=void 0)!==null&&_!==void 0?_:void 0)!==null&&T!==void 0?T:O.weekStartsOn)!==null&&b!==void 0?b:(E=O.locale)===null||E===void 0||(k=E.options)===null||k===void 0?void 0:k.weekStartsOn)!==null&&x!==void 0?x:0);if(!(X>=0&&X<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!R.localize)throw new RangeError("locale must contain localize property");if(!R.formatLong)throw new RangeError("locale must contain formatLong property");var G=er(s);if(!Sv(G))throw new RangeError("Invalid time value");var de=xv(G),we=Ev(G,de),$={firstWeekContainsDate:M,weekStartsOn:X,locale:R,_originalDate:G},he=D.match(Sw).map(function(oe){var re=oe[0];if(re==="p"||re==="P"){var le=Uv[re];return le(oe,R.formatLong)}return oe}).join("").match(kw).map(function(oe){if(oe==="''")return"'";var re=oe[0];if(re==="'")return Ew(oe);var le=Lv[re];if(le)return $v(oe)&&Df(oe,r,String(s)),Bv(oe)&&Df(oe,r,String(s)),le(we,oe,R.localize,$);if(re.match(Nw))throw new RangeError("Format string contains an unescaped latin alphabet character `"+re+"`");return oe}).join("");return he}function Ew(s){var r=s.match(_w);return r?r[1].replace(jw,"'"):s}const Cw={images:["/images/fitbuddyai_head.png"],video:"https://www.youtube.com/embed?listType=search&list=Lunges",resources:[{label:"Lunge technique guide",url:"https://example.com/lunges/technique"},{label:"Walking lunge progression",url:"https://example.com/lunges/progression"},{label:"Lunge programming for strength",url:"https://example.com/lunges/programming"}],galleryImages:["/images/fitbuddyai_head.png"],imageCaptions:["Forward lunge finish"],difficulty:"Moderate",duration:"5-12 min",exampleNote:"Step forward, lower until back knee is near floor, then drive through front heel to stand.",meta:{exercise:"Lower Body / Quads / Glutes / Hamstrings / Calves",movement:"Squat/Lunge -- Sagittal",equipment:"Bodyweight / Optional Weights",trainingType:"Strength / Hypertrophy / Endurance / Balance-Stability",planeOfMotion:"Sagittal",description:"Step forward and lower body by bending knees until back knee is just above the floor; push back to start. Keep torso upright and core engaged."}},Tw={images:["/images/fitbuddyai_head.png"],video:"https://www.youtube.com/embed/aclHkVaku9U",featuredVideo:!0,resources:[{label:"Harvard Health: How to do a squat",url:"https://www.health.harvard.edu/staying-healthy/squat-exercise"},{label:"ACE Fitness: Squat technique and tips",url:"https://www.acefitness.org/education-and-resources/lifestyle/exercise-library/136/squat/"},{label:"Video: How to Do a Barbell Squat (YouTube)",url:"https://www.youtube.com/watch?v=aclHkVaku9U"}],galleryImages:["/images/fitbuddyai_head.png"],imageCaptions:["Proper squat depth and posture"],difficulty:"Moderate",duration:"8-15 min",exampleNote:"Keep chest up, push hips back, and drive through heels to stand.",meta:{exercise:"Lower Body / Quads / Glutes / Hamstrings / Calves / Core Stabilizers",movement:"Squat/Lunge -- Sagittal",equipment:"Bodyweight / Free Weights",trainingType:"Strength / Hypertrophy / Endurance / Power-Plyometrics / Balance-Stability",planeOfMotion:"Sagittal",description:"Stand shoulder-width apart, lower by bending hips and knees, then push through heels to return to standing. Avoid knees caving and keep heels down."}},Pw={images:["/images/fitbuddyai_head.png"],video:"https://www.youtube.com/embed?listType=search&list=Bridges+exercise",resources:[{label:"Glute bridge progressions",url:"https://example.com/bridges/progressions"},{label:"Hip thrust vs bridge comparison",url:"https://example.com/bridges/compare"},{label:"Bridge programming for glute strength",url:"https://example.com/bridges/program"}],galleryImages:["/images/fitbuddyai_head.png"],imageCaptions:["Bridge top squeeze"],difficulty:"Easy",duration:"5-10 min",exampleNote:"Press through heels to lift hips until body forms straight line from shoulders to knees.",meta:{exercise:"Lower Body / Glutes / Hamstrings / Core Stabilizers / Lower Back",movement:"Push -- Hip Hinge/Extension",equipment:"Bodyweight / Optional Weights",trainingType:"Strength / Hypertrophy",planeOfMotion:"Sagittal",description:"Lie on your back with knees bent and feet flat, press through heels to lift hips toward ceiling and squeeze glutes at top."}},Aw={images:["/images/fitbuddyai_head.png"],video:"https://www.youtube.com/embed?listType=search&list=Punches+drill",resources:[{label:"Basic punching technique",url:"https://example.com/punches/technique"},{label:"Shadowboxing routines",url:"https://example.com/punches/shadowboxing"},{label:"Rotational power drills",url:"https://example.com/punches/power"}],galleryImages:["/images/fitbuddyai_head.png"],imageCaptions:["Punching stance"],difficulty:"Moderate",duration:"3-8 min",exampleNote:"Stand in a fighting stance, extend the arm and rotate torso for power, retract quickly.",meta:{exercise:"Upper Body / Arms / Shoulders / Chest / Core  Rotation",movement:"Push -- Horizontal / Rotation",equipment:"Bodyweight / Optional Weights",trainingType:"Endurance / Power-Plyometrics",planeOfMotion:"Transverse",description:"Stand with feet shoulder-width and rotate through the torso while extending the arm to punch, then retract. Focus on controlled power and posture."}},Ow={images:["/images/fitbuddyai_head.png"],video:"https://www.youtube.com/embed?listType=search&list=Superman+exercise",resources:[{label:"Superman back extension tips",url:"https://example.com/superman/tips"},{label:"Lower back strengthening program",url:"https://example.com/superman/program"},{label:"Glute and hamstring pairing",url:"https://example.com/superman/pairings"}],galleryImages:["/images/fitbuddyai_head.png"],imageCaptions:["Superman top position"],difficulty:"Easy",duration:"3-8 min",exampleNote:"Lift arms, chest, and legs slightly off the ground squeezing glutes and lower back.",meta:{exercise:"Core / Lower Back / Glutes / Hamstrings / Shoulders",movement:"Extension -- Sagittal Isometric Hold",equipment:"Bodyweight",trainingType:"Endurance / Balance-Stability",planeOfMotion:"Sagittal",description:"Lie face down and lift arms, chest, and legs a few inches off the ground, holding briefly at the top."}},fu={"Sit-ups":{images:["/images/fitbuddyai_head.png"],video:"https://www.youtube.com/embed/1fbU_MkV7NE",featuredVideo:!0,resources:[{label:"NHS: How to do sit-ups safely",url:"https://www.nhs.uk/live-well/exercise/how-to-do-a-sit-up-or-crunch/"},{label:"LIVESTRONG: How to Do a Sit Up",url:"https://www.livestrong.com/article/137075-how-to-do-a-sit-up/"},{label:"Video: How to Do a Sit Up (YouTube)",url:"https://www.youtube.com/watch?v=1fbU_MkV7NE"}],galleryImages:["/images/fitbuddyai_head.png"],imageCaptions:["Controlled sit-up finish"],difficulty:"Moderate",duration:"3-10 min",exampleNote:"Lie on your back with knees bent and feet flat; curl up using the core and avoid neck strain.",meta:{exercise:"Core / Abs",movement:"Push -- Sagittal Flexion",equipment:"Bodyweight",trainingType:"Endurance / Hypertrophy",planeOfMotion:"Sagittal",description:"Lie on your back with knees bent and feet flat on the floor. Cross arms or place hands by your head. Tighten core and curl upper body toward knees, then lower with control."}},"Reverse Crunches":{images:["/images/fitbuddyai_head.png"],video:"https://www.youtube.com/embed?listType=search&list=Reverse+Crunches",resources:[{label:"Reverse crunch tutorial",url:"https://example.com/reverse-crunches/tutorial"},{label:"Lower-abs progressions",url:"https://example.com/reverse-crunches/progressions"},{label:"Reverse crunch common errors",url:"https://example.com/reverse-crunches/errors"}],galleryImages:["/images/we09532.png"],imageCaptions:["Reverse crunch top position"],difficulty:"Moderate",duration:"5-10 min",exampleNote:"Curl hips off the floor and draw knees toward chest using the abs.",meta:{exercise:"Core / Abs / Lower Back Stabilizers",movement:"Pull -- Sagittal Flexion",equipment:"Bodyweight",trainingType:"Endurance / Hypertrophy",planeOfMotion:"Sagittal",description:"Lie on your back with knees bent and feet lifted. Contract abs to curl hips off the floor and draw knees toward your chest. Lower down under control."}},"Bicycle Crunches":{images:["/images/we09532.png"],video:"https://www.youtube.com/embed?listType=search&list=Bicycle+Crunches",resources:[{label:"Bicycle crunch form guide",url:"https://example.com/bicycle-crunches/form"},{label:"Oblique strengthening routine",url:"https://example.com/bicycle-crunches/obliques"},{label:"Progressions for bicycle crunches",url:"https://example.com/bicycle-crunches/progressions"}],galleryImages:["/images/we09532.png"],imageCaptions:["Bicycle crunch twist"],difficulty:"Moderate",duration:"5-8 min",exampleNote:"Perform slow, controlled alternating twist motions to target obliques.",meta:{exercise:"Core / Abs / Obliques",movement:"Rotation -- Transverse Flexion",equipment:"Bodyweight",trainingType:"Endurance / Hypertrophy",planeOfMotion:"Transverse",description:"Lie on your back with hands behind head and legs lifted. Bring one knee toward chest while twisting the opposite elbow toward it, then switch sides."}},"Flutter Kicks":{images:["/images/fitbuddyai_head.png"],video:"https://www.youtube.com/embed?listType=search&list=Flutter+Kicks",resources:[{label:"Flutter kicks technique",url:"https://example.com/flutter-kicks/technique"},{label:"Core endurance workouts",url:"https://example.com/flutter-kicks/endurance"},{label:"Protect your lower back while flutter kicking",url:"https://example.com/flutter-kicks/lower-back"}],galleryImages:["/images/fitbuddyai_head.png"],imageCaptions:["Flutter kicks supine"],difficulty:"Moderate",duration:"1-3 min",exampleNote:"Keep core tight and lower back pressed to the floor while performing small kicking motions.",meta:{exercise:"Core / Abs / Hip Flexors",movement:"Push -- Sagittal Flexion/Stability",equipment:"Bodyweight",trainingType:"Endurance / Hypertrophy / Balance-Stability",planeOfMotion:"Sagittal",description:"Lie flat on your back with legs extended, hands under hips for support. Lift legs a few inches and alternate small kicks while keeping the core engaged."}},"Leg Raises":{images:["/images/fitbuddyai_head.png"],video:"https://www.youtube.com/embed/2XcmRr0Vj3I",featuredVideo:!0,resources:[{label:"Penn State Health: How to do leg raises",url:"https://www.pennstatehealth.org/health-a-to-z/leg-raises"},{label:"Nuffield Health: Straight leg raise technique",url:"https://www.nuffieldhealth.com/article/how-to-do-a-straight-leg-raise"},{label:"Video: Lying Leg Raises (YouTube)",url:"https://www.youtube.com/watch?v=2XcmRr0Vj3I"}],galleryImages:["/images/fitbuddyai_head.png"],imageCaptions:["Leg raise - controlled descent"],difficulty:"Moderate",duration:"5-10 min",exampleNote:"Keep legs straight and lift toward the ceiling, lowering with control.",meta:{exercise:"Core / Abs / Hip Flexors",movement:"Push -- Sagittal Flexion",equipment:"Bodyweight",trainingType:"Endurance / Hypertrophy",planeOfMotion:"Sagittal",description:"Lie flat with legs extended and hands under hips. Slowly lift legs toward ceiling, then lower with control while maintaining tension in the abs."}},"Elbow Plank":{images:["/images/we09532.png"],video:"https://www.youtube.com/embed?listType=search&list=Elbow+Plank",resources:[{label:"Plank form and variations",url:"https://example.com/elbow-plank/form"},{label:"Plank progressions for endurance",url:"https://example.com/elbow-plank/progressions"},{label:"Shoulder and core stability tips",url:"https://example.com/elbow-plank/stability"}],galleryImages:["/images/we09532.png"],imageCaptions:["Elbow plank alignment"],difficulty:"Easy",duration:"30s-2min",exampleNote:"Form a straight line from head to heels on elbows; keep hips level and core braced.",meta:{exercise:"Core / Abs / Lower Back / Shoulders",movement:"Anti-Rotation / Stability -- Isometric Hold",equipment:"Bodyweight",trainingType:"Endurance / Balance-Stability",planeOfMotion:"Sagittal",description:"Start face down with elbows under shoulders and legs extended. Lift body into a straight line and hold while breathing evenly."}},Lunges:Cw,"High Knees":{images:["/images/fitbuddyai_head.png"],video:"https://www.youtube.com/embed?listType=search&list=High+Knees",resources:[{label:"High knees drill and form",url:"https://example.com/high-knees/drill"},{label:"Warm-up plyometrics",url:"https://example.com/high-knees/plyometrics"},{label:"Cardio interval ideas",url:"https://example.com/high-knees/cardio"}],galleryImages:["/images/fitbuddyai_head.png"],imageCaptions:["High knees sprint form"],difficulty:"Moderate",duration:"30s-3min",exampleNote:"Drive knees up rapidly while pumping opposite arm and staying light on the feet.",meta:{exercise:"Lower Body / Quads / Hamstrings / Glutes / Calves / Core Stabilizers",movement:"Running/Carry -- Sagittal",equipment:"Bodyweight",trainingType:"Endurance / Power-Plyometrics / Balance-Stability",planeOfMotion:"Sagittal",description:"Quickly drive one knee toward the chest while pumping the opposite arm, alternating rapidly to raise heart rate."}},"Side Kicks":{images:["/images/we09532.png"],video:"https://www.youtube.com/embed?listType=search&list=Side+Kicks",resources:[{label:"Side kick mechanics",url:"https://example.com/side-kicks/mechanics"},{label:"Hip abductor strengthening",url:"https://example.com/side-kicks/hip-abductors"},{label:"Balance drills for kicks",url:"https://example.com/side-kicks/balance"}],galleryImages:["/images/we09532.png"],imageCaptions:["Side kick height"],difficulty:"Moderate",duration:"3-8 min",exampleNote:"Shift weight to one leg and lift the opposite leg to the side with control.",meta:{exercise:"Lower Body / Glutes / Hip Abductors / Quads / Core Stabilizers",movement:"Push -- Frontal",equipment:"Bodyweight",trainingType:"Strength / Hypertrophy / Balance-Stability",planeOfMotion:"Frontal",description:"Stand with feet shoulder-width apart, shift weight to one leg, lift the other leg out to the side while keeping torso upright."}},"Mountain Climbers":{images:["/images/fitbuddyai_head.png"],video:"https://www.youtube.com/embed?listType=search&list=Mountain+Climbers",resources:[{label:"Mountain climber intervals",url:"https://example.com/mountain-climbers/intervals"},{label:"Plank-to-mountain transitions",url:"https://example.com/mountain-climbers/transitions"},{label:"Core conditioning with mountain climbers",url:"https://example.com/mountain-climbers/core"}],galleryImages:["/images/fitbuddyai_head.png"],imageCaptions:["Mountain climbers quick drive"],difficulty:"Moderate",duration:"30s-2min",exampleNote:"From high plank, drive knees toward chest alternately while keeping torso stable.",meta:{exercise:"Core / Abs / Shoulders / Arms / Quads / Hip Flexors",movement:"Push -- Sagittal Dynamic Stability",equipment:"Bodyweight",trainingType:"Endurance / Power-Plyometrics / Balance-Stability",planeOfMotion:"Sagittal",description:"Start in a high plank and alternately drive knees toward chest at a steady pace while keeping hips low."}},Squats:Tw,"Donkey Kicks":{images:["/images/fitbuddyai_head.png"],video:"https://www.youtube.com/embed?listType=search&list=Donkey+Kicks",resources:[{label:"Donkey kick variations",url:"https://example.com/donkey-kicks/variations"},{label:"Glute activation exercises",url:"https://example.com/donkey-kicks/activation"},{label:"Band-assisted donkey kicks",url:"https://example.com/donkey-kicks/band"}],galleryImages:["/images/fitbuddyai_head.png"],imageCaptions:["Donkey kick top"],difficulty:"Easy",duration:"3-8 min",exampleNote:"From all fours, lift one knee to the ceiling with knee bent at 90 degrees, squeezing glutes at top.",meta:{exercise:"Lower Body / Glutes / Hamstrings / Core Stabilizers",movement:"Push -- Sagittal Hip Extension",equipment:"Bodyweight / Optional Bands",trainingType:"Strength / Hypertrophy / Balance-Stability",planeOfMotion:"Sagittal",description:"Start on all fours and lift one leg upward with knee bent at 90 degrees, squeeze glutes at the top, then lower with control."}},Bridges:Pw,"Jump Knee Tucks":{images:["/images/fitbuddyai_head.png"],video:"https://www.youtube.com/embed?listType=search&list=Jump+Knee+Tucks",resources:[{label:"Plyometric tuck jump progressions",url:"https://example.com/jump-knee-tucks/progressions"},{label:"Landing mechanics for knee tucks",url:"https://example.com/jump-knee-tucks/landing"},{label:"Plyometric conditioning",url:"https://example.com/jump-knee-tucks/conditioning"}],galleryImages:["/images/fitbuddyai_head.png"],imageCaptions:["Tuck jump peak"],difficulty:"Hard",duration:"1-5 min",exampleNote:"Explosively jump and drive knees to chest; land softly and reset.",meta:{exercise:"Lower Body / Quads / Hamstrings / Glutes / Calves / Core Stabilizers",movement:"Squat/Lunge + Jump -- Explosive Plyometric",equipment:"Bodyweight",trainingType:"Power-Plyometrics / Endurance",planeOfMotion:"Sagittal",description:"Bend into a quarter squat, explode upward bringing knees toward chest, and land softly absorbing impact."}},"Side Leg Raises":{images:["/images/fitbuddyai_head.png"],video:"https://www.youtube.com/embed?listType=search&list=Side+Leg+Raises",resources:[{label:"Side leg raise technique",url:"https://example.com/side-leg-raises/technique"},{label:"Glute med strengthening routine",url:"https://example.com/side-leg-raises/routine"},{label:"Ankle and hip mobility for side raises",url:"https://example.com/side-leg-raises/mobility"}],galleryImages:["/images/fitbuddyai_head.png"],imageCaptions:["Side leg raise top"],difficulty:"Easy",duration:"3-8 min",exampleNote:"Lie on your side and lift the top leg with control, keeping hips stacked.",meta:{exercise:"Lower Body / Glutes / Hip Abductors / Core Stabilizers",movement:"Push -- Frontal Hip Abduction",equipment:"Bodyweight / Optional Bands",trainingType:"Strength / Balance-Stability",planeOfMotion:"Frontal",description:"Lie on your side and lift the top leg upward while keeping your hips stacked and torso stable."}},"Close-Grip Push-ups":{images:["/images/we09532.png"],video:"https://www.youtube.com/embed?listType=search&list=Close-Grip+Push-ups",resources:[{label:"Close-grip push-up form",url:"https://example.com/close-grip-pushups/form"},{label:"Triceps-focused bodyweight work",url:"https://example.com/close-grip-pushups/triceps"},{label:"Progressions for stronger push-ups",url:"https://example.com/close-grip-pushups/progressions"}],galleryImages:["/images/we09532.png"],imageCaptions:["Close-grip push-up finish"],difficulty:"Moderate",duration:"5-12 min",exampleNote:"Hands close under shoulders; lower chest while keeping elbows tucked to emphasize triceps.",meta:{exercise:"Upper Body / Chest / Triceps / Shoulders / Core Stabilizers",movement:"Push -- Horizontal",equipment:"Bodyweight",trainingType:"Strength / Hypertrophy / Endurance",planeOfMotion:"Sagittal",description:"From a push-up position, place hands closer than shoulder width and lower chest while keeping elbows near the ribs."}},Punches:Aw,"Pseudo Planche":{images:["/images/fitbuddyai_head.png"],video:"https://www.youtube.com/embed?listType=search&list=Pseudo+Planche",resources:[{label:"Pseudo planche progressions",url:"https://example.com/pseudo-planche/progressions"},{label:"Wrist and shoulder prep for planche",url:"https://example.com/pseudo-planche/prep"},{label:"Advanced bodyweight skills programming",url:"https://example.com/pseudo-planche/program"}],galleryImages:["/images/fitbuddyai_head.png"],imageCaptions:["Pseudo planche lean"],difficulty:"Hard",duration:"Varies",exampleNote:"Lean shoulders forward in push-up position to increase horizontal load on shoulders and core.",meta:{exercise:"Upper Body / Chest / Triceps / Shoulders / Core Stabilizers",movement:"Push -- Horizontal with Forward Lean",equipment:"Bodyweight",trainingType:"Strength / Hypertrophy / Balance-Stability / Power (advanced variations)",planeOfMotion:"Sagittal",description:"From a push-up position, place hands lower toward hips and lean shoulders forward to increase load on the shoulders and core."}},"Sitting Pull-ups":{images:["/images/we09532.png"],video:"https://www.youtube.com/embed?listType=search&list=Sitting+Pull-ups",resources:[{label:"Assisted pull-up options",url:"https://example.com/sitting-pullups/assisted"},{label:"Seated pull mechanics",url:"https://example.com/sitting-pullups/mechanics"},{label:"Upper back strengthening",url:"https://example.com/sitting-pullups/upper-back"}],galleryImages:["/images/we09532.png"],imageCaptions:["Sitting pull-up setup"],difficulty:"Moderate",duration:"Varies",exampleNote:"Sit under a bar or rings and pull chest toward the bar using the back and arms. Focus on technique over momentum.",meta:{exercise:"Upper Body / Back / Biceps / Forearms / Shoulders / Core Stabilizers",movement:"Pull -- Vertical",equipment:"Bodyweight / Suspension Trainer / Bar / Rings",trainingType:"Strength / Hypertrophy / Endurance",planeOfMotion:"Sagittal",description:"Sit or use an assisted setup to pull the chest toward a bar, focusing on scapular retraction and elbow drive."}},"Doorframe Rows":{images:["/images/fitbuddyai_head.png"],video:"https://www.youtube.com/embed?listType=search&list=Doorframe+Rows",resources:[{label:"Doorframe row setup and safety",url:"https://example.com/doorframe-rows/setup"},{label:"Horizontal pulling programming",url:"https://example.com/doorframe-rows/programming"},{label:"Grip and wrist considerations",url:"https://example.com/doorframe-rows/grip"}],galleryImages:["/images/fitbuddyai_head.png"],imageCaptions:["Doorframe row body angle"],difficulty:"Easy",duration:"5-12 min",exampleNote:"Grip the doorframe and lean back, pulling the chest toward the frame while keeping the body straight.",meta:{exercise:"Upper Body / Back / Biceps / Forearms / Shoulders / Core Stabilizers",movement:"Pull -- Horizontal",equipment:"Bodyweight / Doorframe or Sturdy Support",trainingType:"Strength / Endurance / Balance-Stability",planeOfMotion:"Sagittal",description:"Stand facing an open door, grip the frame, and lean back. Pull your chest toward the frame using back muscles and squeeze shoulder blades."}},"Scapular Shrugs":{images:["/images/fitbuddyai_head.png"],video:"https://www.youtube.com/embed?listType=search&list=Scapular+Shrugs",resources:[{label:"Scapular control drills",url:"https://example.com/scapular-shrugs/drills"},{label:"Shoulder health routines",url:"https://example.com/scapular-shrugs/shoulder-health"},{label:"Band-based scapular work",url:"https://example.com/scapular-shrugs/bands"}],galleryImages:["/images/fitbuddyai_head.png"],imageCaptions:["Scapular shrug small range"],difficulty:"Easy",duration:"2-6 min",exampleNote:"From a hang, pull shoulder blades down and together without bending elbows to create a small upward movement.",meta:{exercise:"Upper Body / Back / Trapezius / Rhomboids / Lats / Shoulders / Core Stabilizers",movement:"Pull -- Vertical Scapular Depression/Elevation",equipment:"Bodyweight / Pull-Up Bar",trainingType:"Strength / Hypertrophy / Balance-Stability",planeOfMotion:"Sagittal",description:"Hang from a bar and pull shoulder blades down and together to produce a slight lift, focusing on scapular control."}},Superman:Ow,"Back Lifts":{images:["/images/fitbuddyai_head.png"],video:"https://www.youtube.com/embed?listType=search&list=Back+Lifts",resources:[{label:"Back lift variations",url:"https://example.com/back-lifts/variations"},{label:"Safe tempo for back lifts",url:"https://example.com/back-lifts/tempo"},{label:"Lower back strengthening plans",url:"https://example.com/back-lifts/plans"}],galleryImages:["/images/fitbuddyai_head.png"],imageCaptions:["Back lift top"],difficulty:"Moderate",duration:"5-12 min",exampleNote:"Lift torso using lower back and glutes; avoid jerky motions.",meta:{exercise:"Core / Lower Back / Glutes / Hamstrings",movement:"Extension -- Hip Hinge",equipment:"Bodyweight / Roman Chair / Stability Ball",trainingType:"Strength / Hypertrophy",planeOfMotion:"Sagittal",description:"Perform controlled back extensions focusing on hip hinge mechanics and lower back engagement."}},"Alternative Arm Leg Plank":{images:["/images/fitbuddyai_head.png"],video:"https://www.youtube.com/embed?listType=search&list=Arm+Leg+Plank",resources:[{label:"Arm/leg plank progressions",url:"https://example.com/arm-leg-plank/progressions"},{label:"Anti-rotation core drills",url:"https://example.com/arm-leg-plank/anti-rotation"},{label:"Plank stability programming",url:"https://example.com/arm-leg-plank/program"}],galleryImages:["/images/fitbuddyai_head.png"],imageCaptions:["Arm-leg plank balance"],difficulty:"Moderate",duration:"30s-2min",exampleNote:"Lift opposite arm and leg while maintaining a straight plank line and steady breathing.",meta:{exercise:"Core / Abs / Lower Back / Shoulders / Glutes",movement:"Anti-Rotation / Stability -- Isometric Hold with Alternating Lift",equipment:"Bodyweight",trainingType:"Endurance / Balance-Stability",planeOfMotion:"Sagittal with Transverse Stability Demand",description:"From a plank position, lift one arm and the opposite leg while keeping hips level and core braced."}},"Push-ups":{images:["/images/we09532.png"],video:"https://www.youtube.com/embed?listType=search&list=Push-ups",resources:[{label:"Push-up form checklist",url:"https://example.com/push-ups/form"},{label:"Push-up progressions and regressions",url:"https://example.com/push-ups/progressions"},{label:"Programming push-ups for strength",url:"https://example.com/push-ups/programming"}],galleryImages:["/images/we09532.png"],imageCaptions:["Standard push-up finish"],difficulty:"Moderate",duration:"5-15 min",exampleNote:"Keep body straight and lower chest to floor, then push back up using chest and triceps.",meta:{exercise:"Upper Body / Chest / Triceps / Shoulders / Core Stabilizers",movement:"Push -- Horizontal",equipment:"Bodyweight",trainingType:"Strength / Hypertrophy / Endurance",planeOfMotion:"Sagittal",description:"From a high plank, lower chest toward floor and press back up, keeping core engaged."}},"Chest Expansions":{images:["/images/fitbuddyai_head.png"],video:"https://www.youtube.com/embed?listType=search&list=Chest+Expansions",resources:[{label:"Chest expansion mobility sequence",url:"https://example.com/chest-expansions/mobility"},{label:"Band-assisted chest opens",url:"https://example.com/chest-expansions/band"},{label:"Upper body flexibility routine",url:"https://example.com/chest-expansions/flexibility"}],galleryImages:["/images/fitbuddyai_head.png"],imageCaptions:["Chest expansion range"],difficulty:"Easy",duration:"3-8 min",exampleNote:"Open the arms wide and squeeze shoulder blades together; focus on posture and range of motion.",meta:{exercise:"Upper Body / Chest / Shoulders / Upper Back / Arms",movement:"Push -- Horizontal Abduction/Adduction",equipment:"Bodyweight / Bands",trainingType:"Endurance / Mobility-Flexibility",planeOfMotion:"Frontal",description:"Extend arms forward and open wide to stretch and mobilize the chest and shoulders."}},"Chest Squeezes":{images:["/images/fitbuddyai_head.png"],video:"https://www.youtube.com/embed?listType=search&list=Chest+Squeezes",resources:[{label:"Chest squeeze variations",url:"https://example.com/chest-squeezes/variations"},{label:"Medicine ball chest squeeze",url:"https://example.com/chest-squeezes/medicine-ball"},{label:"Isometric chest work for posture",url:"https://example.com/chest-squeezes/isometrics"}],galleryImages:["/images/fitbuddyai_head.png"],imageCaptions:["Chest squeeze hold"],difficulty:"Easy",duration:"2-6 min",exampleNote:"Press hands or an object together in front of chest to contract chest muscles.",meta:{exercise:"Upper Body / Chest / Shoulders / Arms",movement:"Push -- Horizontal Adduction/Isometric Hold",equipment:"Bodyweight / Bands / Dumbbell / Medicine Ball",trainingType:"Endurance / Mobility-Flexibility",planeOfMotion:"Frontal",description:"Squeeze hands or an object toward the midline to contract chest muscles and improve posture."}},"Pike Push-ups":{images:["/images/fitbuddyai_head.png"],video:"https://www.youtube.com/embed?listType=search&list=Pike+Push-ups",resources:[{label:"Pike push-up progression",url:"https://example.com/pike-pushups/progression"},{label:"Shoulder press alternatives",url:"https://example.com/pike-pushups/alternatives"},{label:"Inverted push-up technique",url:"https://example.com/pike-pushups/inverted"}],galleryImages:["/images/fitbuddyai_head.png"],imageCaptions:["Pike push-up peak"],difficulty:"Hard",duration:"Varies",exampleNote:"Walk feet toward hands to create a pike position and lower head toward the floor using shoulders.",meta:{exercise:"Upper Body / Shoulders / Triceps / Chest / Core Stabilizers",movement:"Push -- Vertical Press Variation",equipment:"Bodyweight",trainingType:"Strength / Hypertrophy / Endurance",planeOfMotion:"Sagittal",description:"Assume a pike (inverted V) position and lower the top of the head toward the floor, pressing back up to start."}},"Shoulder Taps":{images:["/images/fitbuddyai_head.png"],video:"https://www.youtube.com/embed?listType=search&list=Shoulder+Taps",resources:[{label:"Shoulder tap stability drill",url:"https://example.com/shoulder-taps/drill"},{label:"Anti-rotation core work",url:"https://example.com/shoulder-taps/anti-rotation"},{label:"Progressions for single-arm stability",url:"https://example.com/shoulder-taps/progressions"}],galleryImages:["/images/fitbuddyai_head.png"],imageCaptions:["Shoulder tap balance"],difficulty:"Easy",duration:"1-5 min",exampleNote:"From plank, lift one hand to tap the opposite shoulder while keeping hips square and body stable.",meta:{exercise:"Upper Body / Shoulders / Triceps / Chest / Core Stabilizers",movement:"Anti-Rotation / Stability -- Isometric Hold with Alternating Lift",equipment:"Bodyweight",trainingType:"Endurance / Balance-Stability / Strength",planeOfMotion:"Sagittal",description:"Maintain a stable plank while alternately tapping opposite shoulders with controlled motion."}},"Clapping Push-ups":{images:["/images/fitbuddyai_head.png"],video:"https://www.youtube.com/embed?listType=search&list=Clapping+Push-ups",resources:[{label:"Plyometric push-up progressions",url:"https://example.com/clapping-pushups/progressions"},{label:"Safe landing mechanics for plyo",url:"https://example.com/clapping-pushups/landing"},{label:"Upper body power drills",url:"https://example.com/clapping-pushups/power"}],galleryImages:["/images/fitbuddyai_head.png"],imageCaptions:["Clap push-up explosion"],difficulty:"Hard",duration:"Varies",exampleNote:"Explode off the ground and clap hands before returning to push-up position; land softly.",meta:{exercise:"Upper Body / Chest / Triceps / Shoulders / Core Stabilizers",movement:"Push -- Horizontal Explosive",equipment:"Bodyweight",trainingType:"Power-Plyometrics / Strength / Hypertrophy",planeOfMotion:"Sagittal",description:"Perform an explosive push-up so hands leave the ground, clap, and land in a controlled manner."}},"Cable Woodchop":{images:["/images/fitbuddyai_head.png"],video:"https://www.youtube.com/embed?listType=search&list=Cable+Woodchop",resources:[{label:"Cable woodchop technique",url:"https://example.com/cable-woodchop/technique"},{label:"Rotational core programming",url:"https://example.com/cable-woodchop/programming"},{label:"Anti-rotation vs rotation training",url:"https://example.com/cable-woodchop/rotation"}],galleryImages:["/images/fitbuddyai_head.png"],imageCaptions:["Cable woodchop finish"],difficulty:"Moderate",duration:"5-12 min",exampleNote:"Pull a handle diagonally across the body using torso rotation; control the return.",meta:{exercise:"Core / Abs / Obliques / Shoulders / Back Stabilizers",movement:"Rotation -- Transverse",equipment:"Cables / Bands",trainingType:"Strength / Hypertrophy / Endurance / Balance-Stability",planeOfMotion:"Transverse",description:"Attach a handle high on a cable and pull diagonally across the body while rotating the torso, then return smoothly."}},"Hanging Leg Raises":{images:["/images/fitbuddyai_head.png"],video:"https://www.youtube.com/embed?listType=search&list=Hanging+Leg+Raises",resources:[{label:"Hanging leg raise progressions",url:"https://example.com/hanging-leg-raises/progressions"},{label:"Grip endurance tips",url:"https://example.com/hanging-leg-raises/grip"},{label:"Core-to-hip flexor coordination drills",url:"https://example.com/hanging-leg-raises/coordination"}],galleryImages:["/images/fitbuddyai_head.png"],imageCaptions:["Hanging leg raise top"],difficulty:"Hard",duration:"Varies",exampleNote:"Hang from a bar and raise legs toward parallel while keeping control and avoiding swing.",meta:{exercise:"Core / Abs / Hip Flexors",movement:"Push -- Sagittal Flexion",equipment:"Bodyweight / Pull-Up Bar",trainingType:"Strength / Hypertrophy",planeOfMotion:"Sagittal",description:"Hang from a bar and lift legs upward while maintaining a controlled motion and braced core."}},"Crunch Machine":{images:["/images/fitbuddyai_head.png"],video:"https://www.youtube.com/embed?listType=search&list=Crunch+Machine",resources:[{label:"Using the crunch machine safely",url:"https://example.com/crunch-machine/safety"},{label:"Machine-based core workouts",url:"https://example.com/crunch-machine/workouts"},{label:"Adjusting machine settings for form",url:"https://example.com/crunch-machine/settings"}],galleryImages:["/images/fitbuddyai_head.png"],imageCaptions:["Crunch machine setup"],difficulty:"Easy",duration:"5-12 min",exampleNote:"Use a crunch machine to perform controlled spinal flexion focusing on the abs.",meta:{exercise:"Core / Abs / Obliques  secondary",movement:"Push -- Sagittal Flexion",equipment:"Machine",trainingType:"Strength / Hypertrophy / Endurance",planeOfMotion:"Sagittal",description:"Sit in the crunch machine and curl the torso forward under control, keeping tension in the abs."}},"Cable Crunch":{images:["/images/fitbuddyai_head.png"],video:"https://www.youtube.com/embed?listType=search&list=Cable+Crunch",resources:[{label:"Cable crunch form and setup",url:"https://example.com/cable-crunch/form"},{label:"Rope attachment best practices",url:"https://example.com/cable-crunch/rope"},{label:"Core strength progressions",url:"https://example.com/cable-crunch/progressions"}],galleryImages:["/images/fitbuddyai_head.png"],imageCaptions:["Cable crunch finish"],difficulty:"Moderate",duration:"5-12 min",exampleNote:"Attach a rope to a high pulley and curl the torso down while keeping hips stable.",meta:{exercise:"Core / Abs / Obliques  secondary",movement:"Push -- Sagittal Flexion",equipment:"Cables / Rope Attachment",trainingType:"Strength / Hypertrophy / Endurance",planeOfMotion:"Sagittal",description:"Kneel in front of a high pulley and pull the rope down with core contraction to flex the spine."}},"Rotary Torso Machine":{images:["/images/fitbuddyai_head.png"],video:"https://www.youtube.com/embed?listType=search&list=Rotary+Torso+Machine",resources:[{label:"Rotary torso machine technique",url:"https://example.com/rotary-torso/technique"},{label:"Machine-based rotation programming",url:"https://example.com/rotary-torso/programming"},{label:"Comparing rotational tools",url:"https://example.com/rotary-torso/compare"}],galleryImages:["/images/fitbuddyai_head.png"],imageCaptions:["Rotary torso setup"],difficulty:"Easy",duration:"5-10 min",exampleNote:"Use the rotary torso machine to rotate the torso slowly and with control.",meta:{exercise:"Core / Abs / Obliques / Lower Back Stabilizers",movement:"Rotation -- Transverse",equipment:"Machine",trainingType:"Strength / Hypertrophy / Endurance",planeOfMotion:"Transverse",description:"Use a rotary torso machine to perform controlled rotations, focusing on controlled movement and posture."}},"Leg Press Machine":{images:["/images/fitbuddyai_head.png"],video:"https://www.youtube.com/embed?listType=search&list=Leg+Press+Machine",resources:[{label:"Leg press setup and foot placement",url:"https://example.com/leg-press/setup"},{label:"Programming leg press for hypertrophy",url:"https://example.com/leg-press/programming"},{label:"Knee and hip safety on leg press",url:"https://example.com/leg-press/safety"}],galleryImages:["/images/fitbuddyai_head.png"],imageCaptions:["Leg press foot placement"],difficulty:"Moderate",duration:"Varies",exampleNote:"Place feet on platform and press while keeping lower back against the seat; control range of motion.",meta:{exercise:"Lower Body / Quads / Glutes / Hamstrings / Calves",movement:"Squat/Lunge -- Sagittal",equipment:"Machine  Leg Press",trainingType:"Strength / Hypertrophy / Endurance",planeOfMotion:"Sagittal",description:"Use the leg press machine to push the platform under control, focusing on foot placement and knee tracking."}},"Weighted Lunges":{images:["/images/fitbuddyai_head.png"],video:"https://www.youtube.com/embed?listType=search&list=Weighted+Lunges",resources:[{label:"Weighted lunge variations",url:"https://example.com/weighted-lunges/variations"},{label:"Programming lunges for mass",url:"https://example.com/weighted-lunges/programming"},{label:"Lunge safety with weights",url:"https://example.com/weighted-lunges/safety"}],galleryImages:["/images/fitbuddyai_head.png"],imageCaptions:["Weighted lunge stance"],difficulty:"Moderate",duration:"8-20 min",exampleNote:"Step forward with weight and lower into a controlled lunge, keeping torso upright and pushing through the front heel.",meta:{exercise:"Lower Body / Quads / Glutes / Hamstrings / Calves / Core Stabilizers",movement:"Squat/Lunge -- Sagittal",equipment:"Free Weights  Dumbbells / Barbells / Kettlebells",trainingType:"Strength / Hypertrophy / Endurance",planeOfMotion:"Sagittal",description:"Perform lunges while holding weight, focusing on balance, knee tracking, and controlled movement."}}},Iw=({name:s,exercise:r,onClose:n})=>{const o=fu[s]||fu.Default||{},l=r?{...o,...r}:o,c={images:l.images||[],galleryImages:l.galleryImages||[],imageCaptions:l.imageCaptions||[],video:l.video||"",featuredVideo:l.featuredVideo||!1,resources:Array.isArray(l.resources)?l.resources:[],difficulty:l.difficulty||"",duration:l.duration||"",exampleNote:l.exampleNote||"",meta:l.meta||{}},d=r&&r.muscleGroups&&r.muscleGroups.length?r.muscleGroups.join(", "):c.meta?.muscleGroups&&c.meta.muscleGroups.length?c.meta.muscleGroups.join(", "):l.muscleGroups&&l.muscleGroups.join?l.muscleGroups.join(", "):"",p=r&&(r.sets||r.reps)?r.sets?`${r.sets} sets  ${r.reps||""}`:`${r.reps} reps`:c.sets&&c.reps?`${c.sets} sets  ${c.reps}`:c.meta?.reps?`${c.meta.reps} reps`:null,f=p?p.toString().toLowerCase().endsWith("reps")?p:`${p} reps`:null;return a.jsx("div",{className:"exercise-modal-overlay",onClick:n,children:a.jsxs("div",{className:"exercise-detail-modal",onClick:g=>g.stopPropagation(),role:"dialog","aria-label":`${s} details`,children:[a.jsxs("div",{className:"exercise-detail-header",children:[a.jsxs("div",{className:"header-left",children:[a.jsx("div",{className:"illustration","aria-hidden":!0,children:a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"8",rx:"2",fill:"#F3FBF6"}),a.jsx("path",{d:"M7 11V8a3 3 0 0 1 3-3h4",stroke:"#2EB06A",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("circle",{cx:"17",cy:"6",r:"1.6",fill:"#2EB06A"})]})}),a.jsxs("div",{className:"title-block",children:[a.jsxs("div",{className:"title-text",children:[a.jsx("h3",{children:s}),a.jsxs("div",{className:"tag-row",children:[(()=>{const y=((r&&r.difficulty?r.difficulty:c.difficulty||"")||"").toString().toLowerCase().trim();let x="Unknown",b="unknown";return y.includes("easy")||y.includes("beginner")?(x="Beginner",b="beginner"):y.includes("moder")||y.includes("inter")||y.includes("medium")||y.includes("intermediate")?(x="Intermediate",b="intermediate"):y.includes("hard")||y.includes("adv")||y.includes("advanced")?(x="Advanced",b="advanced"):y&&(x=y.charAt(0).toUpperCase()+y.slice(1),b=y.replace(/\s+/g,"-")),a.jsx("span",{className:`tag tag-difficulty tag-${b}`,children:x})})(),a.jsxs("span",{className:"meta-pill duration",children:[a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-clock",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("polyline",{points:"12 6 12 12 16 14"})]}),c.duration||""]}),f?a.jsxs("span",{className:"meta-pill reps",children:[a.jsx(Et,{size:14}),f]}):null,a.jsxs("span",{className:"meta-pill target",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-zap",children:a.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})}),d]})]})]}),a.jsx("div",{className:"header-subinfo","aria-hidden":!0})]})]}),a.jsx("button",{className:"close-btn",onClick:n,"aria-label":"Close",children:a.jsx(pi,{size:18})})]}),a.jsxs("div",{className:"exercise-body",children:[a.jsx("div",{className:"hero-media",children:c.video?a.jsx("div",{className:"hero-video",children:a.jsx("iframe",{src:c.video,title:`${s} video`,frameBorder:"0",allowFullScreen:!0})}):a.jsx("div",{className:"hero-placeholder",children:a.jsx("svg",{width:"96",height:"64",viewBox:"0 0 96 64",fill:"none",children:a.jsx("rect",{width:"96",height:"64",rx:"8",fill:"#F3FBF6"})})})}),a.jsxs("div",{className:"meta-grid",children:[a.jsxs("div",{className:"meta-item",children:[a.jsx("div",{className:"meta-icon",children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:a.jsx("path",{d:"M12 2v20",stroke:"#4CAF50",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})}),a.jsxs("div",{className:"meta-content",children:[a.jsx("div",{className:"meta-label",children:"Exercise"}),a.jsx("div",{className:"meta-value",children:c.meta?.exercise||""})]})]}),a.jsxs("div",{className:"meta-item",children:[a.jsx("div",{className:"meta-icon",children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:a.jsx("path",{d:"M4 12h16",stroke:"#1E90CB",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})}),a.jsxs("div",{className:"meta-content",children:[a.jsx("div",{className:"meta-label",children:"Movement"}),a.jsx("div",{className:"meta-value",children:c.meta?.movement||""})]})]}),a.jsxs("div",{className:"meta-item",children:[a.jsx("div",{className:"meta-icon",children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:a.jsx("rect",{x:"3",y:"6",width:"18",height:"12",rx:"2",stroke:"#FF9600",strokeWidth:"1.2"})})}),a.jsxs("div",{className:"meta-content",children:[a.jsx("div",{className:"meta-label",children:"Equipment"}),a.jsx("div",{className:"meta-value",children:c.meta?.equipment||""})]})]}),a.jsxs("div",{className:"meta-item",children:[a.jsx("div",{className:"meta-icon",children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:a.jsx("path",{d:"M12 20V4",stroke:"#6A5ACD",strokeWidth:"1.2",strokeLinecap:"round"})})}),a.jsxs("div",{className:"meta-content",children:[a.jsx("div",{className:"meta-label",children:"Type of Training"}),a.jsx("div",{className:"meta-value",children:c.meta?.trainingType||""})]})]}),a.jsxs("div",{className:"meta-item",children:[a.jsx("div",{className:"meta-icon",children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:a.jsx("circle",{cx:"12",cy:"12",r:"8",stroke:"#2E8B57",strokeWidth:"1.2"})})}),a.jsxs("div",{className:"meta-content",children:[a.jsx("div",{className:"meta-label",children:"Plane of Motion"}),a.jsx("div",{className:"meta-value",children:c.meta?.planeOfMotion||""})]})]})]}),a.jsxs("div",{className:"description",children:[a.jsx("div",{className:"desc-label",children:"Description"}),a.jsx("div",{className:"desc-text",children:c.meta?.description||c.exampleNote||"No description available."})]}),a.jsx("div",{className:"image-gallery",children:(c.galleryImages&&c.galleryImages.length?c.galleryImages:c.images||[]).slice(0,2).map((g,y)=>a.jsxs("figure",{className:"gallery-item",children:[a.jsx("img",{src:g,alt:`${s} image ${y+1}`}),a.jsx("figcaption",{children:c.imageCaptions&&c.imageCaptions[y]||c.resources?.[y]?.label||""})]},y))}),a.jsx("div",{className:"section-divider"}),a.jsxs("div",{className:"meta-resources",children:[a.jsx("h4",{children:"Resources"}),a.jsx("div",{className:"resource-cards",children:c.resources.map((g,y)=>a.jsxs("div",{className:"resource-card",children:[a.jsxs("div",{className:"resource-card-left",children:[a.jsx("div",{className:"resource-icon",children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:a.jsx("rect",{x:"3",y:"6",width:"18",height:"12",rx:"2",stroke:"currentColor",strokeWidth:"1.4"})})}),a.jsxs("div",{className:"resource-body",children:[a.jsx("div",{className:"resource-title",children:g.label}),a.jsx("div",{className:"resource-caption",children:g.caption||""})]})]}),a.jsx("div",{className:"resource-actions",children:a.jsx("a",{className:`resource-btn btn btn-primary ${y%2===0?"green":"blue"}`,href:g.url,target:"_blank",rel:"noreferrer",children:"Open"})})]},y))})]})]})]})})};var vi={};(function s(r,n,o,l){var c=!!(r.Worker&&r.Blob&&r.Promise&&r.OffscreenCanvas&&r.OffscreenCanvasRenderingContext2D&&r.HTMLCanvasElement&&r.HTMLCanvasElement.prototype.transferControlToOffscreen&&r.URL&&r.URL.createObjectURL),d=typeof Path2D=="function"&&typeof DOMMatrix=="function",p=function(){if(!r.OffscreenCanvas)return!1;var C=new OffscreenCanvas(1,1),w=C.getContext("2d");w.fillRect(0,0,1,1);var L=C.transferToImageBitmap();try{w.createPattern(L,"no-repeat")}catch{return!1}return!0}();function f(){}function g(C){var w=n.exports.Promise,L=w!==void 0?w:r.Promise;return typeof L=="function"?new L(C):(C(f,f),null)}var y=function(C,w){return{transform:function(L){if(C)return L;if(w.has(L))return w.get(L);var Y=new OffscreenCanvas(L.width,L.height),ne=Y.getContext("2d");return ne.drawImage(L,0,0),w.set(L,Y),Y},clear:function(){w.clear()}}}(p,new Map),x=function(){var C=Math.floor(16.666666666666668),w,L,Y={},ne=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(w=function(ee){var ye=Math.random();return Y[ye]=requestAnimationFrame(function se(ve){ne===ve||ne+C-1<ve?(ne=ve,delete Y[ye],ee()):Y[ye]=requestAnimationFrame(se)}),ye},L=function(ee){Y[ee]&&cancelAnimationFrame(Y[ee])}):(w=function(ee){return setTimeout(ee,C)},L=function(ee){return clearTimeout(ee)}),{frame:w,cancel:L}}(),b=function(){var C,w,L={};function Y(ne){function ee(ye,se){ne.postMessage({options:ye||{},callback:se})}ne.init=function(se){var ve=se.transferControlToOffscreen();ne.postMessage({canvas:ve},[ve])},ne.fire=function(se,ve,Ae){if(w)return ee(se,null),w;var Ie=Math.random().toString(36).slice(2);return w=g(function(Ye){function Ge(K){K.data.callback===Ie&&(delete L[Ie],ne.removeEventListener("message",Ge),w=null,y.clear(),Ae(),Ye())}ne.addEventListener("message",Ge),ee(se,Ie),L[Ie]=Ge.bind(null,{data:{callback:Ie}})}),w},ne.reset=function(){ne.postMessage({reset:!0});for(var se in L)L[se](),delete L[se]}}return function(){if(C)return C;if(!o&&c){var ne=["var CONFETTI, SIZE = {}, module = {};","("+s.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{C=new Worker(URL.createObjectURL(new Blob([ne])))}catch(ee){return typeof console!==void 0&&typeof console.warn=="function"&&console.warn(" Could not load worker",ee),null}Y(C)}return C}}(),T={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function _(C,w){return w?w(C):C}function E(C){return C!=null}function k(C,w,L){return _(C&&E(C[w])?C[w]:T[w],L)}function D(C){return C<0?0:Math.floor(C)}function O(C,w){return Math.floor(Math.random()*(w-C))+C}function R(C){return parseInt(C,16)}function M(C){return C.map(X)}function X(C){var w=String(C).replace(/[^0-9a-f]/gi,"");return w.length<6&&(w=w[0]+w[0]+w[1]+w[1]+w[2]+w[2]),{r:R(w.substring(0,2)),g:R(w.substring(2,4)),b:R(w.substring(4,6))}}function G(C){var w=k(C,"origin",Object);return w.x=k(w,"x",Number),w.y=k(w,"y",Number),w}function de(C){C.width=document.documentElement.clientWidth,C.height=document.documentElement.clientHeight}function we(C){var w=C.getBoundingClientRect();C.width=w.width,C.height=w.height}function $(C){var w=document.createElement("canvas");return w.style.position="fixed",w.style.top="0px",w.style.left="0px",w.style.pointerEvents="none",w.style.zIndex=C,w}function he(C,w,L,Y,ne,ee,ye,se,ve){C.save(),C.translate(w,L),C.rotate(ee),C.scale(Y,ne),C.arc(0,0,1,ye,se,ve),C.restore()}function oe(C){var w=C.angle*(Math.PI/180),L=C.spread*(Math.PI/180);return{x:C.x,y:C.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:C.startVelocity*.5+Math.random()*C.startVelocity,angle2D:-w+(.5*L-Math.random()*L),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:C.color,shape:C.shape,tick:0,totalTicks:C.ticks,decay:C.decay,drift:C.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:C.gravity*3,ovalScalar:.6,scalar:C.scalar,flat:C.flat}}function re(C,w){w.x+=Math.cos(w.angle2D)*w.velocity+w.drift,w.y+=Math.sin(w.angle2D)*w.velocity+w.gravity,w.velocity*=w.decay,w.flat?(w.wobble=0,w.wobbleX=w.x+10*w.scalar,w.wobbleY=w.y+10*w.scalar,w.tiltSin=0,w.tiltCos=0,w.random=1):(w.wobble+=w.wobbleSpeed,w.wobbleX=w.x+10*w.scalar*Math.cos(w.wobble),w.wobbleY=w.y+10*w.scalar*Math.sin(w.wobble),w.tiltAngle+=.1,w.tiltSin=Math.sin(w.tiltAngle),w.tiltCos=Math.cos(w.tiltAngle),w.random=Math.random()+2);var L=w.tick++/w.totalTicks,Y=w.x+w.random*w.tiltCos,ne=w.y+w.random*w.tiltSin,ee=w.wobbleX+w.random*w.tiltCos,ye=w.wobbleY+w.random*w.tiltSin;if(C.fillStyle="rgba("+w.color.r+", "+w.color.g+", "+w.color.b+", "+(1-L)+")",C.beginPath(),d&&w.shape.type==="path"&&typeof w.shape.path=="string"&&Array.isArray(w.shape.matrix))C.fill(H(w.shape.path,w.shape.matrix,w.x,w.y,Math.abs(ee-Y)*.1,Math.abs(ye-ne)*.1,Math.PI/10*w.wobble));else if(w.shape.type==="bitmap"){var se=Math.PI/10*w.wobble,ve=Math.abs(ee-Y)*.1,Ae=Math.abs(ye-ne)*.1,Ie=w.shape.bitmap.width*w.scalar,Ye=w.shape.bitmap.height*w.scalar,Ge=new DOMMatrix([Math.cos(se)*ve,Math.sin(se)*ve,-Math.sin(se)*Ae,Math.cos(se)*Ae,w.x,w.y]);Ge.multiplySelf(new DOMMatrix(w.shape.matrix));var K=C.createPattern(y.transform(w.shape.bitmap),"no-repeat");K.setTransform(Ge),C.globalAlpha=1-L,C.fillStyle=K,C.fillRect(w.x-Ie/2,w.y-Ye/2,Ie,Ye),C.globalAlpha=1}else if(w.shape==="circle")C.ellipse?C.ellipse(w.x,w.y,Math.abs(ee-Y)*w.ovalScalar,Math.abs(ye-ne)*w.ovalScalar,Math.PI/10*w.wobble,0,2*Math.PI):he(C,w.x,w.y,Math.abs(ee-Y)*w.ovalScalar,Math.abs(ye-ne)*w.ovalScalar,Math.PI/10*w.wobble,0,2*Math.PI);else if(w.shape==="star")for(var te=Math.PI/2*3,Se=4*w.scalar,I=8*w.scalar,B=w.x,Ne=w.y,Le=5,be=Math.PI/Le;Le--;)B=w.x+Math.cos(te)*I,Ne=w.y+Math.sin(te)*I,C.lineTo(B,Ne),te+=be,B=w.x+Math.cos(te)*Se,Ne=w.y+Math.sin(te)*Se,C.lineTo(B,Ne),te+=be;else C.moveTo(Math.floor(w.x),Math.floor(w.y)),C.lineTo(Math.floor(w.wobbleX),Math.floor(ne)),C.lineTo(Math.floor(ee),Math.floor(ye)),C.lineTo(Math.floor(Y),Math.floor(w.wobbleY));return C.closePath(),C.fill(),w.tick<w.totalTicks}function le(C,w,L,Y,ne){var ee=w.slice(),ye=C.getContext("2d"),se,ve,Ae=g(function(Ie){function Ye(){se=ve=null,ye.clearRect(0,0,Y.width,Y.height),y.clear(),ne(),Ie()}function Ge(){o&&!(Y.width===l.width&&Y.height===l.height)&&(Y.width=C.width=l.width,Y.height=C.height=l.height),!Y.width&&!Y.height&&(L(C),Y.width=C.width,Y.height=C.height),ye.clearRect(0,0,Y.width,Y.height),ee=ee.filter(function(K){return re(ye,K)}),ee.length?se=x.frame(Ge):Ye()}se=x.frame(Ge),ve=Ye});return{addFettis:function(Ie){return ee=ee.concat(Ie),Ae},canvas:C,promise:Ae,reset:function(){se&&x.cancel(se),ve&&ve()}}}function J(C,w){var L=!C,Y=!!k(w||{},"resize"),ne=!1,ee=k(w,"disableForReducedMotion",Boolean),ye=c&&!!k(w||{},"useWorker"),se=ye?b():null,ve=L?de:we,Ae=C&&se?!!C.__confetti_initialized:!1,Ie=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,Ye;function Ge(te,Se,I){for(var B=k(te,"particleCount",D),Ne=k(te,"angle",Number),Le=k(te,"spread",Number),be=k(te,"startVelocity",Number),Fe=k(te,"decay",Number),ze=k(te,"gravity",Number),$e=k(te,"drift",Number),Ke=k(te,"colors",M),mt=k(te,"ticks",Number),gt=k(te,"shapes"),ht=k(te,"scalar"),jt=!!k(te,"flat"),bt=G(te),Ft=B,Ht=[],gr=C.width*bt.x,Dt=C.height*bt.y;Ft--;)Ht.push(oe({x:gr,y:Dt,angle:Ne,spread:Le,startVelocity:be,color:Ke[Ft%Ke.length],shape:gt[O(0,gt.length)],ticks:mt,decay:Fe,gravity:ze,drift:$e,scalar:ht,flat:jt}));return Ye?Ye.addFettis(Ht):(Ye=le(C,Ht,ve,Se,I),Ye.promise)}function K(te){var Se=ee||k(te,"disableForReducedMotion",Boolean),I=k(te,"zIndex",Number);if(Se&&Ie)return g(function(be){be()});L&&Ye?C=Ye.canvas:L&&!C&&(C=$(I),document.body.appendChild(C)),Y&&!Ae&&ve(C);var B={width:C.width,height:C.height};se&&!Ae&&se.init(C),Ae=!0,se&&(C.__confetti_initialized=!0);function Ne(){if(se){var be={getBoundingClientRect:function(){if(!L)return C.getBoundingClientRect()}};ve(be),se.postMessage({resize:{width:be.width,height:be.height}});return}B.width=B.height=null}function Le(){Ye=null,Y&&(ne=!1,r.removeEventListener("resize",Ne)),L&&C&&(document.body.contains(C)&&document.body.removeChild(C),C=null,Ae=!1)}return Y&&!ne&&(ne=!0,r.addEventListener("resize",Ne,!1)),se?se.fire(te,B,Le):Ge(te,B,Le)}return K.reset=function(){se&&se.reset(),Ye&&Ye.reset()},K}var xe;function ge(){return xe||(xe=J(null,{useWorker:!0,resize:!0})),xe}function H(C,w,L,Y,ne,ee,ye){var se=new Path2D(C),ve=new Path2D;ve.addPath(se,new DOMMatrix(w));var Ae=new Path2D;return Ae.addPath(ve,new DOMMatrix([Math.cos(ye)*ne,Math.sin(ye)*ne,-Math.sin(ye)*ee,Math.cos(ye)*ee,L,Y])),Ae}function V(C){if(!d)throw new Error("path confetti are not supported in this browser");var w,L;typeof C=="string"?w=C:(w=C.path,L=C.matrix);var Y=new Path2D(w),ne=document.createElement("canvas"),ee=ne.getContext("2d");if(!L){for(var ye=1e3,se=ye,ve=ye,Ae=0,Ie=0,Ye,Ge,K=0;K<ye;K+=2)for(var te=0;te<ye;te+=2)ee.isPointInPath(Y,K,te,"nonzero")&&(se=Math.min(se,K),ve=Math.min(ve,te),Ae=Math.max(Ae,K),Ie=Math.max(Ie,te));Ye=Ae-se,Ge=Ie-ve;var Se=10,I=Math.min(Se/Ye,Se/Ge);L=[I,0,0,I,-Math.round(Ye/2+se)*I,-Math.round(Ge/2+ve)*I]}return{type:"path",path:w,matrix:L}}function pe(C){var w,L=1,Y="#000000",ne='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof C=="string"?w=C:(w=C.text,L="scalar"in C?C.scalar:L,ne="fontFamily"in C?C.fontFamily:ne,Y="color"in C?C.color:Y);var ee=10*L,ye=""+ee+"px "+ne,se=new OffscreenCanvas(ee,ee),ve=se.getContext("2d");ve.font=ye;var Ae=ve.measureText(w),Ie=Math.ceil(Ae.actualBoundingBoxRight+Ae.actualBoundingBoxLeft),Ye=Math.ceil(Ae.actualBoundingBoxAscent+Ae.actualBoundingBoxDescent),Ge=2,K=Ae.actualBoundingBoxLeft+Ge,te=Ae.actualBoundingBoxAscent+Ge;Ie+=Ge+Ge,Ye+=Ge+Ge,se=new OffscreenCanvas(Ie,Ye),ve=se.getContext("2d"),ve.font=ye,ve.fillStyle=Y,ve.fillText(w,K,te);var Se=1/L;return{type:"bitmap",bitmap:se.transferToImageBitmap(),matrix:[Se,0,0,Se,-Ie*Se/2,-Ye*Se/2]}}n.exports=function(){return ge().apply(this,arguments)},n.exports.reset=function(){ge().reset()},n.exports.create=J,n.exports.shapeFromPath=V,n.exports.shapeFromText=pe})(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),vi,!1);const Dw=vi.exports;vi.exports.create;const Rw=({workout:s,onClose:r,onComplete:n,onRegenerateWorkout:o,isRegenerating:l,onUpdateWorkout:c})=>{const[d,p]=S.useState(!1),[f,g]=S.useState(!1),[y,x]=S.useState(s),[b,T]=S.useState(s.completed),_=K=>{const te=K?.types,Se=Array.isArray(te)?te.filter(Boolean):[];return Se.length===0&&K.type&&Se.push(K.type),Array.from(new Set(Se)).slice(0,4)},[E,k]=S.useState(_(s).filter(K=>(s.completedTypes||[]).includes(K))),D=_(s),[O,R]=S.useState(D[0]||"mixed"),M=K=>{const te=Se=>{switch(Se){case"strength":return"Strength";case"cardio":return"Cardio";case"flexibility":return"Flexibility";case"rest":return"Rest";default:return"Mixed"}};return!K||K.length===0?"Mixed":K.length>1?K.map(te).join(" / "):te(K[0])};pr.useEffect(()=>{T(s.completed),k(_(s).filter(K=>(s.completedTypes||[]).includes(K)))},[s.completed]),pr.useEffect(()=>{x(s);const K=_(s);R(K[0]||"mixed"),k(K.filter(te=>(s.completedTypes||[]).includes(te)))},[s]);const X=K=>{const[te,Se,I]=K.split("-").map(Number);return new Date(te,Se-1,I).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})},G=K=>{switch(K){case"strength":return"strength";case"cardio":return"cardio";case"flexibility":return"flexibility";case"rest":return"rest";case"mixed":return"mixed";default:return"mixed"}},de=K=>{if(!K)return{label:"",cls:""};const te=(K||"").toString().toLowerCase();return te==="easy"||te==="beginner"?{label:"Easy",cls:"difficulty-easy"}:te==="medium"||te==="intermediate"?{label:"Medium",cls:"difficulty-medium"}:te==="hard"||te==="advanced"?{label:"Hard",cls:"difficulty-hard"}:{label:te.charAt(0).toUpperCase()+te.slice(1),cls:`difficulty-${te.replace(/\s+/g,"-")}`}},we=d?s.alternativeWorkouts:s.workouts,[$,he]=pr.useState(null),[oe,re]=pr.useState(null),le=(K,te=!1)=>{const Se={...y};te?Se.alternativeWorkouts=Se.alternativeWorkouts.filter((I,B)=>B!==K):Se.workouts=Se.workouts.filter((I,B)=>B!==K),x(Se)},J=(K,te=!1)=>{if(te){const Se=y.alternativeWorkouts[K];x({...y,workouts:[...y.workouts,Se],alternativeWorkouts:y.alternativeWorkouts.filter((I,B)=>B!==K)})}else{const Se=y.workouts[K];x({...y,workouts:y.workouts.filter((I,B)=>B!==K),alternativeWorkouts:[...y.alternativeWorkouts,Se]})}},xe=(K,te)=>{x(Se=>{const I=_(Se);if(te&&I.length>=4&&!I.includes(K))return Se;let B=te?[...I,K]:I.filter(Ne=>Ne!==K);return B.length===0&&(B=[Se.type||"mixed"]),{...Se,types:B,type:B[0]}})},ge=(K,te,Se,I=!1)=>{x(B=>{const Ne={...B},Le=I?"alternativeWorkouts":"workouts",be=[...Ne[Le]];return be[K]={...be[K],[te]:Se},Ne[Le]=be,Ne})},H=()=>{const K=y.workouts.length>0,te=y.alternativeWorkouts.length>0;if(!K&&!te){c&&c({...y,workouts:[],alternativeWorkouts:[]}),r();return}const Se=_(y),I={...y,type:Se[0]||y.type||"mixed",types:Se};c&&c(I),g(!1),r()},V=()=>{x(s),g(!1)},pe=()=>{if(!Ge){alert("You can only complete or undo today's workout.");return}const K=O||D[0];E.includes(K)||Dw({particleCount:100,spread:70,origin:{y:.3},zIndex:9999});let te=E.includes(K)?E.filter(I=>I!==K):[...E,K];te=te.filter(I=>D.includes(I));const Se=D.length>0?te.length===D.length:!1;k(te),T(Se),c&&c({...s,completed:Se,completedTypes:te}),n(K)},C=_(s),w=C[0]||"mixed",L=M(C),Y=_(y),ne=E.includes(O),ee=C.length>0?E.length===C.length:b,[ye,se,ve]=s.date.split("-").map(Number),Ae=new Date(ye,se-1,ve),Ie=new Date;Ie.setHours(0,0,0,0);const Ye=Ae<Ie,Ge=Ae.getTime()===Ie.getTime();return a.jsx("div",{className:"modal-overlay",onClick:r,children:a.jsxs("div",{className:"workout-modal",onClick:K=>K.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsxs("div",{className:"modal-title-section",children:[a.jsx("div",{className:`workout-type-badge ${G(w)}`,children:L}),a.jsxs("div",{children:[a.jsx("h2",{children:X(s.date)}),ee&&a.jsxs("span",{className:"completed-badge",children:[a.jsx(Fo,{size:16}),"Completed"]})]})]}),"          ",a.jsx("button",{className:"close-button",onClick:r,title:"Close modal",children:a.jsx(pi,{size:24})})]}),a.jsxs("div",{className:"modal-content",children:[!Ge&&a.jsx("div",{className:"locked-note",children:Ye?"Past workouts are locked. View only.":"You can only complete workouts on the current day."}),C.length>1&&a.jsx("div",{className:"type-tab-strip",role:"tablist","aria-label":"Workout types",children:C.map(K=>{const te=E.includes(K);return a.jsxs("button",{role:"tab","aria-selected":O===K,className:`type-tab ${O===K?"active":""} ${te?"completed":""}`,onClick:()=>R(K),children:[a.jsx("span",{className:"dot","aria-hidden":"true"}),M([K]),te&&a.jsx(Fo,{size:14,className:"tab-check"})]},K)})}),w==="rest"?s.isRickroll?a.jsxs("div",{className:"rest-day-content rickroll-rest",children:[a.jsx("div",{className:"rest-icon",children:a.jsx(ps,{size:48})}),a.jsx("h3",{children:"Rest & Recharge"}),a.jsx("p",{children:"Todays a gentle recovery day  take it slow and treat yourself. A short, uplifting break can do wonders. Enjoy this pick-me-up while you rest."}),a.jsx("div",{className:"rickroll-embed",children:a.jsx("iframe",{width:"560",height:"315",src:"https://www.youtube.com/embed/dQw4w9WgXcQ?rel=0",title:"YouTube video player",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})}),a.jsxs("div",{className:"rest-activities",children:[a.jsxs("div",{className:"activity-item",children:[a.jsx("span",{children:""}),a.jsx("span",{children:"Slow breathing or meditation (5-10 min)"})]}),a.jsxs("div",{className:"activity-item",children:[a.jsx("span",{children:""}),a.jsx("span",{children:"Enjoy a calming drink while you relax"})]})]})]}):a.jsxs("div",{className:"rest-day-content",children:[a.jsx("div",{className:"rest-icon",children:a.jsx(ps,{size:48})}),a.jsx("h3",{children:"Recovery Day"}),a.jsx("p",{children:"Take this day to rest and let your muscles recover. You can do light stretching, meditation, or gentle walking."}),a.jsxs("div",{className:"rest-activities",children:[a.jsxs("div",{className:"activity-item",children:[a.jsx("span",{children:""}),a.jsx("span",{children:"Meditation (10-15 min)"})]}),a.jsxs("div",{className:"activity-item",children:[a.jsx("span",{children:""}),a.jsx("span",{children:"Light walking"})]}),a.jsxs("div",{className:"activity-item",children:[a.jsx("span",{children:""}),a.jsx("span",{children:"Relaxing bath"})]}),a.jsxs("div",{className:"activity-item",children:[a.jsx("span",{children:""}),a.jsx("span",{children:"Reading or relaxing"})]})]})]}):a.jsxs("div",{className:"workout-content",children:[a.jsxs("div",{className:"workout-toggle",children:[a.jsx("button",{className:`toggle-button ${d?"":"active"}`,onClick:()=>p(!1),children:"Main Workout"}),a.jsx("button",{className:`toggle-button ${d?"active":""}`,onClick:()=>p(!0),children:"Alternative"})]}),"              ",a.jsx("div",{className:"exercise-list",children:(f?d?y.alternativeWorkouts:y.workouts:we).map((K,te)=>a.jsxs("div",{className:"exercise-card",role:f?void 0:"button",tabIndex:f?void 0:0,onClick:()=>{f||(he(K.name),re(K))},onKeyDown:Se=>{!f&&(Se.key==="Enter"||Se.key===" ")&&(Se.preventDefault(),he(K.name),re(K))},children:[a.jsxs("div",{className:"exercise-header",children:[a.jsxs("div",{className:"exercise-title-section",children:[a.jsx("h4",{children:K.name}),(()=>{const{label:Se,cls:I}=de(K.difficulty);return a.jsx("div",{className:`difficulty-badge ${I}`,children:Se})})()]}),f&&a.jsxs("div",{className:"exercise-actions",children:[a.jsx("button",{className:"action-btn swap-btn",onClick:Se=>{Se.stopPropagation(),J(te,d)},title:d?"Move to main workout":"Move to alternative",children:d?a.jsx(Vy,{size:16}):a.jsx(Jy,{size:16})}),a.jsx("button",{className:"action-btn delete-btn",onClick:Se=>{Se.stopPropagation(),le(te,d)},title:"Delete exercise",children:a.jsx(Bo,{size:16})})]})]}),a.jsxs("div",{className:"exercise-details",children:[K.sets&&K.reps&&a.jsxs("div",{className:"detail-item",children:[a.jsx(Et,{size:16}),a.jsxs("span",{children:[K.sets," sets  ",K.reps," reps"]})]}),(f||K.duration)&&a.jsxs("div",{className:"detail-item",children:[a.jsx(ia,{size:16}),f?a.jsx("input",{type:"text",className:"duration-input",value:(d?y.alternativeWorkouts[te].duration:y.workouts[te].duration)||"",onChange:Se=>ge(te,"duration",Se.target.value,d),placeholder:"e.g., 30 min"}):a.jsx("span",{children:K.duration})]}),K.muscleGroups&&K.muscleGroups.length>0&&a.jsxs("div",{className:"detail-item",children:[a.jsx(ps,{size:16}),a.jsx("span",{children:K.muscleGroups.join(", ")})]})]}),a.jsx("p",{className:"exercise-description",children:K.description}),Array.isArray(K.equipment)&&K.equipment.some(Se=>Se!=="No equipment")&&a.jsx("div",{className:"equipment-tags",children:K.equipment.filter(Se=>Se!=="No equipment").map((Se,I)=>a.jsx("span",{className:"equipment-tag",children:Se},I))})]},te))})]})]}),$&&a.jsx(Iw,{name:$,exercise:oe||void 0,onClose:()=>{he(null),re(null)}}),w!=="rest"&&a.jsx("div",{className:"modal-footer",children:a.jsx("div",{className:"action-buttons",children:f?a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"btn btn-secondary",onClick:V,children:[a.jsx(pi,{size:16}),"Cancel"]}),a.jsxs("button",{className:"btn btn-primary",onClick:H,children:[a.jsx(du,{size:16}),"Save Changes"]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"btn btn-secondary",onClick:()=>g(!0),disabled:Ye,children:[a.jsx(uu,{size:16}),"Edit Workout"]}),a.jsx("button",{className:"btn btn-secondary",onClick:o,disabled:!!l||Ye,"aria-busy":!!l,children:l?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"button-spinner",children:a.jsx("div",{className:"loading-dumbbell small",children:a.jsx(Et,{size:16,color:"#fff"})})}),a.jsx("span",{className:"generating-text",children:"Generating..."})]}):a.jsxs(a.Fragment,{children:[a.jsx(Nf,{size:16}),"New Workout"]})}),a.jsx("button",{className:`btn ${ne?"btn-accent":"btn-primary"}`,onClick:pe,disabled:!Ge,children:ne?a.jsxs(a.Fragment,{children:[a.jsx(Nf,{size:16}),"Mark ",M([O])," Incomplete"]}):a.jsxs(a.Fragment,{children:[a.jsx(Fo,{size:16}),"Complete ",M([O])]})})]})})}),w!=="rest"&&a.jsxs("div",{className:"add-workout-section",children:[a.jsx("h3",{children:"Select Date and Workout Types"}),a.jsxs("div",{className:"date-picker-container",children:[a.jsx("label",{htmlFor:"workout-date",children:"Date:"}),a.jsx("input",{type:"date",id:"workout-date",className:"date-picker",value:y.date,onChange:K=>x({...y,date:K.target.value})})]}),a.jsxs("div",{className:"workout-type-container",children:[a.jsx("label",{children:"Workout Types (choose up to 4):"}),a.jsx("div",{className:"type-multi-select",children:["strength","cardio","flexibility","mixed","rest"].map(K=>{const te=Y.includes(K);return a.jsxs("label",{className:`type-pill ${te?"selected":""}`,children:[a.jsx("input",{type:"checkbox",checked:te,onChange:Se=>xe(K,Se.target.checked)}),M([K])]},K)})}),a.jsx("small",{className:"type-helper",children:"First selected type becomes the primary color on the calendar."})]}),a.jsx("button",{className:"add-workout-button",onClick:H,children:"Add Workout Day"})]}),a.jsx("style",{children:`
            .add-workout-section {
              margin-top: 20px;
              padding: 15px;
              background-color: var(--light-blue);
              border-radius: 8px;
              box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            }
            .date-picker-container, .workout-type-container {
              margin-bottom: 15px;
            }
            .date-picker, .workout-type-selector {
              width: 100%;
              padding: 10px;
              border: 1px solid var(--gray);
              border-radius: 4px;
              font-size: 16px;
            }
            .add-workout-button {
              width: 100%;
              padding: 10px;
              background-color: var(--green);
              color: white;
              font-size: 16px;
              border: none;
              border-radius: 4px;
              cursor: pointer;
              transition: background-color 0.3s;
            }
            .add-workout-button:hover {
              background-color: var(--dark-green);
            }
          `})]})})},Rf=({workoutPlan:s,userData:r,onUpdatePlan:n})=>{const o=S.useRef(0),l=S.useRef(0),c=(()=>{try{const j=sessionStorage.getItem("fitbuddyai_calendar_last_date");if(j){const W=new Date(j);if(!Number.isNaN(W.getTime()))return W}}catch{}return new Date})(),d=(()=>{try{return sessionStorage.getItem("fitbuddyai_last_plan_id")}catch{return null}})(),[p,f]=S.useState(c),[g,y]=S.useState(null),[x,b]=S.useState(!1),[T,_]=S.useState(null),[E,k]=S.useState(!1),[D,O]=S.useState(null),[R,M]=S.useState(!1),[X,G]=S.useState(!1),[de,we]=S.useState(!1),[$,he]=S.useState(!1),[oe,re]=S.useState([]),[le,J]=S.useState(!1),[xe,ge]=S.useState(["strength"]),[H,V]=S.useState(""),[pe,C]=S.useState([]),[w,L]=S.useState(""),[Y,ne]=S.useState(!1),[ee,ye]=S.useState(""),[se,ve]=S.useState(null),[Ae,Ie]=S.useState(null),[Ye,Ge]=S.useState(!1),[K,te]=S.useState(null),[Se,I]=S.useState(!1),[B,Ne]=S.useState(!1),[Le,be]=S.useState(null),[Fe,ze]=S.useState(!1),[$e,Ke]=S.useState("strength"),[mt,gt]=S.useState({duration:"30 min",muscleGroups:[],equipment:[]}),[ht,jt]=S.useState(!1),[bt,Ft]=S.useState([]),Ht=S.useRef(!1),gr=S.useRef(d),tr=r||{username:"Guest",age:28,fitnessLevel:"beginner",goals:["Get active"],timeAvailable:30,equipment:[],preferences:["Preview mode user"],exerciseFormat:"bodyweight",daysPerWeek:"3"},fn=!r;S.useEffect(()=>{if(s||Ht.current)return;try{const me=gs();if(me&&Array.isArray(me.dailyWorkouts)&&me.dailyWorkouts.length>0){n(me);return}if(mr()?.id)return}catch(me){console.warn("Preview seed guard failed to read storage:",me)}const j=new Date,W=Zt(j,"yyyy-MM-dd"),q=new Date(j.getTime()+8640*60*1e3),ae=Zt(q,"yyyy-MM-dd"),_e=Array.from({length:7}).map((me,Re)=>{const De=new Date(j.getTime()+Re*24*60*60*1e3),ue=Zt(De,"yyyy-MM-dd"),fe=Re%3===0?"strength":Re%3===1?"cardio":"rest",Me=fe==="rest";return{date:ue,type:fe,completed:!1,totalTime:Me?"0 min":"30 min",workouts:Me?[{name:"Rest Day",description:"Take a breather before your next session.",difficulty:"beginner",duration:"0 min",reps:"",muscleGroups:[],equipment:[]}]:[{name:Re%3===0?"Bodyweight Circuit":"Tempo Walk",description:Re%3===0?"Squats, pushups, and lunges to warm up your whole body.":"Light cardio to keep you moving.",difficulty:"beginner",duration:"30 minutes",reps:Re%3===0?"3 rounds":"20 min",muscleGroups:Re%3===0?["full body"]:["cardio"],equipment:Re%3===0?[]:["sneakers"]}],alternativeWorkouts:[]}}),Oe={id:"preview-plan",name:"Preview Plan",description:"Preview the schedule builder. Complete the questionnaire to personalize your plan.",startDate:W,endDate:ae,totalDays:_e.length,weeklyStructure:["Strength","Cardio","Rest","Strength","Cardio","Rest","Mixed"],dailyWorkouts:_e};Ht.current=!0,n(Oe)},[s,n]),S.useEffect(()=>{if(!s||s.dailyWorkouts.length===0)return;const j=s.id||"plan",W=gr.current!==j;if(Fe||!W){gr.current=j;try{sessionStorage.setItem("fitbuddyai_last_plan_id",j)}catch{}return}try{if(s.startDate&&typeof s.startDate=="string"&&s.startDate.includes("-")){const ae=s.startDate.split("-").map(Number);if(ae.length===3&&!ae.some(_e=>Number.isNaN(_e))){const[_e,Oe,me]=ae;f(new Date(_e,Oe-1,me)),gr.current=j;try{sessionStorage.setItem("fitbuddyai_last_plan_id",j)}catch{}return}}const q=s.dailyWorkouts[0];if(q&&q.date&&typeof q.date=="string"&&q.date.includes("-")){const ae=q.date.split("-").map(Number);if(ae.length===3&&!ae.some(_e=>Number.isNaN(_e))){f(new Date(ae[0],ae[1]-1,ae[2])),gr.current=j;try{sessionStorage.setItem("fitbuddyai_last_plan_id",j)}catch{}return}}}catch(q){console.warn("Failed to parse workoutPlan start date, using current date:",q)}gr.current=j;try{sessionStorage.setItem("fitbuddyai_last_plan_id",j)}catch{}},[s,Fe]),S.useEffect(()=>{try{sessionStorage.setItem("fitbuddyai_calendar_last_date",p.toISOString())}catch{}},[p]),S.useEffect(()=>{let j=!0;return(async()=>{try{if(s&&s.dailyWorkouts&&s.dailyWorkouts.length>0)return;try{if(localStorage.getItem("fitbuddyai_no_auto_restore")||sessionStorage.getItem("fitbuddyai_no_auto_restore"))return}catch{}const q=mr();if(!q||!q.id||(await ms(q.id),!j))return;const ae=gs();ae&&n(ae)}catch(q){console.warn("Failed to restore server data in WorkoutCalendar:",q)}})(),()=>{j=!1}},[n]),S.useEffect(()=>{},[s]),S.useEffect(()=>{if(s)try{const j=mr();if(!j)return;const W={...j,workouts:s.dailyWorkouts};qt({data:W})}catch(j){console.warn("Failed to persist multi-type workouts to profile:",j)}},[s]),S.useEffect(()=>{s&&il(s.dailyWorkouts)},[s]),S.useEffect(()=>{},[]),S.useEffect(()=>{if(s){let j=s.dailyWorkouts.map(W=>{const q=!W.workouts||W.workouts.length===0,ae=!W.totalTime||W.totalTime.toString().trim().startsWith("0");if(W.type==="mixed"&&q&&ae){const _e={...W,type:"rest",workouts:[{name:"Rest Day",description:"Take a well-deserved break and let your body recover.",duration:"0 min",difficulty:"beginner",muscleGroups:[]}],alternativeWorkouts:[]};return Math.random()<1e-6&&(_e.isRickroll=!0),_e}return W});try{const W=Array.isArray(s.weeklyStructure)?s.weeklyStructure:[],q=typeof s.totalDays=="number"&&s.totalDays>0?s.totalDays:s.dailyWorkouts?s.dailyWorkouts.length:0;if(s.startDate&&q>0&&W.length===7){const ae=s.startDate.split("-").map(Number);if(ae.length===3){const _e=new Date(ae[0],ae[1]-1,ae[2]),Oe=new Set((j||[]).map(me=>me.date));for(let me=0;me<q;me++){const Re=new Date(_e.getTime());Re.setDate(_e.getDate()+me);const De=Zt(Re,"yyyy-MM-dd"),ue=me%7;if((W[ue]||"").toString().toLowerCase().includes("rest")&&!Oe.has(De)){const Me={date:De,workouts:[{name:"Rest Day",description:"Take a well-deserved break and let your body recover.",duration:"0 min",difficulty:"beginner",muscleGroups:[]}],alternativeWorkouts:[],completed:!1,type:"rest"};Math.random()<1/1e6&&(Me.isRickroll=!0),j=[...j,Me],Oe.add(De)}}}}}catch(W){console.warn("Failed to populate missing rest days from weeklyStructure:",W)}if(JSON.stringify(j)!==JSON.stringify(s.dailyWorkouts)){const W={...s,dailyWorkouts:j,totalDays:j.length};n(W);try{console.log("[WorkoutCalendar] Saving normalized plan to localStorage:",{totalDays:W.totalDays,dailyWorkoutsCount:W.dailyWorkouts.length}),fr(W)}catch(q){console.warn("Failed to save normalized plan locally:",q)}}}},[s,n]);const ya=r?.username?.trim()||tr.username||tr.name||"Guest";if(!s)return a.jsx("div",{className:"calendar-page",children:a.jsx("div",{className:"calendar-container",children:a.jsxs("div",{className:"calendar-preview-callout fade-in-bounce",children:[a.jsx("div",{className:"calendar-no-plan-icon-bg",children:a.jsx(Et,{size:48,color:"#fff"})}),a.jsx("h2",{className:"calendar-no-plan-message",children:"Building a preview schedule..."}),a.jsx("p",{className:"calendar-no-plan-desc",children:"Hang tight  a starter calendar will load so you can explore the schedule builder before filling the questionnaire."}),a.jsx("a",{className:"calendar-no-plan-btn",href:"/questionnaire",children:"Start questionnaire"})]})})});const ws=Nv(p),va=_v(p),wa=jv({start:ws,end:va}),xa=ws.getDay(),Br=j=>{let W;if(typeof j=="string")if(j.includes("T"))W=new Date(j);else{const[q,ae,_e]=j.split("-").map(Number);W=new Date(q,ae-1,_e)}else W=j;if(isNaN(W.getTime()))throw new RangeError("Invalid time value");return Zt(W,"yyyy-MM-dd")},Gt=j=>{const W=j?.types,q=Array.isArray(W)?W.filter(Boolean):[];return q.length===0&&j.type&&q.push(j.type),Array.from(new Set(q)).slice(0,4)},Kr=j=>Gt(j)[0]||"mixed",Pr=j=>{const W=new Date(j.getFullYear(),j.getMonth(),j.getDate()),q=new Date;return q.setHours(0,0,0,0),W<q},bi=j=>{const W=new Date;return W.setHours(0,0,0,0),new Date(j.getFullYear(),j.getMonth(),j.getDate()).getTime()===W.getTime()},ba=j=>{const W=Br(j.toISOString());return s.dailyWorkouts.find(ae=>ae.date===W)||null},ki=j=>{const W=Zt(j,"yyyy-MM-dd");if($){re(ae=>ae.includes(W)?ae.filter(_e=>_e!==W):[...ae,W]);return}if(Y){if(T===W||Ye)return;const ae=new Date(j.getFullYear(),j.getMonth(),j.getDate()-1);bs(ae),ne(!1),be(W);return}if(T===W||Ye)return;if(ht){Ft(ae=>ae.includes(W)?ae.filter(_e=>_e!==W):[...ae,W]);return}const q=ba(j);if(E&&q){ol(q);return}if(E&&!q){const ae=new Date(j.getFullYear(),j.getMonth(),j.getDate()-1);bs(ae);return}q&&(y(q),b(!0))},ka=(j,W)=>{const[q,ae,_e]=j.split("-").map(Number),Oe=new Date(q,ae-1,_e);if(!bi(Oe)){alert("You can only complete or undo today's workout.");return}const me=s.dailyWorkouts.map(ue=>{if(ue.date!==j)return ue;const fe=Gt(ue),Me=W||fe[0]||ue.type,Ve=Array.isArray(ue.completedTypes)?ue.completedTypes:ue.completed?fe:[];let it=Ve;Me&&(Ve.includes(Me)?it=Ve.filter(Qe=>Qe!==Me):it=[...Ve,Me]),it=it.filter(Qe=>fe.includes(Qe));const rt=fe.length>0?it.length===fe.length:!ue.completed;return{...ue,completed:rt,completedTypes:fe.length>0?it:[]}}),Re={...s,dailyWorkouts:me};n(Re),al(me);const De=me.find(ue=>ue.date===j);De&&y(De)},Vn=j=>{const W=new Date(p);j==="prev"?W.setMonth(W.getMonth()-1):W.setMonth(W.getMonth()+1),ze(!0),f(W),window.setTimeout(()=>ze(!1),2e3)},pn=j=>{switch(j){case"strength":return"strength";case"cardio":return"cardio";case"flexibility":return"flexibility";case"rest":return"rest";case"mixed":return"mixed";default:return"mixed"}},Sa=j=>{const W=q=>{switch(q){case"strength":return"Strength";case"cardio":return"Cardio";case"flexibility":return"Flexibility";case"rest":return"Rest";default:return"Mixed"}};return!j||j.length===0?"Mixed":j.length>1?j.map(W).join(" / "):W(j[0])},Yr=s.dailyWorkouts.filter(j=>j.completed&&Kr(j)!=="rest").length,_a=s.dailyWorkouts.filter(j=>Kr(j)!=="rest").length,mn=_a>0?Yr/_a*100:0,Jn=j=>{const W=De=>{if(De>=60){const ue=Math.floor(De/60),fe=De%60;return fe>0?`${ue}h ${fe}m`:`${ue}h`}return`${De} min`},q=De=>{if(!De)return 0;const ue=De.toString().toLowerCase().trim(),fe=ue.match(/^(\d{1,2}):(\d{2})$/);if(fe){const Qe=parseInt(fe[1],10),He=parseInt(fe[2],10);return(Number.isNaN(Qe)?0:Qe*60)+(Number.isNaN(He)?0:He)}let Me=0;const Ve=ue.match(/(\d+(?:\.\d+)?)\s*(h|hr|hrs|hour|hours)/);Ve&&(Me+=parseFloat(Ve[1])*60);const it=ue.match(/(\d+(?:\.\d+)?)\s*(m|min|mins|minute|minutes)\b/);it&&(Me+=parseFloat(it[1]));const rt=ue.match(/(\d+(?:\.\d+)?)\s*(s|sec|secs|second|seconds)\b/);if(rt&&(Me+=parseFloat(rt[1])/60),Me===0){const Qe=parseFloat((ue.match(/(\d+(?:\.\d+)?)/)||[])[1]||"");Number.isNaN(Qe)||(Me=Qe)}return Math.round(Me)};if(Kr(j)==="rest")return"0 min";const ae=(j.workouts||[]).reduce((De,ue)=>{const fe=ue?.duration||ue?.totalTime;return De+q(fe)},0),_e=q(j.totalTime),Oe=Gt(j).length||(j.type?1:0),me=Math.max(1,Oe);if(ae>0){const ue=me>1&&ae<=45?ae*me:ae;return W(ue)}if(_e>0){const De=_e*me;return W(De)}const Re=30*me;return W(Re)},Qr=j=>{if(!j||Kr(j)==="rest")return!1;const q=Gt(j);return q.length===0?!!j.completed:(j.completedTypes||[]).filter(_e=>q.includes(_e)).length===q.length||!!j.completed},xs=j=>{const W=new Date;W.setHours(0,0,0,0);const q=me=>Zt(me,"yyyy-MM-dd"),ae=new Map(j.map(me=>[me.date,me])),_e=ae.get(q(W));if(!Qr(_e))return 0;let Oe=1;for(let me=1;me<365;me++){const Re=new Date(W);Re.setDate(W.getDate()-me);const De=q(Re),ue=ae.get(De);if(!Qr(ue))break;Oe+=1}return Oe},al=j=>{try{const W=xs(j),q=mr();if(!q)return;const ae={...q,streak:W};qt({data:ae});try{const _e=new CustomEvent("fitbuddyai-streak-updated",{detail:{streak:W}});window.dispatchEvent(_e)}catch{}}catch(W){console.warn("Failed to update streak:",W)}},il=j=>{try{const W=new Date;W.setHours(0,0,0,0);let q=0;const ae=j.map(me=>{if(!Qr(me))return me;const[Re,De,ue]=me.date.split("-").map(Number);return new Date(Re,(De||1)-1,ue||1)>=W||me.energyRewarded?me:(q+=1,{...me,energyRewarded:!0})});if(q===0)return j;const _e=mr();if(_e){const me={..._e,energy:(_e.energy??0)+q*250};qt({data:me}),window.dispatchEvent(new Event("storage"))}const Oe={...s,dailyWorkouts:ae,totalDays:ae.length};n(Oe);try{fr(Oe)}catch{}return ae}catch(W){return console.warn("Failed to reward completed past days:",W),j}},ol=j=>{O({...j}),M(!0),k(!0)},Xr=()=>{if(!D||!s)return;const j=s.dailyWorkouts.map(q=>q.date===D.date?D:q),W={...s,dailyWorkouts:j};n(W),M(!1),k(!1),O(null)},Si=()=>{M(!1),k(!1),O(null)},bs=j=>{if(!s)return;let W;if(j?W=new Date(j.getFullYear(),j.getMonth(),j.getDate()+1):W=new Date,Pr(W)){alert("You cannot add or change workouts on past dates.");return}const q=Zt(W,"yyyy-MM-dd"),ae=s.dailyWorkouts.find(Re=>Re.date===q);if(ae){const Re={...ae,type:"rest",types:["rest"],workouts:[{name:"Rest Day",description:"Take a well-deserved break and let your body recover.",duration:"0 min",difficulty:"beginner",muscleGroups:[]}],alternativeWorkouts:[]};Ci(Re);return}const _e={date:q,workouts:[{name:"Rest Day",description:"Take a well-deserved break and let your body recover.",duration:"0 min",difficulty:"beginner",muscleGroups:[]}],alternativeWorkouts:[],completed:!1,type:"rest",types:["rest"]},Oe=[...s?.dailyWorkouts||[],_e];Math.random()<1/1e6&&(_e.isRickroll=!0);const me={...s,dailyWorkouts:Oe};n(me)},ll=()=>{w?(bs(new Date(w)),L(""),G(!1)):G(!0)},_i=()=>{ee?(cl(new Date(ee),$e,mt),ye(""),we(!1)):we(!0)},ji=()=>{const j=Date.now();if(j-l.current<350){console.debug("[WorkoutCalendar] handleSelectToAddToggle ignored - rapid duplicate");return}l.current=j,console.debug("[WorkoutCalendar] handleSelectToAddToggle called",{addMode:$,showBatchAddPanel:le,selectedForAddLength:oe.length}),$?(console.debug("[WorkoutCalendar] exiting selection mode"),he(!1),re([]),J(!1),k(!0)):(he(!0),jt(!1),re([]),J(!1),k(!0))},Ni=()=>{if(console.debug("[WorkoutCalendar] handleConfirmSelection",{selectedForAddLength:oe.length}),oe.length===0){alert("Please select at least one date before confirming.");return}he(!1),J(!0),k(!0)},Ei=async()=>{if(!s)return;if(oe.length===0){alert("Please select at least one date.");return}J(!1),k(!1),he(!1),C([...oe]);const j=br(),W=j?.answers||{},q=j?.questionsList||[];let ae=[...s.dailyWorkouts];for(const Oe of oe){if(ae.some(me=>me.date===Oe)){console.warn("Skipping existing date during batch add:",Oe);continue}try{const me=xe&&xe.length>0?xe.join(","):"mixed",Re={...W,batchComments:H},De=ae.filter(Ve=>Ve.date!==Oe),ue=await Oo(tr,Re,q,Oe,me,De,[]),Me=((Ve,it)=>{const rt=(Ve?.date||it||"").toString();let Qe=rt;try{rt.includes("T")&&(Qe=Zt(new Date(rt),"yyyy-MM-dd"))}catch{Qe=it}Qe=it;const He=Array.isArray(Ve?.types)&&Ve?.types.length?Ve.types.slice(0,4):[Ve?.type||"mixed"],rr=Array.isArray(Ve?.workouts)?Ve.workouts:Array.isArray(Ve?.exercises)?Ve.exercises:[],Bt=Array.isArray(Ve?.alternativeWorkouts)?Ve.alternativeWorkouts:Array.isArray(Ve?.alternativeExercises)?Ve.alternativeExercises:[];return{date:Qe,type:He[0]||"mixed",types:He,workouts:rr.map(ke=>({name:ke?.name||ke?.exercise||"Exercise",description:ke?.description||ke?.instructions||"",difficulty:ke?.difficulty||"beginner",duration:ke?.duration||(ke?.durationSeconds?`${ke.durationSeconds} sec`:""),reps:ke?.reps??"",muscleGroups:Array.isArray(ke?.muscleGroups)?ke.muscleGroups:ke?.muscleGroups?[ke.muscleGroups]:[],equipment:Array.isArray(ke?.equipment)?ke.equipment:ke?.equipment?[ke.equipment]:[],sets:typeof ke?.sets=="number"?ke.sets:void 0,rest:ke?.rest||void 0})),alternativeWorkouts:Bt.map(ke=>({name:ke?.name||ke?.exercise||"Alt Exercise",description:ke?.description||ke?.instructions||"",difficulty:ke?.difficulty||"beginner",duration:ke?.duration||(ke?.durationSeconds?`${ke.durationSeconds} sec`:""),reps:ke?.reps??"",muscleGroups:Array.isArray(ke?.muscleGroups)?ke.muscleGroups:ke?.muscleGroups?[ke.muscleGroups]:[],equipment:Array.isArray(ke?.equipment)?ke.equipment:ke?.equipment?[ke.equipment]:[],sets:typeof ke?.sets=="number"?ke.sets:void 0,rest:ke?.rest||void 0})),totalTime:Ve?.totalTime||""}})(ue,Oe);ae=[...ae,Me]}catch(me){console.error("Batch generate error for date",Oe,me)}}const _e={...s,dailyWorkouts:ae,totalDays:ae.length};n(_e);try{console.log("[WorkoutCalendar] Saving batch-generated plan to localStorage:",{totalDays:_e.totalDays,dailyWorkoutsCount:_e.dailyWorkouts.length}),fr(_e)}catch(Oe){console.warn("Failed to save batch-generated plan locally:",Oe)}C([]),re([])},cl=async(j,W,q)=>{if(!s)return;let ae,_e;if(j){ae=new Date(j.getFullYear(),j.getMonth(),j.getDate()+1),_e=Zt(ae,"yyyy-MM-dd");const Me=new Date;if(Me.setHours(0,0,0,0),ae<Me){alert("You cannot add workouts to a past date.");return}if(s.dailyWorkouts.find(it=>it.date===_e))return}else{const Me=s.dailyWorkouts.length>0?new Date(Math.max(...s.dailyWorkouts.map(Ve=>new Date(Ve.date).getTime()))):new Date(s.startDate);ae=new Date(Me.getTime()+1440*60*1e3),_e=Zt(ae,"yyyy-MM-dd")}const Oe=[...tr.preferences||[],...q?.muscleGroups||[],...q?.equipment||[],`Workout type: ${W||"mixed"}`,`Duration: ${q?.duration||"30 min"}`],me={...tr,preferences:Oe},Re=await ai(me,{},[]),De={date:_e,type:W||"mixed",types:[W||"mixed"],workouts:Re.dailyWorkouts[0]?.workouts||[],alternativeWorkouts:[],completed:!1},ue=[...s.dailyWorkouts,De],fe={...s,dailyWorkouts:ue,totalDays:ue.length};n(fe)},Ci=j=>{if(!s)return;try{const[ue,fe,Me]=j.date.split("-").map(Number),Ve=new Date(ue,fe-1,Me);if(Pr(Ve)){alert("You cannot change workouts on past dates.");return}}catch{}const W=Gt(j),q=(j.completedTypes||[]).filter(ue=>W.includes(ue)),ae=W.length>0?q.length===W.length:j.completed,_e=Array.isArray(j.workouts)&&j.workouts.length>0,Oe=Array.isArray(j.alternativeWorkouts)&&j.alternativeWorkouts.length>0;if(!_e&&!Oe){const ue=s.dailyWorkouts.filter(Me=>Me.date!==j.date),fe={...s,dailyWorkouts:ue,totalDays:ue.length};n(fe);try{fr(fe)}catch(Me){console.warn("Failed to persist plan after deleting empty day:",Me)}return}const me={...j,type:W[0]||j.type||"mixed",types:W,completedTypes:q,completed:ae},Re=s.dailyWorkouts.map(ue=>ue.date===j.date?me:ue),De={...s,dailyWorkouts:Re};n(De)},yt=async j=>{if(!s)return;const[W,q,ae]=j.date.split("-").map(Number),_e=new Date(W,q-1,ae);if(Pr(_e)){alert("You cannot change workouts on past dates.");return}b(!1),_(j.date),Ne(!0);const Oe=br(),me=Oe?.answers||{},Re=Oe?.questionsList||[];try{const De=Kr(j),ue=s.dailyWorkouts.filter(He=>He.date!==j.date),fe=[...j.workouts,...j.alternativeWorkouts];console.log("[AI] Sending generateWorkoutForDay request:",{username:tr?.username,date:j.date,type:De,othersCount:ue.length,currentDayListLength:fe.length});const Me=await Oo(tr,me,Re,j.date,De,ue,fe);console.log("[AI] Received response for generateWorkoutForDay:",Me);const it=(He=>{const rr=(He?.date||j.date||"").toString();let Bt=rr;try{rr.includes("T")&&(Bt=Zt(new Date(rr),"yyyy-MM-dd"))}catch{Bt=j.date}Bt=j.date;const ke=Array.isArray(He?.workouts)?He.workouts:Array.isArray(He?.exercises)?He.exercises:[],Jt=Array.isArray(He?.alternativeWorkouts)?He.alternativeWorkouts:Array.isArray(He?.alternativeExercises)?He.alternativeExercises:[],vt=Array.isArray(He?.types)&&He?.types.length?He.types.slice(0,4):Gt(j);return{date:Bt,type:vt[0]||He?.type||j.type||"mixed",types:vt,completedTypes:Array.isArray(He?.completedTypes)?He.completedTypes.filter(Ue=>vt.includes(Ue)):[],completed:vt.length>0?Array.isArray(He?.completedTypes)&&He.completedTypes.filter(Ue=>vt.includes(Ue)).length===vt.length:!!He?.completed,workouts:ke.map(Ue=>({name:Ue?.name||Ue?.exercise||"Exercise",description:Ue?.description||Ue?.instructions||"",difficulty:Ue?.difficulty||"beginner",duration:Ue?.duration||(Ue?.durationSeconds?`${Ue.durationSeconds} sec`:""),reps:Ue?.reps??"",muscleGroups:Array.isArray(Ue?.muscleGroups)?Ue.muscleGroups:Ue?.muscleGroups?[Ue.muscleGroups]:[],equipment:Array.isArray(Ue?.equipment)?Ue.equipment:Ue?.equipment?[Ue.equipment]:[],sets:typeof Ue?.sets=="number"?Ue.sets:void 0,rest:Ue?.rest||void 0})),alternativeWorkouts:Jt.map(Ue=>({name:Ue?.name||Ue?.exercise||"Alt Exercise",description:Ue?.description||Ue?.instructions||"",difficulty:Ue?.difficulty||"beginner",duration:Ue?.duration||(Ue?.durationSeconds?`${Ue.durationSeconds} sec`:""),reps:Ue?.reps??"",muscleGroups:Array.isArray(Ue?.muscleGroups)?Ue.muscleGroups:Ue?.muscleGroups?[Ue.muscleGroups]:[],equipment:Array.isArray(Ue?.equipment)?Ue.equipment:Ue?.equipment?[Ue.equipment]:[],sets:typeof Ue?.sets=="number"?Ue.sets:void 0,rest:Ue?.rest||void 0})),totalTime:He?.totalTime||""}})(Me);console.log("[REGenerate] Normalized regenerated day:",it);const rt=s.dailyWorkouts.map(He=>He.date===j.date?it:He),Qe={...s,dailyWorkouts:rt};n(Qe);try{console.log("[WorkoutCalendar] Saving regenerated plan to localStorage:",{dailyWorkoutsCount:Qe.dailyWorkouts.length}),fr(Qe),console.log("[REGenerate] saved regenerated plan to localStorage")}catch(He){console.warn("Failed to save regenerated plan locally:",He)}y(it),b(!0),be(it.date),window.setTimeout(()=>be(null),2e3),_(null),Ne(!1)}catch(De){console.error("Error regenerating single-day workout with AI:",De),_(null),Ne(!1)}},ul=async()=>{if(!s||!ee)return;_(ee),C(Oe=>Array.from(new Set([...Oe,ee])));const j=new Date(ee),W=new Date;if(W.setHours(0,0,0,0),j<W){alert("You cannot add workouts to a past date."),_(null);return}const q=br(),ae=q?.answers||{},_e=q?.questionsList||[];try{const Oe=s.dailyWorkouts.filter(Me=>Me.date!==ee);console.log("[AI] Sending generateWorkoutForDay request:",{username:tr?.username,date:ee,type:$e,othersCount:Oe.length});const me=await Oo(tr,ae,_e,ee,$e,Oe,[]),Re=Array.isArray(me?.types)&&me?.types.length?me.types.slice(0,4):[$e],De={...me,type:Re[0]||$e,types:Re,completedTypes:[]};console.log("[AI] Received response for generateWorkoutForDay:",me);const ue=[...s.dailyWorkouts,De],fe={...s,dailyWorkouts:ue};n(fe);try{fr(fe)}catch(Me){console.warn("Failed to save generated day locally:",Me)}console.log("[Calendar] Updated plan after generation:",{totalDays:fe.totalDays||fe.dailyWorkouts.length,dailyWorkoutsCount:fe.dailyWorkouts.length,addedDate:ee,addedDay:me}),_(null),C(Me=>Me.filter(Ve=>Ve!==ee))}catch(Oe){console.error("Error generating workout:",Oe),_(null),C(me=>me.filter(Re=>Re!==ee))}},ja=(j,W)=>{ve(W),Ge(!0);try{j.dataTransfer.effectAllowed="move"}catch{}},gn=(j,W)=>{te(W),Ge(!0);try{j.dataTransfer.effectAllowed="copy",j.dataTransfer.setData("text/calendar-type",W)}catch{}},$r=()=>{te(null),Ge(!1),Ie(null),I(!1)},dl=(j,W)=>{const q=K||j.dataTransfer.getData("text/calendar-type");if(q&&Pr(W)){Ie(null);return}j.preventDefault();try{j.dataTransfer.dropEffect=q?"copy":"move"}catch{}Ie(Br(W.toISOString()))},Ti=()=>{Ie(null)},ks=j=>{if(!(!se||K)){j.preventDefault();try{j.dataTransfer.dropEffect="move"}catch{}I(!0)}},Vt=()=>{I(!1)},hl=j=>{j.preventDefault();const W=j.dataTransfer.getData("text/fba-remove-type");if(!s||!se&&!W||K){Vt(),Wt();return}if(W){try{const _e=JSON.parse(W),{date:Oe,type:me}=_e||{};if(!Oe||!me)throw new Error("Invalid payload");const Re=s.dailyWorkouts.map(ue=>{if(ue.date!==Oe)return ue;const fe=Gt(ue).filter(Ve=>Ve!==me),Me=(ue.completedTypes||[]).filter(Ve=>Ve!==me);return fe.length===0?null:{...ue,types:fe,type:fe[0],completedTypes:Me,completed:Me.length===fe.length&&fe.length>0}}).filter(Boolean),De={...s,dailyWorkouts:Re,totalDays:Re.length};n(De);try{fr(De)}catch(ue){console.warn("Failed to save plan after type removal:",ue)}}catch(_e){console.warn("Failed to process type removal drop:",_e)}Vt(),Wt();return}if(!se){Vt(),Wt();return}const q=s.dailyWorkouts.filter(_e=>_e.date!==se.date),ae={...s,dailyWorkouts:q,totalDays:q.length};n(ae);try{fr(ae)}catch(_e){console.warn("Failed to save plan after legend drop delete:",_e)}Vt(),Wt()},Wt=()=>{Ge(!1),ve(null),te(null),Ie(null)},fl=async(j,W)=>{if(j.preventDefault(),!s){Ge(!1),te(null);return}const q=Br(W.toISOString()),ae=K||j.dataTransfer.getData("text/calendar-type");if(ae&&Pr(W)){alert("You can only add workouts to today or a future date."),Ge(!1),te(null),Ie(null);return}const _e=new Date(q+"T00:00:00"),Oe=se?se.date:"";if(se){const[ue,fe,Me]=Oe.split("-").map(Number),Ve=new Date(ue,fe-1,Me);if(Pr(Ve)||Pr(_e)){alert("You cannot move workouts on past dates."),Ge(!1),ve(null),te(null),Ie(null);return}}if(ae){const ue=ae,fe=s.dailyWorkouts.find(rt=>rt.date===q);if(fe){const rt=Array.from(new Set([...Gt(fe),ue])).slice(0,4),Qe=(fe.completedTypes||[]).filter(ke=>rt.includes(ke)),He={...fe,types:rt,type:rt[0]||fe.type||ue,completedTypes:Qe,completed:Qe.length===rt.length&&rt.length>0},rr=s.dailyWorkouts.map(ke=>ke.date===q?He:ke),Bt={...s,dailyWorkouts:rr};n(Bt);try{fr(Bt)}catch(ke){console.warn("Failed to save merged multi-type day locally:",ke)}be(q),window.setTimeout(()=>be(null),2e3),te(null),Ge(!1),Ie(null);return}_(q),C(rt=>Array.from(new Set([...rt,q])));const Me=br(),Ve=Me?.answers||{},it=Me?.questionsList||[];try{const rt=s.dailyWorkouts.filter(vt=>vt.date!==q),Qe=await Oo(tr,Ve,it,q,ue,rt,[]),He=Array.isArray(Qe?.types)&&Qe?.types.length?Qe.types.slice(0,4):[ue],rr={date:q,type:He[0]||Qe?.type||ue,types:He,completedTypes:[],completed:!!Qe?.completed,totalTime:Qe?.totalTime||"",workouts:Array.isArray(Qe?.workouts)?Qe.workouts:[],alternativeWorkouts:Array.isArray(Qe?.alternativeWorkouts)?Qe.alternativeWorkouts:[]},ke=[...s.dailyWorkouts.filter(vt=>vt.date!==q),rr].sort((vt,Ue)=>vt.date.localeCompare(Ue.date)),Jt={...s,dailyWorkouts:ke,totalDays:ke.length};n(Jt);try{fr(Jt)}catch(vt){console.warn("Failed to save generated day locally:",vt)}be(q),window.setTimeout(()=>be(null),2e3)}catch(rt){console.error("Drag-generate error for",q,rt)}finally{_(null),C(rt=>rt.filter(Qe=>Qe!==q)),te(null),Ge(!1),Ie(null)}return}if(!se){Ge(!1),Ie(null);return}if(q===Oe){ve(null),Ie(null),Ge(!1);return}const me=s.dailyWorkouts.find(ue=>ue.date===q);let Re=[...s.dailyWorkouts];me?Re=Re.map(ue=>ue.date===Oe?{...me,date:Oe}:ue.date===q?{...se,date:q}:ue):Re=Re.map(ue=>ue.date===Oe?{...ue,date:q}:ue),ze(!0),f(p);const De={...s,dailyWorkouts:Re};n(De),window.setTimeout(()=>ze(!1),2e3),ve(null),Ie(null),Ge(!1)},yn=(j,W)=>{gt(q=>({...q,[j]:W}))},pl=async()=>{if(!s)return;const j=s.dailyWorkouts.map(q=>q.date);Ft(j);const W={...s,dailyWorkouts:[]};try{localStorage.setItem("fitbuddyai_no_auto_restore","1"),sessionStorage.setItem("fitbuddyai_no_auto_restore","1"),setTimeout(()=>{try{localStorage.removeItem("fitbuddyai_no_auto_restore")}catch{}try{sessionStorage.removeItem("fitbuddyai_no_auto_restore")}catch{}},3e5)}catch(q){console.warn("Failed to set no-auto-restore guard:",q)}n(W);try{fr(W)}catch(q){console.warn("Failed to persist cleared plan:",q)}try{const{loadUserData:q}=await et(async()=>{const{loadUserData:Oe}=await Promise.resolve().then(()=>ir);return{loadUserData:Oe}},void 0),_e=q()?.id;_e&&gi(_e).catch(()=>{})}catch{}k(!1),jt(!1),alert("Calendar has been cleared!")},Ss=()=>{if(!s)return;if(bt.length===0){alert("Please select at least one date to delete.");return}const j=s.dailyWorkouts.filter(W=>!bt.includes(W.date));n({...s,dailyWorkouts:j}),Ft([]),jt(!1),k(!1)},_s=()=>{Ft([]),jt(!1)};return a.jsxs("div",{className:"calendar-page",children:[a.jsxs("div",{className:"calendar-container",children:[fn&&a.jsxs("div",{className:"calendar-preview-banner",children:[a.jsxs("div",{className:"banner-text",children:[a.jsx("strong",{children:"Preview mode:"})," Explore the scheduler now. Complete the questionnaire to let the AI personalize your plan."]}),a.jsx("a",{className:"calendar-no-plan-btn",href:"/questionnaire",children:"Complete questionnaire"})]}),a.jsxs("div",{className:"calendar-header",children:[a.jsxs("div",{className:"user-info",children:[a.jsxs("h1",{children:["Welcome back, ",ya,"!"]}),a.jsx("p",{children:s.description})]}),a.jsxs("div",{className:"progress-stats",children:[a.jsxs("div",{className:"stat-card",children:[a.jsx(Cr,{size:24}),a.jsxs("div",{className:"stat-content",children:[a.jsx("span",{className:"stat-number",children:Yr}),a.jsx("span",{className:"stat-label",children:"Completed"})]})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx(ia,{size:24}),a.jsxs("div",{className:"stat-content",children:[a.jsx("span",{className:"stat-number",children:_a-Yr}),a.jsx("span",{className:"stat-label",children:"Remaining"})]})]}),a.jsx("div",{className:"progress-circle",children:a.jsxs("svg",{viewBox:"0 0 36 36",className:"circular-chart",children:[a.jsx("path",{className:"circle-bg",d:`M18 2.0845\r
                    a 15.9155 15.9155 0 0 1 0 31.831\r
                    a 15.9155 15.9155 0 0 1 0 -31.831`}),a.jsx("path",{className:"circle",strokeDasharray:`${mn}, 100`,d:`M18 2.0845\r
                    a 15.9155 15.9155 0 0 1 0 31.831\r
                    a 15.9155 15.9155 0 0 1 0 -31.831`}),a.jsxs("text",{x:"18",y:"20.35",className:"percentage",children:[Math.round(mn),"%"]})]})})]})]}),a.jsxs("div",{className:"calendar-nav",children:[a.jsx("button",{className:"nav-button",onClick:()=>Vn("prev"),onDragEnter:()=>{const j=Date.now();j-o.current>=1e3&&(Vn("prev"),o.current=j)},"aria-label":"Previous month",children:a.jsx(cu,{size:20})}),a.jsx("h2",{className:"month-year",children:Zt(p,"MMMM yyyy")}),a.jsx("button",{className:"nav-button",onClick:()=>Vn("next"),onDragEnter:()=>{const j=Date.now();j-o.current>=1e3&&(Vn("next"),o.current=j)},"aria-label":"Next month",children:a.jsx(Ky,{size:20})})]}),a.jsxs("div",{className:"calendar-grid",children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(j=>a.jsx("div",{className:"day-header",children:j},j)),wa.map((j,W)=>{const q=ba(j),ae=Zt(j,"yyyy-MM-dd"),_e=bv(j,new Date),Oe=Ae===ae,me=T===ae,Re=Le===ae,De=q?Gt(q):[],ue=q?Kr(q):void 0,fe=De.length>1,Me=Pr(j),Ve=q?.completedTypes||[],it=De.length>0?Ve.filter(ke=>De.includes(ke)).length||(q?.completed?De.length:0):q?.completed?1:0,rt=De.length>0?Math.min(100,it/De.length*100):q?.completed?100:0,Qe=q?Jn(q):null,He=q?Qr(q):!1,rr=He?xs(s.dailyWorkouts):0,Bt=W===0?` start-${xa+1}`:"";return a.jsxs("div",{className:`calendar-day${Bt} ${_e?" today":""} ${q?" has-workout":""} ${Oe?" drag-over":""}`+(ht?" delete-active":"")+($?" add-active":"")+(me?" loading":"")+(Re?" just-updated":"")+(oe.includes(ae)?" selected":"")+(Y?" rest-pending":"")+(bt.includes(ae)?" delete-selected":"")+(He?" streak-complete":""),onClick:()=>ki(j),onDragOver:ke=>dl(ke,j),onDragLeave:Ti,onDrop:ke=>fl(ke,j),children:[a.jsx("span",{className:"day-number",children:Zt(j,"d")}),Qe&&a.jsxs("span",{className:"day-total-time",children:[" ",Qe]}),He&&a.jsxs("div",{className:"streak-card",children:[a.jsx("div",{className:"streak-icon",children:a.jsx(fi,{size:32})}),a.jsx("div",{className:"streak-number",children:rr}),a.jsx("div",{className:"streak-label",children:"Day Streak"})]}),!He&&q?a.jsxs("div",{className:`workout-indicator ${fe?"multi":pn(ue)} ${q.completed?"completed":""}`,draggable:!E&&!Me,onDragStart:ke=>ja(ke,q),onDragEnd:Wt,children:[a.jsx("div",{className:"workout-progress-bar","aria-label":"Workout progress",children:a.jsx("div",{className:"progress-fill",style:{width:`${rt}%`}})}),fe&&De.length>1&&a.jsx("div",{className:"workout-segments","data-count":De.length,children:De.map(ke=>a.jsx("span",{className:`segment ${pn(ke)}`,draggable:!E&&!Me,onDragStart:Jt=>{try{Jt.dataTransfer.setData("text/fba-remove-type",JSON.stringify({date:q.date,type:ke})),Jt.dataTransfer.effectAllowed="move"}catch{}Ge(!0)}},ke))}),(me||pe.includes(ae))&&a.jsx("div",{className:"loader-overlay inside-indicator",children:a.jsx("div",{className:"loading-dumbbell small",children:a.jsx(Et,{size:28,color:"#fff"})})}),a.jsxs("div",{className:"workout-content",children:[a.jsx("span",{className:"workout-type",children:Sa(De)}),a.jsx("span",{className:"workout-duration",children:` ${Jn(q)}`}),Me&&a.jsx("span",{className:"workout-locked",children:rt===100?"Done (locked)":"Incomplete (locked)"}),q.completed&&a.jsx(Fo,{size:14,className:"check-icon"}),!q.completed&&ue!=="rest"&&a.jsx(Xy,{size:14,className:"play-icon"})]})]}):!He&&pe.includes(ae)?a.jsx("div",{className:"loader-overlay inside-indicator",children:a.jsx("div",{className:"loading-dumbbell small",children:a.jsx(Et,{size:28,color:"#fff"})})}):null]},j.toISOString())})]}),a.jsxs("div",{className:`calendar-legend${Se?" drop-target":""}`,onDragOver:ks,onDrop:hl,onDragLeave:Vt,children:[a.jsx("h3",{children:"Workout Types"}),a.jsxs("div",{className:"legend-items",children:[a.jsxs("div",{className:"legend-item",draggable:!0,onDragStart:j=>gn(j,"strength"),onDragEnd:$r,title:"Drag onto a date to generate a strength workout",children:[a.jsx("div",{className:"legend-color strength"}),a.jsx("span",{children:"Strength Training"})]}),a.jsxs("div",{className:"legend-item",draggable:!0,onDragStart:j=>gn(j,"cardio"),onDragEnd:$r,title:"Drag onto a date to generate a cardio workout",children:[a.jsx("div",{className:"legend-color cardio"}),a.jsx("span",{children:"Cardio"})]}),a.jsxs("div",{className:"legend-item",draggable:!0,onDragStart:j=>gn(j,"flexibility"),onDragEnd:$r,title:"Drag onto a date to generate a flexibility workout",children:[a.jsx("div",{className:"legend-color flexibility"}),a.jsx("span",{children:"Flexibility"})]}),a.jsxs("div",{className:"legend-item",draggable:!0,onDragStart:j=>gn(j,"mixed"),onDragEnd:$r,title:"Drag onto a date to generate a mixed workout",children:[a.jsx("div",{className:"legend-color mixed"}),a.jsx("span",{children:"Mixed"})]}),a.jsxs("div",{className:"legend-item",draggable:!0,onDragStart:j=>gn(j,"rest"),onDragEnd:$r,title:"Drag onto a date to add a rest day",children:[a.jsx("div",{className:"legend-color rest"}),a.jsx("span",{children:"Rest Day"})]})]})]})]}),"      ",x&&g&&a.jsx(Rw,{workout:g,onClose:()=>b(!1),onComplete:j=>ka(g.date,j),onRegenerateWorkout:()=>yt(g),isRegenerating:B,onUpdateWorkout:Ci}),a.jsx("button",{className:`edit-fab ${E?"active":""}`,onClick:()=>k(!E),"aria-label":"Edit workouts",children:E?a.jsx(pi,{size:24}):a.jsx(uu,{size:24})}),a.jsxs("div",{className:`edit-menu ${E?"open":""}`,children:[a.jsxs("div",{className:"edit-menu-header",children:[a.jsx("h3",{children:"Workout Editor"}),a.jsx("p",{children:"Customize your workout plan"})]}),a.jsxs("div",{className:"edit-menu-content",children:["          ",a.jsxs("div",{className:"edit-section",children:[a.jsxs("h4",{children:[a.jsx(ev,{size:16})," Quick Actions"]}),"            ",a.jsxs("div",{className:"edit-actions",children:[a.jsxs("button",{className:"edit-action-btn",onClick:ji,children:[a.jsx(Zy,{size:16}),$?"Selecting...":"Select to Add"]}),$&&a.jsxs("button",{className:"edit-action-btn confirm-btn",onClick:Ni,children:[a.jsx(du,{size:16})," Confirm"]}),le&&a.jsxs("div",{className:"batch-add-panel",children:[a.jsxs("h4",{children:["Batch Add Workouts (",oe.length," selected)"]}),a.jsx("label",{children:"Choose workout types (multi-select):"}),a.jsx("div",{className:"batch-types",children:["strength","cardio","flexibility","mixed","rest"].map(j=>a.jsxs("label",{className:`batch-type ${xe.includes(j)?"selected":""}`,children:[a.jsx("input",{type:"checkbox",checked:xe.includes(j),onChange:W=>{ge(q=>W.target.checked?[...q,j]:q.filter(ae=>ae!==j))}}),j]},j))}),a.jsx("label",{children:"Comments (optional):"}),a.jsx("textarea",{"aria-label":"Batch comments",value:H,onChange:j=>V(j.target.value)}),a.jsxs("div",{className:"batch-actions",children:[a.jsx("button",{className:"save-btn",onClick:Ei,disabled:oe.length===0,children:"Generate"}),a.jsx("button",{className:"cancel-btn",onClick:()=>{J(!1),re([])},children:"Cancel"})]})]}),a.jsxs("button",{className:"edit-action-btn",onClick:()=>{ne(!0),k(!1),G(!1)},title:"Click a calendar day to assign a Rest Day",children:[a.jsx(Tr,{size:16}),Y?"Click a day to add Rest":"Add Rest Day"]}),a.jsxs("button",{className:"edit-action-btn",onClick:()=>{jt(j=>{const W=!j;return W&&he(!1),W})},children:[a.jsx(Bo,{size:16})," ",ht?"Stop Delete":"Delete Days"]}),ht&&a.jsxs("div",{className:"delete-action-row",children:[a.jsxs("button",{className:"confirm-btn",onClick:Ss,disabled:bt.length===0,children:[a.jsx(Bo,{size:16})," Delete ",bt.length>0?`(${bt.length})`:""]}),a.jsx("button",{className:"cancel-btn",onClick:_s,children:"Cancel"})]}),a.jsxs("button",{className:"edit-action-btn clear-calendar-btn",onClick:pl,children:[a.jsx(Bo,{size:16}),"Clear Calendar"]})]}),X&&a.jsxs("div",{className:"date-picker-section",children:[a.jsx("label",{htmlFor:"rest-date",children:"Select date for rest day:"}),a.jsx("input",{id:"rest-date",type:"date",value:w,onChange:j=>L(j.target.value),className:"date-input"}),a.jsxs("div",{className:"date-picker-actions",children:[a.jsx("button",{className:"save-btn",onClick:ll,disabled:!w,children:"Add Rest Day"}),a.jsx("button",{className:"cancel-btn",onClick:()=>{G(!1),L("")},children:"Cancel"})]})]}),de&&a.jsxs("div",{className:"date-picker-section",children:[a.jsx("label",{htmlFor:"workout-date",children:"Select date for workout day:"}),a.jsx("input",{id:"workout-date",type:"date",value:ee,onChange:j=>ye(j.target.value),className:"date-input"}),a.jsx("label",{htmlFor:"workout-type",children:"Select workout type:"}),a.jsxs("select",{id:"workout-type",value:$e,onChange:j=>Ke(j.target.value),children:[a.jsx("option",{value:"strength",children:"Strength"}),a.jsx("option",{value:"cardio",children:"Cardio"}),a.jsx("option",{value:"flexibility",children:"Flexibility"}),a.jsx("option",{value:"mixed",children:"Mixed"})]}),a.jsx("label",{htmlFor:"workout-duration",children:"Duration:"}),a.jsx("input",{id:"workout-duration",type:"text",value:mt.duration,onChange:j=>yn("duration",j.target.value)}),a.jsx("label",{htmlFor:"muscle-groups",children:"Muscle Groups:"}),a.jsx("input",{id:"muscle-groups",type:"text",placeholder:"e.g., Legs, Arms",onChange:j=>yn("muscleGroups",j.target.value.split(",").map(W=>W.trim()))}),a.jsx("label",{htmlFor:"equipment",children:"Equipment:"}),a.jsx("input",{id:"equipment",type:"text",placeholder:"e.g., Dumbbells, Mat",onChange:j=>yn("equipment",j.target.value.split(",").map(W=>W.trim()))}),a.jsxs("div",{className:"date-picker-actions",children:[a.jsx("button",{className:"save-btn",onClick:_i,disabled:!ee,children:"Add Workout Day"}),a.jsx("button",{className:"cancel-btn",onClick:()=>{we(!1),ye("")},children:"Cancel"})]}),ee&&s?.dailyWorkouts.find(j=>j.date===ee)&&a.jsx("div",{className:"error-message",children:"This date already has a workout. Please select a different date."})]})]}),R&&D&&a.jsxs("div",{className:"edit-section",children:[a.jsxs("h4",{children:[a.jsx(uu,{size:16})," Editing ",(()=>{const[j,W,q]=D.date.split("-").map(Number);return Zt(new Date(j,W-1,q),"MMM d")})()]}),a.jsxs("div",{className:"workout-edit-form",children:[a.jsxs("label",{children:["Workout Type:",a.jsxs("select",{value:D.type,onChange:j=>O({...D,type:j.target.value}),children:[a.jsx("option",{value:"strength",children:"Strength"}),a.jsx("option",{value:"cardio",children:"Cardio"}),a.jsx("option",{value:"flexibility",children:"Flexibility"}),a.jsx("option",{value:"mixed",children:"Mixed"}),a.jsx("option",{value:"rest",children:"Rest"})]})]}),a.jsxs("div",{className:"edit-actions",children:[a.jsxs("button",{className:"save-btn",onClick:Xr,children:[a.jsx(du,{size:16}),"Save Changes"]}),a.jsxs("button",{className:"cancel-btn",onClick:Si,children:[a.jsx(pi,{size:16}),"Cancel"]})]})]})]}),a.jsxs("div",{className:"edit-section",children:[a.jsx("h4",{children:"Tips"}),a.jsxs("ul",{className:"edit-tips",children:[a.jsx("li",{children:"Click on any day to view and edit workouts"}),a.jsx("li",{children:"Use quick actions to add new workout or rest days"}),a.jsx("li",{children:"Changes are saved automatically to your plan"})]})]})]})]}),E&&a.jsx("div",{className:"edit-menu-overlay",onClick:()=>k(!1)}),a.jsx("div",{className:"edit-menu-popup-root","aria-hidden":!E,children:E&&$&&a.jsxs("div",{className:"workout-popup",children:[a.jsx("h3",{children:"Workout Details"}),a.jsx("label",{htmlFor:"workout-type",children:"Workout Type:"}),a.jsxs("select",{id:"workout-type",value:$e,onChange:j=>Ke(j.target.value),children:[a.jsx("option",{value:"strength",children:"Strength"}),a.jsx("option",{value:"cardio",children:"Cardio"}),a.jsx("option",{value:"flexibility",children:"Flexibility"}),a.jsx("option",{value:"mixed",children:"Mixed"})]}),a.jsx("label",{htmlFor:"workout-duration",children:"Duration:"}),a.jsx("input",{id:"workout-duration",type:"text",value:mt.duration,onChange:j=>yn("duration",j.target.value)}),a.jsx("label",{htmlFor:"muscle-groups",children:"Muscle Groups:"}),a.jsx("input",{id:"muscle-groups",type:"text",placeholder:"e.g., Legs, Arms",onChange:j=>yn("muscleGroups",j.target.value.split(",").map(W=>W.trim()))}),a.jsx("label",{htmlFor:"equipment",children:"Equipment:"}),a.jsx("input",{id:"equipment",type:"text",placeholder:"e.g., Dumbbells, Mat",onChange:j=>yn("equipment",j.target.value.split(",").map(W=>W.trim()))}),a.jsxs("div",{className:"workout-popup-actions",children:[a.jsx("button",{className:"save-btn",onClick:ul,children:"Generate Workout"}),a.jsx("button",{className:"cancel-btn",onClick:()=>he(!1),children:"Cancel"})]})]})})]})},Ep="fitbuddyai_tos_accepted_v1";function wi(){try{const s=localStorage.getItem(Ep);return s?JSON.parse(s):{}}catch{return{}}}function Lu(s){try{localStorage.setItem(Ep,JSON.stringify(s))}catch{}}function rl(s){try{const r=wi(),n=s?String(s):"__anon__",o=r[n],l=r.__anon__;return!!(o&&(o.tos||o.acceptedAt)||l&&(l.tos||l.acceptedAt))}catch{return!1}}function nl(s){try{const r=wi(),n=s?String(s):"__anon__",o=r[n],l=r.__anon__;return!!(o&&o.privacy||l&&l.privacy)}catch{return!1}}function fs(s){return rl(s)&&nl(s)}function Cp(s){try{const r=wi(),n=s?String(s):"__anon__",o=r[n]||{};o.tos={acceptedAt:new Date().toISOString()},r[n]=o,Lu(r);try{window.dispatchEvent(new CustomEvent("fitbuddyai-tos-accepted",{detail:{userId:n}}))}catch{}return!0}catch{return!1}}function Tp(s){try{const r=wi(),n=s?String(s):"__anon__",o=r[n]||{};o.privacy={acceptedAt:new Date().toISOString()},r[n]=o,Lu(r);try{window.dispatchEvent(new CustomEvent("fitbuddyai-privacy-accepted",{detail:{userId:n}}))}catch{}return!0}catch{return!1}}function Lw(s){try{if(!s)return!1;const r=wi(),n=r.__anon__;if(!n)return!1;const o=String(s),l=r[o]||{};let c=!1;if(n.tos&&!l.tos&&(l.tos=n.tos,c=!0),n.privacy&&!l.privacy&&(l.privacy=n.privacy,c=!0),c){if(r[o]=l,delete r.__anon__,Lu(r),l.tos)try{window.dispatchEvent(new CustomEvent("fitbuddyai-tos-accepted",{detail:{userId:o}}))}catch{}if(l.privacy)try{window.dispatchEvent(new CustomEvent("fitbuddyai-privacy-accepted",{detail:{userId:o}}))}catch{}}return c}catch{return!1}}function Lf({userData:s,children:r}){const[n,o]=S.useState(!1),[l,c]=S.useState(!1),[d,p]=S.useState(!1);if(S.useEffect(()=>{(()=>{c(rl(s?.id)),p(nl(s?.id)),o(!fs(s?.id))})();const y=()=>{c(!0),o(!fs(s?.id))},x=()=>{p(!0),o(!fs(s?.id))};return window.addEventListener("fitbuddyai-tos-accepted",y),window.addEventListener("fitbuddyai-privacy-accepted",x),()=>{window.removeEventListener("fitbuddyai-tos-accepted",y),window.removeEventListener("fitbuddyai-privacy-accepted",x)}},[s?.id]),!n)return a.jsx(a.Fragment,{children:r});const f=()=>{try{Cp(s?.id)}catch{}try{Tp(s?.id)}catch{}if(s?.id)try{et(()=>Promise.resolve().then(()=>Gn),void 0).then(g=>g.attachAuthHeaders({method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:s.id,accepted_terms:!0,accepted_privacy:!0})})).then(g=>{fetch("/api/userdata/save",g).catch(()=>{})}).catch(()=>{})}catch{}o(!1)};return a.jsxs("div",{className:"agreement-guard-wrapper","aria-hidden":"false",children:[a.jsx("div",{className:"agreement-guard-underlay","aria-hidden":"true",children:r}),a.jsx("div",{className:"agreement-guard-backdrop",role:"dialog","aria-modal":"true","aria-label":"Terms and Privacy agreement",children:a.jsxs("div",{className:"agreement-guard-modal",role:"document",children:[a.jsx("h2",{className:"agreement-guard-title",children:"Before you continue"}),a.jsxs("p",{className:"agreement-guard-body",children:["To continue, please agree to our ",a.jsx("a",{className:l?"agreement-accepted":"",href:"/terms",target:"_blank",rel:"noopener noreferrer",children:"Terms of Service"})," and ",a.jsx("a",{className:d?"agreement-accepted":"",href:"/privacy",target:"_blank",rel:"noopener noreferrer",children:"Privacy Policy"}),". Both will open in a new tab if you want to review them."]}),a.jsx("div",{className:"agreement-guard-actions",children:a.jsx("button",{className:"btn btn-agree",onClick:f,children:"I have read and agree"})})]})})]})}const Mw=({profileVersion:s,userData:r})=>{const n=Wr(),o=qn(),[l,c]=pr.useState(null),[d,p]=pr.useState(null);pr.useEffect(()=>{const b=()=>{if(r){c(r);return}try{const{loadUserData:E}=require("../services/localStorage"),k=E();c(k||null)}catch{c(null)}};b(),window.addEventListener("storage",b);const T=E=>{try{const k=E?.detail?.preview;k?.type==="avatar"&&k?.image&&(p(k.image),setTimeout(()=>p(null),4e3))}catch{}};window.addEventListener("shop-try-on",T),b();const _=setInterval(()=>{typeof document<"u"&&document.hidden||b()},15e3);return()=>{window.removeEventListener("storage",b),window.removeEventListener("shop-try-on",T),clearInterval(_)}},[o.pathname,s,r]);const f=pr.useMemo(()=>{try{const b=l||(()=>{try{const{loadUserData:_}=require("../services/localStorage");return _()||null}catch{return null}})();if(!b)return!1;if(b.role&&String(b.role).toLowerCase()==="admin")return!0;const T=b?.token||b?.access_token||null;if(T&&typeof T=="string")try{const _=T.split(".");if(_.length>=2){const E=JSON.parse(atob(_[1].replace(/-/g,"+").replace(/_/g,"/"))),k=E?.roles||E?.role||E?.roles?.join?.(",");if(Array.isArray(k)&&k.includes("admin")||String(k).toLowerCase()==="admin")return!0}}catch{}return String(b.username||"").toLowerCase()==="admin"}catch{return!1}},[l]),g=pr.useMemo(()=>{try{return l?!!(l.id||l.sub):!1}catch{return!1}},[l]),y=()=>{switch(o.pathname){case"/":return"Welcome to FitBuddyAI";case"/questionnaire":return"Fitness Assessment";case"/calendar":return"Your Workout Plan";case"/profile":return"Your Profile";case"/signin":return"Sign In";case"/signup":return"Sign Up";case"/chat":return"Chat with Buddy";default:return"FitBuddyAI"}},x=b=>o.pathname===b;return a.jsx("header",{className:"app-header",children:a.jsxs("div",{className:"header-container",children:[a.jsxs("div",{className:"page-title centered-title",children:[a.jsx("h2",{children:y()}),l&&(()=>{const b=l.username?.trim(),T=l.username?.trim(),_=b||T||"User";return a.jsxs("p",{className:"user-greeting",children:["Hello, ",_,"! "]})})()]}),a.jsxs("nav",{className:"header-nav",children:[a.jsxs("button",{className:`nav-button ${x("/")?"active":""}`,onClick:()=>n("/?intro=0"),"aria-label":"Home",children:[a.jsx(Qy,{size:20,className:"home-icon"}),a.jsx("span",{children:"Home"})]}),a.jsxs("button",{className:`nav-button ${x("/questionnaire")?"active":""}`,onClick:()=>{br()?.completed?n("/questionnaire?edit=true"):n("/questionnaire")},"aria-label":"Questionnaire",children:[a.jsx(ua,{size:20}),a.jsx("span",{children:"Assessment"})]}),a.jsxs("button",{className:`nav-button ${x("/calendar")?"active":""}`,onClick:()=>n("/calendar"),"aria-label":"Workout Calendar",title:g?"Open calendar":"Sign in to save and sync your calendar",children:[a.jsx(Tr,{size:20}),a.jsx("span",{children:"Calendar"})]}),a.jsxs("button",{className:`nav-button ${x("/chat")?"active":""}`,onClick:()=>{try{window.dispatchEvent(new CustomEvent("fitbuddyai-open-chat"))}catch{}n("/chat")},"aria-label":"Chat with Buddy",children:[a.jsx("span",{className:"sparkles-mobile-only",children:a.jsx(dn,{size:20})}),a.jsx("span",{children:"Chat"})]}),a.jsxs("div",{className:"nav-dropdown",children:[a.jsx("button",{className:"nav-button","aria-label":"Explore",children:"Explore "}),a.jsxs("div",{className:"dropdown-content",children:[a.jsx("button",{onClick:()=>n("/dashboard"),children:"Dashboard"}),a.jsx("button",{onClick:()=>n("/workouts"),children:"Workouts"}),a.jsx("button",{onClick:()=>n("/nutrition"),children:"Nutrition"}),a.jsx("button",{onClick:()=>n("/blog"),children:"Blog"}),a.jsx("button",{onClick:()=>n("/pricing"),children:"Pricing"}),a.jsx("button",{onClick:()=>n("/shop"),className:"dropdown-shop",children:"Shop"})]})]}),f&&a.jsxs("button",{className:`nav-button ${x("/admin")?"active":""}`,onClick:()=>n("/admin"),"aria-label":"Admin",children:[a.jsx("span",{className:"flame-mobile-only",children:a.jsx(fi,{size:20})}),a.jsx("span",{children:"Admin"})]}),g&&a.jsx(a.Fragment,{children:a.jsxs("div",{className:"header-counters",children:[a.jsxs("div",{className:"header-counter streak",children:[a.jsx(fi,{size:20,color:"#ffb347",style:{marginRight:4}}),a.jsx("span",{className:"counter-value",children:l?.streak??0})]}),a.jsxs("div",{className:"header-counter energy",children:[a.jsx(dn,{size:20,color:"#1e90cb",style:{marginRight:4}}),a.jsx("span",{className:"counter-value",children:l?.energy??0})]})]})}),a.jsxs("div",{className:"profile-section",children:[a.jsx("img",{src:d||(l&&l.avatar&&l.avatar.trim()?l.avatar:"/images/fitbuddy_head.png"),alt:"Profile",className:"profile-image",onClick:()=>n(g?"/profile":"/signin")}),a.jsxs("div",{className:"dropdown",children:[a.jsx("button",{className:"dropdown-button",onClick:()=>n(g?"/profile":"/signin"),children:g?l.username&&l.username.trim()||"User":"Sign In"}),a.jsx("div",{className:"dropdown-content",children:g?a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>n("/profile"),children:" Profile"}),a.jsx("button",{onClick:()=>n("/profile/settings"),children:"Settings"}),a.jsx("button",{onClick:()=>n("/profile/friends"),children:"Friends"}),a.jsx("button",{onClick:()=>n("/profile/achievements"),children:"Achievements"}),a.jsx("button",{onClick:()=>{(async()=>{try{localStorage.setItem("fitbuddyai_no_auto_restore","1")}catch{}try{sessionStorage.setItem("fitbuddyai_no_auto_restore","1")}catch{}try{const{loadUserData:b}=await et(async()=>{const{loadUserData:E}=await Promise.resolve().then(()=>ir);return{loadUserData:E}},void 0),T=b(),_=T?.id||T?.sub||T?.data?.id||null;if(_){const E=(async()=>{try{await Iu(String(_))}catch{}})(),k=new Promise(D=>setTimeout(D,2e3));await Promise.race([E,k])}}catch{}try{ma()}catch{}try{pa()}catch{}try{yi()}catch{}window.dispatchEvent(new Event("fitbuddyai-logout")),n("/signin")})()},children:"Sign Out"})]}):a.jsx("button",{onClick:()=>n("/signin"),children:"Sign In"})})]})]})]})]})})};function Uw({themeMode:s="auto",onChangeThemeMode:r}){const n=s||"auto";return a.jsx("footer",{className:"fb-footer",children:a.jsxs("div",{className:"fb-footer-inner",children:[a.jsxs("div",{className:"fb-brand",children:[a.jsx("div",{className:"fb-logo",children:a.jsx(Et,{size:28,color:"#fff"})}),a.jsxs("div",{children:[a.jsx("h4",{children:"FitBuddyAI"}),a.jsx("p",{className:"muted",children:"Your friendly AI Fitness Companion"})]})]}),a.jsxs("div",{className:"fb-links",children:[a.jsxs("div",{className:"fb-col",children:[a.jsx("h5",{children:"Product"}),a.jsx(Fr,{to:"/questionnaire",children:"Get Started"}),a.jsx(Fr,{to:"/chat",children:"AI Coach"}),a.jsx(Fr,{to:"/shop",children:"Shop"})]}),a.jsxs("div",{className:"fb-col",children:[a.jsx("h5",{children:"Legal"}),a.jsx(Fr,{to:"/terms",children:"Terms of Service"}),a.jsx(Fr,{to:"/privacy",children:"Privacy Policy"})]}),a.jsxs("div",{className:"fb-col",children:[a.jsx("h5",{children:"Support"}),a.jsx("a",{href:"mailto:fitbuddyaig@gmail.com",children:"fitbuddyaig@gmail.com"}),a.jsx(Fr,{to:"/help",children:"Help Center"})]})]}),a.jsxs("div",{className:"fb-bottom",children:[a.jsxs("div",{children:[" ",new Date().getFullYear()," FitBuddyAI, LLC. All rights reserved."]}),a.jsx("div",{className:"socials muted",children:"Made with  for a healthier life"}),a.jsxs("div",{className:"fb-theme",children:[a.jsx("label",{className:"fb-theme-label",children:"Theme"}),a.jsxs("div",{className:"fb-theme-selector",role:"tablist","aria-label":"Theme selector",children:[a.jsx("button",{className:`fb-theme-btn ${n==="auto"?"active":""}`,onClick:()=>r?.("auto"),children:"Auto"}),a.jsx("button",{className:`fb-theme-btn ${n==="light"?"active":""}`,onClick:()=>r?.("light"),children:"Light"}),a.jsx("button",{className:`fb-theme-btn ${n==="dark"?"active":""}`,onClick:()=>r?.("dark"),children:"Dark"})]})]})]})]})})}const Io=()=>a.jsx("div",{className:"loading-screen",children:a.jsxs("div",{className:"loading-container fade-in-bounce",children:[a.jsx("div",{className:"loading-dumbbell",children:a.jsx(Et,{size:40,color:"#fff"})}),a.jsxs("div",{className:"loading-icons",children:[a.jsxs("div",{className:"loading-icon-pill",children:[a.jsx(Cr,{size:18}),a.jsx("span",{children:"Goals"})]}),a.jsxs("div",{className:"loading-icon-pill",children:[a.jsx(Tr,{size:18}),a.jsx("span",{children:"Schedule"})]}),a.jsxs("div",{className:"loading-icon-pill",children:[a.jsx(ps,{size:18}),a.jsx("span",{children:"Energy"})]}),a.jsxs("div",{className:"loading-icon-pill",children:[a.jsx(Et,{size:18}),a.jsx("span",{children:"Strength"})]})]}),a.jsx("h2",{className:"loading-title",children:"Hang tight!"}),a.jsx("p",{className:"loading-desc",children:"Your personalized plan is on its way..."}),a.jsx("p",{className:"ai-disclaimer",children:"Disclaimer: This plan is AI-generated and may not be perfect for everyone. Check important info."})]})}),Fw=s=>{let r;return s?r=s:typeof fetch>"u"?r=(...n)=>et(async()=>{const{default:o}=await Promise.resolve().then(()=>ga);return{default:o}},void 0).then(({default:o})=>o(...n)):r=fetch,(...n)=>r(...n)};class Mu extends Error{constructor(r,n="FunctionsError",o){super(r),this.name=n,this.context=o}}class Ww extends Mu{constructor(r){super("Failed to send a request to the Edge Function","FunctionsFetchError",r)}}class Mf extends Mu{constructor(r){super("Relay Error invoking the Edge Function","FunctionsRelayError",r)}}class Uf extends Mu{constructor(r){super("Edge Function returned a non-2xx status code","FunctionsHttpError",r)}}var pu;(function(s){s.Any="any",s.ApNortheast1="ap-northeast-1",s.ApNortheast2="ap-northeast-2",s.ApSouth1="ap-south-1",s.ApSoutheast1="ap-southeast-1",s.ApSoutheast2="ap-southeast-2",s.CaCentral1="ca-central-1",s.EuCentral1="eu-central-1",s.EuWest1="eu-west-1",s.EuWest2="eu-west-2",s.EuWest3="eu-west-3",s.SaEast1="sa-east-1",s.UsEast1="us-east-1",s.UsWest1="us-west-1",s.UsWest2="us-west-2"})(pu||(pu={}));var Bw=function(s,r,n,o){function l(c){return c instanceof n?c:new n(function(d){d(c)})}return new(n||(n=Promise))(function(c,d){function p(y){try{g(o.next(y))}catch(x){d(x)}}function f(y){try{g(o.throw(y))}catch(x){d(x)}}function g(y){y.done?c(y.value):l(y.value).then(p,f)}g((o=o.apply(s,r||[])).next())})};class $w{constructor(r,{headers:n={},customFetch:o,region:l=pu.Any}={}){this.url=r,this.headers=n,this.region=l,this.fetch=Fw(o)}setAuth(r){this.headers.Authorization=`Bearer ${r}`}invoke(r,n={}){var o;return Bw(this,void 0,void 0,function*(){try{const{headers:l,method:c,body:d}=n;let p={},{region:f}=n;f||(f=this.region);const g=new URL(`${this.url}/${r}`);f&&f!=="any"&&(p["x-region"]=f,g.searchParams.set("forceFunctionRegion",f));let y;d&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)&&(typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(p["Content-Type"]="application/octet-stream",y=d):typeof d=="string"?(p["Content-Type"]="text/plain",y=d):typeof FormData<"u"&&d instanceof FormData?y=d:(p["Content-Type"]="application/json",y=JSON.stringify(d)));const x=yield this.fetch(g.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},p),this.headers),l),body:y}).catch(E=>{throw new Ww(E)}),b=x.headers.get("x-relay-error");if(b&&b==="true")throw new Mf(x);if(!x.ok)throw new Uf(x);let T=((o=x.headers.get("Content-Type"))!==null&&o!==void 0?o:"text/plain").split(";")[0].trim(),_;return T==="application/json"?_=yield x.json():T==="application/octet-stream"?_=yield x.blob():T==="text/event-stream"?_=x:T==="multipart/form-data"?_=yield x.formData():_=yield x.text(),{data:_,error:null,response:x}}catch(l){return{data:null,error:l,response:l instanceof Uf||l instanceof Mf?l.context:void 0}}})}}var Ut={},Js={},Ks={},Ys={},Qs={},Xs={},zw=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},da=zw();const qw=da.fetch,Pp=da.fetch.bind(da),Ap=da.Headers,Hw=da.Request,Gw=da.Response,ga=Object.freeze(Object.defineProperty({__proto__:null,Headers:Ap,Request:Hw,Response:Gw,default:Pp,fetch:qw},Symbol.toStringTag,{value:"Module"})),Vw=Og(ga);var Do={},Ff;function Op(){if(Ff)return Do;Ff=1,Object.defineProperty(Do,"__esModule",{value:!0});class s extends Error{constructor(n){super(n.message),this.name="PostgrestError",this.details=n.details,this.hint=n.hint,this.code=n.code}}return Do.default=s,Do}var Wf;function Ip(){if(Wf)return Xs;Wf=1;var s=Xs&&Xs.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(Xs,"__esModule",{value:!0});const r=s(Vw),n=s(Op());class o{constructor(c){var d,p;this.shouldThrowOnError=!1,this.method=c.method,this.url=c.url,this.headers=new Headers(c.headers),this.schema=c.schema,this.body=c.body,this.shouldThrowOnError=(d=c.shouldThrowOnError)!==null&&d!==void 0?d:!1,this.signal=c.signal,this.isMaybeSingle=(p=c.isMaybeSingle)!==null&&p!==void 0?p:!1,c.fetch?this.fetch=c.fetch:typeof fetch>"u"?this.fetch=r.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(c,d){return this.headers=new Headers(this.headers),this.headers.set(c,d),this}then(c,d){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const p=this.fetch;let f=p(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async g=>{var y,x,b,T;let _=null,E=null,k=null,D=g.status,O=g.statusText;if(g.ok){if(this.method!=="HEAD"){const G=await g.text();G===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((y=this.headers.get("Accept"))===null||y===void 0)&&y.includes("application/vnd.pgrst.plan+text"))?E=G:E=JSON.parse(G))}const M=(x=this.headers.get("Prefer"))===null||x===void 0?void 0:x.match(/count=(exact|planned|estimated)/),X=(b=g.headers.get("content-range"))===null||b===void 0?void 0:b.split("/");M&&X&&X.length>1&&(k=parseInt(X[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(E)&&(E.length>1?(_={code:"PGRST116",details:`Results contain ${E.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},E=null,k=null,D=406,O="Not Acceptable"):E.length===1?E=E[0]:E=null)}else{const M=await g.text();try{_=JSON.parse(M),Array.isArray(_)&&g.status===404&&(E=[],_=null,D=200,O="OK")}catch{g.status===404&&M===""?(D=204,O="No Content"):_={message:M}}if(_&&this.isMaybeSingle&&(!((T=_?.details)===null||T===void 0)&&T.includes("0 rows"))&&(_=null,D=200,O="OK"),_&&this.shouldThrowOnError)throw new n.default(_)}return{error:_,data:E,count:k,status:D,statusText:O}});return this.shouldThrowOnError||(f=f.catch(g=>{var y,x,b;return{error:{message:`${(y=g?.name)!==null&&y!==void 0?y:"FetchError"}: ${g?.message}`,details:`${(x=g?.stack)!==null&&x!==void 0?x:""}`,hint:"",code:`${(b=g?.code)!==null&&b!==void 0?b:""}`},data:null,count:null,status:0,statusText:""}})),f.then(c,d)}returns(){return this}overrideTypes(){return this}}return Xs.default=o,Xs}var Bf;function Dp(){if(Bf)return Qs;Bf=1;var s=Qs&&Qs.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Qs,"__esModule",{value:!0});const r=s(Ip());class n extends r.default{select(l){let c=!1;const d=(l??"*").split("").map(p=>/\s/.test(p)&&!c?"":(p==='"'&&(c=!c),p)).join("");return this.url.searchParams.set("select",d),this.headers.append("Prefer","return=representation"),this}order(l,{ascending:c=!0,nullsFirst:d,foreignTable:p,referencedTable:f=p}={}){const g=f?`${f}.order`:"order",y=this.url.searchParams.get(g);return this.url.searchParams.set(g,`${y?`${y},`:""}${l}.${c?"asc":"desc"}${d===void 0?"":d?".nullsfirst":".nullslast"}`),this}limit(l,{foreignTable:c,referencedTable:d=c}={}){const p=typeof d>"u"?"limit":`${d}.limit`;return this.url.searchParams.set(p,`${l}`),this}range(l,c,{foreignTable:d,referencedTable:p=d}={}){const f=typeof p>"u"?"offset":`${p}.offset`,g=typeof p>"u"?"limit":`${p}.limit`;return this.url.searchParams.set(f,`${l}`),this.url.searchParams.set(g,`${c-l+1}`),this}abortSignal(l){return this.signal=l,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:l=!1,verbose:c=!1,settings:d=!1,buffers:p=!1,wal:f=!1,format:g="text"}={}){var y;const x=[l?"analyze":null,c?"verbose":null,d?"settings":null,p?"buffers":null,f?"wal":null].filter(Boolean).join("|"),b=(y=this.headers.get("Accept"))!==null&&y!==void 0?y:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${g}; for="${b}"; options=${x};`),g==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(l){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${l}`),this}}return Qs.default=n,Qs}var $f;function Uu(){if($f)return Ys;$f=1;var s=Ys&&Ys.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Ys,"__esModule",{value:!0});const r=s(Dp());class n extends r.default{eq(l,c){return this.url.searchParams.append(l,`eq.${c}`),this}neq(l,c){return this.url.searchParams.append(l,`neq.${c}`),this}gt(l,c){return this.url.searchParams.append(l,`gt.${c}`),this}gte(l,c){return this.url.searchParams.append(l,`gte.${c}`),this}lt(l,c){return this.url.searchParams.append(l,`lt.${c}`),this}lte(l,c){return this.url.searchParams.append(l,`lte.${c}`),this}like(l,c){return this.url.searchParams.append(l,`like.${c}`),this}likeAllOf(l,c){return this.url.searchParams.append(l,`like(all).{${c.join(",")}}`),this}likeAnyOf(l,c){return this.url.searchParams.append(l,`like(any).{${c.join(",")}}`),this}ilike(l,c){return this.url.searchParams.append(l,`ilike.${c}`),this}ilikeAllOf(l,c){return this.url.searchParams.append(l,`ilike(all).{${c.join(",")}}`),this}ilikeAnyOf(l,c){return this.url.searchParams.append(l,`ilike(any).{${c.join(",")}}`),this}is(l,c){return this.url.searchParams.append(l,`is.${c}`),this}in(l,c){const d=Array.from(new Set(c)).map(p=>typeof p=="string"&&new RegExp("[,()]").test(p)?`"${p}"`:`${p}`).join(",");return this.url.searchParams.append(l,`in.(${d})`),this}contains(l,c){return typeof c=="string"?this.url.searchParams.append(l,`cs.${c}`):Array.isArray(c)?this.url.searchParams.append(l,`cs.{${c.join(",")}}`):this.url.searchParams.append(l,`cs.${JSON.stringify(c)}`),this}containedBy(l,c){return typeof c=="string"?this.url.searchParams.append(l,`cd.${c}`):Array.isArray(c)?this.url.searchParams.append(l,`cd.{${c.join(",")}}`):this.url.searchParams.append(l,`cd.${JSON.stringify(c)}`),this}rangeGt(l,c){return this.url.searchParams.append(l,`sr.${c}`),this}rangeGte(l,c){return this.url.searchParams.append(l,`nxl.${c}`),this}rangeLt(l,c){return this.url.searchParams.append(l,`sl.${c}`),this}rangeLte(l,c){return this.url.searchParams.append(l,`nxr.${c}`),this}rangeAdjacent(l,c){return this.url.searchParams.append(l,`adj.${c}`),this}overlaps(l,c){return typeof c=="string"?this.url.searchParams.append(l,`ov.${c}`):this.url.searchParams.append(l,`ov.{${c.join(",")}}`),this}textSearch(l,c,{config:d,type:p}={}){let f="";p==="plain"?f="pl":p==="phrase"?f="ph":p==="websearch"&&(f="w");const g=d===void 0?"":`(${d})`;return this.url.searchParams.append(l,`${f}fts${g}.${c}`),this}match(l){return Object.entries(l).forEach(([c,d])=>{this.url.searchParams.append(c,`eq.${d}`)}),this}not(l,c,d){return this.url.searchParams.append(l,`not.${c}.${d}`),this}or(l,{foreignTable:c,referencedTable:d=c}={}){const p=d?`${d}.or`:"or";return this.url.searchParams.append(p,`(${l})`),this}filter(l,c,d){return this.url.searchParams.append(l,`${c}.${d}`),this}}return Ys.default=n,Ys}var zf;function Rp(){if(zf)return Ks;zf=1;var s=Ks&&Ks.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Ks,"__esModule",{value:!0});const r=s(Uu());class n{constructor(l,{headers:c={},schema:d,fetch:p}){this.url=l,this.headers=new Headers(c),this.schema=d,this.fetch=p}select(l,{head:c=!1,count:d}={}){const p=c?"HEAD":"GET";let f=!1;const g=(l??"*").split("").map(y=>/\s/.test(y)&&!f?"":(y==='"'&&(f=!f),y)).join("");return this.url.searchParams.set("select",g),d&&this.headers.append("Prefer",`count=${d}`),new r.default({method:p,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(l,{count:c,defaultToNull:d=!0}={}){var p;const f="POST";if(c&&this.headers.append("Prefer",`count=${c}`),d||this.headers.append("Prefer","missing=default"),Array.isArray(l)){const g=l.reduce((y,x)=>y.concat(Object.keys(x)),[]);if(g.length>0){const y=[...new Set(g)].map(x=>`"${x}"`);this.url.searchParams.set("columns",y.join(","))}}return new r.default({method:f,url:this.url,headers:this.headers,schema:this.schema,body:l,fetch:(p=this.fetch)!==null&&p!==void 0?p:fetch})}upsert(l,{onConflict:c,ignoreDuplicates:d=!1,count:p,defaultToNull:f=!0}={}){var g;const y="POST";if(this.headers.append("Prefer",`resolution=${d?"ignore":"merge"}-duplicates`),c!==void 0&&this.url.searchParams.set("on_conflict",c),p&&this.headers.append("Prefer",`count=${p}`),f||this.headers.append("Prefer","missing=default"),Array.isArray(l)){const x=l.reduce((b,T)=>b.concat(Object.keys(T)),[]);if(x.length>0){const b=[...new Set(x)].map(T=>`"${T}"`);this.url.searchParams.set("columns",b.join(","))}}return new r.default({method:y,url:this.url,headers:this.headers,schema:this.schema,body:l,fetch:(g=this.fetch)!==null&&g!==void 0?g:fetch})}update(l,{count:c}={}){var d;const p="PATCH";return c&&this.headers.append("Prefer",`count=${c}`),new r.default({method:p,url:this.url,headers:this.headers,schema:this.schema,body:l,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}delete({count:l}={}){var c;const d="DELETE";return l&&this.headers.append("Prefer",`count=${l}`),new r.default({method:d,url:this.url,headers:this.headers,schema:this.schema,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}}return Ks.default=n,Ks}var qf;function Jw(){if(qf)return Js;qf=1;var s=Js&&Js.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(Js,"__esModule",{value:!0});const r=s(Rp()),n=s(Uu());class o{constructor(c,{headers:d={},schema:p,fetch:f}={}){this.url=c,this.headers=new Headers(d),this.schemaName=p,this.fetch=f}from(c){const d=new URL(`${this.url}/${c}`);return new r.default(d,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(c){return new o(this.url,{headers:this.headers,schema:c,fetch:this.fetch})}rpc(c,d={},{head:p=!1,get:f=!1,count:g}={}){var y;let x;const b=new URL(`${this.url}/rpc/${c}`);let T;p||f?(x=p?"HEAD":"GET",Object.entries(d).filter(([E,k])=>k!==void 0).map(([E,k])=>[E,Array.isArray(k)?`{${k.join(",")}}`:`${k}`]).forEach(([E,k])=>{b.searchParams.append(E,k)})):(x="POST",T=d);const _=new Headers(this.headers);return g&&_.set("Prefer",`count=${g}`),new n.default({method:x,url:b,headers:_,schema:this.schemaName,body:T,fetch:(y=this.fetch)!==null&&y!==void 0?y:fetch})}}return Js.default=o,Js}var Hf;function Kw(){if(Hf)return Ut;Hf=1;var s=Ut&&Ut.__importDefault||function(p){return p&&p.__esModule?p:{default:p}};Object.defineProperty(Ut,"__esModule",{value:!0}),Ut.PostgrestError=Ut.PostgrestBuilder=Ut.PostgrestTransformBuilder=Ut.PostgrestFilterBuilder=Ut.PostgrestQueryBuilder=Ut.PostgrestClient=void 0;const r=s(Jw());Ut.PostgrestClient=r.default;const n=s(Rp());Ut.PostgrestQueryBuilder=n.default;const o=s(Uu());Ut.PostgrestFilterBuilder=o.default;const l=s(Dp());Ut.PostgrestTransformBuilder=l.default;const c=s(Ip());Ut.PostgrestBuilder=c.default;const d=s(Op());return Ut.PostgrestError=d.default,Ut.default={PostgrestClient:r.default,PostgrestQueryBuilder:n.default,PostgrestFilterBuilder:o.default,PostgrestTransformBuilder:l.default,PostgrestBuilder:c.default,PostgrestError:d.default},Ut}var Yw=Kw();const Qw=Nu(Yw),{PostgrestClient:Xw,PostgrestQueryBuilder:Nb,PostgrestFilterBuilder:Eb,PostgrestTransformBuilder:Cb,PostgrestBuilder:Tb,PostgrestError:Pb}=Qw;class Zw{static detectEnvironment(){var r;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((r=navigator.userAgent)===null||r===void 0)&&r.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const n=process.versions;if(n&&n.node){const o=n.node,l=parseInt(o.replace(/^v/,"").split(".")[0]);return l>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${l} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${l} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const r=this.detectEnvironment();if(r.constructor)return r.constructor;let n=r.error||"WebSocket not supported in this environment.";throw r.workaround&&(n+=`

Suggested solution: ${r.workaround}`),new Error(n)}static createWebSocket(r,n){const o=this.getWebSocketConstructor();return new o(r,n)}static isWebSocketSupported(){try{const r=this.detectEnvironment();return r.type==="native"||r.type==="ws"}catch{return!1}}}const e0="2.15.5",t0=`realtime-js/${e0}`,r0="1.0.0",mu=1e4,n0=1e3,s0=100;var li;(function(s){s[s.connecting=0]="connecting",s[s.open=1]="open",s[s.closing=2]="closing",s[s.closed=3]="closed"})(li||(li={}));var Ot;(function(s){s.closed="closed",s.errored="errored",s.joined="joined",s.joining="joining",s.leaving="leaving"})(Ot||(Ot={}));var Ur;(function(s){s.close="phx_close",s.error="phx_error",s.join="phx_join",s.reply="phx_reply",s.leave="phx_leave",s.access_token="access_token"})(Ur||(Ur={}));var gu;(function(s){s.websocket="websocket"})(gu||(gu={}));var ds;(function(s){s.Connecting="connecting",s.Open="open",s.Closing="closing",s.Closed="closed"})(ds||(ds={}));class a0{constructor(){this.HEADER_LENGTH=1}decode(r,n){return r.constructor===ArrayBuffer?n(this._binaryDecode(r)):n(typeof r=="string"?JSON.parse(r):{})}_binaryDecode(r){const n=new DataView(r),o=new TextDecoder;return this._decodeBroadcast(r,n,o)}_decodeBroadcast(r,n,o){const l=n.getUint8(1),c=n.getUint8(2);let d=this.HEADER_LENGTH+2;const p=o.decode(r.slice(d,d+l));d=d+l;const f=o.decode(r.slice(d,d+c));d=d+c;const g=JSON.parse(o.decode(r.slice(d,r.byteLength)));return{ref:null,topic:p,event:f,payload:g}}}class Lp{constructor(r,n){this.callback=r,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=r,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var lt;(function(s){s.abstime="abstime",s.bool="bool",s.date="date",s.daterange="daterange",s.float4="float4",s.float8="float8",s.int2="int2",s.int4="int4",s.int4range="int4range",s.int8="int8",s.int8range="int8range",s.json="json",s.jsonb="jsonb",s.money="money",s.numeric="numeric",s.oid="oid",s.reltime="reltime",s.text="text",s.time="time",s.timestamp="timestamp",s.timestamptz="timestamptz",s.timetz="timetz",s.tsrange="tsrange",s.tstzrange="tstzrange"})(lt||(lt={}));const Gf=(s,r,n={})=>{var o;const l=(o=n.skipTypes)!==null&&o!==void 0?o:[];return Object.keys(r).reduce((c,d)=>(c[d]=i0(d,s,r,l),c),{})},i0=(s,r,n,o)=>{const l=r.find(p=>p.name===s),c=l?.type,d=n[s];return c&&!o.includes(c)?Mp(c,d):yu(d)},Mp=(s,r)=>{if(s.charAt(0)==="_"){const n=s.slice(1,s.length);return u0(r,n)}switch(s){case lt.bool:return o0(r);case lt.float4:case lt.float8:case lt.int2:case lt.int4:case lt.int8:case lt.numeric:case lt.oid:return l0(r);case lt.json:case lt.jsonb:return c0(r);case lt.timestamp:return d0(r);case lt.abstime:case lt.date:case lt.daterange:case lt.int4range:case lt.int8range:case lt.money:case lt.reltime:case lt.text:case lt.time:case lt.timestamptz:case lt.timetz:case lt.tsrange:case lt.tstzrange:return yu(r);default:return yu(r)}},yu=s=>s,o0=s=>{switch(s){case"t":return!0;case"f":return!1;default:return s}},l0=s=>{if(typeof s=="string"){const r=parseFloat(s);if(!Number.isNaN(r))return r}return s},c0=s=>{if(typeof s=="string")try{return JSON.parse(s)}catch(r){return console.log(`JSON parse error: ${r}`),s}return s},u0=(s,r)=>{if(typeof s!="string")return s;const n=s.length-1,o=s[n];if(s[0]==="{"&&o==="}"){let c;const d=s.slice(1,n);try{c=JSON.parse("["+d+"]")}catch{c=d?d.split(","):[]}return c.map(p=>Mp(r,p))}return s},d0=s=>typeof s=="string"?s.replace(" ","T"):s,Up=s=>{let r=s;return r=r.replace(/^ws/i,"http"),r=r.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),r.replace(/\/+$/,"")+"/api/broadcast"};class Qc{constructor(r,n,o={},l=mu){this.channel=r,this.event=n,this.payload=o,this.timeout=l,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(r){this.timeout=r,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(r){this.payload=Object.assign(Object.assign({},this.payload),r)}receive(r,n){var o;return this._hasReceived(r)&&n((o=this.receivedResp)===null||o===void 0?void 0:o.response),this.recHooks.push({status:r,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const r=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},r),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(r,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:r,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:r,response:n}){this.recHooks.filter(o=>o.status===r).forEach(o=>o.callback(n))}_hasReceived(r){return this.receivedResp&&this.receivedResp.status===r}}var Vf;(function(s){s.SYNC="sync",s.JOIN="join",s.LEAVE="leave"})(Vf||(Vf={}));class ci{constructor(r,n){this.channel=r,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const o=n?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(o.state,{},l=>{const{onJoin:c,onLeave:d,onSync:p}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ci.syncState(this.state,l,c,d),this.pendingDiffs.forEach(f=>{this.state=ci.syncDiff(this.state,f,c,d)}),this.pendingDiffs=[],p()}),this.channel._on(o.diff,{},l=>{const{onJoin:c,onLeave:d,onSync:p}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(l):(this.state=ci.syncDiff(this.state,l,c,d),p())}),this.onJoin((l,c,d)=>{this.channel._trigger("presence",{event:"join",key:l,currentPresences:c,newPresences:d})}),this.onLeave((l,c,d)=>{this.channel._trigger("presence",{event:"leave",key:l,currentPresences:c,leftPresences:d})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(r,n,o,l){const c=this.cloneDeep(r),d=this.transformState(n),p={},f={};return this.map(c,(g,y)=>{d[g]||(f[g]=y)}),this.map(d,(g,y)=>{const x=c[g];if(x){const b=y.map(k=>k.presence_ref),T=x.map(k=>k.presence_ref),_=y.filter(k=>T.indexOf(k.presence_ref)<0),E=x.filter(k=>b.indexOf(k.presence_ref)<0);_.length>0&&(p[g]=_),E.length>0&&(f[g]=E)}else p[g]=y}),this.syncDiff(c,{joins:p,leaves:f},o,l)}static syncDiff(r,n,o,l){const{joins:c,leaves:d}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return o||(o=()=>{}),l||(l=()=>{}),this.map(c,(p,f)=>{var g;const y=(g=r[p])!==null&&g!==void 0?g:[];if(r[p]=this.cloneDeep(f),y.length>0){const x=r[p].map(T=>T.presence_ref),b=y.filter(T=>x.indexOf(T.presence_ref)<0);r[p].unshift(...b)}o(p,y,f)}),this.map(d,(p,f)=>{let g=r[p];if(!g)return;const y=f.map(x=>x.presence_ref);g=g.filter(x=>y.indexOf(x.presence_ref)<0),r[p]=g,l(p,g,f),g.length===0&&delete r[p]}),r}static map(r,n){return Object.getOwnPropertyNames(r).map(o=>n(o,r[o]))}static transformState(r){return r=this.cloneDeep(r),Object.getOwnPropertyNames(r).reduce((n,o)=>{const l=r[o];return"metas"in l?n[o]=l.metas.map(c=>(c.presence_ref=c.phx_ref,delete c.phx_ref,delete c.phx_ref_prev,c)):n[o]=l,n},{})}static cloneDeep(r){return JSON.parse(JSON.stringify(r))}onJoin(r){this.caller.onJoin=r}onLeave(r){this.caller.onLeave=r}onSync(r){this.caller.onSync=r}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Jf;(function(s){s.ALL="*",s.INSERT="INSERT",s.UPDATE="UPDATE",s.DELETE="DELETE"})(Jf||(Jf={}));var ui;(function(s){s.BROADCAST="broadcast",s.PRESENCE="presence",s.POSTGRES_CHANGES="postgres_changes",s.SYSTEM="system"})(ui||(ui={}));var un;(function(s){s.SUBSCRIBED="SUBSCRIBED",s.TIMED_OUT="TIMED_OUT",s.CLOSED="CLOSED",s.CHANNEL_ERROR="CHANNEL_ERROR"})(un||(un={}));class Fu{constructor(r,n={config:{}},o){this.topic=r,this.params=n,this.socket=o,this.bindings={},this.state=Ot.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=r.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Qc(this,Ur.join,this.params,this.timeout),this.rejoinTimer=new Lp(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ot.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(l=>l.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ot.closed,this.socket._remove(this)}),this._onError(l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=Ot.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ot.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=Ot.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ur.reply,{},(l,c)=>{this._trigger(this._replyEventName(c),l)}),this.presence=new ci(this),this.broadcastEndpointURL=Up(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(r,n=this.timeout){var o,l,c;if(this.socket.isConnected()||this.socket.connect(),this.state==Ot.closed){const{config:{broadcast:d,presence:p,private:f}}=this.params,g=(l=(o=this.bindings.postgres_changes)===null||o===void 0?void 0:o.map(T=>T.filter))!==null&&l!==void 0?l:[],y=!!this.bindings[ui.PRESENCE]&&this.bindings[ui.PRESENCE].length>0||((c=this.params.config.presence)===null||c===void 0?void 0:c.enabled)===!0,x={},b={broadcast:d,presence:Object.assign(Object.assign({},p),{enabled:y}),postgres_changes:g,private:f};this.socket.accessTokenValue&&(x.access_token=this.socket.accessTokenValue),this._onError(T=>r?.(un.CHANNEL_ERROR,T)),this._onClose(()=>r?.(un.CLOSED)),this.updateJoinPayload(Object.assign({config:b},x)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:T})=>{var _;if(this.socket.setAuth(),T===void 0){r?.(un.SUBSCRIBED);return}else{const E=this.bindings.postgres_changes,k=(_=E?.length)!==null&&_!==void 0?_:0,D=[];for(let O=0;O<k;O++){const R=E[O],{filter:{event:M,schema:X,table:G,filter:de}}=R,we=T&&T[O];if(we&&we.event===M&&we.schema===X&&we.table===G&&we.filter===de)D.push(Object.assign(Object.assign({},R),{id:we.id}));else{this.unsubscribe(),this.state=Ot.errored,r?.(un.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=D,r&&r(un.SUBSCRIBED);return}}).receive("error",T=>{this.state=Ot.errored,r?.(un.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(T).join(", ")||"error")))}).receive("timeout",()=>{r?.(un.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(r,n={}){return await this.send({type:"presence",event:"track",payload:r},n.timeout||this.timeout)}async untrack(r={}){return await this.send({type:"presence",event:"untrack"},r)}on(r,n,o){return this.state===Ot.joined&&r===ui.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(r,n,o)}async send(r,n={}){var o,l;if(!this._canPush()&&r.type==="broadcast"){const{event:c,payload:d}=r,f={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:c,payload:d,private:this.private}]})};try{const g=await this._fetchWithTimeout(this.broadcastEndpointURL,f,(o=n.timeout)!==null&&o!==void 0?o:this.timeout);return await((l=g.body)===null||l===void 0?void 0:l.cancel()),g.ok?"ok":"error"}catch(g){return g.name==="AbortError"?"timed out":"error"}}else return new Promise(c=>{var d,p,f;const g=this._push(r.type,r,n.timeout||this.timeout);r.type==="broadcast"&&!(!((f=(p=(d=this.params)===null||d===void 0?void 0:d.config)===null||p===void 0?void 0:p.broadcast)===null||f===void 0)&&f.ack)&&c("ok"),g.receive("ok",()=>c("ok")),g.receive("error",()=>c("error")),g.receive("timeout",()=>c("timed out"))})}updateJoinPayload(r){this.joinPush.updatePayload(r)}unsubscribe(r=this.timeout){this.state=Ot.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ur.close,"leave",this._joinRef())};this.joinPush.destroy();let o=null;return new Promise(l=>{o=new Qc(this,Ur.leave,{},r),o.receive("ok",()=>{n(),l("ok")}).receive("timeout",()=>{n(),l("timed out")}).receive("error",()=>{l("error")}),o.send(),this._canPush()||o.trigger("ok",{})}).finally(()=>{o?.destroy()})}teardown(){this.pushBuffer.forEach(r=>r.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Ot.closed,this.bindings={}}async _fetchWithTimeout(r,n,o){const l=new AbortController,c=setTimeout(()=>l.abort(),o),d=await this.socket.fetch(r,Object.assign(Object.assign({},n),{signal:l.signal}));return clearTimeout(c),d}_push(r,n,o=this.timeout){if(!this.joinedOnce)throw`tried to push '${r}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let l=new Qc(this,r,n,o);return this._canPush()?l.send():this._addToPushBuffer(l),l}_addToPushBuffer(r){if(r.startTimeout(),this.pushBuffer.push(r),this.pushBuffer.length>s0){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(r,n,o){return n}_isMember(r){return this.topic===r}_joinRef(){return this.joinPush.ref}_trigger(r,n,o){var l,c;const d=r.toLocaleLowerCase(),{close:p,error:f,leave:g,join:y}=Ur;if(o&&[p,f,g,y].indexOf(d)>=0&&o!==this._joinRef())return;let b=this._onMessage(d,n,o);if(n&&!b)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(d)?(l=this.bindings.postgres_changes)===null||l===void 0||l.filter(T=>{var _,E,k;return((_=T.filter)===null||_===void 0?void 0:_.event)==="*"||((k=(E=T.filter)===null||E===void 0?void 0:E.event)===null||k===void 0?void 0:k.toLocaleLowerCase())===d}).map(T=>T.callback(b,o)):(c=this.bindings[d])===null||c===void 0||c.filter(T=>{var _,E,k,D,O,R;if(["broadcast","presence","postgres_changes"].includes(d))if("id"in T){const M=T.id,X=(_=T.filter)===null||_===void 0?void 0:_.event;return M&&((E=n.ids)===null||E===void 0?void 0:E.includes(M))&&(X==="*"||X?.toLocaleLowerCase()===((k=n.data)===null||k===void 0?void 0:k.type.toLocaleLowerCase()))}else{const M=(O=(D=T?.filter)===null||D===void 0?void 0:D.event)===null||O===void 0?void 0:O.toLocaleLowerCase();return M==="*"||M===((R=n?.event)===null||R===void 0?void 0:R.toLocaleLowerCase())}else return T.type.toLocaleLowerCase()===d}).map(T=>{if(typeof b=="object"&&"ids"in b){const _=b.data,{schema:E,table:k,commit_timestamp:D,type:O,errors:R}=_;b=Object.assign(Object.assign({},{schema:E,table:k,commit_timestamp:D,eventType:O,new:{},old:{},errors:R}),this._getPayloadRecords(_))}T.callback(b,o)})}_isClosed(){return this.state===Ot.closed}_isJoined(){return this.state===Ot.joined}_isJoining(){return this.state===Ot.joining}_isLeaving(){return this.state===Ot.leaving}_replyEventName(r){return`chan_reply_${r}`}_on(r,n,o){const l=r.toLocaleLowerCase(),c={type:l,filter:n,callback:o};return this.bindings[l]?this.bindings[l].push(c):this.bindings[l]=[c],this}_off(r,n){const o=r.toLocaleLowerCase();return this.bindings[o]&&(this.bindings[o]=this.bindings[o].filter(l=>{var c;return!(((c=l.type)===null||c===void 0?void 0:c.toLocaleLowerCase())===o&&Fu.isEqual(l.filter,n))})),this}static isEqual(r,n){if(Object.keys(r).length!==Object.keys(n).length)return!1;for(const o in r)if(r[o]!==n[o])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(r){this._on(Ur.close,{},r)}_onError(r){this._on(Ur.error,{},n=>r(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(r=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ot.joining,this.joinPush.resend(r))}_getPayloadRecords(r){const n={new:{},old:{}};return(r.type==="INSERT"||r.type==="UPDATE")&&(n.new=Gf(r.columns,r.record)),(r.type==="UPDATE"||r.type==="DELETE")&&(n.old=Gf(r.columns,r.old_record)),n}}const Xc=()=>{},Ro={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},h0=[1e3,2e3,5e3,1e4],f0=1e4,p0=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class m0{constructor(r,n){var o;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=mu,this.transport=null,this.heartbeatIntervalMs=Ro.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Xc,this.ref=0,this.reconnectTimer=null,this.logger=Xc,this.conn=null,this.sendBuffer=[],this.serializer=new a0,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=l=>{let c;return l?c=l:typeof fetch>"u"?c=(...d)=>et(async()=>{const{default:p}=await Promise.resolve().then(()=>ga);return{default:p}},void 0).then(({default:p})=>p(...d)).catch(p=>{throw new Error(`Failed to load @supabase/node-fetch: ${p.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):c=fetch,(...d)=>c(...d)},!(!((o=n?.params)===null||o===void 0)&&o.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${r}/${gu.websocket}`,this.httpEndpoint=Up(r),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Zw.createWebSocket(this.endpointURL())}catch(r){this._setConnectionState("disconnected");const n=r.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:r0}))}disconnect(r,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const o=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(o),this._setConnectionState("disconnected")},r?this.conn.close(r,n??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(r){const n=await r.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const r=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),r}log(r,n,o){this.logger(r,n,o)}connectionState(){switch(this.conn&&this.conn.readyState){case li.connecting:return ds.Connecting;case li.open:return ds.Open;case li.closing:return ds.Closing;default:return ds.Closed}}isConnected(){return this.connectionState()===ds.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(r,n={config:{}}){const o=`realtime:${r}`,l=this.getChannels().find(c=>c.topic===o);if(l)return l;{const c=new Fu(`realtime:${r}`,n,this);return this.channels.push(c),c}}push(r){const{topic:n,event:o,payload:l,ref:c}=r,d=()=>{this.encode(r,p=>{var f;(f=this.conn)===null||f===void 0||f.send(p)})};this.log("push",`${n} ${o} (${c})`,l),this.isConnected()?d():this.sendBuffer.push(d)}async setAuth(r=null){this._authPromise=this._performAuth(r);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var r;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(r=this.conn)===null||r===void 0||r.close(n0,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},Ro.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(r){this.heartbeatCallback=r}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(r=>r()),this.sendBuffer=[])}_makeRef(){let r=this.ref+1;return r===this.ref?this.ref=0:this.ref=r,this.ref.toString()}_leaveOpenTopic(r){let n=this.channels.find(o=>o.topic===r&&(o._isJoined()||o._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${r}"`),n.unsubscribe())}_remove(r){this.channels=this.channels.filter(n=>n.topic!==r.topic)}_onConnMessage(r){this.decode(r.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(g){this.log("error","error in heartbeat callback",g)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:o,event:l,payload:c,ref:d}=n,p=d?`(${d})`:"",f=c.status||"";this.log("receive",`${f} ${o} ${l} ${p}`.trim(),c),this.channels.filter(g=>g._isMember(o)).forEach(g=>g._trigger(l,c,d)),this._triggerStateCallbacks("message",n)})}_clearTimer(r){var n;r==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):r==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=r=>this._onConnError(r),this.conn.onmessage=r=>this._onConnMessage(r),this.conn.onclose=r=>this._onConnClose(r))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(r=>r.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const r=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(r),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(r){var n;this._setConnectionState("disconnected"),this.log("transport","close",r),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",r)}_onConnError(r){this._setConnectionState("disconnected"),this.log("transport",`${r}`),this._triggerChanError(),this._triggerStateCallbacks("error",r)}_triggerChanError(){this.channels.forEach(r=>r._trigger(Ur.error))}_appendParams(r,n){if(Object.keys(n).length===0)return r;const o=r.match(/\?/)?"&":"?",l=new URLSearchParams(n);return`${r}${o}${l}`}_workerObjectUrl(r){let n;if(r)n=r;else{const o=new Blob([p0],{type:"application/javascript"});n=URL.createObjectURL(o)}return n}_setConnectionState(r,n=!1){this._connectionState=r,r==="connecting"?this._wasManualDisconnect=!1:r==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(r=null){let n;r?n=r:this.accessToken?n=await this.accessToken():n=this.accessTokenValue,this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(o=>{const l={access_token:n,version:t0};n&&o.updateJoinPayload(l),o.joinedOnce&&o._isJoined()&&o._push(Ur.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(r="general"){this.setAuth().catch(n=>{this.log("error",`error setting auth in ${r}`,n)})}_triggerStateCallbacks(r,n){try{this.stateChangeCallbacks[r].forEach(o=>{try{o(n)}catch(l){this.log("error",`error in ${r} callback`,l)}})}catch(o){this.log("error",`error triggering ${r} callbacks`,o)}}_setupReconnectionTimer(){this.reconnectTimer=new Lp(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Ro.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(r){var n,o,l,c,d,p,f,g,y;if(this.transport=(n=r?.transport)!==null&&n!==void 0?n:null,this.timeout=(o=r?.timeout)!==null&&o!==void 0?o:mu,this.heartbeatIntervalMs=(l=r?.heartbeatIntervalMs)!==null&&l!==void 0?l:Ro.HEARTBEAT_INTERVAL,this.worker=(c=r?.worker)!==null&&c!==void 0?c:!1,this.accessToken=(d=r?.accessToken)!==null&&d!==void 0?d:null,this.heartbeatCallback=(p=r?.heartbeatCallback)!==null&&p!==void 0?p:Xc,r?.params&&(this.params=r.params),r?.logger&&(this.logger=r.logger),(r?.logLevel||r?.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(f=r?.reconnectAfterMs)!==null&&f!==void 0?f:x=>h0[x-1]||f0,this.encode=(g=r?.encode)!==null&&g!==void 0?g:(x,b)=>b(JSON.stringify(x)),this.decode=(y=r?.decode)!==null&&y!==void 0?y:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=r?.workerUrl}}}class Wu extends Error{constructor(r){super(r),this.__isStorageError=!0,this.name="StorageError"}}function It(s){return typeof s=="object"&&s!==null&&"__isStorageError"in s}class g0 extends Wu{constructor(r,n,o){super(r),this.name="StorageApiError",this.status=n,this.statusCode=o}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class vu extends Wu{constructor(r,n){super(r),this.name="StorageUnknownError",this.originalError=n}}var y0=function(s,r,n,o){function l(c){return c instanceof n?c:new n(function(d){d(c)})}return new(n||(n=Promise))(function(c,d){function p(y){try{g(o.next(y))}catch(x){d(x)}}function f(y){try{g(o.throw(y))}catch(x){d(x)}}function g(y){y.done?c(y.value):l(y.value).then(p,f)}g((o=o.apply(s,r||[])).next())})};const Fp=s=>{let r;return s?r=s:typeof fetch>"u"?r=(...n)=>et(async()=>{const{default:o}=await Promise.resolve().then(()=>ga);return{default:o}},void 0).then(({default:o})=>o(...n)):r=fetch,(...n)=>r(...n)},v0=()=>y0(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield et(()=>Promise.resolve().then(()=>ga),void 0)).Response:Response}),wu=s=>{if(Array.isArray(s))return s.map(n=>wu(n));if(typeof s=="function"||s!==Object(s))return s;const r={};return Object.entries(s).forEach(([n,o])=>{const l=n.replace(/([-_][a-z])/gi,c=>c.toUpperCase().replace(/[-_]/g,""));r[l]=wu(o)}),r},w0=s=>{if(typeof s!="object"||s===null)return!1;const r=Object.getPrototypeOf(s);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(Symbol.toStringTag in s)&&!(Symbol.iterator in s)};var vs=function(s,r,n,o){function l(c){return c instanceof n?c:new n(function(d){d(c)})}return new(n||(n=Promise))(function(c,d){function p(y){try{g(o.next(y))}catch(x){d(x)}}function f(y){try{g(o.throw(y))}catch(x){d(x)}}function g(y){y.done?c(y.value):l(y.value).then(p,f)}g((o=o.apply(s,r||[])).next())})};const Zc=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),x0=(s,r,n)=>vs(void 0,void 0,void 0,function*(){const o=yield v0();s instanceof o&&!n?.noResolveJson?s.json().then(l=>{const c=s.status||500,d=l?.statusCode||c+"";r(new g0(Zc(l),c,d))}).catch(l=>{r(new vu(Zc(l),l))}):r(new vu(Zc(s),s))}),b0=(s,r,n,o)=>{const l={method:s,headers:r?.headers||{}};return s==="GET"||!o?l:(w0(o)?(l.headers=Object.assign({"Content-Type":"application/json"},r?.headers),l.body=JSON.stringify(o)):l.body=o,r?.duplex&&(l.duplex=r.duplex),Object.assign(Object.assign({},l),n))};function xi(s,r,n,o,l,c){return vs(this,void 0,void 0,function*(){return new Promise((d,p)=>{s(n,b0(r,o,l,c)).then(f=>{if(!f.ok)throw f;return o?.noResolveJson?f:f.json()}).then(f=>d(f)).catch(f=>x0(f,p,o))})})}function Jo(s,r,n,o){return vs(this,void 0,void 0,function*(){return xi(s,"GET",r,n,o)})}function Vr(s,r,n,o,l){return vs(this,void 0,void 0,function*(){return xi(s,"POST",r,o,l,n)})}function xu(s,r,n,o,l){return vs(this,void 0,void 0,function*(){return xi(s,"PUT",r,o,l,n)})}function k0(s,r,n,o){return vs(this,void 0,void 0,function*(){return xi(s,"HEAD",r,Object.assign(Object.assign({},n),{noResolveJson:!0}),o)})}function Wp(s,r,n,o,l){return vs(this,void 0,void 0,function*(){return xi(s,"DELETE",r,o,l,n)})}var ar=function(s,r,n,o){function l(c){return c instanceof n?c:new n(function(d){d(c)})}return new(n||(n=Promise))(function(c,d){function p(y){try{g(o.next(y))}catch(x){d(x)}}function f(y){try{g(o.throw(y))}catch(x){d(x)}}function g(y){y.done?c(y.value):l(y.value).then(p,f)}g((o=o.apply(s,r||[])).next())})};const S0={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Kf={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class _0{constructor(r,n={},o,l){this.shouldThrowOnError=!1,this.url=r,this.headers=n,this.bucketId=o,this.fetch=Fp(l)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(r,n,o,l){return ar(this,void 0,void 0,function*(){try{let c;const d=Object.assign(Object.assign({},Kf),l);let p=Object.assign(Object.assign({},this.headers),r==="POST"&&{"x-upsert":String(d.upsert)});const f=d.metadata;typeof Blob<"u"&&o instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),f&&c.append("metadata",this.encodeMetadata(f)),c.append("",o)):typeof FormData<"u"&&o instanceof FormData?(c=o,c.append("cacheControl",d.cacheControl),f&&c.append("metadata",this.encodeMetadata(f))):(c=o,p["cache-control"]=`max-age=${d.cacheControl}`,p["content-type"]=d.contentType,f&&(p["x-metadata"]=this.toBase64(this.encodeMetadata(f)))),l?.headers&&(p=Object.assign(Object.assign({},p),l.headers));const g=this._removeEmptyFolders(n),y=this._getFinalPath(g),x=yield(r=="PUT"?xu:Vr)(this.fetch,`${this.url}/object/${y}`,c,Object.assign({headers:p},d?.duplex?{duplex:d.duplex}:{}));return{data:{path:g,id:x.Id,fullPath:x.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(It(c))return{data:null,error:c};throw c}})}upload(r,n,o){return ar(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",r,n,o)})}uploadToSignedUrl(r,n,o,l){return ar(this,void 0,void 0,function*(){const c=this._removeEmptyFolders(r),d=this._getFinalPath(c),p=new URL(this.url+`/object/upload/sign/${d}`);p.searchParams.set("token",n);try{let f;const g=Object.assign({upsert:Kf.upsert},l),y=Object.assign(Object.assign({},this.headers),{"x-upsert":String(g.upsert)});typeof Blob<"u"&&o instanceof Blob?(f=new FormData,f.append("cacheControl",g.cacheControl),f.append("",o)):typeof FormData<"u"&&o instanceof FormData?(f=o,f.append("cacheControl",g.cacheControl)):(f=o,y["cache-control"]=`max-age=${g.cacheControl}`,y["content-type"]=g.contentType);const x=yield xu(this.fetch,p.toString(),f,{headers:y});return{data:{path:c,fullPath:x.Key},error:null}}catch(f){if(this.shouldThrowOnError)throw f;if(It(f))return{data:null,error:f};throw f}})}createSignedUploadUrl(r,n){return ar(this,void 0,void 0,function*(){try{let o=this._getFinalPath(r);const l=Object.assign({},this.headers);n?.upsert&&(l["x-upsert"]="true");const c=yield Vr(this.fetch,`${this.url}/object/upload/sign/${o}`,{},{headers:l}),d=new URL(this.url+c.url),p=d.searchParams.get("token");if(!p)throw new Wu("No token returned by API");return{data:{signedUrl:d.toString(),path:r,token:p},error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(It(o))return{data:null,error:o};throw o}})}update(r,n,o){return ar(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",r,n,o)})}move(r,n,o){return ar(this,void 0,void 0,function*(){try{return{data:yield Vr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:r,destinationKey:n,destinationBucket:o?.destinationBucket},{headers:this.headers}),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(It(l))return{data:null,error:l};throw l}})}copy(r,n,o){return ar(this,void 0,void 0,function*(){try{return{data:{path:(yield Vr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:r,destinationKey:n,destinationBucket:o?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(It(l))return{data:null,error:l};throw l}})}createSignedUrl(r,n,o){return ar(this,void 0,void 0,function*(){try{let l=this._getFinalPath(r),c=yield Vr(this.fetch,`${this.url}/object/sign/${l}`,Object.assign({expiresIn:n},o?.transform?{transform:o.transform}:{}),{headers:this.headers});const d=o?.download?`&download=${o.download===!0?"":o.download}`:"";return c={signedUrl:encodeURI(`${this.url}${c.signedURL}${d}`)},{data:c,error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(It(l))return{data:null,error:l};throw l}})}createSignedUrls(r,n,o){return ar(this,void 0,void 0,function*(){try{const l=yield Vr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:r},{headers:this.headers}),c=o?.download?`&download=${o.download===!0?"":o.download}`:"";return{data:l.map(d=>Object.assign(Object.assign({},d),{signedUrl:d.signedURL?encodeURI(`${this.url}${d.signedURL}${c}`):null})),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(It(l))return{data:null,error:l};throw l}})}download(r,n){return ar(this,void 0,void 0,function*(){const l=typeof n?.transform<"u"?"render/image/authenticated":"object",c=this.transformOptsToQueryString(n?.transform||{}),d=c?`?${c}`:"";try{const p=this._getFinalPath(r);return{data:yield(yield Jo(this.fetch,`${this.url}/${l}/${p}${d}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(p){if(this.shouldThrowOnError)throw p;if(It(p))return{data:null,error:p};throw p}})}info(r){return ar(this,void 0,void 0,function*(){const n=this._getFinalPath(r);try{const o=yield Jo(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:wu(o),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(It(o))return{data:null,error:o};throw o}})}exists(r){return ar(this,void 0,void 0,function*(){const n=this._getFinalPath(r);try{return yield k0(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(It(o)&&o instanceof vu){const l=o.originalError;if([400,404].includes(l?.status))return{data:!1,error:o}}throw o}})}getPublicUrl(r,n){const o=this._getFinalPath(r),l=[],c=n?.download?`download=${n.download===!0?"":n.download}`:"";c!==""&&l.push(c);const p=typeof n?.transform<"u"?"render/image":"object",f=this.transformOptsToQueryString(n?.transform||{});f!==""&&l.push(f);let g=l.join("&");return g!==""&&(g=`?${g}`),{data:{publicUrl:encodeURI(`${this.url}/${p}/public/${o}${g}`)}}}remove(r){return ar(this,void 0,void 0,function*(){try{return{data:yield Wp(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:r},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(It(n))return{data:null,error:n};throw n}})}list(r,n,o){return ar(this,void 0,void 0,function*(){try{const l=Object.assign(Object.assign(Object.assign({},S0),n),{prefix:r||""});return{data:yield Vr(this.fetch,`${this.url}/object/list/${this.bucketId}`,l,{headers:this.headers},o),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(It(l))return{data:null,error:l};throw l}})}listV2(r,n){return ar(this,void 0,void 0,function*(){try{const o=Object.assign({},r);return{data:yield Vr(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,o,{headers:this.headers},n),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(It(o))return{data:null,error:o};throw o}})}encodeMetadata(r){return JSON.stringify(r)}toBase64(r){return typeof Buffer<"u"?Buffer.from(r).toString("base64"):btoa(r)}_getFinalPath(r){return`${this.bucketId}/${r.replace(/^\/+/,"")}`}_removeEmptyFolders(r){return r.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(r){const n=[];return r.width&&n.push(`width=${r.width}`),r.height&&n.push(`height=${r.height}`),r.resize&&n.push(`resize=${r.resize}`),r.format&&n.push(`format=${r.format}`),r.quality&&n.push(`quality=${r.quality}`),n.join("&")}}const j0="2.12.1",N0={"X-Client-Info":`storage-js/${j0}`};var Zs=function(s,r,n,o){function l(c){return c instanceof n?c:new n(function(d){d(c)})}return new(n||(n=Promise))(function(c,d){function p(y){try{g(o.next(y))}catch(x){d(x)}}function f(y){try{g(o.throw(y))}catch(x){d(x)}}function g(y){y.done?c(y.value):l(y.value).then(p,f)}g((o=o.apply(s,r||[])).next())})};class E0{constructor(r,n={},o,l){this.shouldThrowOnError=!1;const c=new URL(r);l?.useNewHostname&&/supabase\.(co|in|red)$/.test(c.hostname)&&!c.hostname.includes("storage.supabase.")&&(c.hostname=c.hostname.replace("supabase.","storage.supabase.")),this.url=c.href,this.headers=Object.assign(Object.assign({},N0),n),this.fetch=Fp(o)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return Zs(this,void 0,void 0,function*(){try{return{data:yield Jo(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(It(r))return{data:null,error:r};throw r}})}getBucket(r){return Zs(this,void 0,void 0,function*(){try{return{data:yield Jo(this.fetch,`${this.url}/bucket/${r}`,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(It(n))return{data:null,error:n};throw n}})}createBucket(r,n={public:!1}){return Zs(this,void 0,void 0,function*(){try{return{data:yield Vr(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(It(o))return{data:null,error:o};throw o}})}updateBucket(r,n){return Zs(this,void 0,void 0,function*(){try{return{data:yield xu(this.fetch,`${this.url}/bucket/${r}`,{id:r,name:r,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(It(o))return{data:null,error:o};throw o}})}emptyBucket(r){return Zs(this,void 0,void 0,function*(){try{return{data:yield Vr(this.fetch,`${this.url}/bucket/${r}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(It(n))return{data:null,error:n};throw n}})}deleteBucket(r){return Zs(this,void 0,void 0,function*(){try{return{data:yield Wp(this.fetch,`${this.url}/bucket/${r}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(It(n))return{data:null,error:n};throw n}})}}class C0 extends E0{constructor(r,n={},o,l){super(r,n,o,l)}from(r){return new _0(this.url,this.headers,r,this.fetch)}}const T0="2.57.4";let ii="";typeof Deno<"u"?ii="deno":typeof document<"u"?ii="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ii="react-native":ii="node";const P0={"X-Client-Info":`supabase-js-${ii}/${T0}`},A0={headers:P0},O0={schema:"public"},I0={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},D0={};var R0=function(s,r,n,o){function l(c){return c instanceof n?c:new n(function(d){d(c)})}return new(n||(n=Promise))(function(c,d){function p(y){try{g(o.next(y))}catch(x){d(x)}}function f(y){try{g(o.throw(y))}catch(x){d(x)}}function g(y){y.done?c(y.value):l(y.value).then(p,f)}g((o=o.apply(s,r||[])).next())})};const L0=s=>{let r;return s?r=s:typeof fetch>"u"?r=Pp:r=fetch,(...n)=>r(...n)},M0=()=>typeof Headers>"u"?Ap:Headers,U0=(s,r,n)=>{const o=L0(n),l=M0();return(c,d)=>R0(void 0,void 0,void 0,function*(){var p;const f=(p=yield r())!==null&&p!==void 0?p:s;let g=new l(d?.headers);return g.has("apikey")||g.set("apikey",s),g.has("Authorization")||g.set("Authorization",`Bearer ${f}`),o(c,Object.assign(Object.assign({},d),{headers:g}))})};var F0=function(s,r,n,o){function l(c){return c instanceof n?c:new n(function(d){d(c)})}return new(n||(n=Promise))(function(c,d){function p(y){try{g(o.next(y))}catch(x){d(x)}}function f(y){try{g(o.throw(y))}catch(x){d(x)}}function g(y){y.done?c(y.value):l(y.value).then(p,f)}g((o=o.apply(s,r||[])).next())})};function W0(s){return s.endsWith("/")?s:s+"/"}function B0(s,r){var n,o;const{db:l,auth:c,realtime:d,global:p}=s,{db:f,auth:g,realtime:y,global:x}=r,b={db:Object.assign(Object.assign({},f),l),auth:Object.assign(Object.assign({},g),c),realtime:Object.assign(Object.assign({},y),d),storage:{},global:Object.assign(Object.assign(Object.assign({},x),p),{headers:Object.assign(Object.assign({},(n=x?.headers)!==null&&n!==void 0?n:{}),(o=p?.headers)!==null&&o!==void 0?o:{})}),accessToken:()=>F0(this,void 0,void 0,function*(){return""})};return s.accessToken?b.accessToken=s.accessToken:delete b.accessToken,b}function $0(s){const r=s?.trim();if(!r)throw new Error("supabaseUrl is required.");if(!r.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(W0(r))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const Bp="2.71.1",sa=30*1e3,bu=3,eu=bu*sa,z0="http://localhost:9999",q0="supabase.auth.token",H0={"X-Client-Info":`gotrue-js/${Bp}`},ku="X-Supabase-Api-Version",$p={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},G0=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,V0=600*1e3;class Bu extends Error{constructor(r,n,o){super(r),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=o}}function Je(s){return typeof s=="object"&&s!==null&&"__isAuthError"in s}class J0 extends Bu{constructor(r,n,o){super(r,n,o),this.name="AuthApiError",this.status=n,this.code=o}}function K0(s){return Je(s)&&s.name==="AuthApiError"}class zp extends Bu{constructor(r,n){super(r),this.name="AuthUnknownError",this.originalError=n}}class Hn extends Bu{constructor(r,n,o,l){super(r,o,l),this.name=n,this.status=o}}class Un extends Hn{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Y0(s){return Je(s)&&s.name==="AuthSessionMissingError"}class Lo extends Hn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Mo extends Hn{constructor(r){super(r,"AuthInvalidCredentialsError",400,void 0)}}class Uo extends Hn{constructor(r,n=null){super(r,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Q0(s){return Je(s)&&s.name==="AuthImplicitGrantRedirectError"}class Yf extends Hn{constructor(r,n=null){super(r,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Su extends Hn{constructor(r,n){super(r,"AuthRetryableFetchError",n,void 0)}}function tu(s){return Je(s)&&s.name==="AuthRetryableFetchError"}class Qf extends Hn{constructor(r,n,o){super(r,"AuthWeakPasswordError",n,"weak_password"),this.reasons=o}}class _u extends Hn{constructor(r){super(r,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ko="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Xf=` 	
\r=`.split(""),X0=(()=>{const s=new Array(128);for(let r=0;r<s.length;r+=1)s[r]=-1;for(let r=0;r<Xf.length;r+=1)s[Xf[r].charCodeAt(0)]=-2;for(let r=0;r<Ko.length;r+=1)s[Ko[r].charCodeAt(0)]=r;return s})();function Zf(s,r,n){if(s!==null)for(r.queue=r.queue<<8|s,r.queuedBits+=8;r.queuedBits>=6;){const o=r.queue>>r.queuedBits-6&63;n(Ko[o]),r.queuedBits-=6}else if(r.queuedBits>0)for(r.queue=r.queue<<6-r.queuedBits,r.queuedBits=6;r.queuedBits>=6;){const o=r.queue>>r.queuedBits-6&63;n(Ko[o]),r.queuedBits-=6}}function qp(s,r,n){const o=X0[s];if(o>-1)for(r.queue=r.queue<<6|o,r.queuedBits+=6;r.queuedBits>=8;)n(r.queue>>r.queuedBits-8&255),r.queuedBits-=8;else{if(o===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(s)}"`)}}function ep(s){const r=[],n=d=>{r.push(String.fromCodePoint(d))},o={utf8seq:0,codepoint:0},l={queue:0,queuedBits:0},c=d=>{tx(d,o,n)};for(let d=0;d<s.length;d+=1)qp(s.charCodeAt(d),l,c);return r.join("")}function Z0(s,r){if(s<=127){r(s);return}else if(s<=2047){r(192|s>>6),r(128|s&63);return}else if(s<=65535){r(224|s>>12),r(128|s>>6&63),r(128|s&63);return}else if(s<=1114111){r(240|s>>18),r(128|s>>12&63),r(128|s>>6&63),r(128|s&63);return}throw new Error(`Unrecognized Unicode codepoint: ${s.toString(16)}`)}function ex(s,r){for(let n=0;n<s.length;n+=1){let o=s.charCodeAt(n);if(o>55295&&o<=56319){const l=(o-55296)*1024&65535;o=(s.charCodeAt(n+1)-56320&65535|l)+65536,n+=1}Z0(o,r)}}function tx(s,r,n){if(r.utf8seq===0){if(s<=127){n(s);return}for(let o=1;o<6;o+=1)if((s>>7-o&1)===0){r.utf8seq=o;break}if(r.utf8seq===2)r.codepoint=s&31;else if(r.utf8seq===3)r.codepoint=s&15;else if(r.utf8seq===4)r.codepoint=s&7;else throw new Error("Invalid UTF-8 sequence");r.utf8seq-=1}else if(r.utf8seq>0){if(s<=127)throw new Error("Invalid UTF-8 sequence");r.codepoint=r.codepoint<<6|s&63,r.utf8seq-=1,r.utf8seq===0&&n(r.codepoint)}}function rx(s){const r=[],n={queue:0,queuedBits:0},o=l=>{r.push(l)};for(let l=0;l<s.length;l+=1)qp(s.charCodeAt(l),n,o);return new Uint8Array(r)}function nx(s){const r=[];return ex(s,n=>r.push(n)),new Uint8Array(r)}function sx(s){const r=[],n={queue:0,queuedBits:0},o=l=>{r.push(l)};return s.forEach(l=>Zf(l,n,o)),Zf(null,n,o),r.join("")}function ax(s){return Math.round(Date.now()/1e3)+s}function ix(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(s){const r=Math.random()*16|0;return(s=="x"?r:r&3|8).toString(16)})}const Mr=()=>typeof window<"u"&&typeof document<"u",os={tested:!1,writable:!1},Hp=()=>{if(!Mr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(os.tested)return os.writable;const s=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(s,s),globalThis.localStorage.removeItem(s),os.tested=!0,os.writable=!0}catch{os.tested=!0,os.writable=!1}return os.writable};function ox(s){const r={},n=new URL(s);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((l,c)=>{r[c]=l})}catch{}return n.searchParams.forEach((o,l)=>{r[l]=o}),r}const Gp=s=>{let r;return s?r=s:typeof fetch>"u"?r=(...n)=>et(async()=>{const{default:o}=await Promise.resolve().then(()=>ga);return{default:o}},void 0).then(({default:o})=>o(...n)):r=fetch,(...n)=>r(...n)},lx=s=>typeof s=="object"&&s!==null&&"status"in s&&"ok"in s&&"json"in s&&typeof s.json=="function",aa=async(s,r,n)=>{await s.setItem(r,JSON.stringify(n))},ls=async(s,r)=>{const n=await s.getItem(r);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Mn=async(s,r)=>{await s.removeItem(r)};class sl{constructor(){this.promise=new sl.promiseConstructor((r,n)=>{this.resolve=r,this.reject=n})}}sl.promiseConstructor=Promise;function ru(s){const r=s.split(".");if(r.length!==3)throw new _u("Invalid JWT structure");for(let o=0;o<r.length;o++)if(!G0.test(r[o]))throw new _u("JWT not in base64url format");return{header:JSON.parse(ep(r[0])),payload:JSON.parse(ep(r[1])),signature:rx(r[2]),raw:{header:r[0],payload:r[1]}}}async function cx(s){return await new Promise(r=>{setTimeout(()=>r(null),s)})}function ux(s,r){return new Promise((o,l)=>{(async()=>{for(let c=0;c<1/0;c++)try{const d=await s(c);if(!r(c,null,d)){o(d);return}}catch(d){if(!r(c,d)){l(d);return}}})()})}function dx(s){return("0"+s.toString(16)).substr(-2)}function hx(){const r=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",o=n.length;let l="";for(let c=0;c<56;c++)l+=n.charAt(Math.floor(Math.random()*o));return l}return crypto.getRandomValues(r),Array.from(r,dx).join("")}async function fx(s){const n=new TextEncoder().encode(s),o=await crypto.subtle.digest("SHA-256",n),l=new Uint8Array(o);return Array.from(l).map(c=>String.fromCharCode(c)).join("")}async function px(s){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),s;const n=await fx(s);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ea(s,r,n=!1){const o=hx();let l=o;n&&(l+="/PASSWORD_RECOVERY"),await aa(s,`${r}-code-verifier`,l);const c=await px(o);return[c,o===c?"plain":"s256"]}const mx=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function gx(s){const r=s.headers.get(ku);if(!r||!r.match(mx))return null;try{return new Date(`${r}T00:00:00.0Z`)}catch{return null}}function yx(s){if(!s)throw new Error("Missing exp claim");const r=Math.floor(Date.now()/1e3);if(s<=r)throw new Error("JWT has expired")}function vx(s){switch(s){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const wx=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function ta(s){if(!wx.test(s))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function nu(){const s={};return new Proxy(s,{get:(r,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const o=n.toString();if(o==="Symbol(Symbol.toPrimitive)"||o==="Symbol(Symbol.toStringTag)"||o==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(r,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(r,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function tp(s){return JSON.parse(JSON.stringify(s))}var xx=function(s,r){var n={};for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&r.indexOf(o)<0&&(n[o]=s[o]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,o=Object.getOwnPropertySymbols(s);l<o.length;l++)r.indexOf(o[l])<0&&Object.prototype.propertyIsEnumerable.call(s,o[l])&&(n[o[l]]=s[o[l]]);return n};const us=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),bx=[502,503,504];async function rp(s){var r;if(!lx(s))throw new Su(us(s),0);if(bx.includes(s.status))throw new Su(us(s),s.status);let n;try{n=await s.json()}catch(c){throw new zp(us(c),c)}let o;const l=gx(s);if(l&&l.getTime()>=$p["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?o=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(o=n.error_code),o){if(o==="weak_password")throw new Qf(us(n),s.status,((r=n.weak_password)===null||r===void 0?void 0:r.reasons)||[]);if(o==="session_not_found")throw new Un}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((c,d)=>c&&typeof d=="string",!0))throw new Qf(us(n),s.status,n.weak_password.reasons);throw new J0(us(n),s.status||500,o)}const kx=(s,r,n,o)=>{const l={method:s,headers:r?.headers||{}};return s==="GET"?l:(l.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},r?.headers),l.body=JSON.stringify(o),Object.assign(Object.assign({},l),n))};async function Ze(s,r,n,o){var l;const c=Object.assign({},o?.headers);c[ku]||(c[ku]=$p["2024-01-01"].name),o?.jwt&&(c.Authorization=`Bearer ${o.jwt}`);const d=(l=o?.query)!==null&&l!==void 0?l:{};o?.redirectTo&&(d.redirect_to=o.redirectTo);const p=Object.keys(d).length?"?"+new URLSearchParams(d).toString():"",f=await Sx(s,r,n+p,{headers:c,noResolveJson:o?.noResolveJson},{},o?.body);return o?.xform?o?.xform(f):{data:Object.assign({},f),error:null}}async function Sx(s,r,n,o,l,c){const d=kx(r,o,l,c);let p;try{p=await s(n,Object.assign({},d))}catch(f){throw console.error(f),new Su(us(f),0)}if(p.ok||await rp(p),o?.noResolveJson)return p;try{return await p.json()}catch(f){await rp(f)}}function cn(s){var r;let n=null;Ex(s)&&(n=Object.assign({},s),s.expires_at||(n.expires_at=ax(s.expires_in)));const o=(r=s.user)!==null&&r!==void 0?r:s;return{data:{session:n,user:o},error:null}}function np(s){const r=cn(s);return!r.error&&s.weak_password&&typeof s.weak_password=="object"&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.message&&typeof s.weak_password.message=="string"&&s.weak_password.reasons.reduce((n,o)=>n&&typeof o=="string",!0)&&(r.data.weak_password=s.weak_password),r}function Fn(s){var r;return{data:{user:(r=s.user)!==null&&r!==void 0?r:s},error:null}}function _x(s){return{data:s,error:null}}function jx(s){const{action_link:r,email_otp:n,hashed_token:o,redirect_to:l,verification_type:c}=s,d=xx(s,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),p={action_link:r,email_otp:n,hashed_token:o,redirect_to:l,verification_type:c},f=Object.assign({},d);return{data:{properties:p,user:f},error:null}}function Nx(s){return s}function Ex(s){return s.access_token&&s.refresh_token&&s.expires_in}const su=["global","local","others"];var Cx=function(s,r){var n={};for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&r.indexOf(o)<0&&(n[o]=s[o]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,o=Object.getOwnPropertySymbols(s);l<o.length;l++)r.indexOf(o[l])<0&&Object.prototype.propertyIsEnumerable.call(s,o[l])&&(n[o[l]]=s[o[l]]);return n};class Tx{constructor({url:r="",headers:n={},fetch:o}){this.url=r,this.headers=n,this.fetch=Gp(o),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(r,n=su[0]){if(su.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${su.join(", ")}`);try{return await Ze(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:r,noResolveJson:!0}),{data:null,error:null}}catch(o){if(Je(o))return{data:null,error:o};throw o}}async inviteUserByEmail(r,n={}){try{return await Ze(this.fetch,"POST",`${this.url}/invite`,{body:{email:r,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Fn})}catch(o){if(Je(o))return{data:{user:null},error:o};throw o}}async generateLink(r){try{const{options:n}=r,o=Cx(r,["options"]),l=Object.assign(Object.assign({},o),n);return"newEmail"in o&&(l.new_email=o?.newEmail,delete l.newEmail),await Ze(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:l,headers:this.headers,xform:jx,redirectTo:n?.redirectTo})}catch(n){if(Je(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(r){try{return await Ze(this.fetch,"POST",`${this.url}/admin/users`,{body:r,headers:this.headers,xform:Fn})}catch(n){if(Je(n))return{data:{user:null},error:n};throw n}}async listUsers(r){var n,o,l,c,d,p,f;try{const g={nextPage:null,lastPage:0,total:0},y=await Ze(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(o=(n=r?.page)===null||n===void 0?void 0:n.toString())!==null&&o!==void 0?o:"",per_page:(c=(l=r?.perPage)===null||l===void 0?void 0:l.toString())!==null&&c!==void 0?c:""},xform:Nx});if(y.error)throw y.error;const x=await y.json(),b=(d=y.headers.get("x-total-count"))!==null&&d!==void 0?d:0,T=(f=(p=y.headers.get("link"))===null||p===void 0?void 0:p.split(","))!==null&&f!==void 0?f:[];return T.length>0&&(T.forEach(_=>{const E=parseInt(_.split(";")[0].split("=")[1].substring(0,1)),k=JSON.parse(_.split(";")[1].split("=")[1]);g[`${k}Page`]=E}),g.total=parseInt(b)),{data:Object.assign(Object.assign({},x),g),error:null}}catch(g){if(Je(g))return{data:{users:[]},error:g};throw g}}async getUserById(r){ta(r);try{return await Ze(this.fetch,"GET",`${this.url}/admin/users/${r}`,{headers:this.headers,xform:Fn})}catch(n){if(Je(n))return{data:{user:null},error:n};throw n}}async updateUserById(r,n){ta(r);try{return await Ze(this.fetch,"PUT",`${this.url}/admin/users/${r}`,{body:n,headers:this.headers,xform:Fn})}catch(o){if(Je(o))return{data:{user:null},error:o};throw o}}async deleteUser(r,n=!1){ta(r);try{return await Ze(this.fetch,"DELETE",`${this.url}/admin/users/${r}`,{headers:this.headers,body:{should_soft_delete:n},xform:Fn})}catch(o){if(Je(o))return{data:{user:null},error:o};throw o}}async _listFactors(r){ta(r.userId);try{const{data:n,error:o}=await Ze(this.fetch,"GET",`${this.url}/admin/users/${r.userId}/factors`,{headers:this.headers,xform:l=>({data:{factors:l},error:null})});return{data:n,error:o}}catch(n){if(Je(n))return{data:null,error:n};throw n}}async _deleteFactor(r){ta(r.userId),ta(r.id);try{return{data:await Ze(this.fetch,"DELETE",`${this.url}/admin/users/${r.userId}/factors/${r.id}`,{headers:this.headers}),error:null}}catch(n){if(Je(n))return{data:null,error:n};throw n}}}function sp(s={}){return{getItem:r=>s[r]||null,setItem:(r,n)=>{s[r]=n},removeItem:r=>{delete s[r]}}}function Px(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const ra={debug:!!(globalThis&&Hp()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Vp extends Error{constructor(r){super(r),this.isAcquireTimeout=!0}}class Ax extends Vp{}async function Ox(s,r,n){ra.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",s,r);const o=new globalThis.AbortController;return r>0&&setTimeout(()=>{o.abort(),ra.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",s)},r),await Promise.resolve().then(()=>globalThis.navigator.locks.request(s,r===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:o.signal},async l=>{if(l){ra.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",s,l.name);try{return await n()}finally{ra.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",s,l.name)}}else{if(r===0)throw ra.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",s),new Ax(`Acquiring an exclusive Navigator LockManager lock "${s}" immediately failed`);if(ra.debug)try{const c=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(c,null,"  "))}catch(c){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",c)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}Px();const Ix={url:z0,storageKey:q0,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:H0,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function ap(s,r,n){return await n()}const na={};class mi{constructor(r){var n,o;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=mi.nextInstanceID,mi.nextInstanceID+=1,this.instanceID>0&&Mr()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const l=Object.assign(Object.assign({},Ix),r);if(this.logDebugMessages=!!l.debug,typeof l.debug=="function"&&(this.logger=l.debug),this.persistSession=l.persistSession,this.storageKey=l.storageKey,this.autoRefreshToken=l.autoRefreshToken,this.admin=new Tx({url:l.url,headers:l.headers,fetch:l.fetch}),this.url=l.url,this.headers=l.headers,this.fetch=Gp(l.fetch),this.lock=l.lock||ap,this.detectSessionInUrl=l.detectSessionInUrl,this.flowType=l.flowType,this.hasCustomAuthorizationHeader=l.hasCustomAuthorizationHeader,l.lock?this.lock=l.lock:Mr()&&(!((n=globalThis?.navigator)===null||n===void 0)&&n.locks)?this.lock=Ox:this.lock=ap,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(l.storage?this.storage=l.storage:Hp()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=sp(this.memoryStorage)),l.userStorage&&(this.userStorage=l.userStorage)):(this.memoryStorage={},this.storage=sp(this.memoryStorage)),Mr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(c){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",c)}(o=this.broadcastChannel)===null||o===void 0||o.addEventListener("message",async c=>{this._debug("received broadcast notification from other tab or client",c),await this._notifyAllSubscribers(c.data.event,c.data.session,!1)})}this.initialize()}get jwks(){var r,n;return(n=(r=na[this.storageKey])===null||r===void 0?void 0:r.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(r){na[this.storageKey]=Object.assign(Object.assign({},na[this.storageKey]),{jwks:r})}get jwks_cached_at(){var r,n;return(n=(r=na[this.storageKey])===null||r===void 0?void 0:r.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(r){na[this.storageKey]=Object.assign(Object.assign({},na[this.storageKey]),{cachedAt:r})}_debug(...r){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Bp}) ${new Date().toISOString()}`,...r),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var r;try{const n=ox(window.location.href);let o="none";if(this._isImplicitGrantCallback(n)?o="implicit":await this._isPKCECallback(n)&&(o="pkce"),Mr()&&this.detectSessionInUrl&&o!=="none"){const{data:l,error:c}=await this._getSessionFromURL(n,o);if(c){if(this._debug("#_initialize()","error detecting session from URL",c),Q0(c)){const f=(r=c.details)===null||r===void 0?void 0:r.code;if(f==="identity_already_exists"||f==="identity_not_found"||f==="single_identity_not_deletable")return{error:c}}return await this._removeSession(),{error:c}}const{session:d,redirectType:p}=l;return this._debug("#_initialize()","detected session in URL",d,"redirect type",p),await this._saveSession(d),setTimeout(async()=>{p==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",d):await this._notifyAllSubscribers("SIGNED_IN",d)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return Je(n)?{error:n}:{error:new zp("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(r){var n,o,l;try{const c=await Ze(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(o=(n=r?.options)===null||n===void 0?void 0:n.data)!==null&&o!==void 0?o:{},gotrue_meta_security:{captcha_token:(l=r?.options)===null||l===void 0?void 0:l.captchaToken}},xform:cn}),{data:d,error:p}=c;if(p||!d)return{data:{user:null,session:null},error:p};const f=d.session,g=d.user;return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",f)),{data:{user:g,session:f},error:null}}catch(c){if(Je(c))return{data:{user:null,session:null},error:c};throw c}}async signUp(r){var n,o,l;try{let c;if("email"in r){const{email:y,password:x,options:b}=r;let T=null,_=null;this.flowType==="pkce"&&([T,_]=await ea(this.storage,this.storageKey)),c=await Ze(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:b?.emailRedirectTo,body:{email:y,password:x,data:(n=b?.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:b?.captchaToken},code_challenge:T,code_challenge_method:_},xform:cn})}else if("phone"in r){const{phone:y,password:x,options:b}=r;c=await Ze(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:y,password:x,data:(o=b?.data)!==null&&o!==void 0?o:{},channel:(l=b?.channel)!==null&&l!==void 0?l:"sms",gotrue_meta_security:{captcha_token:b?.captchaToken}},xform:cn})}else throw new Mo("You must provide either an email or phone number and a password");const{data:d,error:p}=c;if(p||!d)return{data:{user:null,session:null},error:p};const f=d.session,g=d.user;return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",f)),{data:{user:g,session:f},error:null}}catch(c){if(Je(c))return{data:{user:null,session:null},error:c};throw c}}async signInWithPassword(r){try{let n;if("email"in r){const{email:c,password:d,options:p}=r;n=await Ze(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:c,password:d,gotrue_meta_security:{captcha_token:p?.captchaToken}},xform:np})}else if("phone"in r){const{phone:c,password:d,options:p}=r;n=await Ze(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:c,password:d,gotrue_meta_security:{captcha_token:p?.captchaToken}},xform:np})}else throw new Mo("You must provide either an email or phone number and a password");const{data:o,error:l}=n;return l?{data:{user:null,session:null},error:l}:!o||!o.session||!o.user?{data:{user:null,session:null},error:new Lo}:(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:Object.assign({user:o.user,session:o.session},o.weak_password?{weakPassword:o.weak_password}:null),error:l})}catch(n){if(Je(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(r){var n,o,l,c;return await this._handleProviderSignIn(r.provider,{redirectTo:(n=r.options)===null||n===void 0?void 0:n.redirectTo,scopes:(o=r.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=r.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:(c=r.options)===null||c===void 0?void 0:c.skipBrowserRedirect})}async exchangeCodeForSession(r){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(r))}async signInWithWeb3(r){const{chain:n}=r;if(n==="solana")return await this.signInWithSolana(r);throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}async signInWithSolana(r){var n,o,l,c,d,p,f,g,y,x,b,T;let _,E;if("message"in r)_=r.message,E=r.signature;else{const{chain:k,wallet:D,statement:O,options:R}=r;let M;if(Mr())if(typeof D=="object")M=D;else{const G=window;if("solana"in G&&typeof G.solana=="object"&&("signIn"in G.solana&&typeof G.solana.signIn=="function"||"signMessage"in G.solana&&typeof G.solana.signMessage=="function"))M=G.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof D!="object"||!R?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");M=D}const X=new URL((n=R?.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in M&&M.signIn){const G=await M.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},R?.signInWithSolana),{version:"1",domain:X.host,uri:X.href}),O?{statement:O}:null));let de;if(Array.isArray(G)&&G[0]&&typeof G[0]=="object")de=G[0];else if(G&&typeof G=="object"&&"signedMessage"in G&&"signature"in G)de=G;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in de&&"signature"in de&&(typeof de.signedMessage=="string"||de.signedMessage instanceof Uint8Array)&&de.signature instanceof Uint8Array)_=typeof de.signedMessage=="string"?de.signedMessage:new TextDecoder().decode(de.signedMessage),E=de.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in M)||typeof M.signMessage!="function"||!("publicKey"in M)||typeof M!="object"||!M.publicKey||!("toBase58"in M.publicKey)||typeof M.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");_=[`${X.host} wants you to sign in with your Solana account:`,M.publicKey.toBase58(),...O?["",O,""]:[""],"Version: 1",`URI: ${X.href}`,`Issued At: ${(l=(o=R?.signInWithSolana)===null||o===void 0?void 0:o.issuedAt)!==null&&l!==void 0?l:new Date().toISOString()}`,...!((c=R?.signInWithSolana)===null||c===void 0)&&c.notBefore?[`Not Before: ${R.signInWithSolana.notBefore}`]:[],...!((d=R?.signInWithSolana)===null||d===void 0)&&d.expirationTime?[`Expiration Time: ${R.signInWithSolana.expirationTime}`]:[],...!((p=R?.signInWithSolana)===null||p===void 0)&&p.chainId?[`Chain ID: ${R.signInWithSolana.chainId}`]:[],...!((f=R?.signInWithSolana)===null||f===void 0)&&f.nonce?[`Nonce: ${R.signInWithSolana.nonce}`]:[],...!((g=R?.signInWithSolana)===null||g===void 0)&&g.requestId?[`Request ID: ${R.signInWithSolana.requestId}`]:[],...!((x=(y=R?.signInWithSolana)===null||y===void 0?void 0:y.resources)===null||x===void 0)&&x.length?["Resources",...R.signInWithSolana.resources.map(de=>`- ${de}`)]:[]].join(`
`);const G=await M.signMessage(new TextEncoder().encode(_),"utf8");if(!G||!(G instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");E=G}}try{const{data:k,error:D}=await Ze(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:_,signature:sx(E)},!((b=r.options)===null||b===void 0)&&b.captchaToken?{gotrue_meta_security:{captcha_token:(T=r.options)===null||T===void 0?void 0:T.captchaToken}}:null),xform:cn});if(D)throw D;return!k||!k.session||!k.user?{data:{user:null,session:null},error:new Lo}:(k.session&&(await this._saveSession(k.session),await this._notifyAllSubscribers("SIGNED_IN",k.session)),{data:Object.assign({},k),error:D})}catch(k){if(Je(k))return{data:{user:null,session:null},error:k};throw k}}async _exchangeCodeForSession(r){const n=await ls(this.storage,`${this.storageKey}-code-verifier`),[o,l]=(n??"").split("/");try{const{data:c,error:d}=await Ze(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:r,code_verifier:o},xform:cn});if(await Mn(this.storage,`${this.storageKey}-code-verifier`),d)throw d;return!c||!c.session||!c.user?{data:{user:null,session:null,redirectType:null},error:new Lo}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:Object.assign(Object.assign({},c),{redirectType:l??null}),error:d})}catch(c){if(Je(c))return{data:{user:null,session:null,redirectType:null},error:c};throw c}}async signInWithIdToken(r){try{const{options:n,provider:o,token:l,access_token:c,nonce:d}=r,p=await Ze(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:o,id_token:l,access_token:c,nonce:d,gotrue_meta_security:{captcha_token:n?.captchaToken}},xform:cn}),{data:f,error:g}=p;return g?{data:{user:null,session:null},error:g}:!f||!f.session||!f.user?{data:{user:null,session:null},error:new Lo}:(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",f.session)),{data:f,error:g})}catch(n){if(Je(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(r){var n,o,l,c,d;try{if("email"in r){const{email:p,options:f}=r;let g=null,y=null;this.flowType==="pkce"&&([g,y]=await ea(this.storage,this.storageKey));const{error:x}=await Ze(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:p,data:(n=f?.data)!==null&&n!==void 0?n:{},create_user:(o=f?.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:f?.captchaToken},code_challenge:g,code_challenge_method:y},redirectTo:f?.emailRedirectTo});return{data:{user:null,session:null},error:x}}if("phone"in r){const{phone:p,options:f}=r,{data:g,error:y}=await Ze(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:p,data:(l=f?.data)!==null&&l!==void 0?l:{},create_user:(c=f?.shouldCreateUser)!==null&&c!==void 0?c:!0,gotrue_meta_security:{captcha_token:f?.captchaToken},channel:(d=f?.channel)!==null&&d!==void 0?d:"sms"}});return{data:{user:null,session:null,messageId:g?.message_id},error:y}}throw new Mo("You must provide either an email or phone number.")}catch(p){if(Je(p))return{data:{user:null,session:null},error:p};throw p}}async verifyOtp(r){var n,o;try{let l,c;"options"in r&&(l=(n=r.options)===null||n===void 0?void 0:n.redirectTo,c=(o=r.options)===null||o===void 0?void 0:o.captchaToken);const{data:d,error:p}=await Ze(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},r),{gotrue_meta_security:{captcha_token:c}}),redirectTo:l,xform:cn});if(p)throw p;if(!d)throw new Error("An error occurred on token verification.");const f=d.session,g=d.user;return f?.access_token&&(await this._saveSession(f),await this._notifyAllSubscribers(r.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",f)),{data:{user:g,session:f},error:null}}catch(l){if(Je(l))return{data:{user:null,session:null},error:l};throw l}}async signInWithSSO(r){var n,o,l;try{let c=null,d=null;return this.flowType==="pkce"&&([c,d]=await ea(this.storage,this.storageKey)),await Ze(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in r?{provider_id:r.providerId}:null),"domain"in r?{domain:r.domain}:null),{redirect_to:(o=(n=r.options)===null||n===void 0?void 0:n.redirectTo)!==null&&o!==void 0?o:void 0}),!((l=r?.options)===null||l===void 0)&&l.captchaToken?{gotrue_meta_security:{captcha_token:r.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:c,code_challenge_method:d}),headers:this.headers,xform:_x})}catch(c){if(Je(c))return{data:null,error:c};throw c}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async r=>{const{data:{session:n},error:o}=r;if(o)throw o;if(!n)throw new Un;const{error:l}=await Ze(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:l}})}catch(r){if(Je(r))return{data:{user:null,session:null},error:r};throw r}}async resend(r){try{const n=`${this.url}/resend`;if("email"in r){const{email:o,type:l,options:c}=r,{error:d}=await Ze(this.fetch,"POST",n,{headers:this.headers,body:{email:o,type:l,gotrue_meta_security:{captcha_token:c?.captchaToken}},redirectTo:c?.emailRedirectTo});return{data:{user:null,session:null},error:d}}else if("phone"in r){const{phone:o,type:l,options:c}=r,{data:d,error:p}=await Ze(this.fetch,"POST",n,{headers:this.headers,body:{phone:o,type:l,gotrue_meta_security:{captcha_token:c?.captchaToken}}});return{data:{user:null,session:null,messageId:d?.message_id},error:p}}throw new Mo("You must provide either an email or phone number and a type")}catch(n){if(Je(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(r,n){this._debug("#_acquireLock","begin",r);try{if(this.lockAcquired){const o=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),l=(async()=>(await o,await n()))();return this.pendingInLock.push((async()=>{try{await l}catch{}})()),l}return await this.lock(`lock:${this.storageKey}`,r,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const o=n();for(this.pendingInLock.push((async()=>{try{await o}catch{}})()),await o;this.pendingInLock.length;){const l=[...this.pendingInLock];await Promise.all(l),this.pendingInLock.splice(0,l.length)}return await o}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(r){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await r(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let r=null;const n=await ls(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?r=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!r)return{data:{session:null},error:null};const o=r.expires_at?r.expires_at*1e3-Date.now()<eu:!1;if(this._debug("#__loadSession()",`session has${o?"":" not"} expired`,"expires_at",r.expires_at),!o){if(this.userStorage){const d=await ls(this.userStorage,this.storageKey+"-user");d?.user?r.user=d.user:r.user=nu()}if(this.storage.isServer&&r.user){let d=this.suppressGetSessionWarning;r=new Proxy(r,{get:(f,g,y)=>(!d&&g==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),d=!0,this.suppressGetSessionWarning=!0),Reflect.get(f,g,y))})}return{data:{session:r},error:null}}const{session:l,error:c}=await this._callRefreshToken(r.refresh_token);return c?{data:{session:null},error:c}:{data:{session:l},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(r){return r?await this._getUser(r):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(r){try{return r?await Ze(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:r,xform:Fn}):await this._useSession(async n=>{var o,l,c;const{data:d,error:p}=n;if(p)throw p;return!(!((o=d.session)===null||o===void 0)&&o.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Un}:await Ze(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(c=(l=d.session)===null||l===void 0?void 0:l.access_token)!==null&&c!==void 0?c:void 0,xform:Fn})})}catch(n){if(Je(n))return Y0(n)&&(await this._removeSession(),await Mn(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(r,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(r,n))}async _updateUser(r,n={}){try{return await this._useSession(async o=>{const{data:l,error:c}=o;if(c)throw c;if(!l.session)throw new Un;const d=l.session;let p=null,f=null;this.flowType==="pkce"&&r.email!=null&&([p,f]=await ea(this.storage,this.storageKey));const{data:g,error:y}=await Ze(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n?.emailRedirectTo,body:Object.assign(Object.assign({},r),{code_challenge:p,code_challenge_method:f}),jwt:d.access_token,xform:Fn});if(y)throw y;return d.user=g.user,await this._saveSession(d),await this._notifyAllSubscribers("USER_UPDATED",d),{data:{user:d.user},error:null}})}catch(o){if(Je(o))return{data:{user:null},error:o};throw o}}async setSession(r){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(r))}async _setSession(r){try{if(!r.access_token||!r.refresh_token)throw new Un;const n=Date.now()/1e3;let o=n,l=!0,c=null;const{payload:d}=ru(r.access_token);if(d.exp&&(o=d.exp,l=o<=n),l){const{session:p,error:f}=await this._callRefreshToken(r.refresh_token);if(f)return{data:{user:null,session:null},error:f};if(!p)return{data:{user:null,session:null},error:null};c=p}else{const{data:p,error:f}=await this._getUser(r.access_token);if(f)throw f;c={access_token:r.access_token,refresh_token:r.refresh_token,user:p.user,token_type:"bearer",expires_in:o-n,expires_at:o},await this._saveSession(c),await this._notifyAllSubscribers("SIGNED_IN",c)}return{data:{user:c.user,session:c},error:null}}catch(n){if(Je(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(r){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(r))}async _refreshSession(r){try{return await this._useSession(async n=>{var o;if(!r){const{data:d,error:p}=n;if(p)throw p;r=(o=d.session)!==null&&o!==void 0?o:void 0}if(!r?.refresh_token)throw new Un;const{session:l,error:c}=await this._callRefreshToken(r.refresh_token);return c?{data:{user:null,session:null},error:c}:l?{data:{user:l.user,session:l},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(Je(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(r,n){try{if(!Mr())throw new Uo("No browser detected.");if(r.error||r.error_description||r.error_code)throw new Uo(r.error_description||"Error in URL with unspecified error_description",{error:r.error||"unspecified_error",code:r.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new Yf("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Uo("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!r.code)throw new Yf("No code detected.");const{data:O,error:R}=await this._exchangeCodeForSession(r.code);if(R)throw R;const M=new URL(window.location.href);return M.searchParams.delete("code"),window.history.replaceState(window.history.state,"",M.toString()),{data:{session:O.session,redirectType:null},error:null}}const{provider_token:o,provider_refresh_token:l,access_token:c,refresh_token:d,expires_in:p,expires_at:f,token_type:g}=r;if(!c||!p||!d||!g)throw new Uo("No session defined in URL");const y=Math.round(Date.now()/1e3),x=parseInt(p);let b=y+x;f&&(b=parseInt(f));const T=b-y;T*1e3<=sa&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${T}s, should have been closer to ${x}s`);const _=b-x;y-_>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",_,b,y):y-_<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",_,b,y);const{data:E,error:k}=await this._getUser(c);if(k)throw k;const D={provider_token:o,provider_refresh_token:l,access_token:c,expires_in:x,expires_at:b,refresh_token:d,token_type:g,user:E.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:D,redirectType:r.type},error:null}}catch(o){if(Je(o))return{data:{session:null,redirectType:null},error:o};throw o}}_isImplicitGrantCallback(r){return!!(r.access_token||r.error_description)}async _isPKCECallback(r){const n=await ls(this.storage,`${this.storageKey}-code-verifier`);return!!(r.code&&n)}async signOut(r={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(r))}async _signOut({scope:r}={scope:"global"}){return await this._useSession(async n=>{var o;const{data:l,error:c}=n;if(c)return{error:c};const d=(o=l.session)===null||o===void 0?void 0:o.access_token;if(d){const{error:p}=await this.admin.signOut(d,r);if(p&&!(K0(p)&&(p.status===404||p.status===401||p.status===403)))return{error:p}}return r!=="others"&&(await this._removeSession(),await Mn(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(r){const n=ix(),o={id:n,callback:r,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,o),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:o}}}async _emitInitialSession(r){return await this._useSession(async n=>{var o,l;try{const{data:{session:c},error:d}=n;if(d)throw d;await((o=this.stateChangeEmitters.get(r))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",c)),this._debug("INITIAL_SESSION","callback id",r,"session",c)}catch(c){await((l=this.stateChangeEmitters.get(r))===null||l===void 0?void 0:l.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",r,"error",c),console.error(c)}})}async resetPasswordForEmail(r,n={}){let o=null,l=null;this.flowType==="pkce"&&([o,l]=await ea(this.storage,this.storageKey,!0));try{return await Ze(this.fetch,"POST",`${this.url}/recover`,{body:{email:r,code_challenge:o,code_challenge_method:l,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(c){if(Je(c))return{data:null,error:c};throw c}}async getUserIdentities(){var r;try{const{data:n,error:o}=await this.getUser();if(o)throw o;return{data:{identities:(r=n.user.identities)!==null&&r!==void 0?r:[]},error:null}}catch(n){if(Je(n))return{data:null,error:n};throw n}}async linkIdentity(r){var n;try{const{data:o,error:l}=await this._useSession(async c=>{var d,p,f,g,y;const{data:x,error:b}=c;if(b)throw b;const T=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,r.provider,{redirectTo:(d=r.options)===null||d===void 0?void 0:d.redirectTo,scopes:(p=r.options)===null||p===void 0?void 0:p.scopes,queryParams:(f=r.options)===null||f===void 0?void 0:f.queryParams,skipBrowserRedirect:!0});return await Ze(this.fetch,"GET",T,{headers:this.headers,jwt:(y=(g=x.session)===null||g===void 0?void 0:g.access_token)!==null&&y!==void 0?y:void 0})});if(l)throw l;return Mr()&&!(!((n=r.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(o?.url),{data:{provider:r.provider,url:o?.url},error:null}}catch(o){if(Je(o))return{data:{provider:r.provider,url:null},error:o};throw o}}async unlinkIdentity(r){try{return await this._useSession(async n=>{var o,l;const{data:c,error:d}=n;if(d)throw d;return await Ze(this.fetch,"DELETE",`${this.url}/user/identities/${r.identity_id}`,{headers:this.headers,jwt:(l=(o=c.session)===null||o===void 0?void 0:o.access_token)!==null&&l!==void 0?l:void 0})})}catch(n){if(Je(n))return{data:null,error:n};throw n}}async _refreshAccessToken(r){const n=`#_refreshAccessToken(${r.substring(0,5)}...)`;this._debug(n,"begin");try{const o=Date.now();return await ux(async l=>(l>0&&await cx(200*Math.pow(2,l-1)),this._debug(n,"refreshing attempt",l),await Ze(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:r},headers:this.headers,xform:cn})),(l,c)=>{const d=200*Math.pow(2,l);return c&&tu(c)&&Date.now()+d-o<sa})}catch(o){if(this._debug(n,"error",o),Je(o))return{data:{session:null,user:null},error:o};throw o}finally{this._debug(n,"end")}}_isValidSession(r){return typeof r=="object"&&r!==null&&"access_token"in r&&"refresh_token"in r&&"expires_at"in r}async _handleProviderSignIn(r,n){const o=await this._getUrlForProvider(`${this.url}/authorize`,r,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",r,"options",n,"url",o),Mr()&&!n.skipBrowserRedirect&&window.location.assign(o),{data:{provider:r,url:o},error:null}}async _recoverAndRefresh(){var r,n;const o="#_recoverAndRefresh()";this._debug(o,"begin");try{const l=await ls(this.storage,this.storageKey);if(l&&this.userStorage){let d=await ls(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!d&&(d={user:l.user},await aa(this.userStorage,this.storageKey+"-user",d)),l.user=(r=d?.user)!==null&&r!==void 0?r:nu()}else if(l&&!l.user&&!l.user){const d=await ls(this.storage,this.storageKey+"-user");d&&d?.user?(l.user=d.user,await Mn(this.storage,this.storageKey+"-user"),await aa(this.storage,this.storageKey,l)):l.user=nu()}if(this._debug(o,"session from storage",l),!this._isValidSession(l)){this._debug(o,"session is not valid"),l!==null&&await this._removeSession();return}const c=((n=l.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<eu;if(this._debug(o,`session has${c?"":" not"} expired with margin of ${eu}s`),c){if(this.autoRefreshToken&&l.refresh_token){const{error:d}=await this._callRefreshToken(l.refresh_token);d&&(console.error(d),tu(d)||(this._debug(o,"refresh failed with a non-retryable error, removing the session",d),await this._removeSession()))}}else if(l.user&&l.user.__isUserNotAvailableProxy===!0)try{const{data:d,error:p}=await this._getUser(l.access_token);!p&&d?.user?(l.user=d.user,await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)):this._debug(o,"could not get user data, skipping SIGNED_IN notification")}catch(d){console.error("Error getting user data:",d),this._debug(o,"error getting user data, skipping SIGNED_IN notification",d)}else await this._notifyAllSubscribers("SIGNED_IN",l)}catch(l){this._debug(o,"error",l),console.error(l);return}finally{this._debug(o,"end")}}async _callRefreshToken(r){var n,o;if(!r)throw new Un;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const l=`#_callRefreshToken(${r.substring(0,5)}...)`;this._debug(l,"begin");try{this.refreshingDeferred=new sl;const{data:c,error:d}=await this._refreshAccessToken(r);if(d)throw d;if(!c.session)throw new Un;await this._saveSession(c.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",c.session);const p={session:c.session,error:null};return this.refreshingDeferred.resolve(p),p}catch(c){if(this._debug(l,"error",c),Je(c)){const d={session:null,error:c};return tu(c)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(d),d}throw(o=this.refreshingDeferred)===null||o===void 0||o.reject(c),c}finally{this.refreshingDeferred=null,this._debug(l,"end")}}async _notifyAllSubscribers(r,n,o=!0){const l=`#_notifyAllSubscribers(${r})`;this._debug(l,"begin",n,`broadcast = ${o}`);try{this.broadcastChannel&&o&&this.broadcastChannel.postMessage({event:r,session:n});const c=[],d=Array.from(this.stateChangeEmitters.values()).map(async p=>{try{await p.callback(r,n)}catch(f){c.push(f)}});if(await Promise.all(d),c.length>0){for(let p=0;p<c.length;p+=1)console.error(c[p]);throw c[0]}}finally{this._debug(l,"end")}}async _saveSession(r){this._debug("#_saveSession()",r),this.suppressGetSessionWarning=!0;const n=Object.assign({},r),o=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!o&&n.user&&await aa(this.userStorage,this.storageKey+"-user",{user:n.user});const l=Object.assign({},n);delete l.user;const c=tp(l);await aa(this.storage,this.storageKey,c)}else{const l=tp(n);await aa(this.storage,this.storageKey,l)}}async _removeSession(){this._debug("#_removeSession()"),await Mn(this.storage,this.storageKey),await Mn(this.storage,this.storageKey+"-code-verifier"),await Mn(this.storage,this.storageKey+"-user"),this.userStorage&&await Mn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const r=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{r&&Mr()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",r)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const r=setInterval(()=>this._autoRefreshTokenTick(),sa);this.autoRefreshTicker=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const r=this.autoRefreshTicker;this.autoRefreshTicker=null,r&&clearInterval(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const r=Date.now();try{return await this._useSession(async n=>{const{data:{session:o}}=n;if(!o||!o.refresh_token||!o.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const l=Math.floor((o.expires_at*1e3-r)/sa);this._debug("#_autoRefreshTokenTick()",`access token expires in ${l} ticks, a tick lasts ${sa}ms, refresh threshold is ${bu} ticks`),l<=bu&&await this._callRefreshToken(o.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(r){if(r.isAcquireTimeout||r instanceof Vp)this._debug("auto refresh token tick lock not available");else throw r}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Mr()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(r){console.error("_handleVisibilityChange",r)}}async _onVisibilityChanged(r){const n=`#_onVisibilityChanged(${r})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),r||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(r,n,o){const l=[`provider=${encodeURIComponent(n)}`];if(o?.redirectTo&&l.push(`redirect_to=${encodeURIComponent(o.redirectTo)}`),o?.scopes&&l.push(`scopes=${encodeURIComponent(o.scopes)}`),this.flowType==="pkce"){const[c,d]=await ea(this.storage,this.storageKey),p=new URLSearchParams({code_challenge:`${encodeURIComponent(c)}`,code_challenge_method:`${encodeURIComponent(d)}`});l.push(p.toString())}if(o?.queryParams){const c=new URLSearchParams(o.queryParams);l.push(c.toString())}return o?.skipBrowserRedirect&&l.push(`skip_http_redirect=${o.skipBrowserRedirect}`),`${r}?${l.join("&")}`}async _unenroll(r){try{return await this._useSession(async n=>{var o;const{data:l,error:c}=n;return c?{data:null,error:c}:await Ze(this.fetch,"DELETE",`${this.url}/factors/${r.factorId}`,{headers:this.headers,jwt:(o=l?.session)===null||o===void 0?void 0:o.access_token})})}catch(n){if(Je(n))return{data:null,error:n};throw n}}async _enroll(r){try{return await this._useSession(async n=>{var o,l;const{data:c,error:d}=n;if(d)return{data:null,error:d};const p=Object.assign({friendly_name:r.friendlyName,factor_type:r.factorType},r.factorType==="phone"?{phone:r.phone}:{issuer:r.issuer}),{data:f,error:g}=await Ze(this.fetch,"POST",`${this.url}/factors`,{body:p,headers:this.headers,jwt:(o=c?.session)===null||o===void 0?void 0:o.access_token});return g?{data:null,error:g}:(r.factorType==="totp"&&(!((l=f?.totp)===null||l===void 0)&&l.qr_code)&&(f.totp.qr_code=`data:image/svg+xml;utf-8,${f.totp.qr_code}`),{data:f,error:null})})}catch(n){if(Je(n))return{data:null,error:n};throw n}}async _verify(r){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var o;const{data:l,error:c}=n;if(c)return{data:null,error:c};const{data:d,error:p}=await Ze(this.fetch,"POST",`${this.url}/factors/${r.factorId}/verify`,{body:{code:r.code,challenge_id:r.challengeId},headers:this.headers,jwt:(o=l?.session)===null||o===void 0?void 0:o.access_token});return p?{data:null,error:p}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+d.expires_in},d)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",d),{data:d,error:p})})}catch(n){if(Je(n))return{data:null,error:n};throw n}})}async _challenge(r){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var o;const{data:l,error:c}=n;return c?{data:null,error:c}:await Ze(this.fetch,"POST",`${this.url}/factors/${r.factorId}/challenge`,{body:{channel:r.channel},headers:this.headers,jwt:(o=l?.session)===null||o===void 0?void 0:o.access_token})})}catch(n){if(Je(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(r){const{data:n,error:o}=await this._challenge({factorId:r.factorId});return o?{data:null,error:o}:await this._verify({factorId:r.factorId,challengeId:n.id,code:r.code})}async _listFactors(){const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const o=r?.factors||[],l=o.filter(d=>d.factor_type==="totp"&&d.status==="verified"),c=o.filter(d=>d.factor_type==="phone"&&d.status==="verified");return{data:{all:o,totp:l,phone:c},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async r=>{var n,o;const{data:{session:l},error:c}=r;if(c)return{data:null,error:c};if(!l)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:d}=ru(l.access_token);let p=null;d.aal&&(p=d.aal);let f=p;((o=(n=l.user.factors)===null||n===void 0?void 0:n.filter(x=>x.status==="verified"))!==null&&o!==void 0?o:[]).length>0&&(f="aal2");const y=d.amr||[];return{data:{currentLevel:p,nextLevel:f,currentAuthenticationMethods:y},error:null}}))}async fetchJwk(r,n={keys:[]}){let o=n.keys.find(p=>p.kid===r);if(o)return o;const l=Date.now();if(o=this.jwks.keys.find(p=>p.kid===r),o&&this.jwks_cached_at+V0>l)return o;const{data:c,error:d}=await Ze(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(d)throw d;return!c.keys||c.keys.length===0||(this.jwks=c,this.jwks_cached_at=l,o=c.keys.find(p=>p.kid===r),!o)?null:o}async getClaims(r,n={}){try{let o=r;if(!o){const{data:T,error:_}=await this.getSession();if(_||!T.session)return{data:null,error:_};o=T.session.access_token}const{header:l,payload:c,signature:d,raw:{header:p,payload:f}}=ru(o);n?.allowExpired||yx(c.exp);const g=!l.alg||l.alg.startsWith("HS")||!l.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(l.kid,n?.keys?{keys:n.keys}:n?.jwks);if(!g){const{error:T}=await this.getUser(o);if(T)throw T;return{data:{claims:c,header:l,signature:d},error:null}}const y=vx(l.alg),x=await crypto.subtle.importKey("jwk",g,y,!0,["verify"]);if(!await crypto.subtle.verify(y,x,d,nx(`${p}.${f}`)))throw new _u("Invalid JWT signature");return{data:{claims:c,header:l,signature:d},error:null}}catch(o){if(Je(o))return{data:null,error:o};throw o}}}mi.nextInstanceID=0;const Dx=mi;class Rx extends Dx{constructor(r){super(r)}}var Lx=function(s,r,n,o){function l(c){return c instanceof n?c:new n(function(d){d(c)})}return new(n||(n=Promise))(function(c,d){function p(y){try{g(o.next(y))}catch(x){d(x)}}function f(y){try{g(o.throw(y))}catch(x){d(x)}}function g(y){y.done?c(y.value):l(y.value).then(p,f)}g((o=o.apply(s,r||[])).next())})};class Mx{constructor(r,n,o){var l,c,d;this.supabaseUrl=r,this.supabaseKey=n;const p=$0(r);if(!n)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",p),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",p),this.storageUrl=new URL("storage/v1",p),this.functionsUrl=new URL("functions/v1",p);const f=`sb-${p.hostname.split(".")[0]}-auth-token`,g={db:O0,realtime:D0,auth:Object.assign(Object.assign({},I0),{storageKey:f}),global:A0},y=B0(o??{},g);this.storageKey=(l=y.auth.storageKey)!==null&&l!==void 0?l:"",this.headers=(c=y.global.headers)!==null&&c!==void 0?c:{},y.accessToken?(this.accessToken=y.accessToken,this.auth=new Proxy({},{get:(x,b)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(b)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((d=y.auth)!==null&&d!==void 0?d:{},this.headers,y.global.fetch),this.fetch=U0(n,this._getAccessToken.bind(this),y.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},y.realtime)),this.rest=new Xw(new URL("rest/v1",p).href,{headers:this.headers,schema:y.db.schema,fetch:this.fetch}),this.storage=new C0(this.storageUrl.href,this.headers,this.fetch,o?.storage),y.accessToken||this._listenForAuthEvents()}get functions(){return new $w(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(r){return this.rest.from(r)}schema(r){return this.rest.schema(r)}rpc(r,n={},o={}){return this.rest.rpc(r,n,o)}channel(r,n={config:{}}){return this.realtime.channel(r,n)}getChannels(){return this.realtime.getChannels()}removeChannel(r){return this.realtime.removeChannel(r)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var r,n;return Lx(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:o}=yield this.auth.getSession();return(n=(r=o.session)===null||r===void 0?void 0:r.access_token)!==null&&n!==void 0?n:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:r,persistSession:n,detectSessionInUrl:o,storage:l,userStorage:c,storageKey:d,flowType:p,lock:f,debug:g},y,x){const b={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Rx({url:this.authUrl.href,headers:Object.assign(Object.assign({},b),y),storageKey:d,autoRefreshToken:r,persistSession:n,detectSessionInUrl:o,storage:l,userStorage:c,flowType:p,lock:f,debug:g,fetch:x,hasCustomAuthorizationHeader:Object.keys(this.headers).some(T=>T.toLowerCase()==="authorization")})}_initRealtimeClient(r){return new m0(this.realtimeUrl.href,Object.assign(Object.assign({},r),{params:Object.assign({apikey:this.supabaseKey},r?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,o)=>{this._handleTokenChanged(n,"CLIENT",o?.access_token)})}_handleTokenChanged(r,n,o){(r==="TOKEN_REFRESHED"||r==="SIGNED_IN")&&this.changedAccessToken!==o?this.changedAccessToken=o:r==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Ux=(s,r,n)=>new Mx(s,r,n);function Fx(){if(typeof window<"u"||typeof process>"u")return!1;const s=process.version;if(s==null)return!1;const r=s.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}Fx()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Wx="https://hkvkomtaffybchjdjfws.supabase.co",Bx="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhrdmtvbXRhZmZ5YmNoamRqZndzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY4MTc3ODQsImV4cCI6MjA3MjM5Mzc4NH0.A0Eaqx1g8ADX0uiUL8eDw-2h6RF50csP-KKCTtVdhCE",dt=Ux(Wx,Bx,{auth:{persistSession:!1}});async function ju(s){const r=s&&s.headers?{...s.headers}:{};try{if(dt&&typeof dt.auth?.getSession=="function"){const o=(await dt.auth.getSession())?.data?.session?.access_token??null;o&&(r.Authorization=`Bearer ${o}`)}}catch{}if(!r.Authorization)try{const n=qo();n&&(r.Authorization=`Bearer ${n}`)}catch{}return{...s||{},headers:r}}const Gn=Object.freeze(Object.defineProperty({__proto__:null,attachAuthHeaders:ju,default:ju},Symbol.toStringTag,{value:"Module"})),ca=1e4;async function $x(s,r){try{const n={id:r.id,name:r.name,price:r.price,type:r.type,image:r.image||null,description:r.description||""},o=await ju({method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:s,item:n})}),l=await fetch("/api/user?action=buy",o);if(!l.ok){try{const d=await l.json();console.warn("[buyShopItem] server error",d.code||d.message||l.status)}catch{console.warn("[buyShopItem] server error status",l.status)}return null}const c=await l.json();if(c.user){try{qt({data:c.user})}catch{}return c.user}return null}catch{return null}}async function Yo(s){try{try{const{data:l,error:c}=await dt.from("fitbuddyai_userdata").select("*").eq("user_id",s).limit(1).maybeSingle();if(c||!l)return null;try{qt({data:l})}catch{}return l}catch{return null}const n=await fetch(`/api/user/${s}`);if(!n.ok)return null;const o=await n.json();if(o.user){const l=o.user.energy??ca,c={...o.user,energy:l};try{qt({data:c})}catch{}return c}return null}catch{return null}}async function zx(s,r){const n=String(s).trim().toLowerCase();if(!0){const d=await dt.auth.signInWithPassword({email:n,password:r});if(d.error||!d.data?.session){const b=d.error?.message||"Sign in failed";if(/confirm|verify|not.*confirmed|email.*confirm/i.test(b)){const T=new Error("Email not confirmed");throw T.code="ERR_EMAIL_UNCONFIRMED",T}throw new Error(b)}const p=d.data.session.access_token,f=d.data.user;let g=f.user_metadata&&f.user_metadata.username||null;if(!g)try{const{data:b}=await dt.from("fitbuddyai_userdata").select("username").eq("user_id",f.id).limit(1).maybeSingle();b&&b.username&&(g=b.username)}catch{}const y=(f.user_metadata&&f.user_metadata.energy)??ca,x={data:{id:f.id,email:f.email,username:g||f.email,energy:y}};try{sessionStorage.removeItem("fitbuddyai_no_auto_restore")}catch{}try{localStorage.removeItem("fitbuddyai_no_auto_restore")}catch{}try{qt({data:x.data,token:p},{skipBackup:!0,forceSave:!0})}catch{}try{p&&Sp(p)}catch{}try{const b=x.data.username;b&&await dt.auth.updateUser({data:{display_name:b,username:b}})}catch(b){console.warn("[authService] failed to update supabase user metadata",b&&b.message||String(b))}return x.data}const l=await fetch("/api/auth?action=signin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:r})});if(!l.ok){const d=await l.json();throw new Error(d.message||"Sign in failed")}const c=await l.json();if(c.user){const d=c.user.energy??ca,f={data:{...c.user,energy:d},token:c.token??null};try{qt(f,{skipBackup:!0,forceSave:!0})}catch{}}return{...c.user,energy:c.user.energy??ca}}async function qx(s,r,n){const o=String(s).trim().toLowerCase();if(!0){const p=await dt.auth.signUp({email:o,password:n,options:{data:{username:r,energy:ca}}});if(p.error)throw new Error(p.error.message||"Sign up failed");const f=p.data?.session?.access_token??null,g=p.data?.user??null,y=g?{id:g.id,email:g.email,username:r,energy:ca}:null;if(f&&y){try{sessionStorage.removeItem("fitbuddyai_no_auto_restore")}catch{}try{localStorage.removeItem("fitbuddyai_no_auto_restore")}catch{}try{qt({data:y,token:f},{skipBackup:!0,forceSave:!0})}catch{}}try{g&&g.id&&await fetch("/api/auth?action=create_profile",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:g.id,email:g.email,username:r})})}catch(x){console.warn("[authService] create_profile call failed",x)}return y}const c=await fetch("/api/auth?action=signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:o,username:r,password:n})});if(!c.ok){let p=null;try{p=await c.json()}catch{}const f=new Error(p&&p.message||"Sign up failed");throw p&&p.code&&(f.code=p.code),f}const d=await c.json();if(d.user){const p={data:d.user,token:d.token??null};try{qt(p,{skipBackup:!0,forceSave:!0})}catch{}}return d.user}async function Hx(){try{const r="http://localhost:5173".trim()||"",n=window.location.origin+window.location.pathname+window.location.search+window.location.hash,o=r&&r!=="PUT_YOUR_PUBLIC_APP_URL_HERE"?r.replace(/\/$/,"")+window.location.pathname:n;console.log("[authService] initiating Google sign-in, redirectTo=",o),await dt.auth.signInWithOAuth({provider:"google",options:{redirectTo:o}});return}catch(r){throw console.warn("[authService] Google sign-in failed",r),r}throw new Error("Google sign-in is not available in this environment.")}async function Gx(s){try{const r=await fetch("/api/auth?action=google_id_token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_token:s})});if(!r.ok){let o=null;try{o=await r.json()}catch{}throw new Error(o&&o.message||`Google ID token sign-in failed (${r.status})`)}const n=await r.json();if(n&&n.user)try{qt({data:n.user,token:n.token??null},{skipBackup:!0})}catch{}return n}catch(r){throw console.warn("[authService] signInWithGoogleCredential error",r),r}}function Qo(){try{return mr()}catch{return null}}function Vx(){try{Ru()}catch{}try{sessionStorage.removeItem("fitbuddyai_no_auto_restore")}catch{}try{localStorage.removeItem("fitbuddyai_no_auto_restore")}catch{}try{const{clearUserData:s}=require("./localStorage");s()}catch{}try{sessionStorage.removeItem("fitbuddyaiUsername")}catch{}try{dt&&typeof dt.auth?.signOut=="function"&&dt.auth.signOut().catch(()=>{})}catch{}}const Jx=()=>{const s=Wr(),r=()=>{try{localStorage.setItem("fitbuddyai_no_auto_restore","1")}catch{}try{sessionStorage.setItem("fitbuddyai_no_auto_restore","1")}catch{}try{Ru()}catch{}try{ma()}catch{}try{pa()}catch{}try{yi()}catch{}try{Vx()}catch{}try{window.dispatchEvent(new Event("fitbuddyai-logout"))}catch{}s("/signin"),(async()=>{try{let n=null;try{const{loadUserData:o}=await et(async()=>{const{loadUserData:c}=await Promise.resolve().then(()=>ir);return{loadUserData:c}},void 0),l=o();n=l?.id||l?.sub||l?.data?.id||null}catch{}if(n){try{await Iu(String(n))}catch{}try{await gi(String(n))}catch{}}}catch{}})();try{setTimeout(()=>{try{sessionStorage.removeItem("fitbuddyai_no_auto_restore")}catch{}try{localStorage.removeItem("fitbuddyai_no_auto_restore")}catch{}},3e3)}catch{}};return a.jsx("button",{className:"btn signout-btn",onClick:r,children:"Sign Out"})},Kx=({userData:s,onProfileUpdate:r})=>{const[n,o]=S.useState(s||Qo()),[l,c]=S.useState(!1),[d,p]=S.useState(n?.username||""),[f,g]=S.useState(n?.avatar||"/images/fitbuddyai_head.png"),[y,x]=S.useState(!1),[b,T]=S.useState(""),_=Wr();if(S.useEffect(()=>{let M=!1;const X=async()=>{try{if(M)return;const de=Qo();if(!de?.id||typeof document<"u"&&document.hidden)return;const we=await Yo(de.id);!M&&we&&o(we)}catch{}};X();const G=setInterval(X,15e3);return()=>{M=!0,clearInterval(G)}},[]),!n)return a.jsx("div",{className:"profile-page",children:a.jsxs("div",{className:"profile-card fade-in-bounce",children:[a.jsx("div",{className:"profile-avatar-bg",children:a.jsx("img",{src:"/images/fitbuddyai_head.png",alt:"User Avatar",className:"avatar","data-testid":"profile-avatar"})}),a.jsx("h1",{className:"profile-username-gradient",children:"Guest"}),a.jsxs("div",{className:"profile-actions-row",children:[a.jsx("button",{className:"btn edit-profile",onClick:()=>_("/signin"),children:"Sign In"}),a.jsx("button",{className:"btn view-achievements",onClick:()=>_("/signup"),children:"Sign Up"})]}),a.jsx("p",{className:"not-logged-in-desc",children:"Sign in to track your workouts, earn energy, and unlock achievements!"})]})});const E=["https://api.dicebear.com/7.x/bottts/svg?seed=FitBuddyAI1","https://api.dicebear.com/7.x/bottts/svg?seed=DragonHead","https://api.dicebear.com/7.x/bottts/svg?seed=Duolingo"],k=["/images/fitbuddyai_head.png",...E,"https://api.dicebear.com/7.x/bottts/svg?seed=FitBuddyAI2","https://api.dicebear.com/7.x/bottts/svg?seed=FitBuddyAI3","https://api.dicebear.com/7.x/bottts/svg?seed=FitBuddyAI4","https://api.dicebear.com/7.x/bottts/svg?seed=Pizza","https://we09532.github.io/Image_Hosting/Fishwins/Fishwin_Head.png","https://api.dicebear.com/7.x/bottts/svg?seed=Language","https://api.dicebear.com/7.x/bottts/svg?seed=Fitness","https://media1.giphy.com/media/4bjIKBOWUnVPICCzJc/source.gif"],D=()=>{p(n?.username||""),g(n?.avatar||"/images/fitbuddyai_head.png"),c(!0),T("")},O=()=>{c(!1),T("")},R=async()=>{x(!0),T("");try{const M=await fetch("/api/user?action=update",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:n.id,username:d,avatar:f})});if(M.ok){const X=await M.json();o(X.user),r(X.user),c(!1);try{const G=X.user?.username;G&&dt&&typeof dt.auth?.updateUser=="function"&&await dt.auth.updateUser({data:{display_name:G,username:G}})}catch(G){console.warn("[ProfilePage] failed to update supabase user metadata",G&&G.message||String(G))}}else{const X={...n,username:d,avatar:f};try{const{saveUserData:G}=await et(async()=>{const{saveUserData:de}=await Promise.resolve().then(()=>ir);return{saveUserData:de}},void 0);G({data:X})}catch{}o(X),r(X),c(!1),T("Saved locally (session)  server unavailable.")}}catch{const X={...n,username:d,avatar:f};try{const{saveUserData:G}=await et(async()=>{const{saveUserData:de}=await Promise.resolve().then(()=>ir);return{saveUserData:de}},void 0);G({data:X})}catch{}o(X),r(X),c(!1),T("Saved locally (network error).")}finally{x(!1)}};return a.jsx("div",{className:"profile-page",children:a.jsxs("div",{className:"profile-card fade-in-bounce",children:[a.jsx("div",{className:"profile-avatar-bg",children:a.jsx("img",{src:l?f:n.avatar||"/images/fitbuddy_head.png",alt:"User Avatar",className:"avatar","data-testid":"profile-avatar"})}),l?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"avatar-select-row",children:k.map(M=>{const G=!E.includes(M)||Array.isArray(n.inventory)&&n.inventory.some(de=>de.image===M);return a.jsxs("button",{className:`avatar-select-btn${f===M?" selected":""}${G?"":" locked"}`,onClick:()=>{G?g(M):_("/shop")},type:"button","aria-label":G?"Choose avatar":"Locked avatar",children:[!G&&a.jsx("span",{className:"avatar-lock-emoji",children:""}),a.jsx("img",{src:M,alt:"avatar option",className:"avatar avatar-option"})]},M)})}),a.jsx("input",{className:"edit-username-input",value:d,onChange:M=>p(M.target.value),maxLength:20,placeholder:"Username"}),b&&a.jsx("div",{className:"edit-error",children:b}),a.jsxs("div",{className:"profile-actions-row",children:[a.jsx("button",{className:"btn edit-profile",onClick:R,disabled:y,children:y?"Saving...":"Save"}),a.jsx("button",{className:"btn view-achievements",onClick:O,disabled:y,children:"Cancel"})]})]}):a.jsxs(a.Fragment,{children:[a.jsx("h1",{className:"profile-username-gradient",children:n.username}),a.jsxs("div",{className:"profile-stats-row",children:[a.jsxs("div",{className:"profile-stat",children:[a.jsx("span",{className:"profile-stat-label",children:"Workouts"}),a.jsx("span",{className:"profile-stat-value",children:n?.workouts?.length??"-"})]}),a.jsxs("div",{className:"profile-stat",children:[a.jsx("span",{className:"profile-stat-label",children:"Streak"}),a.jsx("span",{className:"profile-stat-value streak",children:n?.streak??"-"})]}),a.jsxs("div",{className:"profile-stat",children:[a.jsx("span",{className:"profile-stat-label",children:"Energy"}),a.jsx("span",{className:"profile-stat-value points",children:n?.energy??0})]})]}),a.jsxs("div",{className:"profile-actions-row",children:[a.jsx("button",{className:"btn edit-profile",onClick:D,children:"Edit Profile"}),a.jsx("button",{className:"btn view-achievements",children:"View Achievements"}),a.jsx(Jx,{})]})]})]})})};function Yx(s){try{const n=s.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),o=decodeURIComponent(atob(n).split("").map(function(l){return"%"+("00"+l.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(o)}catch{return null}}const Jp=()=>{const s=S.useRef(null),r="401606357553-q8h8b6do4c26cuho2ja94p03kkq5vht1.apps.googleusercontent.com";return!0?a.jsx("div",{className:"google-fallback",children:a.jsxs("button",{className:"btn btn-google",onClick:async()=>{try{await Hx()}catch(o){console.warn("[GoogleIdentityButton] signInWithGoogle failed",o),window.alert("Google sign-in failed. Check console for details.")}},children:[a.jsx("span",{className:"google-icon","aria-hidden":"true",children:a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 533.5 544.3",width:"18",height:"18","aria-hidden":"true",children:[a.jsx("path",{fill:"#4285F4",d:"M533.5 278.4c0-17.4-1.6-34.1-4.6-50.4H272v95.5h146.9c-6.3 34.1-25 63-53.4 82.3v68.3h86.4c50.6-46.6 81.6-115.3 81.6-195.7z"}),a.jsx("path",{fill:"#34A853",d:"M272 544.3c72.6 0 133.7-24.1 178.2-65.6l-86.4-68.3c-24 16.1-54.9 25.6-91.8 25.6-70.6 0-130.4-47.6-151.8-111.5H29.8v69.9C74.3 486.9 166.3 544.3 272 544.3z"}),a.jsx("path",{fill:"#FBBC05",d:"M120.2 325.1c-10.9-32.6-10.9-67.6 0-100.2V155H29.8c-39.6 77.4-39.6 169.4 0 246.8l90.4-76.7z"}),a.jsx("path",{fill:"#EA4335",d:"M272 107.7c38.5 0 73 13.2 100.3 39.2l75.1-75.1C405.8 24.7 346.7 0 272 0 166.3 0 74.3 57.4 29.8 143.6l90.4 69.9C141.6 155.3 201.4 107.7 272 107.7z"})]})}),a.jsx("span",{className:"google-text",children:"Continue with Google"})]})}):(S.useEffect(()=>{const o=()=>{if(window.google&&window.google.accounts&&window.google.accounts.id)try{window.google.accounts.id.initialize({client_id:r,callback:async l=>{try{const c=l?.credential;if(!c)return;const d=Yx(c);console.log("[GoogleIdentityButton] GSI credential received, payload:",d);try{await Gx(c)}catch(p){console.warn("[GoogleIdentityButton] signInWithGoogleCredential failed",p)}}catch(c){console.warn("[GoogleIdentityButton] error handling credential",c)}},auto_select:!1,cancel_on_tap_outside:!0}),s.current&&window.google.accounts.id.renderButton(s.current,{theme:"outline",size:"large",width:"100%"})}catch(l){console.warn("[GoogleIdentityButton] failed to initialize GSI",l)}else setTimeout(o,250)};return o(),()=>{try{window.google&&window.google.accounts&&window.google.accounts.id&&typeof window.google.accounts.id.cancel=="function"&&window.google.accounts.id.cancel()}catch{}}},[r]),a.jsxs("div",{children:[a.jsx("div",{ref:s}),!window.google&&a.jsx("div",{className:"google-fallback",children:a.jsx("button",{className:"btn btn-google",onClick:()=>window.alert("Google sign-in is not available. Try enabling Supabase OAuth or add VITE_GOOGLE_CLIENT_ID to your .env"),children:"Continue with Google"})})]}))},Qx=()=>{const s=Wr(),[r,n]=S.useState(""),[o,l]=S.useState(""),[c,d]=S.useState(""),[p,f]=S.useState(!1),[g,y]=S.useState(!1),[x,b]=S.useState(""),T=async _=>{_.preventDefault(),f(!0),d("");const E=String(r).trim().toLowerCase();try{const k=await zx(E,o),D=k?{user:k,token:null}:null;if(D&&D.user){const O={data:D.user,token:D.token||null};try{qt(O,{skipBackup:!0,forceSave:!0})}catch{}await(async(M=2e3)=>{const X=Date.now();for(;Date.now()-X<M;){try{const{getAuthToken:G,loadUserData:de}=await et(async()=>{const{getAuthToken:$,loadUserData:he}=await Promise.resolve().then(()=>ir);return{getAuthToken:$,loadUserData:he}},void 0),we=G()||de()?.token||de()?.data?.token||null;if(we)return we}catch{}await new Promise(G=>setTimeout(G,150))}return null})(3e3);try{sessionStorage.setItem("fitbuddyaiUsername",D.user.username)}catch{}try{await ms(D.user.id)}catch(M){console.warn("Failed to restore user data from server:",M)}try{window.dispatchEvent(new Event("fitbuddyai-login"))}catch{}try{const M="/api/userdata/load";console.log("[SignInPage] POSTing to userdata save endpoint to retrieve stored payload",M);const X=await et(()=>Promise.resolve().then(()=>Gn),void 0).then(he=>he.attachAuthHeaders({method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:D.user.id})})),G=async(he,oe,re=3,le=500)=>{let J=null,xe=null;for(let ge=1;ge<=re;ge++)try{const H=await fetch(he,oe),V=await H.text();if(J=H,xe=V,H.ok)return{res:H,text:V};if(ge<re&&(H.status===401||H.status===403||H.status>=500&&H.status<600)){console.warn(`[SignInPage] userdata POST attempt ${ge} failed status ${H.status}. Retrying after ${le}ms`),await new Promise(pe=>setTimeout(pe,le));continue}return{res:H,text:V}}catch(H){if(J=null,xe=null,ge<re){console.warn(`[SignInPage] userdata POST attempt ${ge} threw, retrying after ${le}ms`,H),await new Promise(V=>setTimeout(V,le));continue}throw H}return{res:J,text:xe}},{res:de,text:we}=await G(M,X,3,500);if(!de)throw new Error("Failed to receive a response from userdata endpoint");console.log("[SignInPage] userdata POST response status:",de.status,"ok:",de.ok),we&&we.length&&console.log("[SignInPage] userdata POST response snippet:",we.slice(0,500));const $=de.headers.get("x-userdata-source");if($&&console.log("[SignInPage] userdata source header:",$),de.ok){let he=null;try{he=we?JSON.parse(we):null}catch(re){console.warn("[SignInPage] userdata POST returned invalid JSON; invoking restoreUserDataFromServer fallback",re);try{await ms(D.user.id)}catch(le){console.warn("[SignInPage] fallback restore failed:",le)}}const oe=he?.stored??he?.payload??he;if(oe)try{const re=oe.assessment_data??oe.fitbuddyai_assessment_data,le=oe.workout_plan??oe.fitbuddyai_workout_plan,J=re?.data??re??null,xe=le?.data??le??null;J&&Du(J),xe&&fr(xe)}catch(re){console.warn("Failed to save restored payload values:",re)}}else{console.warn("[SignInPage] userdata POST returned non-ok status");try{await ms(D.user.id)}catch(he){console.warn("[SignInPage] fallback restore failed:",he)}}}catch(M){console.warn("Failed to fetch userdata payload via POST:",M)}s("/profile")}else throw new Error("Invalid server response.")}catch(k){if(k&&(k.code==="ERR_EMAIL_UNCONFIRMED"||/Email not confirmed/i.test(k.message||""))){d("Your email address is not confirmed. Please check your inbox for the confirmation link."),b(E),y(!0);return}d(k.message)}finally{f(!1)}};return a.jsxs("div",{className:"signin-page",children:[a.jsxs("form",{className:"signin-form",onSubmit:T,children:[a.jsx("h1",{children:"Sign In"}),a.jsxs("label",{children:["Email",a.jsx("input",{type:"email",value:r,onChange:_=>n(_.target.value),required:!0,autoComplete:"username"})]}),a.jsxs("label",{children:["Password",a.jsx("input",{type:"password",value:o,onChange:_=>l(_.target.value),required:!0,autoComplete:"current-password"})]}),c&&a.jsx("div",{className:"error",children:c}),a.jsx("button",{className:"btn",type:"submit",disabled:p,children:p?"Signing in...":"Sign In"}),a.jsx("div",{className:"oauth-divider",children:"or"}),a.jsx(Jp,{}),a.jsxs("div",{className:"signup-link",children:["Don't have an account? ",a.jsx("span",{onClick:()=>s("/signup"),children:"Sign Up"})]})]}),g&&a.jsx(Xx,{email:x,onClose:()=>y(!1),onSent:()=>{y(!1),s("/verify-email?email="+encodeURIComponent(x))}})]})};function Xx({email:s,onClose:r,onSent:n}){const[o,l]=S.useState(!1),[c,d]=S.useState(""),p=async()=>{l(!0),d("");try{const f=`${"https://hkvkomtaffybchjdjfws.supabase.co".replace(/\/$/,"")}/auth/v1/recover`;(await fetch(f,{method:"POST",headers:{apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhrdmtvbXRhZmZ5YmNoamRqZndzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY4MTc3ODQsImV4cCI6MjA3MjM5Mzc4NH0.A0Eaqx1g8ADX0uiUL8eDw-2h6RF50csP-KKCTtVdhCE"||"","Content-Type":"application/json"},body:JSON.stringify({email:s})})).ok?(d("Verification email resent  check your inbox (and spam)."),n()):d("Failed to resend verification email. Please contact support.")}catch{d("Failed to resend verification email. Please contact support.")}l(!1)};return a.jsx("div",{className:"hc-modal-backdrop",role:"dialog","aria-modal":"true",children:a.jsxs("div",{className:"hc-modal",children:[a.jsxs("header",{className:"hc-modal-header",children:[a.jsx("h3",{children:"Resend confirmation"}),a.jsx("button",{className:"btn",onClick:r,children:"Close"})]}),a.jsxs("div",{className:"hc-modal-body",children:[a.jsxs("p",{children:["We can resend the verification email to ",a.jsx("strong",{children:s}),". Would you like to resend it now?"]}),c&&a.jsx("div",{className:"info",children:c}),a.jsxs("div",{className:"hc-modal-actions",children:[a.jsx("button",{className:"btn",onClick:r,disabled:o,children:"Cancel"}),a.jsx("button",{className:"btn btn-primary",onClick:p,disabled:o,children:o?"Sending...":"Resend"})]})]})]})})}const Zx=()=>{const s=Wr(),[r,n]=S.useState(""),[o,l]=S.useState(""),[c,d]=S.useState(""),[p,f]=S.useState(""),[g,y]=S.useState(""),[x,b]=S.useState(!1),T=async _=>{if(_.preventDefault(),y(""),c!==p){y("Passwords do not match");return}b(!0);try{const E=String(r).trim().toLowerCase(),k=await qx(E,o,c);if(k&&k.id){try{sessionStorage.setItem("fitbuddyaiUsername",k.username)}catch{}s("/profile")}else throw new Error("Invalid server response.")}catch(E){const k=String(E?.message||E||"");/email already exists|duplicate|23505|An account with that email already exists/i.test(k)?y("An account with that email already exists. Please sign in or use a different email."):y(k||"Sign up failed")}finally{b(!1)}};return a.jsx("div",{className:"signup-page",children:a.jsxs("form",{className:"signup-form",onSubmit:T,children:[a.jsx("h1",{children:"Sign Up"}),a.jsxs("label",{children:["Email",a.jsx("input",{type:"email",value:r,onChange:_=>n(_.target.value),required:!0})]}),a.jsxs("label",{children:["Username",a.jsx("input",{type:"text",value:o,onChange:_=>l(_.target.value),required:!0})]}),a.jsxs("label",{children:["Password",a.jsx("input",{type:"password",value:c,onChange:_=>d(_.target.value),required:!0,autoComplete:"new-password"})]}),a.jsxs("label",{children:["Confirm Password",a.jsx("input",{type:"password",value:p,onChange:_=>f(_.target.value),required:!0,autoComplete:"new-password"})]}),g&&a.jsx("div",{className:"error",children:g}),a.jsx("button",{className:"btn",type:"submit",disabled:x,children:x?"Signing up...":"Sign Up"}),a.jsx("div",{className:"oauth-divider",children:"or"}),a.jsx(Jp,{}),a.jsxs("div",{className:"signin-link",children:["Already have an account? ",a.jsx("span",{onClick:()=>s("/signin"),children:"Sign In"})]})]})})};function eb(s){try{const r="analytics_verify_page_views",n=localStorage.getItem(r),o=n&&Number(n)||0;localStorage.setItem(r,String(o+1))}catch{}}function tb(){return new URLSearchParams(qn().search)}const rb=()=>{const s=Wr(),n=tb().get("email")||"",[o,l]=S.useState(!1),[c,d]=S.useState("");return S.useEffect(()=>{eb({email:n})},[n]),a.jsx("div",{className:"email-verify-page",children:a.jsxs("div",{className:"verify-card",children:[a.jsx("h1",{children:"Confirm your email"}),a.jsxs("p",{children:["We sent a confirmation link to ",a.jsx("strong",{children:n||"your email address"}),". Please check your inbox and click the link to finish signing up."]}),a.jsx("p",{children:"If you don't see the email, check your spam/junk folder."}),a.jsx("p",{children:"After clicking the link you'll be signed in automatically."}),a.jsxs("div",{className:"verify-actions",children:[a.jsx("button",{className:"btn",onClick:()=>s("/signin"),children:"Back to Sign In"}),a.jsx("button",{className:"btn",disabled:o,onClick:async()=>{l(!0),d("");try{const p="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhrdmtvbXRhZmZ5YmNoamRqZndzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY4MTc3ODQsImV4cCI6MjA3MjM5Mzc4NH0.A0Eaqx1g8ADX0uiUL8eDw-2h6RF50csP-KKCTtVdhCE",f=`${"https://hkvkomtaffybchjdjfws.supabase.co".replace(/\/$/,"")}/auth/v1/recover`,g=JSON.stringify({email:n});if((await fetch(f,{method:"POST",headers:{apikey:p||"","Content-Type":"application/json"},body:g})).ok)d("Verification email resent  check your inbox (and spam).");else try{await dt.auth.resetPasswordForEmail(n),d("Verification email resent  check your inbox (and spam).")}catch{d("Failed to resend verification email. Contact support.")}}catch{d("Failed to resend verification email. Contact support.")}l(!1)},children:"Resend confirmation"})]}),c&&a.jsx("div",{className:"info",children:c})]})})},$u=()=>a.jsx("div",{className:"notfound-container",children:a.jsxs("div",{className:"notfound-content fade-in-bounce",children:[a.jsx("div",{className:"notfound-icon-bg",children:a.jsx(Et,{size:48,color:"#fff"})}),a.jsx("h1",{className:"notfound-title",children:"404"}),a.jsx("h2",{className:"notfound-message",children:"Page Not Found"}),a.jsx("p",{className:"notfound-desc",children:"Oops! The page you are looking for does not exist."}),a.jsx("a",{className:"notfound-home-btn",href:"/?intro=0",children:"Go Home"})]})}),nb=[{id:"avatar1",name:"Bot Buddy",image:"https://api.dicebear.com/7.x/bottts/svg?seed=FitBuddyAI1",price:100,type:"avatar",description:"A friendly robot avatar."},{id:"avatar2",name:"Dragon Head",image:"https://api.dicebear.com/7.x/bottts/svg?seed=DragonHead",price:200,type:"avatar",description:"Unleash your inner dragon!"},{id:"avatar3",name:"Duolingo Owl",image:"https://api.dicebear.com/7.x/bottts/svg?seed=Duolingo",price:250,type:"avatar",description:"Inspired by the language learning legend."},{id:"avatar4",name:"Neo Cat",image:"https://api.dicebear.com/7.x/croodles/svg?seed=NeoCat",price:120,type:"avatar",description:"A sleek cyber cat."},{id:"avatar5",name:"Mountain Goat",image:"https://api.dicebear.com/7.x/bottts/svg?seed=Goat",price:140,type:"avatar",description:"Sturdy and sure-footed."},{id:"avatar6",name:"Galaxy Fox",image:"https://api.dicebear.com/7.x/bottts/svg?seed=GalaxyFox",price:220,type:"avatar",description:"Out-of-this-world style."},{id:"avatar7",name:"Pixel Pup",image:"https://api.dicebear.com/7.x/bottts/svg?seed=PixelPup",price:80,type:"avatar",description:"Cute pixel-styled puppy."},{id:"avatar8",name:"Samurai",image:"https://api.dicebear.com/7.x/bottts/svg?seed=Samurai",price:300,type:"avatar",description:"Honor and style."},{id:"avatar9",name:"Astronaut",image:"https://api.dicebear.com/7.x/bottts/svg?seed=Astronaut",price:260,type:"avatar",description:"Reach for the stars."},{id:"avatar10",name:"Vintage Robot",image:"https://api.dicebear.com/7.x/bottts/svg?seed=VintageBot",price:110,type:"avatar",description:"Retro charm."},{id:"avatar11",name:"Neon Ninja",image:"https://api.dicebear.com/7.x/bottts/svg?seed=NeonNinja",price:210,type:"avatar",description:"Stealthy and bright."},{id:"avatar12",name:"Forest Sprite",image:"https://api.dicebear.com/7.x/bottts/svg?seed=ForestSprite",price:130,type:"avatar",description:"Whimsical woodland friend."},{id:"avatar13",name:"Forest Sprite",image:"/images/ChatGPT_Image_Clan_Of_27_Fire.png",price:130,type:"avatar",description:"Whimsical woodland friend."}],sb=[{id:"streak-saver-1",name:"Streak Saver 1x",quantity:1,price:1e3},{id:"streak-saver-3",name:"Streak Saver 3x",quantity:3,price:2e3},{id:"streak-saver-5",name:"Streak Saver 5x",quantity:5,price:3e3}],ip=1e4,ab=[{id:"spinpfp",name:"Spinning Profile Picture",icon:a.jsx(oi,{size:32,color:"#1e90cb"}),price:300,type:"powerup",description:"Make your profile picture spin for 7 days!"},{id:"sparkle",name:"Sparkle Effect",icon:a.jsx(dn,{size:32,color:"#ffb347"}),price:150,type:"powerup",description:"Add a sparkle effect to your avatar."},{id:"smile",name:"Smile Badge",icon:a.jsx(Wo,{size:32,color:"#1ecb7b"}),price:80,type:"powerup",description:"Show off your positivity!"},{id:"glow",name:"Glow Outline",icon:a.jsx(dn,{size:32,color:"#1ecb7b"}),price:140,type:"powerup",description:"Add a soft glow behind your avatar."},{id:"confetti",name:"Confetti Burst",icon:a.jsx(dn,{size:32,color:"#ffb347"}),price:220,type:"powerup",description:"Celebrate finishes with confetti."},{id:"badge-pro",name:"Pro Badge",icon:a.jsx(Wo,{size:32,color:"#1ecb7b"}),price:190,type:"powerup",description:"Show you are a FitBuddyAI Pro."},{id:"trail",name:"Movement Trail",icon:a.jsx(oi,{size:32,color:"#1e90cb"}),price:170,type:"powerup",description:"Leave a subtle trail when you move."},{id:"animated-frames",name:"Animated Frames",icon:a.jsx(dn,{size:32,color:"#ffb347"}),price:250,type:"powerup",description:"Frame your avatar with animated borders."},{id:"voice-chime",name:"Voice Chime",icon:a.jsx(Wo,{size:32,color:"#1ecb7b"}),price:120,type:"powerup",description:"Play a chime when you start workouts."},{id:"seasonal-halo",name:"Seasonal Halo",icon:a.jsx(dn,{size:32,color:"#1ecb7b"}),price:160,type:"powerup",description:"A seasonal halo that changes with events."},{id:"vfx",name:"VFX Pack",icon:a.jsx(dn,{size:32,color:"#ffb347"}),price:320,type:"powerup",description:"A bundle of effects for your avatar."},{id:"status-glow",name:"Status Glow",icon:a.jsx(oi,{size:32,color:"#1e90cb"}),price:90,type:"powerup",description:"Show a small glow if you are active."}],ib=({user:s,onPurchase:r})=>{const[n,o]=S.useState("avatars"),[l,c]=S.useState(null),[d,p]=S.useState(""),[f,g]=S.useState("popular"),[y,x]=S.useState(null),b=S.useRef(null),T=S.useRef(null),_=S.useRef(null),E=S.useRef(void 0),[k,D]=S.useState(!1);S.useEffect(()=>{if(!s?.id)return;const $=async()=>{await Yo(s.id)&&window.dispatchEvent(new Event("storage"))};return $(),b.current=setInterval(()=>{typeof document<"u"&&document.hidden||$()},7e3),()=>{b.current&&clearInterval(b.current)}},[s?.id]),S.useEffect(()=>{const $=T.current,he=_.current;if(!$||!he)return;const oe=$.querySelector(`button[data-tab="${n}"]`);if(!oe)return;const re=oe.getBoundingClientRect(),le=$.getBoundingClientRect(),J=re.left-le.left+$.scrollLeft;he.style.width=`${re.width}px`,he.style.transform=`translateX(${J}px)`},[n]),S.useEffect(()=>{const $=T.current;if(!$)return;const he=oe=>{if(!(oe.key==="ArrowLeft"||oe.key==="ArrowRight"))return;oe.preventDefault();const re=["avatars","powerups"],le=re.indexOf(n);let J=le;oe.key==="ArrowLeft"&&(J=Math.max(0,le-1)),oe.key==="ArrowRight"&&(J=Math.min(re.length-1,le+1)),re[J]&&re[J]!==n&&o(re[J])};return $.addEventListener("keydown",he),()=>$.removeEventListener("keydown",he)},[n]),S.useEffect(()=>{const $=E.current??s?.energy??0,he=s?.energy??0;if(he>$){D(!0);const oe=setTimeout(()=>D(!1),900);return()=>clearTimeout(oe)}E.current=he},[s?.energy]);const O=Math.min(100,Math.round((s?.energy||0)/(s?.maxEnergy||ip)*100)),M=`fill--${Math.round(O/5)*5}`,X=async $=>{if(!s?.id){alert("Please sign in to purchase items.");return}if(s.energy<$.price){alert("Not enough energy!");return}if(c($.id),String($.id||"").startsWith("streak-saver")){try{const re=Number($.quantity??1);let le=Array.isArray(s.inventory)?[...s.inventory]:[];const J=le.findIndex(H=>String(H?.id||"").startsWith("streak-saver"));if(J>=0){const H=le[J],V=Number(H.quantity??H.count??1);le[J]={...H,quantity:(Number.isFinite(V)?V:1)+re}}else le.push({id:"streak-saver",quantity:re,type:"powerup"});const xe=Math.max(0,(s.energy??ip)-$.price),ge={...s,energy:xe,inventory:le};qt({data:ge}),r($),window.dispatchEvent(new Event("storage"))}catch(re){console.warn("Failed to process streak saver purchase:",re),alert("Purchase failed.")}finally{c(null)}return}const oe=await $x(s.id,$);if(c(null),oe){try{let re=Array.isArray(oe.inventory)?[...oe.inventory]:Array.isArray(s.inventory)?[...s.inventory]:[];const le=Math.max(0,(oe.energy??s.energy)-$.price),J={...s,...oe,energy:le,inventory:re};qt({data:J})}catch(re){console.warn("Failed to save user after purchase:",re)}r($),window.dispatchEvent(new Event("storage"))}else alert("Purchase failed.")},G=$=>{const he=d.trim().toLowerCase();let oe=$.filter(re=>!he||re.name.toLowerCase().includes(he)||(re.description||"").toLowerCase().includes(he));return f==="price-asc"&&(oe=oe.sort((re,le)=>re.price-le.price)),f==="price-desc"&&(oe=oe.sort((re,le)=>le.price-re.price)),oe},we=($=>(Array.isArray(s?.inventory)?s.inventory:[]).reduce((oe,re)=>{if(!re?.id||!String(re.id).startsWith($))return oe;const le=Number(re.quantity??re.count??1);return oe+(Number.isFinite(le)?le:1)},0))("streak-saver");return a.jsxs("div",{className:"shop-page fade-in-bounce",children:[a.jsx(Zo,{}),a.jsxs("div",{className:"shop-header-row",children:[a.jsxs("header",{className:"shop-header",children:[a.jsx(Et,{size:32,className:"shop-logo"}),a.jsx("h1",{className:"shop-title gradient-text",children:"FitBuddyAI Shop"}),a.jsx("div",{className:"shop-energy",children:a.jsxs("div",{className:`energy-pill ${k?"pulse":""}`,"aria-live":"polite",children:[a.jsxs("span",{className:"energy-value",children:[" ",s.energy]}),a.jsx("div",{className:"energy-meter","aria-hidden":!0,children:a.jsx("div",{className:`fill ${M}`})})]})})]}),a.jsxs("aside",{className:"shop-inventory",children:[a.jsxs("div",{className:"inventory-header",children:[a.jsx(tv,{size:18}),a.jsx("span",{children:"Inventory"})]}),a.jsxs("div",{className:"inventory-row",children:[a.jsx("span",{className:"inventory-label",children:"Streak Savers"}),a.jsx("span",{className:"inventory-value",children:we})]})]})]}),a.jsxs("div",{className:"shop-topbar",children:[a.jsxs("div",{className:"shop-tabs",ref:T,role:"tablist","aria-label":"Shop categories",children:[a.jsx("div",{className:"tab-indicator",ref:_,"aria-hidden":"true"}),a.jsx("button",{"data-tab":"avatars",role:"tab","aria-pressed":n==="avatars",className:n==="avatars"?"active":"",onClick:()=>o("avatars"),children:"Avatars"}),a.jsx("button",{"data-tab":"powerups",role:"tab","aria-pressed":n==="powerups",className:n==="powerups"?"active":"",onClick:()=>o("powerups"),children:"Powerups"})]}),a.jsxs("div",{className:"shop-controls",children:[a.jsxs("div",{className:"search-wrap",role:"search",children:[a.jsx(xp,{size:18,className:"icon-muted"}),a.jsx("input",{"aria-label":"Search shop items",placeholder:"Search items",value:d,onChange:$=>p($.target.value)})]}),a.jsxs("div",{className:"sort-wrap",children:[a.jsx(Yy,{size:16,className:"icon-muted"}),a.jsxs("select",{"aria-label":"Sort items",value:f,onChange:$=>g($.target.value),children:[a.jsx("option",{value:"popular",children:"Recommended"}),a.jsx("option",{value:"price-asc",children:"Price: Low to High"}),a.jsx("option",{value:"price-desc",children:"Price: High to Low"})]})]})]})]}),a.jsxs("div",{className:"shop-featured",children:[a.jsxs("div",{className:"featured-left",children:[a.jsx(Et,{size:28}),a.jsxs("div",{children:[a.jsx("div",{className:"featured-title",children:"Limited-time: Double Energy Sundays"}),a.jsx("div",{className:"featured-desc",children:"Buy selected powerups and receive double energy back for your first workout."})]})]}),a.jsx("button",{className:"featured-cta",children:"Learn More"})]}),a.jsxs("div",{className:"shop-items-grid",children:[n==="powerups"&&a.jsxs("div",{className:"shop-card streak-saver-card shop-card-span",children:[a.jsx("div",{className:"shop-card-top",children:a.jsx("div",{className:"shop-powerup-icon streak-saver-icon",children:a.jsx(fi,{size:36,color:"#fff"})})}),a.jsxs("div",{className:"shop-card-body",children:[a.jsx("h2",{className:"shop-item-title",children:"Streak Savers"}),a.jsx("p",{className:"shop-item-desc",children:"Choose a pack to protect your streak on a missed day."}),a.jsx("div",{className:"streak-saver-options",children:sb.map($=>{const he={id:$.id,name:$.name,price:$.price,type:"powerup",description:`${$.quantity}x streak saver`,quantity:$.quantity,icon:a.jsx(fi,{size:24,color:"#fb923c"})},oe=l===$.id,re=s.energy<$.price||oe;return a.jsxs("button",{className:"streak-saver-btn",disabled:re,onClick:()=>X(he),children:[a.jsxs("div",{className:"option-title",children:[$.quantity,"x Saver"]}),a.jsxs("div",{className:"option-price",children:[" ",$.price]})]},$.id)})})]})]}),n==="avatars"&&G(nb).map($=>{const he=Array.isArray(s.inventory)&&s.inventory.some(oe=>oe.id===$.id);return a.jsxs("div",{className:"shop-card",onClick:()=>x($),children:[a.jsx("div",{className:"shop-card-top",children:a.jsx("img",{src:$.image,alt:$.name,className:"shop-avatar-img"})}),a.jsxs("div",{className:"shop-card-body",children:[a.jsxs("h2",{className:"shop-item-title",children:[$.name," ",he&&a.jsx("span",{className:"owned-badge",children:"Owned"})]}),a.jsx("p",{className:"shop-item-desc",children:$.description}),a.jsxs("div",{className:"shop-card-footer",children:[a.jsxs("span",{className:"price-badge",children:[" ",$.price]}),a.jsx("button",{className:"shop-buy-btn",disabled:he||s.energy<$.price||l===$.id,onClick:oe=>{oe.stopPropagation(),X($)},children:he?"Owned":l===$.id?"Buying...":a.jsxs(a.Fragment,{children:[a.jsx(Ef,{size:16})," Buy"]})})]})]})]},$.id)}),n==="powerups"&&G(ab).map($=>a.jsxs("div",{className:`shop-card ${$.id==="streak-saver"?"shop-card-span":""}`,onClick:()=>x($),children:[a.jsx("div",{className:"shop-card-top",children:a.jsx("div",{className:"shop-powerup-icon",children:$.icon})}),a.jsxs("div",{className:"shop-card-body",children:[a.jsx("h2",{className:"shop-item-title",children:$.name}),a.jsx("p",{className:"shop-item-desc",children:$.description}),a.jsxs("div",{className:"shop-card-footer",children:[a.jsxs("span",{className:"price-badge",children:[" ",$.price]}),a.jsx("button",{className:"shop-buy-btn",disabled:s.energy<$.price||l===$.id,onClick:he=>{he.stopPropagation(),X($)},children:l===$.id?"Buying...":a.jsxs(a.Fragment,{children:[a.jsx(Ef,{size:16})," Buy"]})})]})]})]},$.id))]}),y&&a.jsx("div",{className:"shop-preview",onClick:()=>x(null),children:a.jsxs("div",{className:"preview-card",onClick:$=>$.stopPropagation(),children:[a.jsx("button",{className:"preview-close",onClick:()=>x(null),children:""}),a.jsxs("div",{className:"preview-body",children:[a.jsxs("div",{className:"preview-demo",children:[y.type==="avatar"&&y.image&&a.jsx("img",{src:y.image,alt:y.name,className:"preview-img"}),y.type==="powerup"&&a.jsxs("div",{className:"powerup-demo",children:[y.id==="spinpfp"&&a.jsx("div",{className:"preview-demo-box spin-anim",children:""}),y.id==="sparkle"&&a.jsxs("div",{className:"preview-demo-box dots-anim",children:[a.jsx("span",{}),a.jsx("span",{}),a.jsx("span",{})]}),y.id==="confetti"&&a.jsx("div",{className:"preview-demo-box confetti-anim",children:""}),y.id==="glow"&&a.jsx("div",{className:"preview-demo-box glow-anim",children:""}),y.id==="trail"&&a.jsx("div",{className:"preview-demo-box trail-anim",children:""}),y.id==="animated-frames"&&a.jsx("div",{className:"preview-demo-box frames-anim",children:""}),y.id==="voice-chime"&&a.jsx("div",{className:"preview-demo-box chime-anim",children:""}),y.id==="vfx"&&a.jsx("div",{className:"preview-demo-box vfx-anim",children:""}),y.id==="status-glow"&&a.jsx("div",{className:"preview-demo-box statusglow-anim",children:""}),!["spinpfp","sparkle","confetti","glow","trail","animated-frames","voice-chime","vfx","status-glow"].includes(y.id)&&a.jsx("div",{className:"preview-demo-box",children:"Preview"})]})]}),a.jsx("h3",{children:y.name}),a.jsx("p",{children:y.description}),a.jsxs("div",{className:"preview-actions",children:[a.jsxs("span",{className:"price-badge",children:[" ",y.price]}),a.jsxs("div",{className:"preview-actions-row",children:[a.jsx("button",{className:"shop-buy-btn",onClick:()=>{X(y),x(null)},children:"Buy"}),a.jsx("button",{className:"shop-buy-btn",onClick:()=>{window.dispatchEvent(new CustomEvent("shop-try-on",{detail:{preview:y}}))},children:"Try On"})]})]})]})]})})]})},au="Hi! I am Buddy  your AI Fitness assistant. I can answer questions about your workouts, goals, and progress.",ob=500,op=12,lb=["","Examples (MUST follow the JSON format exactly, but feel free to chnage the data and values):","","1) Simple numeric set (set energy to 10)","Human reply:","I've increased your energy to help with today's workout.","","JSON block:","```json","{",'  "__action": true,','  "updates": [','    { "op": "set", "path": "energy", "value": 10 }',"  ],",'  "summary": "Set energy to 10"',"}","```","","2) Change username","Human reply:","I can update your display name now.","","JSON block:","```json","{",'  "__action": true,','  "updates": [','    { "op": "set", "path": "username", "value": "fit_william" }',"  ],",'  "summary": "Change username to fit_william"',"}","```","","3) Add an item to inventory (push)","Human reply:","I'll add the SuperBand to your inventory for resistance training.","","JSON block:","```json","{",'  "__action": true,','  "updates": [',"    {",'      "op": "push",','      "path": "inventory",','      "value": {','        "id": "superband-01",','        "name": "SuperBand",','        "type": "equipment",','        "acquiredAt": "2025-09-05"',"      }","    }","  ],",'  "summary": "Add SuperBand to inventory"',"}","```","","4) Replace the full workout plan (ONLY if user explicitly requests a full replacement)","Human reply:","You asked to replace your entire workout plan. I will prepare a complete plan object  please confirm before applying.","","JSON block (skeleton example):","```json","{",'  "__action": true,','  "updates": [',"    {",'      "op": "set",','      "path": "workoutPlan",','      "value": { "id": "<id>", "name": "<name>", "startDate": "<YYYY-MM-DD>", "endDate": "<YYYY-MM-DD>", "dailyWorkouts": [ /* day objects */ ] }',"    }","  ],",'  "summary": "Replace entire workoutPlan (user-requested full replacement)"',"}","```","","Instruction: DO NOT create or emit a full workoutPlan unless the user explicitly asks for a full replacement. Prefer patch-style single-day or small updates. If the user asks for a full plan, emit a compact skeleton like above and ask for confirmation before applying.","","5) Multiple updates in one action:","Human reply:","I'll apply the three updates you requested: raise energy, add equipment, and update your display name.","","JSON block:","```json","{",'  "__action": true,','  "updates": [','    { "op": "set", "path": "energy", "value": 8 },',"    {",'      "op": "push",','      "path": "inventory",','      "value": { "id": "resmat-02", "name": "Travel Mat", "type": "equipment", "acquiredAt": "2025-09-05" }',"    },",'    { "op": "set", "path": "username", "value": "will_fit" }',"  ],",'  "summary": "Set energy to 8, add Travel Mat to inventory, change username to will_fit"',"}","```","","6) When no changes are intended:","Human reply only (no JSON block):","No changes are needed  here's a suggestion: try adding a 10-minute mobility warmup before your workouts this week.","","(Must NOT include a JSON block in this case.)","","Short checklist to follow exactly:","- Always emit human reply first.",'- If proposing changes emit exactly one fenced JSON block with the object keys: "__action", "updates", "summary".','- Use "set" to replace values and "push" to append to arrays.','- For "workoutPlan" send the full new object as the value for a "set".',"- No additional text inside or around the fenced JSON block.","","NEW EXAMPLES (Modify single days)","","7) Modify a single day's workouts (preferred when only one day needs adjustment)","Human reply:","I'll update day 3's workouts to an active recovery set  keeping the rest of your plan intact.","","JSON block:","```json","{",'  "__action": true,','  "updates": [','    { "op": "set", "path": "workoutPlan/dailyWorkouts/2/workouts", "value": [ { "name": "Foam Rolling", "description": "Release muscle tension.", "difficulty": "beginner", "duration": "15 minutes", "reps": "1x15", "muscleGroups": ["full body"], "equipment": ["Foam roller"] } ] }',"  ],",'  "summary": "Set Day 3 to active recovery workouts"',"}","```","","8) Modify a single day's metadata (type or totalTime)","Human reply:","I'll change day 3's type to 'activeRecovery' and adjust totalTime to '30 minutes'.","","JSON block:","```json","{",'  "__action": true,','  "updates": [','    { "op": "set", "path": "workoutPlan/dailyWorkouts/2/type", "value": "activeRecovery" },','    { "op": "set", "path": "workoutPlan/dailyWorkouts/2/totalTime", "value": "30 minutes" }',"  ],",'  "summary": "Update Day 3 type and totalTime"',"}","```","","9) Recommended example day (use as template for modifications)","Human reply:","Here's a recommended example day  when updating a day, keep the same object shape:","","Example day JSON:","```json","{",'    "date": "2025-09-10",','    "type": "Full Body",','    "completed": false,','    "totalTime": "30 minutes",','    "workouts": [',"        {",'            "name": "Lunges",','            "description": "",','            "difficulty": "beginner",','            "duration": "10 minutes",','            "reps": "3x10 each leg",','            "muscleGroups": ["quads","glutes","hamstrings"],','            "equipment": []',"        },","        {",'            "name": "Plank",','            "description": "",','            "difficulty": "beginner",','            "duration": "10 minutes",','            "reps": "3x30 seconds",','            "muscleGroups": ["core"],','            "equipment": []',"        },","        {",'            "name": "Overhead Press (Dumbbell)",','            "description": "",','            "difficulty": "beginner",','            "duration": "10 minutes",','            "reps": "3x10",','            "muscleGroups": ["shoulders"],','            "equipment": ["dumbbell"]',"        }","    ],",'    "alternativeWorkouts": []',"}","```","","Instruction: When modifying days, prefer the patch-style single-day updates above rather than replacing the whole `workoutPlan` unless the user explicitly asks for a full replacement."].join(`
`),cb=({userData:s})=>{const[r,n]=S.useState([{role:"assistant",text:au}]),[o,l]=S.useState(""),[c,d]=S.useState(!1),p=S.useRef(null),f=S.useRef(!1);S.useEffect(()=>{p.current&&(p.current.scrollTop=p.current.scrollHeight)},[r,c]),S.useEffect(()=>{(()=>{try{const k=s?.id||"anon",D=sessionStorage.getItem(`fitbuddyai_chat_${k}`);if(!D)return;const O=JSON.parse(D);Array.isArray(O)&&O.length&&n(O)}catch{}})(),(async()=>{try{f.current=!0;const k=s?.id;if(!k)return;await(await et(()=>Promise.resolve().then(()=>la),void 0)).restoreUserDataFromServer(String(k));const O=sessionStorage.getItem(`fitbuddyai_chat_${k}`);if(f.current=!1,!O)return;const R=JSON.parse(O);Array.isArray(R)&&R.length&&n(R)}catch{f.current=!1}})()},[s?.id]),S.useEffect(()=>{const _=async()=>{try{f.current=!0;const k=s?.id;if(!k)return;await(await et(()=>Promise.resolve().then(()=>la),void 0)).restoreUserDataFromServer(String(k));const O=sessionStorage.getItem(`fitbuddyai_chat_${k}`);if(f.current=!1,!O)return;const R=JSON.parse(O);Array.isArray(R)&&R.length&&n(R)}catch{f.current=!1}};window.addEventListener("fitbuddyai-login",_);const E=async()=>{try{f.current=!0;const k=s?.id;if(!k)return;await(await et(()=>Promise.resolve().then(()=>la),void 0)).restoreUserDataFromServer(String(k));const O=localStorage.getItem(`fitbuddyai_chat_${k}`);if(f.current=!1,!O)return;const R=JSON.parse(O);Array.isArray(R)&&R.length&&n(R)}catch{}};return window.addEventListener("fitbuddyai-open-chat",E),()=>window.removeEventListener("fitbuddyai-login",_)},[s?.id]),S.useEffect(()=>{const _=E=>{try{if(!E.key)return;const D=`fitbuddyai_chat_${s?.id||"anon"}`;if(E.key===D){if(!E.newValue){n([{role:"assistant",text:au}]);return}try{const O=JSON.parse(E.newValue);Array.isArray(O)&&n(O)}catch{}}}catch{}};return window.addEventListener("storage",_),()=>window.removeEventListener("storage",_)},[s?.id]),S.useEffect(()=>{let _=null;try{_=setTimeout(()=>{try{if(f.current)return;const E=s?.id||"anon";if(r.length===1&&r[0].role==="assistant"&&r[0].text==="Hi! I am Buddy  your AI Fitness assistant. I can answer questions about your workouts, goals, and progress.")return;try{sessionStorage.setItem(`fitbuddyai_chat_${E}`,JSON.stringify(r))}catch{}}catch{}},400)}catch{}return()=>{_&&clearTimeout(_)}},[r,s?.id]),S.useEffect(()=>{const _=()=>{try{const E=s?.id||"anon";try{sessionStorage.removeItem(`fitbuddyai_chat_${E}`)}catch{}try{localStorage.removeItem(`fitbuddyai_chat_${E}`)}catch{}n([{role:"assistant",text:au}])}catch{}};return window.addEventListener("fitbuddyai-logout",_),()=>window.removeEventListener("fitbuddyai-logout",_)},[s?.id]),S.useEffect(()=>{let _;return(()=>{const k=s?.id;if((_===void 0||_==="anon")&&k&&k!=="anon")try{const D=sessionStorage.getItem("fitbuddyai_chat_anon");if(D)try{sessionStorage.setItem(`fitbuddyai_chat_${k}`,D)}catch{}try{sessionStorage.removeItem("fitbuddyai_chat_anon")}catch{}}catch{}_=k??"anon"})(),()=>{}},[s?.id]);const g=_=>{if(!_)return"No user data available.";try{const E={id:_.id,username:_.username,age:_.age,goals:_.goals||_.preferences||[],fitnessLevel:_.fitnessLevel||_.fitness_level||"unknown",energy:_.energy??null,streak:_.streak??null};return JSON.stringify(E)}catch{return"User data present but could not be summarized."}},y=_=>{if(!_)return _;let E=String(_);try{for(E=E.replace(/```json[\s\S]*?```/gi,""),E=E.replace(/```[\s\S]*?```/g,"");E.includes('"__action"');){const D=E.indexOf('"__action"');if(D===-1)break;const O=E.lastIndexOf("{",D);if(O===-1)break;let R=0,M=-1;for(let X=O;X<E.length;X++){const G=E[X];if(G==="{")R++;else if(G==="}"&&(R--,R===0)){M=X;break}}if(M!==-1)E=(E.slice(0,O)+E.slice(M+1)).trim();else break}return E=E.replace(/\{[^\}]*__action[^\}]*\}/g,""),E=E.replace(/\n{3,}/g,`

`),E.trim()}catch{return _}},x=async(_,E)=>{try{const k=(_.updates||[]).map(H=>{try{if(H.path==="workoutPlan"&&typeof H.value=="string")try{H.value=JSON.parse(H.value)}catch{}}catch{}return H}),D={..._,updates:k},{getAuthToken:O,loadUserData:R}=await et(async()=>{const{getAuthToken:H,loadUserData:V}=await Promise.resolve().then(()=>ir);return{getAuthToken:H,loadUserData:V}},void 0),M=R()||null,X=M?.id||M?.data?.id||s?.id;let G=O()||M?.token||M?.data?.token||s?.token||M?.jwt||M?.data?.jwt||M?.access_token||M?.data?.access_token;if(!X||X==="anon"){try{sessionStorage.setItem("fitbuddyai_chat_anon",JSON.stringify(r))}catch{}const H=encodeURIComponent(window.location.pathname||"/chat");window.location.href=`/signin?returnTo=${H}`;return}const de={"Content-Type":"application/json"};G&&(de.Authorization=`Bearer ${G}`);const we=await fetch("/api/user/apply-action",{method:"POST",headers:de,body:JSON.stringify({id:X,action:D})}),$=await we.json();if(!we.ok)throw $;const{user:he}=$,{saveUserData:oe,saveWorkoutPlan:re,appendChatMessage:le}=await et(async()=>{const{saveUserData:H,saveWorkoutPlan:V,appendChatMessage:pe}=await Promise.resolve().then(()=>ir);return{saveUserData:H,saveWorkoutPlan:V,appendChatMessage:pe}},void 0);try{he&&he.workoutPlan&&re(he.workoutPlan)}catch{}oe(he,{skipBackup:!1}),window.dispatchEvent(new Event("fitbuddyai-login"));const J=E||$.humanReply||$.applied||"Buddy applied the changes.";n(H=>[...H,{role:"assistant",text:J}]);try{const H=s?.id||he?.id;le({role:"assistant",text:J,ts:Date.now()},{userId:H})}catch{}const xe=$.applied||_.summary||"Applied changes";let ge=xe;try{const H=String(xe).match(/^\s*Set\s+(\w+)\s+to\s+(.+)$/i);if(H){const V=H[1],pe=H[2];ge=`${V.charAt(0).toUpperCase()+V.slice(1)} set to ${pe}`}else ge=typeof xe=="string"?xe:JSON.stringify(xe)}catch{}n(H=>[...H,{role:"action",text:ge}]);try{const H=s?.id||he?.id;le({role:"assistant",text:ge,ts:Date.now()},{userId:H})}catch{}}catch(k){console.error("Failed to apply action on server:",k),n(D=>[...D,{role:"assistant",text:"Failed to apply changes on the server."}])}},b=async()=>{const _=o.trim();if(!_)return;const E={role:"user",text:_};n(G=>[...G,E]),l(""),d(!0);try{const{appendChatMessage:G}=await et(async()=>{const{appendChatMessage:we}=await Promise.resolve().then(()=>ir);return{appendChatMessage:we}},void 0),de=s?.id;G({role:"user",text:_,ts:Date.now()},{userId:de})}catch{}const k=r.concat(E),O=k.slice(Math.max(k.length-op,0)).map(G=>`${G.role==="user"?"User":"Assistant"}: ${G.text}`).join(`
`),R=s?.workoutPlan?(()=>{try{return`
User workoutPlan: ${JSON.stringify(s.workoutPlan).slice(0,ob)}`}catch{return""}})():"",X=`You are FitBuddyAI's AI assistant named Buddy. Use the following user profile to personalize answers: ${g(s)}

Conversation (most recent ${op} messages):
${O}

Respond fully and directly to the user's last message. Keep answers actionable and concise.`+R+'\n\nWhen you propose changes to the user\'s profile or workout plan, produce both: (1) a human-readable reply, and (2) a JSON action block fenced as ```json containing {"__action":true, "updates":[...], "summary":"..."}. Only include the JSON block when you intend the site to apply changes. Close the JSON block with ```.'+lb;try{const G=localStorage.getItem("fitbuddyai_questionnaire_progress"),de=sessionStorage.getItem("fitbuddyai_user_data"),we=localStorage.getItem("fitbuddyai_workout_plan");let $=null,he=null,oe=null;try{$=G?JSON.parse(G):null}catch{$=G}try{he=de?JSON.parse(de):null}catch{he=de}try{oe=we?JSON.parse(we):null}catch{oe=we}const re=await ov({prompt:X,localStorageContext:{questionnaire:$,userData:he,workoutPlan:oe}});let le=re.text||"",J=null;try{let ge=null;const H=le.match(/```json([\s\S]*?)```/i);if(H&&H[1])ge=H[1].trim();else{const V=le.match(/```([\s\S]*?)```/i);V&&V[1]&&(ge=V[1].trim())}if(!ge){const V=Array.from(le.match(/\{[\s\S]*?\}/g)||[]);if(V.length)ge=V[V.length-1];else if(re.raw){const pe=Array.from(String(re.raw).match(/\{[\s\S]*?\}/g)||[]);pe.length&&(ge=pe[pe.length-1])}}if(ge){const V=ge.replace(/^```json\s*/i,"").replace(/\s*```$/,"");J=JSON.parse(V),le=le.replace(ge,"").replace(/```json[\s\S]*?```/i,"").trim()}else try{const pe=le.indexOf('"__action"');if(pe!==-1){const C=le.lastIndexOf("{",pe);if(C!==-1){let w=0,L=-1;for(let Y=C;Y<le.length;Y++){const ne=le[Y];if(ne==="{")w++;else if(ne==="}"&&(w--,w===0)){L=Y;break}}if(L!==-1){const Y=le.slice(C,L+1);try{J=JSON.parse(Y),le=(le.slice(0,C)+le.slice(L+1)).trim()}catch{}}}}}catch{}}catch{J=null}const xe=y(le);if(J&&J.__action&&Array.isArray(J.updates))await x(J,xe);else{n(ge=>[...ge,{role:"assistant",text:xe}]);try{const{appendChatMessage:ge}=await et(async()=>{const{appendChatMessage:V}=await Promise.resolve().then(()=>ir);return{appendChatMessage:V}},void 0),H=s?.id;ge({role:"assistant",text:xe,ts:Date.now()},{userId:H})}catch{}}}catch(G){console.error("Gemini chat error",G),n(de=>[...de,{role:"assistant",text:"Buddy is currently unavailable. Please try again later."}])}finally{d(!1)}},T=_=>{_.key==="Enter"&&!_.shiftKey&&(_.preventDefault(),b())};return a.jsxs("div",{className:"gemini-page-root",children:[a.jsx(Zo,{}),a.jsx("div",{className:"gemini-page",children:a.jsxs("div",{className:"gemini-container",children:[a.jsxs("header",{className:"gemini-header",children:[a.jsx("h1",{children:"Chat with Buddy"}),a.jsx("p",{className:"gemini-sub",children:"Ask Buddy about your workouts, plan, or goals  Buddy knows your profile."})]}),a.jsxs("div",{className:"gemini-chat",ref:p,role:"log","aria-live":"polite",children:[r.map((_,E)=>{const k=_.role==="assistant",D=_.role==="user",O=(k||D)&&typeof _.text=="string"&&_.text.indexOf(`
`)===-1,R=["msg",k?"msg-assistant":_.role==="user"?"msg-user":"msg-action"];return O&&R.push("single-line"),a.jsxs("div",{className:R.join(" "),children:[k&&a.jsx("div",{className:"logo","aria-hidden":"true",children:a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"#ffffff",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-dumbbell",children:[a.jsx("path",{d:"m6.5 6.5 11 11"}),a.jsx("path",{d:"m21 21-1-1"}),a.jsx("path",{d:"m3 3 1 1"}),a.jsx("path",{d:"m18 22 4-4"}),a.jsx("path",{d:"m2 6 4-4"}),a.jsx("path",{d:"m3 10 7-7"}),a.jsx("path",{d:"m14 21 7-7"})]})}),_.role==="user"&&a.jsx("div",{className:"logo user-logo","aria-hidden":!0,children:s?.avatar||s?.avatarUrl?a.jsx("img",{src:s?.avatar||s?.avatarUrl,alt:s?.username||"User"}):a.jsx("span",{className:"initials",children:(s?.username||"U").toString().trim().substring(0,2).toUpperCase()})}),a.jsx("div",{className:"msg-text",children:_.text})]},E)}),c&&a.jsxs("div",{className:"msg msg-assistant loading",children:[a.jsx("div",{className:"logo","aria-hidden":"true",children:a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"#ffffff",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-dumbbell",children:[a.jsx("path",{d:"m6.5 6.5 11 11"}),a.jsx("path",{d:"m21 21-1-1"}),a.jsx("path",{d:"m3 3 1 1"}),a.jsx("path",{d:"m18 22 4-4"}),a.jsx("path",{d:"m2 6 4-4"}),a.jsx("path",{d:"m3 10 7-7"}),a.jsx("path",{d:"m14 21 7-7"})]})}),a.jsx("div",{className:"msg-text",children:"Buddy is typing..."})]})]}),a.jsxs("div",{className:"gemini-input",children:[a.jsx("input",{value:o,onChange:_=>l(_.target.value),onKeyDown:T,placeholder:"Ask Buddy about your plan or goals...","aria-label":"Ask Gemini"}),a.jsx("button",{className:"send-btn",onClick:b,disabled:c||!o.trim(),"aria-label":"Send message",children:"Send"})]})]})})]})},ub=()=>{const[s,r]=S.useState(null);S.useEffect(()=>{try{const J=mr(),xe=J?.email||J?.data?.email||J?.data?.email;if(["localhost","127.0.0.1"].includes(window.location.hostname)&&xe==="admin@local"){r(!0);return}const H=J?.role||J?.data?.role;if(H&&String(H).toLowerCase()==="admin"){r(!0);return}(async()=>{try{if(dt&&typeof dt.auth?.getSession=="function"){const pe=(await dt.auth.getSession())?.data?.session?.access_token??null;if(pe)try{const C=pe.split(".");if(C.length>=2){const w=JSON.parse(atob(C[1].replace(/-/g,"+").replace(/_/g,"/"))),L=w?.roles||w?.role||[];if(Array.isArray(L)&&L.includes("admin")){r(!0);return}if(String(L).toLowerCase()==="admin"){r(!0);return}}}catch{}}}catch{}try{const V=qo();if(V)try{const pe=V.split(".");if(pe.length>=2){const C=JSON.parse(atob(pe[1].replace(/-/g,"+").replace(/_/g,"/"))),w=C?.roles||C?.role||[];if(Array.isArray(w)&&w.includes("admin")){r(!0);return}if(String(w).toLowerCase()==="admin"){r(!0);return}}}catch{}}catch{}r(!1)})()}catch{r(!1)}},[]);const[n,o]=S.useState([]),[l,c]=S.useState([]),[d,p]=S.useState(!1),[f,g]=S.useState(null),[y,x]=S.useState(!1),[b,T]=S.useState(!1),[_,E]=S.useState([]),[k,D]=S.useState(null),[O,R]=S.useState([]),[M,X]=S.useState(""),G=async(J,xe)=>{const ge=xe?{...xe}:{},H=ge.headers?{...ge.headers}:{};try{if(dt&&typeof dt.auth?.getSession=="function"){const pe=(await dt.auth.getSession())?.data?.session?.access_token??null;pe&&(H.Authorization=`Bearer ${pe}`)}}catch{}if(!H.Authorization)try{const V=qo();V&&(H.Authorization=`Bearer ${V}`)}catch{}return ge.headers=H,fetch(J,ge)};S.useEffect(()=>{y&&s===!0&&(async()=>{p(!0);const{data:J,error:xe}=await dt.from("workout_plans").select("*").eq("deleted",!0);xe||E(J||[]),p(!1)})()},[y,s]),S.useEffect(()=>{b&&s===!0&&(async()=>{p(!0);const{data:J,error:xe}=await dt.from("banned_usernames").select("username");xe||R((J||[]).map(ge=>ge.username)),p(!1)})()},[b,s]),S.useEffect(()=>{if(s!==!0)return;(async()=>{p(!0),g(null);try{const xe=await G("/api/admin/users",{method:"GET"});if(!xe.ok){const pe=await xe.text();throw new Error(`Failed to load users: ${xe.status} ${pe}`)}const ge=await xe.json();c(ge?.users||[]);const{data:H,error:V}=await dt.from("audit_logs").select("*").order("timestamp",{ascending:!1});if(V)if(String(V.message).toLowerCase().includes("relation")||String(V.message).toLowerCase().includes("could not find"))g("Audit log table not found. Run the DB setup SQL (sql/setup_db.sql) to create required tables.");else throw V;o(H||[])}catch(xe){g(xe.message||"Error")}finally{p(!1)}})()},[s]);const de=async J=>{D(J),(await G("/api/admin/users?action=restore_plan",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({planId:J})})).ok?E(ge=>ge.filter(H=>H.id!==J)):g("Failed to restore"),D(null)},we=async()=>{if(!M.trim())return;p(!0),(await G("/api/admin/users?action=ban_username",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:M.trim()})})).ok?R(xe=>[...xe,M.trim()]):g("Failed to ban username"),X(""),p(!1)},$=async J=>{p(!0),(await G("/api/admin/users?action=unban_username",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:J})})).ok?R(ge=>ge.filter(H=>H!==J)):g("Failed to unban username"),p(!1)},he=async J=>{p(!0),(await G("/api/admin/users?action=ban",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:J})})).ok?c(ge=>ge.map(H=>H.id===J?{...H,banned:!0}:H)):g("Failed to ban user"),p(!1)},oe=async J=>{p(!0),(await G("/api/admin/users?action=unban",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:J})})).ok?c(ge=>ge.map(H=>H.id===J?{...H,banned:!1}:H)):g("Failed to unban user"),p(!1)},re=async J=>{p(!0),(await G("/api/admin/users?action=delete",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:J})})).ok?c(ge=>ge.filter(H=>H.id!==J)):g("Failed to delete user"),p(!1)},le=()=>{const J=new Blob([n.map(H=>JSON.stringify(H)).join(`
`)],{type:"application/json"}),xe=URL.createObjectURL(J),ge=document.createElement("a");ge.href=xe,ge.download="ai_action_audit.log",ge.click(),URL.revokeObjectURL(xe)};return s===!1?a.jsx($u,{}):a.jsxs("div",{className:"admin-audit-root",children:[a.jsx("div",{className:"admin-hero",children:a.jsxs("div",{children:[a.jsx("div",{className:"title",children:"Admin Console"}),a.jsx("div",{className:"subtitle",children:"Manage users, audit logs and site-wide policies."})]})}),a.jsxs("div",{className:"admin-grid",children:[a.jsxs("div",{className:"admin-card",children:[a.jsx("div",{className:"admin-section-title",children:"Admin Powers"}),a.jsxs("div",{className:"admin-powers",children:[a.jsx("button",{className:"admin-power-btn",onClick:le,disabled:n.length===0,children:"Download Audit Log"}),a.jsx("button",{className:"admin-power-btn",onClick:()=>x(!0),children:"Restore Workout Plans"}),a.jsx("button",{className:"admin-power-btn",onClick:()=>T(!0),children:"Manage Banned Usernames"}),a.jsx("div",{className:"admin-power-row",children:a.jsx("button",{className:"admin-power-btn secondary",onClick:()=>window.location.href="/",children:"Open App"})}),a.jsx("div",{className:"admin-power-note",children:"Tip: actions are proxied through the server to protect secrets and follow RLS."})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"admin-card mb-20",children:[a.jsx("div",{className:"admin-section-title",children:"Users"}),l.length===0&&a.jsx("div",{className:"muted",children:"No users found."}),a.jsx("div",{className:"users-list",children:l.map(J=>a.jsxs("div",{className:`user-row${J.banned?" banned":""}`.trim(),children:[a.jsxs("div",{className:"user-meta",children:[a.jsx("div",{className:"user-name",children:J.username||J.email}),a.jsx("div",{className:"user-email",children:J.email}),a.jsx("div",{className:"meta-id",children:J.id})]}),a.jsxs("div",{className:"user-actions",children:[J.banned?a.jsx("button",{className:"small-btn ghost",onClick:()=>oe(J.id),disabled:d,children:"Unban"}):a.jsx("button",{className:"small-btn ghost",onClick:()=>he(J.id),disabled:d,children:"Ban"}),a.jsx("button",{className:"small-btn negative",onClick:()=>re(J.id),disabled:d,children:"Delete"})]})]},J.id))})]}),a.jsxs("div",{className:"admin-card",children:[a.jsx("div",{className:"admin-section-title",children:"AI Action Audit Log"}),d&&a.jsx("div",{className:"muted",children:"Loading..."}),f&&a.jsx("div",{className:"error",children:f}),a.jsxs("div",{className:"audit-list",children:[n.map((J,xe)=>a.jsxs("div",{className:"audit-row",children:[a.jsx("div",{className:"audit-ts",children:J.timestamp}),J.event==="rickroll"?a.jsxs("div",{className:"audit-rickroll",children:[a.jsx("div",{children:"Event: rickroll"}),a.jsxs("div",{children:["IP: ",J.ip||""]}),a.jsxs("div",{children:["Verified: ",String(J.verified)]}),a.jsxs("div",{children:["UserAgent: ",a.jsx("pre",{className:"audit-json-small",children:String(J.userAgent||"")})]})]}):a.jsx("pre",{className:"audit-json",children:JSON.stringify(J.action,null,2)})]},xe)),n.length===0&&!d&&a.jsx("div",{className:"muted",children:"No audit entries found."})]})]})]})]}),y&&a.jsx("div",{className:"admin-modal-overlay",children:a.jsxs("div",{className:"admin-modal",children:[a.jsx("h3",{children:"Restore Workout Plans"}),d&&a.jsx("div",{children:"Loading..."}),a.jsxs("div",{children:[_.map(J=>a.jsxs("div",{className:"admin-modal-list-item",children:[a.jsxs("div",{children:[a.jsx("b",{children:J.name}),a.jsx("div",{className:"meta-id",children:J.id})]}),a.jsx("div",{children:a.jsx("button",{className:"small-btn",onClick:()=>de(J.id),disabled:k===J.id,children:k===J.id?"Restoring...":"Restore"})})]},J.id)),_.length===0&&!d&&a.jsx("div",{children:"No deleted plans found."})]}),a.jsx("div",{className:"modal-footer",children:a.jsx("button",{className:"small-btn ghost",onClick:()=>x(!1),children:"Close"})})]})}),b&&a.jsx("div",{className:"admin-modal-overlay",children:a.jsxs("div",{className:"admin-modal",children:[a.jsx("h3",{children:"Manage Banned Usernames"}),d&&a.jsx("div",{children:"Loading..."}),a.jsxs("div",{children:[O.map(J=>a.jsxs("div",{className:"admin-modal-list-item",children:[a.jsx("div",{children:J}),a.jsx("div",{children:a.jsx("button",{className:"small-btn ghost",onClick:()=>$(J),disabled:d,children:"Unban"})})]},J)),O.length===0&&!d&&a.jsx("div",{children:"No banned usernames."})]}),a.jsxs("div",{className:"admin-modal-input-row",children:[a.jsx("input",{type:"text",value:M,onChange:J=>X(J.target.value),placeholder:"Ban new username...",className:"admin-modal-input"}),a.jsx("button",{className:"small-btn warn",onClick:we,disabled:d||!M.trim(),children:"Ban"})]}),a.jsx("div",{className:"modal-footer",children:a.jsx("button",{className:"small-btn ghost",onClick:()=>T(!1),children:"Close"})})]})})]})};function db(){S.useEffect(()=>{const s=Qo();try{if(localStorage.getItem("fitbuddyai_no_auto_restore")||sessionStorage.getItem("fitbuddyai_no_auto_restore"))return}catch{}try{const n=br(),o=gs();if(n||o&&o.dailyWorkouts&&o.dailyWorkouts.length>0)return}catch{}s?.id&&ms(s.id);const r=()=>{const n=Qo();n?.id&&gi(n.id)};return window.addEventListener("beforeunload",r),()=>{r(),window.removeEventListener("beforeunload",r)}},[])}const lp="https://www.youtube.com/watch?v=dQw4w9WgXcQ",hb=()=>{const[s,r]=S.useState("pending");return S.useEffect(()=>{Math.random()<.5?r("rick"):r("notfound")},[]),S.useEffect(()=>{if(s==="rick"){const o=setTimeout(async()=>{try{let l={"Content-Type":"application/json"};try{const{getAuthToken:c}=await et(async()=>{const{getAuthToken:p}=await Promise.resolve().then(()=>ir);return{getAuthToken:p}},void 0),d=c();d&&(l.Authorization=`Bearer ${d}`)}catch{}await fetch("/api/rickroll",{method:"POST",headers:l,body:JSON.stringify({userId:null})})}catch{}finally{window.location.href=lp}},150);return()=>clearTimeout(o)}},[s]),s==="pending"?a.jsx("div",{className:"rickroll-loading",children:a.jsx("p",{children:"Deciding your fate..."})}):s==="notfound"?a.jsx($u,{}):a.jsxs("div",{className:"rickroll-redirect",children:[a.jsx("p",{children:"Redirecting you to something special..."}),a.jsx("a",{href:lp,target:"_blank",rel:"noopener noreferrer",children:"Open"})]})};function fb({userData:s}){const[r,n]=S.useState(!1);if(S.useEffect(()=>{if(s?.id)try{Lw(s.id)}catch{}(async()=>{try{if(fs(s?.id)){n(!1);return}const g=s?.id;if(!g){n(!0);return}const y=await et(()=>Promise.resolve().then(()=>Gn),void 0).then(k=>k.attachAuthHeaders({method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:g})})),x=await fetch("/api/userdata/load",y);if(!x.ok){n(!0);return}const b=await x.text();let T=null;try{T=b?JSON.parse(b):null}catch{T=null}const _=T?.stored??T?.payload??T??{},E=_&&_.accepted_terms&&_.accepted_privacy;n(!E)}catch{const g=fs(s?.id);n(!g)}})();const d=()=>{fs(s?.id)?n(!1):n(!0)},p=()=>{fs(s?.id)?n(!1):n(!0)};return window.addEventListener("fitbuddyai-tos-accepted",d),window.addEventListener("fitbuddyai-privacy-accepted",p),()=>{window.removeEventListener("fitbuddyai-tos-accepted",d),window.removeEventListener("fitbuddyai-privacy-accepted",p)}},[s?.id]),!r)return null;const o=rl(s?.id),l=nl(s?.id);return a.jsx("div",{className:"tos-banner compact",role:"region","aria-label":"Terms and Privacy banner",children:a.jsx("div",{className:"tos-inner inline",children:a.jsxs("div",{className:"tos-left",children:[a.jsx("div",{className:"tos-info","aria-hidden":"true",children:""}),a.jsxs("div",{className:"tos-text",children:["Please read and accept our ",a.jsx(Fr,{to:"/terms",className:o?"tos-link accepted":"tos-link",children:"Terms of Service"})," and ",a.jsx(Fr,{to:"/privacy",className:l?"tos-link accepted":"tos-link",children:"Privacy Policy"}),". This banner will remain until both are accepted."]})]})})})}function Kp(s={}){const r=s.count||30,n=s.gravity||.6,o=["#1ecb7b","#1e90cb","#ffb347","#ffd54a","#7bd389"],l=document.createElement("div");l.style.position="fixed",l.style.left="0",l.style.top="0",l.style.width="100%",l.style.height="0",l.style.pointerEvents="none",l.style.overflow="visible",l.style.zIndex="9999",document.body.appendChild(l);for(let c=0;c<r;c++){let d=function(){y+=n*.05,x+=g,b+=y,p.style.left=x+"px",p.style.top=b+"px";const _=(parseFloat(p.style.transform.replace("rotate(","").replace("deg)",""))||0)+T;p.style.transform="rotate("+_+"deg)",p.style.opacity=String(Math.max(0,1-b/(window.innerHeight*.9))),b<window.innerHeight+100?requestAnimationFrame(d):p.remove()};const p=document.createElement("div"),f=6+Math.random()*10;p.style.position="absolute",p.style.left=50+(Math.random()-.5)*60+"%",p.style.top="-10px",p.style.width=f+"px",p.style.height=f*.6+"px",p.style.background=o[Math.floor(Math.random()*o.length)],p.style.opacity="0.95",p.style.transform="rotate("+Math.random()*360+"deg)",p.style.borderRadius=Math.random()*3+"px",p.style.willChange="transform, top, opacity",l.appendChild(p);const g=(Math.random()-.5)*6;let y=2+Math.random()*4,x=window.innerWidth*.5+(Math.random()-.5)*window.innerWidth*.6,b=-20-Math.random()*50;const T=(Math.random()-.5)*10;requestAnimationFrame(d)}setTimeout(()=>l.remove(),5e3)}function pb(){const s=rl(void 0),[r,n]=S.useState(s),[o,l]=S.useState(s);S.useEffect(()=>{const d=()=>{l(!0),n(!0)};return window.addEventListener("fitbuddyai-tos-accepted",d),()=>window.removeEventListener("fitbuddyai-tos-accepted",d)},[]);const c=()=>{if(r){Cp(void 0),l(!0);try{Kp({count:40})}catch{}try{et(()=>Promise.resolve().then(()=>ir),void 0).then(d=>{try{const f=d.loadUserData()?.id;f&&et(()=>Promise.resolve().then(()=>Gn),void 0).then(g=>g.attachAuthHeaders({method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:f,accepted_terms:!0})})).then(g=>fetch("/api/userdata/save",g)).catch(()=>{})}catch{}}).catch(()=>{})}catch{}}};return a.jsxs("div",{className:"terms-page",children:[a.jsx("header",{className:"terms-hero",children:a.jsxs("div",{className:"terms-hero-inner",children:[a.jsx("div",{className:"hero-logo",children:a.jsx(Et,{size:36,color:"#fff"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"hero-title",children:"FitBuddyAI Terms of Service"}),a.jsx("p",{className:"hero-sub",children:"Short, clear summary about how to use the app safely and what we store."})]})]})}),a.jsxs("main",{className:"terms-container",children:[a.jsxs("article",{className:"terms-card",children:[a.jsx("h2",{children:"1. Use of the Service"}),a.jsx("p",{children:"FitBuddyAI provides workout suggestions and educational material to help you train safely. This is not medical advice. If you have a medical condition, please consult a healthcare professional before acting on any exercise recommendation."})]}),a.jsxs("article",{className:"terms-card",children:[a.jsx("h2",{children:"2. AI & Content"}),a.jsx("p",{children:"Some content or workout suggestions may be generated or assisted by AI. AI outputs are best-effort guidance and should be used in combination with your own judgment and professional advice."})]}),a.jsxs("article",{className:"terms-card",children:[a.jsx("h2",{children:"3. Data & Privacy"}),a.jsxs("p",{children:["We store workout plans and profile data locally for convenience. If you create an account, data may be backed up to our servers for sync across devices. See the ",a.jsx(Fr,{to:"/privacy",className:"tos-link",children:"Privacy Policy"})," for details."]})]}),a.jsxs("article",{className:"terms-card",children:[a.jsx("h2",{children:"4. Liability"}),a.jsx("p",{children:"By using FitBuddyAI you acknowledge that you are voluntarily participating in physical activity and accept responsibility for any risks. We are not liable for injuries caused while following the app."})]})]}),a.jsx("section",{className:"terms-full",children:a.jsxs("div",{className:"terms-full-inner",children:[a.jsx("h2",{children:"Full Terms of Service"}),a.jsx("p",{children:'The following terms ("Agreement") constitute a legally binding agreement between you ("User") and FitBuddyAI, LLC ("FitBuddyAI", "we", "us" or "our"), governing your access to and use of the FitBuddyAI website, mobile applications, services, software, APIs and associated content (collectively, the "Service"). By accessing, browsing, or using the Service you acknowledge that you have read, understood, and agree to be bound by this Agreement. If you do not agree to these terms, do not access or use the Service.'}),a.jsx("h3",{children:"1. Definitions"}),a.jsx("p",{children:'"Content" means any information, text, graphics, images, audio, video, code, algorithms, workout plans, recommendations, comments, and other materials provided by FitBuddyAI or Users. "User Content" means Content submitted or transmitted by Users. "Personal Data" means information that identifies or can be used to identify an individual, subject to the Privacy Policy.'}),a.jsx("h3",{children:"2. Scope of Service"}),a.jsx("p",{children:'FitBuddyAI provides fitness and wellness related guidance, educational materials, personalized workout plans, and software tools. The Service may include content generated or assisted by artificial intelligence. The Service is provided on an "as is" and "as available" basis. FitBuddyAI reserves the right to modify, suspend, or discontinue any aspect of the Service at any time without prior notice.'}),a.jsx("h3",{children:"3. User Eligibility and Conduct"}),a.jsx("p",{children:"Users represent and warrant that they are at least the minimum age required to use the Service under applicable law and that they have full authority to accept this Agreement. Users shall not misuse the Service or interfere with its operation. Prohibited conduct includes, but is not limited to: circumventing technical restrictions; attempting to access other Users' accounts; uploading malicious code; impersonating others; or using the Service for unlawful or harmful activities."}),a.jsx("h3",{children:"4. Medical Disclaimer and Assumption of Risk"}),a.jsx("p",{children:"The Service provides general fitness information and recommendations which are not a substitute for professional medical advice, diagnosis, or treatment. Users should consult a qualified healthcare professional before beginning any exercise program or if they have health concerns. By using the Service, Users acknowledge and assume all risks associated with participating in physical activity and agree that FitBuddyAI is not responsible for any injury, loss, or damage arising from use of the Service."}),a.jsx("h3",{children:"5. AI-Generated Content and Accuracy"}),a.jsx("p",{children:"Some Content may be generated or assisted by machine learning models, thirdparty APIs, or algorithmic systems. While FitBuddyAI strives for accuracy and utility, AI outputs may be incomplete, imprecise, or contextually inappropriate. FitBuddyAI disclaims any warranty regarding the suitability, reliability, or accuracy of AI-generated Content. Reliance on such Content is at the User's own risk."}),a.jsx("h3",{children:"6. Intellectual Property"}),a.jsx("p",{children:"FitBuddyAI and its licensors retain all right, title, and interest in and to the Service and Content provided by FitBuddyAI, including intellectual property rights. Users are granted a limited, non-exclusive, non-sublicensable, revocable license to access and use the Service for personal, non-commercial purposes in accordance with this Agreement. Users shall not reproduce, distribute, modify, create derivative works, reverse engineer, or otherwise exploit FitBuddyAI's intellectual property except as expressly authorized herein."}),a.jsx("h3",{children:"7. User Content and License to FitBuddyAI"}),a.jsx("p",{children:"By submitting User Content, Users grant FitBuddyAI a worldwide, royalty-free, sublicensable, transferable, perpetual, irrevocable license to use, host, store, reproduce, modify, create derivative works, communicate, publish, and distribute such User Content for the purposes of operating, improving, and promoting the Service. Users warrant that they have the rights to grant such license and that User Content does not violate third-party rights."}),a.jsx("h3",{children:"8. Payments and Subscriptions"}),a.jsx("p",{children:"Paid features of the Service are governed by separate subscription terms and payment agreements. Users agree to provide accurate billing information and authorize recurring charges as applicable. Refunds, cancellations, and dispute procedures are governed by the posted subscription terms and any applicable laws."}),a.jsx("h3",{children:"9. Third-Party Services and Links"}),a.jsx("p",{children:"The Service may contain links to third-party websites, services, or content. FitBuddyAI does not endorse and is not responsible for third-party offerings, practices, or privacy policies. Users access third-party resources at their own risk and should review the third-party terms and privacy policies."}),a.jsx("h3",{children:"10. Privacy and Data"}),a.jsx("p",{children:"Use of Personal Data is governed by FitBuddyAIs Privacy Policy. By using the Service, Users consent to FitBuddyAIs collection, processing, storage, and transfer of Personal Data in accordance with the Privacy Policy. FitBuddyAI will take commercially reasonable measures to secure User Data but cannot guarantee absolute security."}),a.jsx("h3",{children:"11. Warranties and Disclaimers"}),a.jsx("p",{children:'EXCEPT AS EXPRESSLY PROVIDED HEREIN, THE SERVICE IS PROVIDED "AS IS" AND "AS AVAILABLE" WITHOUT WARRANTIES OF ANY KIND. FITBUDDYAI DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, TITLE, AND NON-INFRINGEMENT. FITBUDDYAI DOES NOT WARRANT THAT THE SERVICE WILL BE UNINTERRUPTED, ERROR-FREE, OR SECURE.'}),a.jsx("h3",{children:"12. Limitation of Liability"}),a.jsx("p",{children:"TO THE MAXIMUM EXTENT PERMITTED BY LAW, IN NO EVENT SHALL FITBUDDYAI, ITS AFFILIATES, LICENSORS, OR SERVICE PROVIDERS BE LIABLE FOR INDIRECT, INCIDENTAL, SPECIAL, CONSEQUENTIAL, OR PUNITIVE DAMAGES, OR FOR LOSS OF PROFITS, REVENUE, DATA, OR USE, ARISING OUT OF OR IN CONNECTION WITH THE SERVICE, WHETHER IN CONTRACT, TORT (INCLUDING NEGLIGENCE), STRICT LIABILITY, OR OTHERWISE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGES. FITBUDDYAI'S AGGREGATE LIABILITY FOR DIRECT DAMAGES SHALL NOT EXCEED THE AMOUNTS PAID BY THE USER TO FITBUDDYAI IN THE TWELVE (12) MONTHS PRECEDING THE CLAIM, OR ONE HUNDRED DOLLARS (USD $100), WHICHEVER IS GREATER."}),a.jsx("h3",{children:"13. Indemnification"}),a.jsx("p",{children:"Users agree to indemnify, defend, and hold harmless FitBuddyAI and its officers, directors, employees, agents, and affiliates from and against any and all losses, liabilities, claims, demands, damages, costs, and expenses (including reasonable attorneys fees) arising out of or relating to: (a) User's breach of this Agreement; (b) Users violation of any law or third-party rights; or (c) User Content."}),a.jsx("h3",{children:"14. Termination"}),a.jsx("p",{children:"FitBuddyAI may suspend or terminate a User's access to the Service at any time, with or without cause, and without liability. Upon termination, license rights granted to the User will immediately cease. Sections concerning ownership, disclaimers, limitations of liability, indemnity, and dispute resolution will survive termination."}),a.jsx("h3",{children:"15. Governing Law; Dispute Resolution"}),a.jsx("p",{children:"This Agreement shall be governed by and construed in accordance with the laws of the state in which FitBuddyAI is incorporated, without regard to conflict of laws principles. Any dispute arising out of or related to this Agreement shall be resolved exclusively through final and binding arbitration, except where prohibited by law. The arbitrator's decision will be final and binding and may be entered as a judgment in any court of competent jurisdiction."}),a.jsx("h3",{children:"16. Changes to Terms"}),a.jsx("p",{children:"FitBuddyAI may update these Terms from time to time. We will provide notice of material changes, for example by email to registered accounts or prominent notice within the Service. Continued use of the Service after changes constitute acceptance of the revised Terms."}),a.jsx("h3",{children:"17. Miscellaneous"}),a.jsx("p",{children:"This Agreement, together with the Privacy Policy and any other legal notices published by FitBuddyAI, constitutes the entire agreement between the parties concerning the subject matter herein. If any provision is found unenforceable, the remaining provisions will remain in full force. Failure to enforce a right is not a waiver of that right."}),a.jsxs("p",{children:[a.jsx("em",{children:"Effective Date:"})," The effective date of these Terms is the date you first use the Service. For questions regarding these Terms, please contact our support team."]})]})}),a.jsxs("div",{className:"terms-cta-bottom",children:[a.jsx("div",{className:"terms-cta-inner",children:a.jsxs("label",{className:"terms-checkbox",children:[a.jsx("input",{type:"checkbox",checked:r,onChange:d=>n(d.target.checked)}),a.jsx("span",{children:"I have read and agree to the Terms of Service"})]})}),a.jsx("div",{className:"terms-cta-inner stack",children:a.jsx("button",{className:"btn btn-primary btn-lg"+(o?" accepted-btn":""),onClick:c,disabled:!r||o,"aria-disabled":!r||o,children:o?"Accepted":"Accept"})})]})]})}function mb(){const s=nl(void 0),[r,n]=S.useState(s),[o,l]=S.useState(s);S.useEffect(()=>{const d=()=>{l(!0),n(!0)};return window.addEventListener("fitbuddyai-privacy-accepted",d),()=>window.removeEventListener("fitbuddyai-privacy-accepted",d)},[]);const c=()=>{if(r){Tp(void 0),l(!0);try{Kp({count:36})}catch{}try{et(()=>Promise.resolve().then(()=>ir),void 0).then(d=>{try{const f=d.loadUserData()?.id;f&&et(()=>Promise.resolve().then(()=>Gn),void 0).then(g=>g.attachAuthHeaders({method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:f,accepted_privacy:!0})})).then(g=>fetch("/api/userdata/save",g)).catch(()=>{})}catch{}}).catch(()=>{})}catch{}}};return a.jsxs("div",{className:"terms-page",children:[a.jsx("header",{className:"terms-hero",children:a.jsxs("div",{className:"terms-hero-inner",children:[a.jsx("div",{className:"hero-logo",children:a.jsx(Et,{size:36,color:"#fff"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"hero-title",children:"FitBuddyAI Privacy Policy"}),a.jsx("p",{className:"hero-sub",children:"How we collect, use, and protect your data  short summary."})]})]})}),a.jsxs("main",{className:"terms-container",children:[a.jsxs("article",{className:"terms-card",children:[a.jsx("h2",{children:"Data We Collect"}),a.jsx("p",{children:"We collect workout preferences, profile details, and optionally account information when you sign up. We do not collect sensitive medical data unless you explicitly provide it."})]}),a.jsxs("article",{className:"terms-card",children:[a.jsx("h2",{children:"How We Use Data"}),a.jsx("p",{children:"Data is used to personalize workout plans, sync across devices, and improve the service. We may use aggregated, anonymized data for analytics."})]}),a.jsxs("article",{className:"terms-card",children:[a.jsx("h2",{children:"Sharing & Third Parties"}),a.jsx("p",{children:"We do not sell personal data. We may share data with service providers who assist in backup, analytics, or authentication, under appropriate agreements."})]}),a.jsxs("article",{className:"terms-card",children:[a.jsx("h2",{children:"Security"}),a.jsx("p",{children:"We use industry-standard measures to secure data but cannot guarantee absolute security. Follow secure practices and protect your account credentials."})]})]}),a.jsx("section",{className:"terms-full",children:a.jsxs("div",{className:"terms-full-inner",children:[a.jsx("h2",{children:"Full Privacy Policy"}),a.jsx("p",{children:"This Privacy Policy explains how FitBuddyAI, LLC collects, uses, discloses, and protects the personal information of users of the Service. By using the Service you consent to the collection and use of information as described in this policy."}),a.jsx("h3",{children:"1. Information We Collect"}),a.jsx("p",{children:"We collect information you provide directly (profile, email, preferences), information generated by your use of the Service (workout logs, settings), and technical information (device, browser, IP) to operate and improve the Service."}),a.jsx("h3",{children:"2. Use of Information"}),a.jsx("p",{children:"Information is used to personalize content, provide support, enable backups (when opted-in), deliver notifications, and prevent abuse."}),a.jsx("h3",{children:"3. Sharing and Disclosure"}),a.jsx("p",{children:"We may share information with vendors who perform services for us, comply with legal obligations, or protect our rights. Aggregated or anonymized data may be used for research or analytics."}),a.jsx("h3",{children:"4. Data Retention and Rights"}),a.jsx("p",{children:"We retain data as long as necessary to provide the Service or as required by law. Users may request deletion or access to their data by contacting support."}),a.jsx("h3",{children:"5. International Transfers"}),a.jsx("p",{children:"Data may be processed in different jurisdictions. We take measures to protect data when transferring across borders."}),a.jsx("h3",{children:"6. Changes to Privacy Policy"}),a.jsx("p",{children:"We may update this Privacy Policy and will provide notice for material changes. Continued use after updates constitutes acceptance."}),a.jsxs("p",{children:[a.jsx("em",{children:"Effective Date:"})," The effective date is the date you first use the Service. For privacy questions, contact our support team."]})]})}),a.jsxs("div",{className:"terms-cta-bottom",children:[a.jsx("div",{className:"terms-cta-inner",children:a.jsxs("label",{className:"terms-checkbox",children:[a.jsx("input",{type:"checkbox",checked:r,onChange:d=>n(d.target.checked)}),a.jsx("span",{children:"I have read and agree to the Privacy Policy"})]})}),a.jsx("div",{className:"terms-cta-inner stack",children:a.jsx("button",{className:"btn btn-primary btn-lg"+(o?" accepted-btn":""),onClick:c,disabled:!r||o,"aria-disabled":!r||o,children:o?"Accepted":"Accept"})})]})]})}function gb(){const[s,r]=S.useState(""),[n,o]=S.useState(!1),l=()=>o(!0),c=[{id:"start",title:"Getting Started",desc:"Create your profile and generate a plan.",icon:a.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 8v4l3 3"})]})},{id:"account",title:"Account & Sign-in",desc:"Manage sign-ins, backups and recovery.",icon:a.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]})},{id:"plans",title:"Workouts & Plans",desc:"Edit your calendar, swap workouts, and track progress.",icon:a.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"2",y:"7",width:"20",height:"14",rx:"2"}),a.jsx("path",{d:"M16 3v4"}),a.jsx("path",{d:"M8 3v4"})]})},{id:"privacy",title:"Privacy & Data",desc:"How your data is stored and secured.",icon:a.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M3 12h18"}),a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M3 18h18"})]})}],d=[{q:"How do I get my personalized workout plan?",a:"Complete the questionnaire accessible from the Get Started button. The AI will generate a plan based on your answers."},{q:"Can I change workouts or difficulty?",a:"Yes. On the calendar, tap a workout to see options for regenerating, swapping, or adjusting difficulty."},{q:"How do I restore my account or backups?",a:"If you signed up with an account, use Sign In to restore. If you used local storage, use the restore options in settings."},{q:"How is my data stored and protected?",a:"We store plans locally and optionally in cloud backups if enabled. See Privacy Policy for details."}],p=[{title:"Restore Backups",desc:"How to restore from your cloud backups or local exports."},{title:"Regenerate a Workout",desc:"Steps to regenerate a single workout in your plan."},{title:"Cancel Subscription",desc:"How to manage and cancel billing."}];return a.jsxs("div",{className:"hc-page",children:[a.jsx("header",{className:"hc-hero",children:a.jsxs("div",{className:"hc-hero-inner",children:[a.jsxs("div",{className:"hc-brand",children:[a.jsx(Et,{size:36}),a.jsxs("div",{className:"hc-brand-text",children:[a.jsx("h1",{children:"Help Center"}),a.jsx("p",{children:"Fast answers and guides to get the most from FitBuddyAI."})]})]}),a.jsxs("div",{className:"hc-search",children:[a.jsxs("div",{className:"hc-search-input",children:[a.jsx(xp,{size:18}),a.jsx("input",{placeholder:"Search help articles, e.g. 'backup'",value:s,onChange:f=>r(f.target.value)})]}),a.jsx("div",{className:"hc-search-hint",children:'Try: "restore", "calendar", "account"'})]})]})}),a.jsxs("main",{className:"hc-grid",children:[a.jsxs("aside",{className:"hc-left",children:[a.jsxs("div",{className:"hc-card compact",children:[a.jsx("h3",{children:"Popular Articles"}),a.jsx("ul",{className:"hc-popular",children:p.map((f,g)=>a.jsxs("li",{children:[a.jsx("button",{className:"link-like",onClick:l,children:f.title}),a.jsx("p",{className:"muted",children:f.desc})]},g))})]}),a.jsxs("div",{className:"hc-card compact",children:[a.jsx("h3",{children:"Contact"}),a.jsx("p",{className:"muted",children:"Need help from a human? Our support responds within 24 hours."}),a.jsx("button",{className:"btn btn-primary",onClick:l,children:"Contact Support"})]})]}),a.jsxs("section",{className:"hc-main",children:[a.jsx("div",{className:"hc-cats",children:c.map(f=>a.jsxs("article",{className:"hc-category",children:[a.jsx("div",{className:"hc-cat-icon","aria-hidden":!0,children:f.icon}),a.jsxs("div",{children:[a.jsx("h4",{children:f.title}),a.jsx("p",{className:"muted",children:f.desc})]})]},f.id))}),a.jsxs("div",{className:"hc-faq",children:[a.jsx("h2",{children:"Frequently Asked Questions"}),a.jsx(vb,{items:d})]})]}),a.jsxs("aside",{className:"hc-right",children:[a.jsxs("div",{className:"hc-card spotlight",children:[a.jsx("h3",{children:"Featured Guide"}),a.jsx("h4",{children:"Optimize Your 30-Day Plan"}),a.jsx("p",{className:"muted",children:"Tips on balancing strength, cardio, and recovery to hit your goals."}),a.jsxs("div",{className:"guide-actions",children:[a.jsx("button",{className:"btn btn-secondary",children:"Read Guide"}),a.jsx("button",{className:"btn btn-accent",onClick:l,children:"Ask Support"})]})]}),a.jsxs("div",{className:"hc-card",children:[a.jsx("h3",{children:"Resources"}),a.jsxs("ul",{className:"hc-links",children:[a.jsx("li",{children:a.jsx("a",{href:"/help/privacy",children:"Privacy Policy"})}),a.jsx("li",{children:a.jsx("a",{href:"/help/changelog",children:"Changelog"})}),a.jsx("li",{children:a.jsx("a",{href:"/help/api",children:"Developer API"})})]})]})]})]}),a.jsx(yb,{open:n,onClose:()=>o(!1),onSubmitted:()=>{o(!1),console.log("support form submitted")}})]})}function yb({open:s,onClose:r,onSubmitted:n}){const[o,l]=S.useState(""),[c,d]=S.useState(""),[p,f]=S.useState(""),[g,y]=S.useState("");if(!s)return null;const x=b=>{b.preventDefault();try{n?.()}catch{}};return a.jsx("div",{className:"hc-modal-backdrop",role:"dialog","aria-modal":"true",children:a.jsxs("div",{className:"hc-modal",children:[a.jsxs("header",{className:"hc-modal-header",children:[a.jsx("h3",{children:"Contact Support"}),a.jsx("button",{className:"hc-close",onClick:r,"aria-label":"Close",children:""})]}),a.jsxs("form",{className:"hc-form",onSubmit:x,children:[a.jsxs("label",{children:["Name",a.jsx("input",{value:o,onChange:b=>l(b.target.value),required:!0})]}),a.jsxs("label",{children:["Email",a.jsx("input",{type:"email",value:c,onChange:b=>d(b.target.value),required:!0})]}),a.jsxs("label",{children:["Subject",a.jsx("input",{value:p,onChange:b=>f(b.target.value)})]}),a.jsxs("label",{children:["Message",a.jsx("textarea",{value:g,onChange:b=>y(b.target.value),rows:6,required:!0})]}),a.jsxs("div",{className:"hc-actions",children:[a.jsx("button",{type:"button",className:"btn",onClick:r,children:"Cancel"}),a.jsx("button",{type:"submit",className:"btn btn-primary",children:"Send"})]})]})]})})}function vb({items:s}){const[r,n]=S.useState(0),o=l=>n(r===l?null:l);return a.jsx("div",{className:"accordion",role:"region","aria-label":"Help center FAQ",children:s.map((l,c)=>a.jsxs("div",{className:`accordion-item ${r===c?"open":""}`,children:[a.jsxs("button",{className:"accordion-button","aria-expanded":r===c,onClick:()=>o(c),children:[a.jsx("span",{children:l.q}),a.jsx("svg",{className:"chev",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("polyline",{points:"6 9 12 15 18 9"})})]}),a.jsx("div",{className:"accordion-panel",children:a.jsx("p",{children:l.a})})]},c))})}const wb=({theme:s,onToggleTheme:r})=>{const n=s==="theme-dark";return a.jsx("div",{className:"settings-page",children:a.jsxs("div",{className:"settings-card",children:[a.jsxs("div",{className:"settings-header",children:[a.jsx("h1",{children:"Settings"}),a.jsx("p",{className:"settings-subtitle",children:"Personalize your FitBuddyAI experience."})]}),a.jsx("div",{className:"settings-section",children:a.jsxs("div",{className:"settings-row",children:[a.jsxs("div",{children:[a.jsx("h3",{children:"Theme"}),a.jsx("p",{className:"setting-help",children:"Switch between light and dark mode."})]}),a.jsx("button",{className:"toggle-btn",onClick:r,children:n?"Switch to Light Mode":"Switch to Dark Mode"})]})})]})})},xb=()=>{const[s,r]=S.useState(""),[n,o]=S.useState("All"),[l,c]=S.useState(null),d=S.useMemo(()=>Object.entries(fu).map(([g,y])=>({title:g,...y})),[]),p=S.useMemo(()=>{const f=s.trim().toLowerCase();return d.filter(g=>{if(n!=="All"){const y=(g.difficulty||"").toLowerCase();if(n.toLowerCase()!==y&&!(n==="Moderate"&&y==="moderate"))return!1}return f?g.title.toLowerCase().includes(f)||(g.exampleNote||"").toLowerCase().includes(f)||(g.meta?.description||"").toLowerCase().includes(f):!0})},[d,s,n]);return a.jsxs("div",{className:"workouts-page",children:[a.jsxs("div",{className:"workouts-hero",children:[a.jsxs("div",{className:"hero-left",children:[a.jsx("h1",{children:"Workouts Library"}),a.jsx("p",{className:"hero-sub",children:"Explore exercises, watch technique videos, and view trusted resources  curated for quick practice."})]}),a.jsxs("div",{className:"hero-right",children:[a.jsx("div",{className:"search-wrap",children:a.jsx("input",{className:"search-input",placeholder:"Search workouts, muscles, etc.",value:s,onChange:f=>r(f.target.value),"aria-label":"Search workouts"})}),a.jsx("div",{className:"filters",children:["All","Easy","Moderate","Hard"].map(f=>a.jsx("button",{className:`filter-btn ${n===f?"active":""}`,onClick:()=>o(f),"aria-pressed":n===f,children:f},f))})]})]}),a.jsxs("div",{className:"workouts-grid",children:[p.length===0&&a.jsx("div",{className:"empty",children:"No workouts found. Try a different search."}),p.map(f=>a.jsxs("article",{className:"workout-card",children:[a.jsxs("div",{className:"card-media",children:[f.images&&f.images[0]?a.jsx("img",{src:f.images[0],alt:f.imageCaptions?.[0]||f.title}):a.jsx("div",{className:"media-fallback",children:f.title.charAt(0)}),f.featuredVideo&&a.jsx("span",{className:"featured-pill",children:"Video"})]}),a.jsxs("div",{className:"card-body",children:[a.jsx("h3",{className:"card-title",children:f.title}),a.jsxs("div",{className:"card-meta",children:[a.jsx("span",{className:`difficulty ${(f.difficulty||"").toLowerCase()}`,children:f.difficulty||"Varies"}),a.jsx("span",{className:"duration",children:f.duration||"Varies"})]}),a.jsx("p",{className:"card-desc",children:f.exampleNote||f.meta?.description?.slice(0,120)||"No description available."})]}),a.jsxs("div",{className:"card-footer",children:[a.jsx("button",{className:"btn-ghost",onClick:g=>{g.stopPropagation(),c(f.title)},children:"View"}),a.jsx("a",{className:"btn-link",href:f.resources?.[0]?.url||"#",target:"_blank",rel:"noreferrer",onClick:g=>g.stopPropagation(),children:"Resources"})]})]},f.title))]}),l&&a.jsx(bb,{title:l,data:d.find(f=>f.title===l),onClose:()=>c(null)})]})};function bb({title:s,data:r,onClose:n}){return a.jsx("div",{className:"workouts-modal-overlay",role:"dialog","aria-modal":"true","aria-label":`${s} details`,children:a.jsxs("div",{className:"workouts-modal",children:[a.jsxs("header",{className:"modal-head",children:[a.jsxs("div",{children:[a.jsx("h2",{children:s}),a.jsxs("div",{className:"meta-row",children:[a.jsx("span",{className:`difficulty ${(r.difficulty||"").toLowerCase()}`,children:r.difficulty||"Varies"}),a.jsx("span",{className:"duration",children:r.duration})]})]}),a.jsx("button",{className:"modal-close",onClick:n,"aria-label":"Close",children:""})]}),a.jsxs("main",{className:"modal-body",children:[a.jsx("div",{className:"modal-media",children:r.video?a.jsx("iframe",{src:r.video,title:`${s} video`,frameBorder:0,allowFullScreen:!0}):r.images&&r.images[0]?a.jsx("img",{src:r.images[0],alt:r.imageCaptions?.[0]||s}):a.jsx("div",{className:"media-fallback large",children:s.charAt(0)})}),a.jsxs("div",{className:"modal-info",children:[a.jsx("p",{className:"long-desc",children:r.meta?.description||r.exampleNote}),r.resources?.length?a.jsxs("section",{className:"resources",children:[a.jsx("h4",{children:"Resources"}),a.jsx("ul",{children:r.resources.map((o,l)=>a.jsx("li",{children:a.jsx("a",{href:o.url,target:"_blank",rel:"noreferrer",children:o.label})},l))})]}):null,a.jsx("div",{className:"meta-grid",children:r.meta&&Object.entries(r.meta).map(([o,l])=>a.jsxs("div",{className:"meta-item",children:[a.jsx("strong",{children:o}),a.jsx("span",{children:String(l)})]},o))})]})]}),a.jsxs("footer",{className:"modal-actions",children:[a.jsx("button",{className:"btn-primary",onClick:()=>{},children:"Add to Plan"}),a.jsx("button",{className:"btn-outline",onClick:n,children:"Close"})]})]})})}function kb(){const[s,r]=S.useState(null),[n,o]=S.useState(null),[l,c]=S.useState(0),d=Wr(),[p,f]=S.useState(0),[g,y]=S.useState(!0),[x,b]=S.useState(()=>{if(typeof window>"u")return"auto";const D=localStorage.getItem("fitbuddy_theme_mode");if(D==="light"||D==="dark"||D==="auto")return D;const O=localStorage.getItem("fitbuddy_theme");return O==="theme-dark"?"dark":O==="theme-light"?"light":"auto"});db(),S.useEffect(()=>{const D=M=>{let X="theme-light";if(M==="auto")try{const de=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)");de&&de.matches&&(X="theme-dark")}catch{}else M==="dark"&&(X="theme-dark");const G=X==="theme-dark";document.documentElement.classList.toggle("theme-dark",G),document.body.classList.toggle("theme-dark",G);try{localStorage.setItem("fitbuddy_theme",X)}catch{}};D(x);let O=null;const R=()=>{x==="auto"&&D("auto")};try{O=window.matchMedia("(prefers-color-scheme: dark)"),O&&O.addEventListener?O.addEventListener("change",R):O&&O.addListener&&O.addListener(R)}catch{}return()=>{try{O&&O.removeEventListener?O.removeEventListener("change",R):O&&O.removeListener&&O.removeListener(R)}catch{}}},[x]),S.useEffect(()=>{const D=s?.data?.theme||s?.theme;D&&(D==="theme-dark"?b("dark"):D==="theme-light"&&b("light"))},[s]);const T=D=>{b(D);try{localStorage.setItem("fitbuddy_theme_mode",D)}catch{}if(D==="light"||D==="dark"){const O=D==="dark"?"theme-dark":"theme-light",R=s,M=R?{...R}:{data:{}};M.data={...R?.data??R??{},theme:O},r(M);try{qt(M,{skipBackup:!1})}catch(X){console.warn("Failed to persist theme to user profile:",X)}}},_=()=>{T(x==="dark"?"light":"dark")};S.useEffect(()=>{if(!s?.id)return;let D=!1;const O=async()=>{if(D||typeof document<"u"&&document.hidden)return;const M=await Yo(s.id);M&&r(M)};O();const R=setInterval(O,15e3);return()=>{D=!0,clearInterval(R)}},[s?.id]),S.useEffect(()=>{const D=()=>r(null);return window.addEventListener("fitbuddyai-logout",D),()=>window.removeEventListener("fitbuddyai-logout",D)},[]),S.useEffect(()=>{const D=()=>{const O=mr(),R=gs();O&&r(O),R&&(o(R),c(M=>M+1))};return window.addEventListener("fitbuddyai-login",D),()=>window.removeEventListener("fitbuddyai-login",D)},[]),S.useEffect(()=>{const D=()=>{try{const R=mr();if(!R)return;r(M=>{try{if(!M||R.id===M.id){const X=JSON.stringify(M||{}),G=JSON.stringify(R||{});if(X!==G)return R}}catch{if(!M||R.id===M.id)return R}return M})}catch{}};window.addEventListener("storage",D);let O=null;try{O=new BroadcastChannel("fitbuddyai"),O.onmessage=()=>D()}catch{}return()=>{window.removeEventListener("storage",D);try{O&&O.close()}catch{}}},[]),S.useEffect(()=>{let D=!1;return(async()=>{const O=mr(),R=gs();if(console.log("App startup - loadUserData ->",O),console.log("App startup - loadWorkoutPlan ->",R),!D&&O&&(r(O),O.id))try{const M=await Yo(O.id);!D&&M&&r(M)}catch{}!D&&R&&(o(R),c(M=>M+1)),D||y(!1)})(),()=>{D=!0}},[]),S.useEffect(()=>{g||(s?qt(s,{skipBackup:!0}):ma())},[s,g]),S.useEffect(()=>{n&&fr(n)},[n]),S.useEffect(()=>{console.log("App: workoutPlan updated (version:",l,"):",n)},[n,l]);const E=D=>{r(O=>{if(!O)return O;const R=(O.energy||0)-D.price,M=Array.isArray(O.inventory)?O.inventory:[];return{...O,energy:R,inventory:[...M,D]}})},k=(()=>{try{if(x==="auto"){const D=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)");return D&&D.matches?"theme-dark":"theme-light"}return x==="dark"?"theme-dark":"theme-light"}catch{return"theme-light"}})();return a.jsxs("div",{className:`App ${k}`,style:{paddingBottom:"120px"},children:[a.jsx(Mw,{userData:s,profileVersion:p,theme:k}),a.jsx(fb,{userData:s}),a.jsxs(Iy,{children:[a.jsx(At,{path:"/",element:a.jsx(sv,{})}),a.jsx(At,{path:"/workouts",element:a.jsx(xb,{})}),a.jsx(At,{path:"/profile",element:a.jsx(Kx,{userData:s,onProfileUpdate:D=>{r(D),f(O=>O+1)},profileVersion:p})}),a.jsx(At,{path:"/profile/settings",element:a.jsx(wb,{theme:k,onToggleTheme:_})}),a.jsx(At,{path:"/loading",element:a.jsx(Io,{})}),a.jsx(At,{path:"/questionnaire",element:s?.id?a.jsx(yv,{onComplete:(D,O)=>{r(D),o(O),c(R=>R+1),d("/calendar")}}):g?a.jsx(Io,{}):a.jsx(kf,{to:"/signin",replace:!0})}),a.jsx(At,{path:"/calendar",element:s?.id?a.jsx(Lf,{userData:s,children:a.jsx(Rf,{workoutPlan:n,userData:s,onUpdatePlan:D=>{o(D),c(O=>O+1)}},l)}):g?a.jsx(Io,{}):a.jsx(Rf,{workoutPlan:n,userData:s,onUpdatePlan:D=>{o(D),c(O=>O+1)}},l)}),a.jsx(At,{path:"/shop",element:s?.id?a.jsx(ib,{user:s||{energy:0,inventory:[]},onPurchase:E}):g?a.jsx(Io,{}):a.jsx(kf,{to:"/signin",replace:!0})}),a.jsx(At,{path:"/chat",element:a.jsx(Lf,{userData:s,children:a.jsx(cb,{userData:s})})}),a.jsx(At,{path:"/admin",element:a.jsx(ub,{})}),a.jsx(At,{path:"/help",element:a.jsx(gb,{})}),a.jsx(At,{path:"/terms",element:a.jsx(pb,{})}),a.jsx(At,{path:"/privacy",element:a.jsx(mb,{})}),a.jsx(At,{path:"/signin",element:a.jsx(Qx,{})}),a.jsx(At,{path:"/signup",element:a.jsx(Zx,{})}),a.jsx(At,{path:"/verify-email",element:a.jsx(rb,{})}),a.jsx(At,{path:"/rickroll",element:a.jsx(hb,{})}),a.jsx(At,{path:"*",element:a.jsx($u,{})})]}),a.jsx(Uw,{themeMode:x,onChangeThemeMode:T})]})}const Sb=()=>{try{let s=!1;const r=async()=>{try{let n=null;try{const{loadUserData:o}=await et(async()=>{const{loadUserData:c}=await Promise.resolve().then(()=>ir);return{loadUserData:c}},void 0),l=o();if(n=l?.id||l?.sub||l?.data?.id||null,!n)return}catch{return}try{if(await(await et(()=>Promise.resolve().then(()=>la),void 0)).beaconBackupUserData(String(n)))return}catch{}try{(await et(()=>Promise.resolve().then(()=>la),void 0)).backupUserDataToServer(String(n))}catch{}}catch{}};s||(window.addEventListener("beforeunload",r,{passive:!0}),window.addEventListener("fitbuddyai-logout",async()=>{try{const{loadUserData:n}=await et(async()=>{const{loadUserData:d}=await Promise.resolve().then(()=>ir);return{loadUserData:d}},void 0),o=n(),l=o?.id||o?.sub||o?.data?.id||null;if(!l)return;const c=await et(()=>Promise.resolve().then(()=>la),void 0);try{await c.backupAndDeleteSensitive(String(l))}catch{}try{await c.backupUserDataToServer(String(l))}catch{}}catch{}}),s=!0)}catch{}};Sb();$g.createRoot(document.getElementById("root")).render(a.jsx(pr.StrictMode,{children:a.jsx(Wy,{children:a.jsx(kb,{})})}))});export default _b();
